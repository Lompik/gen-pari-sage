/* Generated by Cython 0.22 */

/* BEGIN: Cython Metadata
{
    "distutils": {
        "libraries": [
            "pari",
            "gmp",
            "m",
            "csage"
        ],
        "depends": [
            "misc.h",
            "mpz_pylong.h",
            "pari_err.h",
            "stdsage.h",
            "interrupt.h"
        ],
        "extra_link_args": [
            "-Wl,--library-path=build/lib.linux-x86_64-2.7",
            "-Wl,-rpath=$ORIGIN"
        ]
    }
}
END: Cython Metadata */

#define PY_SSIZE_T_CLEAN
#ifndef CYTHON_USE_PYLONG_INTERNALS
#ifdef PYLONG_BITS_IN_DIGIT
#define CYTHON_USE_PYLONG_INTERNALS 0
#else
#include "pyconfig.h"
#ifdef PYLONG_BITS_IN_DIGIT
#define CYTHON_USE_PYLONG_INTERNALS 1
#else
#define CYTHON_USE_PYLONG_INTERNALS 0
#endif
#endif
#endif
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03020000)
    #error Cython requires Python 2.6+ or Python 3.2+.
#else
#define CYTHON_ABI "0_22"
#include <stddef.h>
#ifndef offsetof
#define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
#define CYTHON_COMPILING_IN_PYPY 1
#define CYTHON_COMPILING_IN_CPYTHON 0
#else
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
#define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyClass_Type
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyType_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_VERSION_HEX < 0x030400a1 && !defined(Py_TPFLAGS_HAVE_FINALIZE)
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ? \
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_KIND(u)         (sizeof(Py_UNICODE))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)PyUnicode_AS_UNICODE(u))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)(k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
  #define __Pyx_PyFrozenSet_Size(s)         PyObject_Size(s)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ? \
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
  #define __Pyx_PyFrozenSet_Size(s)         PySet_Size(s)
#endif
#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
#else
  #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
  #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
  #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
  #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define PyNumber_Int                 PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
  #ifndef PyUnicode_InternFromString
    #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
  #endif
#endif
#if PY_VERSION_HEX < 0x030200A4
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#else
  #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  /* Initialize NaN. The sign is irrelevant, an exponent with all bits 1 and
   a nonzero mantissa means NaN. If the first bit in the mantissa is 1, it is
   a quiet NaN. */
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif
#define __Pyx_void_to_None(void_result) (void_result, Py_INCREF(Py_None), Py_None)
#ifdef __cplusplus
template<typename T>
void __Pyx_call_destructor(T* x) {
    x->~T();
}
template<typename T>
class __Pyx_FakeReference {
  public:
    __Pyx_FakeReference() : ptr(NULL) { }
    __Pyx_FakeReference(T& ref) : ptr(&ref) { }
    T *operator->() { return ptr; }
    operator T&() { return *ptr; }
  private:
    T *ptr;
};
#endif


#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
#define _USE_MATH_DEFINES
#endif
#include <math.h>
#define __PYX_HAVE__gen
#define __PYX_HAVE_API__gen
#include "string.h"
#include "stdio.h"
#include "math.h"
#include "gmp.h"
#include "setjmp.h"
#include "pari/paricfg.h"
#include "pari/pari.h"
#include "stdsage.h"
#include "pari/paripriv.h"
#include "interrupt.h"
#include "pari_err.h"
#include "misc.h"
#include "mpz_pylong.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; char *s; const Py_ssize_t n; const char* encoding;
                const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (    \
    (sizeof(type) < sizeof(Py_ssize_t))  ||             \
    (sizeof(type) > sizeof(Py_ssize_t) &&               \
          likely(v < (type)PY_SSIZE_T_MAX ||            \
                 v == (type)PY_SSIZE_T_MAX)  &&         \
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||       \
                                v == (type)PY_SSIZE_T_MIN)))  ||  \
    (sizeof(type) == sizeof(Py_ssize_t) &&              \
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||        \
                               v == (type)PY_SSIZE_T_MAX)))  )
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
#define __Pyx_PyByteArray_FromString(s) PyByteArray_FromStringAndSize((const char*)s, strlen((const char*)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if PY_MAJOR_VERSION < 3
    #define __Pyx_PyStr_FromString        __Pyx_PyBytes_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
    #define __Pyx_PyStr_FromString        __Pyx_PyUnicode_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyObject_AsSString(s)    ((signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#if PY_MAJOR_VERSION < 3
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
{
    const Py_UNICODE *u_end = u;
    while (*u_end++) ;
    return (size_t)(u_end - u - 1);
}
#else
#define __Pyx_Py_UNICODE_strlen Py_UNICODE_strlen
#endif
#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
#define __Pyx_Owned_Py_None(b) (Py_INCREF(Py_None), Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    PyObject* ascii_chars_u = NULL;
    PyObject* ascii_chars_b = NULL;
    const char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    if (strcmp(default_encoding_c, "ascii") == 0) {
        __Pyx_sys_getdefaultencoding_not_ascii = 0;
    } else {
        char ascii_chars[128];
        int c;
        for (c = 0; c < 128; c++) {
            ascii_chars[c] = c;
        }
        __Pyx_sys_getdefaultencoding_not_ascii = 1;
        ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
        if (!ascii_chars_u) goto bad;
        ascii_chars_b = PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
        if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) || memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
            PyErr_Format(
                PyExc_ValueError,
                "This module compiled with c_string_encoding=ascii, but default encoding '%.200s' is not a superset of ascii.",
                default_encoding_c);
            goto bad;
        }
        Py_DECREF(ascii_chars_u);
        Py_DECREF(ascii_chars_b);
    }
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    Py_XDECREF(ascii_chars_u);
    Py_XDECREF(ascii_chars_b);
    return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char* __PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
    if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
    strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    return -1;
}
#endif
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "gen.pyx",
  "bool.pxd",
  "complex.pxd",
  "pari_instance.pxd",
};

/* "decl.pxi":30
 *     int longjmp (jmp_buf __env, int val)
 * 
 * ctypedef unsigned long ulong             # <<<<<<<<<<<<<<
 * 
 * cdef extern from 'pari/paricfg.h':
 */
typedef unsigned long __pyx_t_13pari_instance_ulong;
typedef unsigned long __pyx_t_3gen_ulong;

/*--- Type declarations ---*/
struct __pyx_obj_13pari_instance_PariInstance;
struct __pyx_obj_3gen_gen;

/* "pari_instance.pxd":12
 * 
 * @cython.final
 * cdef class PariInstance:             # <<<<<<<<<<<<<<
 *     cdef gen PARI_ZERO, PARI_ONE, PARI_TWO
 *     cdef inline gen new_gen(self, GEN x)
 */
struct __pyx_obj_13pari_instance_PariInstance {
  PyObject_HEAD
  struct __pyx_vtabstruct_13pari_instance_PariInstance *__pyx_vtab;
  struct __pyx_obj_3gen_gen *PARI_ZERO;
  struct __pyx_obj_3gen_gen *PARI_ONE;
  struct __pyx_obj_3gen_gen *PARI_TWO;
};


/* "gen.pxd":7
 * 
 * @cython.final
 * cdef class gen:             # <<<<<<<<<<<<<<
 *      #cdef object _parent
 *      cdef GEN g
 */
struct __pyx_obj_3gen_gen {
  PyObject_HEAD
  GEN g;
  pari_sp b;
  PyObject *refers_to;
};



/* "pari_instance.pxd":12
 * 
 * @cython.final
 * cdef class PariInstance:             # <<<<<<<<<<<<<<
 *     cdef gen PARI_ZERO, PARI_ONE, PARI_TWO
 *     cdef inline gen new_gen(self, GEN x)
 */

struct __pyx_vtabstruct_13pari_instance_PariInstance {
  struct __pyx_obj_3gen_gen *(*new_gen)(struct __pyx_obj_13pari_instance_PariInstance *, GEN);
  struct __pyx_obj_3gen_gen *(*new_gen_noclear)(struct __pyx_obj_13pari_instance_PariInstance *, GEN);
  struct __pyx_obj_3gen_gen *(*new_gen_from_mpz_t)(struct __pyx_obj_13pari_instance_PariInstance *, mpz_t);
  GEN (*_new_GEN_from_mpz_t)(struct __pyx_obj_13pari_instance_PariInstance *, mpz_t);
  struct __pyx_obj_3gen_gen *(*new_gen_from_mpq_t)(struct __pyx_obj_13pari_instance_PariInstance *, mpq_t);
  GEN (*_new_GEN_from_mpq_t)(struct __pyx_obj_13pari_instance_PariInstance *, mpq_t);
  struct __pyx_obj_3gen_gen *(*new_gen_from_int)(struct __pyx_obj_13pari_instance_PariInstance *, int);
  struct __pyx_obj_3gen_gen *(*new_t_POL_from_int_star)(struct __pyx_obj_13pari_instance_PariInstance *, int *, int, long);
  struct __pyx_obj_3gen_gen *(*new_gen_from_padic)(struct __pyx_obj_13pari_instance_PariInstance *, long, long, mpz_t, mpz_t, mpz_t);
  void (*clear_stack)(struct __pyx_obj_13pari_instance_PariInstance *);
  struct __pyx_obj_3gen_gen *(*double_to_gen_c)(struct __pyx_obj_13pari_instance_PariInstance *, double);
  GEN (*double_to_GEN)(struct __pyx_obj_13pari_instance_PariInstance *, double);
  GEN (*deepcopy_to_python_heap)(struct __pyx_obj_13pari_instance_PariInstance *, GEN, pari_sp *);
  struct __pyx_obj_3gen_gen *(*new_ref)(struct __pyx_obj_13pari_instance_PariInstance *, GEN, struct __pyx_obj_3gen_gen *);
  struct __pyx_obj_3gen_gen *(*_empty_vector)(struct __pyx_obj_13pari_instance_PariInstance *, long);
  long (*get_var)(struct __pyx_obj_13pari_instance_PariInstance *, PyObject *);
  GEN (*_new_GEN_from_mpz_t_matrix)(struct __pyx_obj_13pari_instance_PariInstance *, mpz_t **, Py_ssize_t, Py_ssize_t);
  GEN (*_new_GEN_from_mpz_t_matrix_rotate90)(struct __pyx_obj_13pari_instance_PariInstance *, mpz_t **, Py_ssize_t, Py_ssize_t);
  struct __pyx_obj_3gen_gen *(*integer_matrix)(struct __pyx_obj_13pari_instance_PariInstance *, mpz_t **, Py_ssize_t, Py_ssize_t, int);
  GEN (*_new_GEN_from_mpq_t_matrix)(struct __pyx_obj_13pari_instance_PariInstance *, mpq_t **, Py_ssize_t, Py_ssize_t);
  struct __pyx_obj_3gen_gen *(*rational_matrix)(struct __pyx_obj_13pari_instance_PariInstance *, mpq_t **, Py_ssize_t, Py_ssize_t);
};
static struct __pyx_vtabstruct_13pari_instance_PariInstance *__pyx_vtabptr_13pari_instance_PariInstance;

/* --- Runtime support code (head) --- */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          if (acquire_gil) { \
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure(); \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
              PyGILState_Release(__pyx_gilstate_save); \
          } else { \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext() \
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v) do {                            \
        PyObject *tmp = (PyObject *) r;                         \
        r = v; __Pyx_XDECREF(tmp);                              \
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {                             \
        PyObject *tmp = (PyObject *) r;                         \
        r = v; __Pyx_DECREF(tmp);                               \
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_getattr))
        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
    return PyObject_GetAttr(obj, attr_name);
}
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

static PyObject *__Pyx_GetBuiltinName(PyObject *name);

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb);

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);

static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[], \
    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args, \
    const char* function_name);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);

static CYTHON_INLINE int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact);

#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) : \
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) : \
               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) : \
    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) : \
    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck);

static CYTHON_INLINE int __Pyx_PyDict_Contains(PyObject* item, PyObject* dict, int eq) {
    int result = PyDict_Contains(dict, item);
    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

#if PY_MAJOR_VERSION >= 3
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (!PyErr_Occurred()) {
            PyObject* args = PyTuple_Pack(1, key);
            if (likely(args))
                PyErr_SetObject(PyExc_KeyError, args);
            Py_XDECREF(args);
        }
        return NULL;
    }
    Py_INCREF(value);
    return value;
}
#else
    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#endif

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static CYTHON_INLINE int __Pyx_IterFinish(void);

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

#define __Pyx_SetItemInt(o, i, v, type, is_signed, to_py_func, is_list, wraparound, boundscheck) \
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ? \
    __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) : \
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) : \
               __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                               int is_list, int wraparound, int boundscheck);

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb);

static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb);

static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb);
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb);

static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** py_start, PyObject** py_stop, PyObject** py_slice,
        int has_cstart, int has_cstop, int wraparound);

#include <string.h>

static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);

static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);

#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyString_Equals __Pyx_PyUnicode_Equals
#else
#define __Pyx_PyString_Equals __Pyx_PyBytes_Equals
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len) & likely(len > (L->allocated >> 1))) {
        Py_INCREF(x);
        PyList_SET_ITEM(list, len, x);
        Py_SIZE(list) = len+1;
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
#endif

static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_ListComp_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len)) {
        Py_INCREF(x);
        PyList_SET_ITEM(list, len, x);
        Py_SIZE(list) = len+1;
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_ListComp_Append(L,x) PyList_Append(L,x)
#endif

static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);

static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg);

static CYTHON_INLINE PyObject* __Pyx_PyDict_Keys(PyObject* d);

static CYTHON_INLINE PyObject* __Pyx_PyDict_Values(PyObject* d);

static CYTHON_INLINE int __Pyx_PySequence_Contains(PyObject* item, PyObject* seq, int eq) {
    int result = PySequence_Contains(seq, item);
    return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
}

static void* __Pyx_GetVtable(PyObject *dict);

static PyObject *__Pyx_GetNameInClass(PyObject *nmspace, PyObject *name);

static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases);

static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);

#define __Pyx_CyFunction_USED 1
#include <structmember.h>
#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
#define __Pyx_CYFUNCTION_CCLASS        0x04
#define __Pyx_CyFunction_GetClosure(f) \
    (((__pyx_CyFunctionObject *) (f))->func_closure)
#define __Pyx_CyFunction_GetClassObj(f) \
    (((__pyx_CyFunctionObject *) (f))->func_classobj)
#define __Pyx_CyFunction_Defaults(type, f) \
    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
#define __Pyx_CyFunction_SetDefaultsGetter(f, g) \
    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
typedef struct {
    PyCFunctionObject func;
#if PY_VERSION_HEX < 0x030500A0
    PyObject *func_weakreflist;
#endif
    PyObject *func_dict;
    PyObject *func_name;
    PyObject *func_qualname;
    PyObject *func_doc;
    PyObject *func_globals;
    PyObject *func_code;
    PyObject *func_closure;
    PyObject *func_classobj;
    void *defaults;
    int defaults_pyobjects;
    int flags;
    PyObject *defaults_tuple;
    PyObject *defaults_kwdict;
    PyObject *(*defaults_getter)(PyObject *);
    PyObject *func_annotations;
} __pyx_CyFunctionObject;
static PyTypeObject *__pyx_CyFunctionType = 0;
#define __Pyx_CyFunction_NewEx(ml, flags, qualname, self, module, globals, code) \
    __Pyx_CyFunction_New(__pyx_CyFunctionType, ml, flags, qualname, self, module, globals, code)
static PyObject *__Pyx_CyFunction_New(PyTypeObject *, PyMethodDef *ml,
                                      int flags, PyObject* qualname,
                                      PyObject *self,
                                      PyObject *module, PyObject *globals,
                                      PyObject* code);
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
                                                         size_t size,
                                                         int pyobjects);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
                                                            PyObject *tuple);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
                                                             PyObject *dict);
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
                                                              PyObject *dict);
static int __Pyx_CyFunction_init(void);

static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name, PyObject *qualname,
                                           PyObject *mkw, PyObject *modname, PyObject *doc);
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name, PyObject *bases, PyObject *dict,
                                      PyObject *mkw, int calculate_metaclass, int allow_py2_metaclass);

typedef struct {
    int code_line;
    PyCodeObject* code_object;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

static CYTHON_INLINE unsigned long __Pyx_PyInt_As_unsigned_long(PyObject *);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_char(char value);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);

static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *, PyObject *);

static PyObject* __Pyx_Globals(void);

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_unsigned_long(unsigned long value);

static int __Pyx_Print(PyObject*, PyObject *, int);
#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

static int __Pyx_PrintOne(PyObject* stream, PyObject *o);

static int __Pyx_check_binary_version(void);

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig);

#if !defined(__Pyx_PyIdentifier_FromString)
#if PY_MAJOR_VERSION < 3
  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
#else
  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
#endif
#endif

static PyObject *__Pyx_ImportModule(const char *name);

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);

static int __Pyx_ImportVoidPtr(PyObject *module, const char *name, void **p, const char *sig);

static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig);

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);


/* Module declarations from 'libc.string' */

/* Module declarations from 'libc.stdio' */

/* Module declarations from 'libc.math' */

/* Module declarations from 'gmp.types' */

/* Module declarations from 'gmp.random' */

/* Module declarations from 'gmp.mpz' */

/* Module declarations from 'gmp.mpq' */

/* Module declarations from 'gmp.all' */

/* Module declarations from 'cython' */

/* Module declarations from 'handle_error' */
static PyObject **__pyx_vp_12handle_error_pari_error_string = 0;
#define __pyx_v_12handle_error_pari_error_string (*__pyx_vp_12handle_error_pari_error_string)
static void (*_pari_check_warning)(void); /*proto*/

/* Module declarations from 'cpython.ref' */

/* Module declarations from 'cpython.exc' */

/* Module declarations from 'cpython.module' */

/* Module declarations from 'cpython.mem' */

/* Module declarations from 'cpython.tuple' */

/* Module declarations from 'cpython.list' */

/* Module declarations from 'cpython.object' */

/* Module declarations from 'cpython.sequence' */

/* Module declarations from 'cpython.mapping' */

/* Module declarations from 'cpython.iterator' */

/* Module declarations from 'cpython.number' */

/* Module declarations from 'cpython.int' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.bool' */
static PyTypeObject *__pyx_ptype_7cpython_4bool_bool = 0;

/* Module declarations from 'cpython.long' */

/* Module declarations from 'cpython.float' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.complex' */
static PyTypeObject *__pyx_ptype_7cpython_7complex_complex = 0;

/* Module declarations from 'cpython.string' */

/* Module declarations from 'cpython.dict' */

/* Module declarations from 'cpython.instance' */

/* Module declarations from 'cpython.function' */

/* Module declarations from 'cpython.method' */

/* Module declarations from 'cpython.set' */

/* Module declarations from 'pari_instance' */
static PyTypeObject *__pyx_ptype_13pari_instance_PariInstance = 0;
static long (*__pyx_f_13pari_instance_prec_bits_to_words)(unsigned long, int __pyx_skip_dispatch); /*proto*/

/* Module declarations from 'gen' */
static PyTypeObject *__pyx_ptype_3gen_gen = 0;
static struct __pyx_obj_13pari_instance_PariInstance *__pyx_v_3gen_P = 0;
static struct __pyx_obj_3gen_gen *__pyx_f_3gen_objtogen(PyObject *); /*proto*/
static GEN __pyx_f_3gen__Vec_append(GEN, GEN, long); /*proto*/
static PyObject *__pyx_f_3gen__richcmp_(PyObject *, PyObject *, int); /*proto*/
#define __Pyx_MODULE_NAME "gen"
int __pyx_module_is_main_gen = 0;

/* Implementation of 'gen' */
static PyObject *__pyx_builtin_RuntimeError;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_TypeError;
static PyObject *__pyx_builtin_IndexError;
static PyObject *__pyx_builtin_xrange;
static PyObject *__pyx_builtin_enumerate;
static PyObject *__pyx_builtin_chr;
static PyObject *__pyx_builtin_ValueError;
static PyObject *__pyx_builtin_eval;
static PyObject *__pyx_builtin_ZeroDivisionError;
static PyObject *__pyx_builtin_AttributeError;
static int __pyx_pf_3gen_3gen___init__(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static void __pyx_pf_3gen_3gen_2__dealloc__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_4TestBesselk(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n11, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_6__repr__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static Py_hash_t __pyx_pf_3gen_3gen_8__hash__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_10_testclass(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_12list(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_14__reduce__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_16_add_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_3gen_3gen_18_sub_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_3gen_3gen_20_mul_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_3gen_3gen_22_div_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_3gen_3gen_24_add_one(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_26__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_3gen_3gen_28__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m); /* proto */
static PyObject *__pyx_pf_3gen_3gen_30__neg__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_32__xor__(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_34__rshift__(PyObject *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_36__lshift__(PyObject *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_38__invert__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_40__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_3gen_3gen_42__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_3gen_3gen_44__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_46__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
#endif
static PyObject *__pyx_pf_3gen_3gen_48getattr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
static PyObject *__pyx_pf_3gen_3gen_50mod(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_52nf_get_pol(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_54nf_get_diff(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_56nf_get_sign(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_58nf_get_zk(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_60bnf_get_no(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_62bnf_get_cyc(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_64bnf_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_66bnf_get_reg(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_68pr_get_p(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_70pr_get_e(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_72pr_get_f(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_74pr_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_76bid_get_cyc(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_78bid_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_80__getitem__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static int __pyx_pf_3gen_3gen_82__setitem__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y); /* proto */
static Py_ssize_t __pyx_pf_3gen_3gen_84__len__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_86__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op); /* proto */
static PyObject *__pyx_pf_3gen_3gen_88_cmp_c_impl(struct __pyx_obj_3gen_gen *__pyx_v_left, struct __pyx_obj_3gen_gen *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_3gen_3gen_90__copy__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_92list_str(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_94__hex__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
#endif
static PyObject *__pyx_pf_3gen_3gen_96__int__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_98python_list_small(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_100python_list(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_102python(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_locals); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_104__long__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
#endif
static PyObject *__pyx_pf_3gen_3gen_106__float__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_108__complex__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static int __pyx_pf_3gen_3gen_110__nonzero__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_112gequal(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_3gen_3gen_114gequal0(struct __pyx_obj_3gen_gen *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_3gen_3gen_116gequal_long(struct __pyx_obj_3gen_gen *__pyx_v_a, long __pyx_v_b); /* proto */
static PyObject *__pyx_pf_3gen_3gen_118isprime(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_120qfbhclassno(struct __pyx_obj_3gen_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_122ispseudoprime(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_124ispower(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_k); /* proto */
static PyObject *__pyx_pf_3gen_3gen_126divrem(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_3gen_3gen_128lex(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_130max(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_132min(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_134shift(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_136shiftmul(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_138sign(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_140vecmax(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_142vecmin(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_144Col(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_146Colrev(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_148List(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_150Mat(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_152Mod(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_154Pol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_156Polrev(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_158Qfb(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_D, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_160Ser(struct __pyx_obj_3gen_gen *__pyx_v_f, PyObject *__pyx_v_v, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_162Set(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_164Str(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_166Strchr(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_168Strexpand(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_170Strtex(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_172printtex(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_174Vec(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_176Vecrev(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_178Vecsmall(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_180binary(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_182bitand(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_184bitneg(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_186bitnegimply(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_188bitor(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_190bittest(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_192bitxor(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_194ceil(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_196centerlift(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_198component(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_200conj(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_202conjvec(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_204denominator(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_206floor(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_208frac(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_210imag(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_212length(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_214lift(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_216numbpart(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_218numerator(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_220numtoperm(struct __pyx_obj_3gen_gen *__pyx_v_k, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_222padicprec(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_224padicprime(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_226permtonum(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_228precision(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_230random(struct __pyx_obj_3gen_gen *__pyx_v_N); /* proto */
static PyObject *__pyx_pf_3gen_3gen_232real(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_234round(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_estimate); /* proto */
static PyObject *__pyx_pf_3gen_3gen_236simplify(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_238sizeword(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_240sizebyte(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_242sizedigit(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_244truncate(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_estimate); /* proto */
static PyObject *__pyx_pf_3gen_3gen_246valuation(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_248_valp(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_250variable(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_252abs(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_254acos(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_256acosh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_258agm(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_260arg(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_262asin(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_264asinh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_266atan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_268atanh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_270bernfrac(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_272bernreal(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_274bernvec(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_276besselh1(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_278besselh2(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_280besselj(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_282besseljh(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_284besseli(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_286besselk(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_288besseln(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_290cos(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_292cosh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_294cotan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_296dilog(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_298eint1(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_300erfc(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_302eta(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_304exp(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_306gamma(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_308gammah(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_310hyperu(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_312incgam(struct __pyx_obj_3gen_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_y, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_314incgamc(struct __pyx_obj_3gen_gen *__pyx_v_s, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_316log(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_318lngamma(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_320log_gamma(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_322polylog(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_m, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_324psi(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_326sin(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_328sinh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_330sqr(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_332sqrt(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_334sqrtint(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_336sqrtn(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_n, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_338tan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_340tanh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_342teichmuller(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_344theta(struct __pyx_obj_3gen_gen *__pyx_v_q, PyObject *__pyx_v_z, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_346thetanullk(struct __pyx_obj_3gen_gen *__pyx_v_q, long __pyx_v_k, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_348weber(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_350zeta(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_352bezout(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_354binomial(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_k); /* proto */
static PyObject *__pyx_pf_3gen_3gen_356contfrac(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_b, long __pyx_v_lmax); /* proto */
static PyObject *__pyx_pf_3gen_3gen_358contfracpnqn(struct __pyx_obj_3gen_gen *__pyx_v_x, CYTHON_UNUSED PyObject *__pyx_v_b, CYTHON_UNUSED long __pyx_v_lmax); /* proto */
static PyObject *__pyx_pf_3gen_3gen_360ffgen(struct __pyx_obj_3gen_gen *__pyx_v_T, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_362ffinit(struct __pyx_obj_3gen_gen *__pyx_v_p, long __pyx_v_n, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_364fibonacci(struct __pyx_obj_3gen_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_366gcd(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_368issquare(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_find_root); /* proto */
static PyObject *__pyx_pf_3gen_3gen_370issquarefree(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_372lcm(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_374primepi(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_376sumdiv(struct __pyx_obj_3gen_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_378sumdivk(struct __pyx_obj_3gen_gen *__pyx_v_n, long __pyx_v_k); /* proto */
static PyObject *__pyx_pf_3gen_3gen_380xgcd(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_382Zn_issquare(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_384Zn_sqrt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_386ellinit(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_388ellglobalred(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_390elladd(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1); /* proto */
static PyObject *__pyx_pf_3gen_3gen_392ellak(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_394ellan(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints); /* proto */
static PyObject *__pyx_pf_3gen_3gen_396ellanalyticrank(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_398ellap(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_400ellaplist(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints); /* proto */
static PyObject *__pyx_pf_3gen_3gen_402ellbil(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_404ellchangecurve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_ch); /* proto */
static PyObject *__pyx_pf_3gen_3gen_406elleta(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_408ellheight(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_410ellheightmatrix(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_412ellisoncurve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_414elllocalred(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_416elllseries(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_A, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_418ellminimalmodel(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_420ellorder(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_422ellordinate(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_424ellpointtoz(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_pt, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_426ellpow(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_428ellrootno(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_430ellsigma(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_432ellsub(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1); /* proto */
static PyObject *__pyx_pf_3gen_3gen_434elltaniyama(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_436elltors(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_438ellzeta(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_440ellztopoint(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_442omega(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_444disc(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_446j(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_448ellj(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_450bnfcertify(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_452bnfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_tech, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_454bnfisintnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_456bnfisnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_458bnfisprincipal(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_460bnfnarrow(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_462bnfsunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_S, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_464bnfunit(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_466bnfisunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_468bnrclassno(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I); /* proto */
static PyObject *__pyx_pf_3gen_3gen_470bnfissunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_sunit_data, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_472dirzetak(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_474galoisapply(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_aut, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_476galoisinit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_den); /* proto */
static PyObject *__pyx_pf_3gen_3gen_478galoispermtopol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_perm); /* proto */
static PyObject *__pyx_pf_3gen_3gen_480galoisfixedfield(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_perm, long __pyx_v_flag, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_482idealred(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I, PyObject *__pyx_v_vdir); /* proto */
static PyObject *__pyx_pf_3gen_3gen_484idealadd(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_486idealaddtoone(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_488idealappr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_490idealcoprime(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_492idealdiv(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_494idealfactor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_496idealhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_3gen_3gen_498idealintersection(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_500ideallist(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_bound, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_502ideallog(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_bid); /* proto */
static PyObject *__pyx_pf_3gen_3gen_504idealmul(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_506idealnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_508idealprimedec(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_510idealstar(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_512idealtwoelt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_3gen_3gen_514idealval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_516elementval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_518modreverse(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_520nfbasis(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_3gen_3gen_522nfbasis_d(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_3gen_3gen_524nfbasistoalg(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_526nfbasistoalg_lift(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_528nfdisc(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_530nfeltdiveuc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_532nfeltreduce(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_I); /* proto */
static PyObject *__pyx_pf_3gen_3gen_534nffactor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_536nfgenerator(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_538nfhilbert(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_540nfhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_542nfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_544nfisisom(struct __pyx_obj_3gen_gen *__pyx_v_self, struct __pyx_obj_3gen_gen *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_3gen_3gen_546nfrootsof1(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_548nfsubfields(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_d); /* proto */
static PyObject *__pyx_pf_3gen_3gen_550rnfcharpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_T, PyObject *__pyx_v_a, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_552rnfdisc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_554rnfeltabstorel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_556rnfeltreltoabs(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_558rnfequation(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_560rnfidealabstorel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_562rnfidealdown(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_564rnfidealhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_566rnfidealnormrel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_568rnfidealreltoabs(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_570rnfidealtwoelt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_572rnfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_3gen_3gen_574rnfisfree(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_3gen_3gen_576quadhilbert(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_578reverse(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_580content(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_582deriv(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_584eval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwds); /* proto */
static PyObject *__pyx_pf_3gen_3gen_586__call__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwds); /* proto */
static PyObject *__pyx_pf_3gen_3gen_588factornf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_t); /* proto */
static PyObject *__pyx_pf_3gen_3gen_590factorpadic(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_r, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_592factormod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_594intformal(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_596padicappr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_3gen_3gen_598newtonpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_600polcoeff(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_3gen_3gen_602polcompositum(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_pol2, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_604poldegree(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_3gen_3gen_606poldisc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_3gen_3gen_608poldiscreduced(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_610polgalois(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_612nfgaloisconj(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_denom, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_614nfroots(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_3gen_3gen_616polhensellift(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_p, long __pyx_v_e); /* proto */
static PyObject *__pyx_pf_3gen_3gen_618polisirreducible(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_620pollead(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_622polrecip(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_624polred(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_3gen_3gen_626polredabs(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_628polredbest(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_630polresultant(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_var, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_632polroots(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_634polrootsmod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_636polrootspadic(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r); /* proto */
static PyObject *__pyx_pf_3gen_3gen_638polrootspadicfast(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r); /* proto */
static PyObject *__pyx_pf_3gen_3gen_640polsturm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_3gen_3gen_642polsturm_full(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_644polsylvestermatrix(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_g); /* proto */
static PyObject *__pyx_pf_3gen_3gen_646polsym(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_648serconvol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_g); /* proto */
static PyObject *__pyx_pf_3gen_3gen_650serlaplace(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_652serreverse(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_654thueinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_656rnfisnorminit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_polrel, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_658rnfisnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_T, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_660vecextract(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_3gen_3gen_662ncols(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_664nrows(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_666mattranspose(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_668matadjoint(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_670qflll(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_672qflllgram(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_674lllgram(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_676lllgramint(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_678qfminim(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_b, PyObject *__pyx_v_m, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_680qfrep(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_B, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_682matsolve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_B); /* proto */
static PyObject *__pyx_pf_3gen_3gen_684matsolvemod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_D, PyObject *__pyx_v_B, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_686matker(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_688matkerint(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_690matdet(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_692trace(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_694mathnf(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_696mathnfmod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_d); /* proto */
static PyObject *__pyx_pf_3gen_3gen_698mathnfmodid(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_d); /* proto */
static PyObject *__pyx_pf_3gen_3gen_700matsnf(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_702matfrobenius(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_704factor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_limit, CYTHON_UNUSED int __pyx_v_proof); /* proto */
static PyObject *__pyx_pf_3gen_3gen_706hilbert(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_3gen_3gen_708chinese(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_710order(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_712__abs__(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_714norm(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_716nextprime(struct __pyx_obj_3gen_gen *__pyx_v_self, int __pyx_v_add_one); /* proto */
static PyObject *__pyx_pf_3gen_3gen_718change_variable_name(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_3gen_3gen_720subst(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_3gen_3gen_722substpol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_3gen_3gen_724nf_subst(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_3gen_3gen_726taylor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_3gen_3gen_728thue(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_rhs, PyObject *__pyx_v_ne); /* proto */
static PyObject *__pyx_pf_3gen_3gen_730charpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_732kronecker(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_734type(struct __pyx_obj_3gen_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_3gen_736polinterpolate(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_ya, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_3gen_3gen_738algdep(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_740concat(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_742lindep(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_3gen_3gen_744listinsert(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_746listput(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_3gen_3gen_748elleisnum(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_k, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_750ellwp(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, CYTHON_UNUSED long __pyx_v_n, long __pyx_v_flag, unsigned long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_3gen_3gen_752ellchangepoint(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_3gen_3gen_754debug(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_depth); /* proto */
static PyObject *__pyx_pf_3gen_init_pari_stack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_s); /* proto */
static PyObject *__pyx_pf_3gen_9PariError_errnum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_9PariError_2errtext(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_9PariError_4__repr__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_3gen_9PariError_6__str__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_tp_new_3gen_gen(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
static char __pyx_k_0[] = "0";
static char __pyx_k_A[] = "A";
static char __pyx_k_B[] = "B";
static char __pyx_k_D[] = "D";
static char __pyx_k_I[] = "I";
static char __pyx_k_S[] = "S";
static char __pyx_k_T[] = "T";
static char __pyx_k_a[] = "a";
static char __pyx_k_b[] = "b";
static char __pyx_k_c[] = "c";
static char __pyx_k_d[] = "d";
static char __pyx_k_e[] = "e";
static char __pyx_k_k[] = "k";
static char __pyx_k_m[] = "m";
static char __pyx_k_n[] = "n";
static char __pyx_k_p[] = "p";
static char __pyx_k_r[] = "r";
static char __pyx_k_s[] = "s";
static char __pyx_k_v[] = "v";
static char __pyx_k_x[] = "x";
static char __pyx_k_y[] = "y";
static char __pyx_k_z[] = "z";
static char __pyx_k__2[] = "_.";
static char __pyx_k__5[] = "\"";
static char __pyx_k__6[] = "..";
static char __pyx_k__8[] = "[";
static char __pyx_k_fa[] = "fa";
static char __pyx_k_ne[] = "ne";
static char __pyx_k_pt[] = "pt";
static char __pyx_k_ya[] = "ya";
static char __pyx_k_z0[] = "z0";
static char __pyx_k_z1[] = "z1";
static char __pyx_k_Mat[] = "Mat(";
static char __pyx_k_Mod[] = "Mod";
static char __pyx_k_Vec[] = "Vec";
static char __pyx_k__10[] = "]";
static char __pyx_k__11[] = "~";
static char __pyx_k__12[] = "";
static char __pyx_k__14[] = ";";
static char __pyx_k__16[] = "], [";
static char __pyx_k__29[] = "\n";
static char __pyx_k__31[] = " *";
static char __pyx_k__33[] = " .:";
static char __pyx_k_abs[] = "abs";
static char __pyx_k_aut[] = "aut";
static char __pyx_k_bid[] = "bid";
static char __pyx_k_chr[] = "chr";
static char __pyx_k_den[] = "den";
static char __pyx_k_doc[] = "__doc__";
static char __pyx_k_end[] = "end";
static char __pyx_k_gen[] = "gen";
static char __pyx_k_n11[] = "n11";
static char __pyx_k_obj[] = "obj";
static char __pyx_k_rhs[] = "rhs";
static char __pyx_k_str[] = "__str__";
static char __pyx_k_var[] = "var";
static char __pyx_k_args[] = "args";
static char __pyx_k_eval[] = "eval";
static char __pyx_k_file[] = "file";
static char __pyx_k_find[] = "find";
static char __pyx_k_flag[] = "flag";
static char __pyx_k_init[] = "_init";
static char __pyx_k_keys[] = "keys";
static char __pyx_k_line[] = "line";
static char __pyx_k_lmax[] = "lmax";
static char __pyx_k_main[] = "__main__";
static char __pyx_k_math[] = "math";
static char __pyx_k_pari[] = "pari";
static char __pyx_k_perm[] = "perm";
static char __pyx_k_pol2[] = "pol2";
static char __pyx_k_poly[] = "poly";
static char __pyx_k_repr[] = "__repr__";
static char __pyx_k_sage[] = "sage";
static char __pyx_k_self[] = "self";
static char __pyx_k_tech[] = "tech";
static char __pyx_k_test[] = "test";
static char __pyx_k_type[] = "type";
static char __pyx_k_vdir[] = "vdir";
static char __pyx_k_Mat_2[] = "Mat";
static char __pyx_k_bound[] = "bound";
static char __pyx_k_denom[] = "denom";
static char __pyx_k_depth[] = "depth";
static char __pyx_k_limit[] = "limit";
static char __pyx_k_lines[] = "lines";
static char __pyx_k_ncols[] = "ncols";
static char __pyx_k_nrows[] = "nrows";
static char __pyx_k_print[] = "print";
static char __pyx_k_proof[] = "proof";
static char __pyx_k_range[] = "range";
static char __pyx_k_split[] = "split";
static char __pyx_k_t_COL[] = "t_COL";
static char __pyx_k_t_INT[] = "t_INT";
static char __pyx_k_t_MAT[] = "t_MAT";
static char __pyx_k_t_POL[] = "t_POL";
static char __pyx_k_t_QFI[] = "t_QFI";
static char __pyx_k_t_QFR[] = "t_QFR";
static char __pyx_k_t_SER[] = "t_SER";
static char __pyx_k_t_STR[] = "t_STR";
static char __pyx_k_t_VEC[] = "t_VEC";
static char __pyx_k_types[] = "types";
static char __pyx_k_utf_8[] = "utf-8";
static char __pyx_k_Polrev[] = "Polrev";
static char __pyx_k_Strtex[] = "Strtex";
static char __pyx_k_Vecrev[] = "Vecrev";
static char __pyx_k_bezout[] = "bezout";
static char __pyx_k_encode[] = "encode";
static char __pyx_k_errnum[] = "errnum";
static char __pyx_k_eval_2[] = "_eval_";
static char __pyx_k_factor[] = "factor";
static char __pyx_k_gen_py[] = "gen_py";
static char __pyx_k_import[] = "__import__";
static char __pyx_k_locals[] = "locals";
static char __pyx_k_lstrip[] = "lstrip";
static char __pyx_k_matrix[] = "matrix";
static char __pyx_k_module[] = "__module__";
static char __pyx_k_nfinit[] = "nfinit";
static char __pyx_k_pari_2[] = "_pari_";
static char __pyx_k_polrel[] = "polrel";
static char __pyx_k_python[] = "python";
static char __pyx_k_rstrip[] = "rstrip";
static char __pyx_k_sage_2[] = "_sage_";
static char __pyx_k_silent[] = "silent";
static char __pyx_k_t_FRAC[] = "t_FRAC";
static char __pyx_k_t_LIST[] = "t_LIST";
static char __pyx_k_t_QUAD[] = "t_QUAD";
static char __pyx_k_t_REAL[] = "t_REAL";
static char __pyx_k_test_2[] = "__test__";
static char __pyx_k_values[] = "values";
static char __pyx_k_vector[] = "vector";
static char __pyx_k_xrange[] = "xrange";
static char __pyx_k_Integer[] = "Integer";
static char __pyx_k_add_one[] = "add_one";
static char __pyx_k_errtext[] = "errtext";
static char __pyx_k_getitem[] = "__getitem__";
static char __pyx_k_indices[] = "indices";
static char __pyx_k_isprime[] = "isprime";
static char __pyx_k_prepare[] = "__prepare__";
static char __pyx_k_replace[] = "replace";
static char __pyx_k_t_FFELT[] = "t_FFELT";
static char __pyx_k_t_PADIC[] = "t_PADIC";
static char __pyx_k_t_RFRAC[] = "t_RFRAC";
static char __pyx_k_ListType[] = "ListType";
static char __pyx_k_estimate[] = "estimate";
static char __pyx_k_operator[] = "operator";
static char __pyx_k_polcoeff[] = "polcoeff";
static char __pyx_k_qualname[] = "__qualname__";
static char __pyx_k_t_INTMOD[] = "t_INTMOD";
static char __pyx_k_t_POLMOD[] = "t_POLMOD";
static char __pyx_k_variable[] = "variable";
static char __pyx_k_PariError[] = "PariError";
static char __pyx_k_TupleType[] = "TupleType";
static char __pyx_k_TypeError[] = "TypeError";
static char __pyx_k_component[] = "component";
static char __pyx_k_ellaplist[] = "ellaplist";
static char __pyx_k_enumerate[] = "enumerate";
static char __pyx_k_find_root[] = "find_root";
static char __pyx_k_log_gamma[] = "log_gamma";
static char __pyx_k_metaclass[] = "__metaclass__";
static char __pyx_k_precision[] = "precision";
static char __pyx_k_qflllgram[] = "qflllgram";
static char __pyx_k_t_CLOSURE[] = "t_CLOSURE";
static char __pyx_k_t_COMPLEX[] = "t_COMPLEX";
static char __pyx_k_testclass[] = "testclass";
static char __pyx_k_IndexError[] = "IndexError";
static char __pyx_k_ValueError[] = "ValueError";
static char __pyx_k_XRangeType[] = "XRangeType";
static char __pyx_k_cmp_c_impl[] = "_cmp_c_impl";
static char __pyx_k_primelimit[] = "_primelimit";
static char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
static char __pyx_k_sunit_data[] = "sunit_data";
static char __pyx_k_t_VECSMALL[] = "t_VECSMALL";
static char __pyx_k_vecextract[] = "vecextract";
static char __pyx_k_PariError_d[] = "PariError(%d)";
static char __pyx_k_allocatemem[] = "allocatemem";
static char __pyx_k_deprecation[] = "deprecation";
static char __pyx_k_init_primes[] = "init_primes";
static char __pyx_k_python_ints[] = "python_ints";
static char __pyx_k_RuntimeError[] = "RuntimeError";
static char __pyx_k_syntax_error[] = "syntax error";
static char __pyx_k_GeneratorType[] = "GeneratorType";
static char __pyx_k_pari_instance[] = "pari_instance";
static char __pyx_k_AttributeError[] = "AttributeError";
static char __pyx_k_PariError___str[] = "PariError.__str__";
static char __pyx_k_init_pari_stack[] = "init_pari_stack";
static char __pyx_k_0123456789abcdef[] = "0123456789abcdef";
static char __pyx_k_PariError___repr[] = "PariError.__repr__";
static char __pyx_k_PariError_errnum[] = "PariError.errnum";
static char __pyx_k_PariError_errtext[] = "PariError.errtext";
static char __pyx_k_ZeroDivisionError[] = "ZeroDivisionError";
static char __pyx_k_get_real_precision[] = "get_real_precision";
static char __pyx_k_unindexable_object[] = "unindexable object";
static char __pyx_k_Unknown_PARI_type_s[] = "Unknown PARI type: %s";
static char __pyx_k_index_out_of_bounds[] = "index out of bounds";
static char __pyx_k_Error_raised_by_PARI[] = "\n    Error raised by PARI\n    ";
static char __pyx_k_get_series_precision[] = "get_series_precision";
static char __pyx_k_sage_misc_superseded[] = "sage.misc.superseded";
static char __pyx_k_row_index_out_of_bounds[] = "row index out of bounds";
static char __pyx_k_x_must_be_of_type_t_VEC[] = "x must be of type t_VEC.";
static char __pyx_k_column_index_out_of_bounds[] = "column index out of bounds";
static char __pyx_k_s_is_not_a_square_modulo_s[] = "%s is not a square modulo %s";
static char __pyx_k_Not_an_INTMOD_or_POLMOD_in_mod[] = "Not an INTMOD or POLMOD in mod()";
static char __pyx_k_Object_s_must_be_of_type_t_VEC[] = "Object (=%s) must be of type t_VEC.";
static char __pyx_k_Sage_class_for_PARI_s_GEN_type[] = "\nSage class for PARI's GEN type\n\nSee the ``PariInstance`` class for documentation and examples.\n\nAUTHORS:\n\n- William Stein (2006-03-01): updated to work with PARI 2.2.12-beta\n\n- William Stein (2006-03-06): added newtonpoly\n\n- Justin Walker: contributed some of the function definitions\n\n- Gonzalo Tornaria: improvements to conversions; much better error\n  handling.\n\n- Robert Bradshaw, Jeroen Demeyer, William Stein (2010-08-15):\n  Upgrade to PARI 2.4.3 (#9343)\n\n- Jeroen Demeyer (2011-11-12): rewrite various conversion routines\n  (#11611, #11854, #11952)\n\n- Peter Bruin (2013-11-17): move PariInstance to a separate file\n  (#15185)\n\n";
static char __pyx_k_gen_must_be_of_PARI_type_t_INT[] = "gen must be of PARI type t_INT";
static char __pyx_k_BIG_WARNING_The_number_s_wasn_t[] = "BIG WARNING: The number %s wasn't split at all by PARI, but it's definitely composite.";
static char __pyx_k_evaluating_PARI_s_takes_exactly[] = "evaluating PARI %s takes exactly 1 argument (%d given)";
static char __pyx_k_index_must_be_an_integer_or_a_2[] = "index must be an integer or a 2-tuple (i,j)";
static char __pyx_k_index_s_must_be_between_0_and_s[] = "index (%s) must be between 0 and %s";
static char __pyx_k_mnt_E_Programmation_Pari_Sage_T[] = "/mnt/E/Programmation/Pari/Sage/Test/gen.pyx";
static char __pyx_k_row_i_s_must_be_between_0_and_s[] = "row i(=%s) must be between 0 and %s";
static char __pyx_k_self_must_be_of_pari_type_t_MAT[] = "self must be of pari type t_MAT";
static char __pyx_k_Object_s_must_be_of_type_t_VECSM[] = "Object (=%s) must be of type t_VECSMALL.";
static char __pyx_k_PARI_closure_takes_at_most_d_arg[] = "PARI closure takes at most %d argument%s (%d given)";
static char __pyx_k_PARI_objects_cannot_be_instantia[] = "PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI";
static char __pyx_k_The_method_lngamma_is_deprecated[] = "The method lngamma() is deprecated. Use log_gamma() instead.";
static char __pyx_k_This_is_probably_an_infinite_loo[] = "This is probably an infinite loop...";
static char __pyx_k_Use_for_exponentiation_not_which[] = "Use ** for exponentiation, not '^', which means xor\n";
static char __pyx_k_attempt_to_assign_sequence_of_si[] = "attempt to assign sequence of size %s to slice of size %s";
static char __pyx_k_cannot_evaluate_PARI_s_using_unn[] = "cannot evaluate PARI %s using unnamed arguments";
static char __pyx_k_cannot_evaluate_a_PARI_closure_u[] = "cannot evaluate a PARI closure using keyword arguments";
static char __pyx_k_cannot_index_PARI_type_s_by_tupl[] = "cannot index PARI type %s by tuple";
static char __pyx_k_column_j_s_must_be_between_0_and[] = "column j(=%s) must be between 0 and %s";
static char __pyx_k_in_Python_and_has_the_wrong_prec[] = "in Python, and has the wrong precedence.";
static char __pyx_k_init_pari_stack_is_deprecated_us[] = "init_pari_stack() is deprecated; use pari.allocatemem() instead.";
static char __pyx_k_matrix_index_must_be_of_the_form[] = "matrix index must be of the form [row, column]";
static char __pyx_k_mixing_unnamed_and_keyword_argum[] = "mixing unnamed and keyword arguments not allowed when evaluating a PARI object";
static char __pyx_k_set_variable_only_works_for_poly[] = "set_variable() only works for polynomials or power series";
static char __pyx_k_substituting_0_in_Laurent_series[] = "substituting 0 in Laurent series with negative valuation";
static char __pyx_k_x_s_must_be_of_type_t_INT_but_is[] = "x (=%s) must be of type t_INT, but is of type %s.";
static char __pyx_k_x_s_must_be_of_type_t_VEC_but_is[] = "x (=%s) must be of type t_VEC, but is of type %s.";
static PyObject *__pyx_kp_s_0;
static PyObject *__pyx_n_s_A;
static PyObject *__pyx_n_s_AttributeError;
static PyObject *__pyx_n_s_B;
static PyObject *__pyx_kp_s_BIG_WARNING_The_number_s_wasn_t;
static PyObject *__pyx_n_s_D;
static PyObject *__pyx_kp_s_Error_raised_by_PARI;
static PyObject *__pyx_n_s_GeneratorType;
static PyObject *__pyx_n_s_I;
static PyObject *__pyx_n_s_IndexError;
static PyObject *__pyx_n_s_Integer;
static PyObject *__pyx_n_s_ListType;
static PyObject *__pyx_kp_s_Mat;
static PyObject *__pyx_n_s_Mat_2;
static PyObject *__pyx_n_s_Mod;
static PyObject *__pyx_kp_s_Not_an_INTMOD_or_POLMOD_in_mod;
static PyObject *__pyx_kp_s_Object_s_must_be_of_type_t_VEC;
static PyObject *__pyx_kp_s_Object_s_must_be_of_type_t_VECSM;
static PyObject *__pyx_kp_s_PARI_closure_takes_at_most_d_arg;
static PyObject *__pyx_kp_s_PARI_objects_cannot_be_instantia;
static PyObject *__pyx_n_s_PariError;
static PyObject *__pyx_n_s_PariError___repr;
static PyObject *__pyx_n_s_PariError___str;
static PyObject *__pyx_kp_s_PariError_d;
static PyObject *__pyx_n_s_PariError_errnum;
static PyObject *__pyx_n_s_PariError_errtext;
static PyObject *__pyx_n_s_Polrev;
static PyObject *__pyx_n_s_RuntimeError;
static PyObject *__pyx_n_s_S;
static PyObject *__pyx_n_s_Strtex;
static PyObject *__pyx_n_s_T;
static PyObject *__pyx_kp_s_The_method_lngamma_is_deprecated;
static PyObject *__pyx_kp_s_This_is_probably_an_infinite_loo;
static PyObject *__pyx_n_s_TupleType;
static PyObject *__pyx_n_s_TypeError;
static PyObject *__pyx_kp_s_Unknown_PARI_type_s;
static PyObject *__pyx_kp_s_Use_for_exponentiation_not_which;
static PyObject *__pyx_n_s_ValueError;
static PyObject *__pyx_n_s_Vec;
static PyObject *__pyx_n_s_Vecrev;
static PyObject *__pyx_n_s_XRangeType;
static PyObject *__pyx_n_s_ZeroDivisionError;
static PyObject *__pyx_kp_s__10;
static PyObject *__pyx_kp_s__11;
static PyObject *__pyx_kp_s__12;
static PyObject *__pyx_kp_s__14;
static PyObject *__pyx_kp_s__16;
static PyObject *__pyx_kp_s__2;
static PyObject *__pyx_kp_s__29;
static PyObject *__pyx_kp_s__31;
static PyObject *__pyx_kp_s__33;
static PyObject *__pyx_kp_s__5;
static PyObject *__pyx_kp_s__6;
static PyObject *__pyx_kp_s__8;
static PyObject *__pyx_n_s_a;
static PyObject *__pyx_n_s_abs;
static PyObject *__pyx_n_s_add_one;
static PyObject *__pyx_n_s_allocatemem;
static PyObject *__pyx_n_s_args;
static PyObject *__pyx_kp_s_attempt_to_assign_sequence_of_si;
static PyObject *__pyx_n_s_aut;
static PyObject *__pyx_n_s_b;
static PyObject *__pyx_n_s_bezout;
static PyObject *__pyx_n_s_bid;
static PyObject *__pyx_n_s_bound;
static PyObject *__pyx_n_s_c;
static PyObject *__pyx_kp_s_cannot_evaluate_PARI_s_using_unn;
static PyObject *__pyx_kp_s_cannot_evaluate_a_PARI_closure_u;
static PyObject *__pyx_kp_s_cannot_index_PARI_type_s_by_tupl;
static PyObject *__pyx_n_s_chr;
static PyObject *__pyx_n_s_cmp_c_impl;
static PyObject *__pyx_kp_s_column_index_out_of_bounds;
static PyObject *__pyx_kp_s_column_j_s_must_be_between_0_and;
static PyObject *__pyx_n_s_component;
static PyObject *__pyx_n_s_d;
static PyObject *__pyx_n_s_den;
static PyObject *__pyx_n_s_denom;
static PyObject *__pyx_n_s_deprecation;
static PyObject *__pyx_n_s_depth;
static PyObject *__pyx_n_s_doc;
static PyObject *__pyx_n_s_e;
static PyObject *__pyx_n_s_ellaplist;
static PyObject *__pyx_n_s_encode;
static PyObject *__pyx_n_s_end;
static PyObject *__pyx_n_s_enumerate;
static PyObject *__pyx_n_s_errnum;
static PyObject *__pyx_n_s_errtext;
static PyObject *__pyx_n_s_estimate;
static PyObject *__pyx_n_s_eval;
static PyObject *__pyx_n_s_eval_2;
static PyObject *__pyx_kp_s_evaluating_PARI_s_takes_exactly;
static PyObject *__pyx_n_s_fa;
static PyObject *__pyx_n_s_factor;
static PyObject *__pyx_n_s_file;
static PyObject *__pyx_n_s_find;
static PyObject *__pyx_n_s_find_root;
static PyObject *__pyx_n_s_flag;
static PyObject *__pyx_n_s_gen;
static PyObject *__pyx_kp_s_gen_must_be_of_PARI_type_t_INT;
static PyObject *__pyx_n_s_gen_py;
static PyObject *__pyx_n_s_get_real_precision;
static PyObject *__pyx_n_s_get_series_precision;
static PyObject *__pyx_n_s_getitem;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_kp_s_in_Python_and_has_the_wrong_prec;
static PyObject *__pyx_kp_s_index_must_be_an_integer_or_a_2;
static PyObject *__pyx_kp_s_index_out_of_bounds;
static PyObject *__pyx_kp_s_index_s_must_be_between_0_and_s;
static PyObject *__pyx_n_s_indices;
static PyObject *__pyx_n_s_init;
static PyObject *__pyx_n_s_init_pari_stack;
static PyObject *__pyx_kp_s_init_pari_stack_is_deprecated_us;
static PyObject *__pyx_n_s_init_primes;
static PyObject *__pyx_n_s_isprime;
static PyObject *__pyx_n_s_k;
static PyObject *__pyx_n_s_keys;
static PyObject *__pyx_n_s_limit;
static PyObject *__pyx_n_s_line;
static PyObject *__pyx_n_s_lines;
static PyObject *__pyx_n_s_lmax;
static PyObject *__pyx_n_s_locals;
static PyObject *__pyx_n_s_log_gamma;
static PyObject *__pyx_n_s_lstrip;
static PyObject *__pyx_n_s_m;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_s_math;
static PyObject *__pyx_n_s_matrix;
static PyObject *__pyx_kp_s_matrix_index_must_be_of_the_form;
static PyObject *__pyx_n_s_metaclass;
static PyObject *__pyx_kp_s_mixing_unnamed_and_keyword_argum;
static PyObject *__pyx_kp_s_mnt_E_Programmation_Pari_Sage_T;
static PyObject *__pyx_n_s_module;
static PyObject *__pyx_n_s_n;
static PyObject *__pyx_n_s_n11;
static PyObject *__pyx_n_s_ncols;
static PyObject *__pyx_n_s_ne;
static PyObject *__pyx_n_s_nfinit;
static PyObject *__pyx_n_s_nrows;
static PyObject *__pyx_n_s_obj;
static PyObject *__pyx_n_s_operator;
static PyObject *__pyx_n_s_p;
static PyObject *__pyx_n_s_pari;
static PyObject *__pyx_n_s_pari_2;
static PyObject *__pyx_n_s_pari_instance;
static PyObject *__pyx_n_s_perm;
static PyObject *__pyx_n_s_pol2;
static PyObject *__pyx_n_s_polcoeff;
static PyObject *__pyx_n_s_polrel;
static PyObject *__pyx_n_s_poly;
static PyObject *__pyx_n_s_precision;
static PyObject *__pyx_n_s_prepare;
static PyObject *__pyx_n_s_primelimit;
static PyObject *__pyx_n_s_print;
static PyObject *__pyx_n_s_proof;
static PyObject *__pyx_n_s_pt;
static PyObject *__pyx_n_s_python;
static PyObject *__pyx_n_s_python_ints;
static PyObject *__pyx_n_s_pyx_vtable;
static PyObject *__pyx_n_s_qflllgram;
static PyObject *__pyx_n_s_qualname;
static PyObject *__pyx_n_s_r;
static PyObject *__pyx_n_s_range;
static PyObject *__pyx_n_s_replace;
static PyObject *__pyx_n_s_repr;
static PyObject *__pyx_n_s_rhs;
static PyObject *__pyx_kp_s_row_i_s_must_be_between_0_and_s;
static PyObject *__pyx_kp_s_row_index_out_of_bounds;
static PyObject *__pyx_n_s_rstrip;
static PyObject *__pyx_n_s_s;
static PyObject *__pyx_kp_s_s_is_not_a_square_modulo_s;
static PyObject *__pyx_n_s_sage;
static PyObject *__pyx_n_s_sage_2;
static PyObject *__pyx_n_s_sage_misc_superseded;
static PyObject *__pyx_n_s_self;
static PyObject *__pyx_kp_s_self_must_be_of_pari_type_t_MAT;
static PyObject *__pyx_kp_s_set_variable_only_works_for_poly;
static PyObject *__pyx_n_s_silent;
static PyObject *__pyx_n_s_split;
static PyObject *__pyx_n_s_str;
static PyObject *__pyx_kp_s_substituting_0_in_Laurent_series;
static PyObject *__pyx_n_s_sunit_data;
static PyObject *__pyx_kp_s_syntax_error;
static PyObject *__pyx_n_s_t_CLOSURE;
static PyObject *__pyx_n_s_t_COL;
static PyObject *__pyx_n_s_t_COMPLEX;
static PyObject *__pyx_n_s_t_FFELT;
static PyObject *__pyx_n_s_t_FRAC;
static PyObject *__pyx_n_s_t_INT;
static PyObject *__pyx_n_s_t_INTMOD;
static PyObject *__pyx_n_s_t_LIST;
static PyObject *__pyx_n_s_t_MAT;
static PyObject *__pyx_n_s_t_PADIC;
static PyObject *__pyx_n_s_t_POL;
static PyObject *__pyx_n_s_t_POLMOD;
static PyObject *__pyx_n_s_t_QFI;
static PyObject *__pyx_n_s_t_QFR;
static PyObject *__pyx_n_s_t_QUAD;
static PyObject *__pyx_n_s_t_REAL;
static PyObject *__pyx_n_s_t_RFRAC;
static PyObject *__pyx_n_s_t_SER;
static PyObject *__pyx_n_s_t_STR;
static PyObject *__pyx_n_s_t_VEC;
static PyObject *__pyx_n_s_t_VECSMALL;
static PyObject *__pyx_n_s_tech;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_n_s_test_2;
static PyObject *__pyx_n_s_testclass;
static PyObject *__pyx_n_s_type;
static PyObject *__pyx_n_s_types;
static PyObject *__pyx_kp_s_unindexable_object;
static PyObject *__pyx_kp_s_utf_8;
static PyObject *__pyx_n_s_v;
static PyObject *__pyx_n_s_values;
static PyObject *__pyx_n_s_var;
static PyObject *__pyx_n_s_variable;
static PyObject *__pyx_n_s_vdir;
static PyObject *__pyx_n_s_vecextract;
static PyObject *__pyx_n_s_vector;
static PyObject *__pyx_n_s_x;
static PyObject *__pyx_kp_s_x_must_be_of_type_t_VEC;
static PyObject *__pyx_kp_s_x_s_must_be_of_type_t_INT_but_is;
static PyObject *__pyx_kp_s_x_s_must_be_of_type_t_VEC_but_is;
static PyObject *__pyx_n_s_xrange;
static PyObject *__pyx_n_s_y;
static PyObject *__pyx_n_s_ya;
static PyObject *__pyx_n_s_z;
static PyObject *__pyx_n_s_z0;
static PyObject *__pyx_n_s_z1;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_4;
static PyObject *__pyx_int_10;
static PyObject *__pyx_int_14;
static PyObject *__pyx_int_16;
static PyObject *__pyx_int_20;
static PyObject *__pyx_int_6992;
static PyObject *__pyx_int_10018;
static PyObject *__pyx_int_8000000;
static PyObject *__pyx_int_neg_1;
static PyObject *__pyx_tuple_;
static PyObject *__pyx_slice__7;
static PyObject *__pyx_slice__9;
static PyObject *__pyx_tuple__3;
static PyObject *__pyx_tuple__4;
static PyObject *__pyx_slice__21;
static PyObject *__pyx_tuple__13;
static PyObject *__pyx_tuple__15;
static PyObject *__pyx_tuple__17;
static PyObject *__pyx_tuple__18;
static PyObject *__pyx_tuple__19;
static PyObject *__pyx_tuple__20;
static PyObject *__pyx_tuple__22;
static PyObject *__pyx_tuple__23;
static PyObject *__pyx_tuple__24;
static PyObject *__pyx_tuple__25;
static PyObject *__pyx_tuple__26;
static PyObject *__pyx_tuple__27;
static PyObject *__pyx_tuple__28;
static PyObject *__pyx_tuple__30;
static PyObject *__pyx_tuple__32;
static PyObject *__pyx_tuple__34;
static PyObject *__pyx_tuple__35;
static PyObject *__pyx_tuple__36;
static PyObject *__pyx_tuple__37;
static PyObject *__pyx_tuple__39;
static PyObject *__pyx_tuple__41;
static PyObject *__pyx_tuple__43;
static PyObject *__pyx_tuple__45;
static PyObject *__pyx_codeobj__38;
static PyObject *__pyx_codeobj__40;
static PyObject *__pyx_codeobj__42;
static PyObject *__pyx_codeobj__44;
static PyObject *__pyx_codeobj__46;

/* "gen.pyx":87
 *     Python extension class that models the PARI GEN type.
 *     """
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")
 * 
 */

/* Python wrapper */
static int __pyx_pw_3gen_3gen_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_3gen_3gen_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_3gen_3gen___init__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_3gen_3gen___init__(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "gen.pyx":88
 *     """
 *     def __init__(self):
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":87
 *     Python extension class that models the PARI GEN type.
 *     """
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":90
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         if self.b:
 *             sage_free(<void*> self.b)
 */

/* Python wrapper */
static void __pyx_pw_3gen_3gen_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_3gen_3gen_3__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_pf_3gen_3gen_2__dealloc__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_3gen_3gen_2__dealloc__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "gen.pyx":91
 * 
 *     def __dealloc__(self):
 *         if self.b:             # <<<<<<<<<<<<<<
 *             sage_free(<void*> self.b)
 * 
 */
  __pyx_t_1 = (__pyx_v_self->b != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":92
 *     def __dealloc__(self):
 *         if self.b:
 *             sage_free(<void*> self.b)             # <<<<<<<<<<<<<<
 * 
 *     def TestBesselk(self,long n11=10000, long precision=0):
 */
    sage_free(((void *)__pyx_v_self->b));
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "gen.pyx":90
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         if self.b:
 *             sage_free(<void*> self.b)
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "gen.pyx":94
 *             sage_free(<void*> self.b)
 * 
 *     def TestBesselk(self,long n11=10000, long precision=0):             # <<<<<<<<<<<<<<
 *          pari_catch_sig_on()
 *          cdef GEN b	  #/[inserted by cython to avoid comment start]* vec *[inserted by cython to avoid comment closer]/
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_5TestBesselk(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_5TestBesselk(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n11;
  long __pyx_v_precision;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("TestBesselk (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n11,&__pyx_n_s_precision,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n11);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "TestBesselk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_n11 = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n11 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_n11 = ((long)10000);
    }
    if (values[1]) {
      __pyx_v_precision = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_precision = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("TestBesselk", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.TestBesselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_4TestBesselk(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_n11, __pyx_v_precision);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_4TestBesselk(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n11, long __pyx_v_precision) {
  GEN __pyx_v_b;
  CYTHON_UNUSED GEN __pyx_v_temp;
  long __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  long __pyx_t_6;
  long __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("TestBesselk", 0);

  /* "gen.pyx":95
 * 
 *     def TestBesselk(self,long n11=10000, long precision=0):
 *          pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *          cdef GEN b	  #/[inserted by cython to avoid comment start]* vec *[inserted by cython to avoid comment closer]/
 *          cdef GEN temp
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":98
 *          cdef GEN b	  #/[inserted by cython to avoid comment start]* vec *[inserted by cython to avoid comment closer]/
 *          cdef GEN temp
 *          b = cgetg(n11,t_VEC)             # <<<<<<<<<<<<<<
 *          if precision==0:
 *              precision=P.get_real_precision();
 */
  __pyx_v_b = cgetg(__pyx_v_n11, t_VEC);

  /* "gen.pyx":99
 *          cdef GEN temp
 *          b = cgetg(n11,t_VEC)
 *          if precision==0:             # <<<<<<<<<<<<<<
 *              precision=P.get_real_precision();
 *          cdef long i;
 */
  __pyx_t_2 = ((__pyx_v_precision == 0) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":100
 *          b = cgetg(n11,t_VEC)
 *          if precision==0:
 *              precision=P.get_real_precision();             # <<<<<<<<<<<<<<
 *          cdef long i;
 *          for i in range(1,n11):
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_get_real_precision); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_5) {
      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_precision = __pyx_t_6;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "gen.pyx":102
 *              precision=P.get_real_precision();
 *          cdef long i;
 *          for i in range(1,n11):             # <<<<<<<<<<<<<<
 *              temp = gel(b, i)
 *              temp = kbessel(gen_0, gen_1, precision)
 */
  __pyx_t_6 = __pyx_v_n11;
  for (__pyx_t_7 = 1; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;

    /* "gen.pyx":103
 *          cdef long i;
 *          for i in range(1,n11):
 *              temp = gel(b, i)             # <<<<<<<<<<<<<<
 *              temp = kbessel(gen_0, gen_1, precision)
 *          return P.new_gen(b)
 */
    __pyx_v_temp = gel(__pyx_v_b, __pyx_v_i);

    /* "gen.pyx":104
 *          for i in range(1,n11):
 *              temp = gel(b, i)
 *              temp = kbessel(gen_0, gen_1, precision)             # <<<<<<<<<<<<<<
 *          return P.new_gen(b)
 * 
 */
    __pyx_v_temp = kbessel(gen_0, gen_1, __pyx_v_precision);
  }

  /* "gen.pyx":105
 *              temp = gel(b, i)
 *              temp = kbessel(gen_0, gen_1, precision)
 *          return P.new_gen(b)             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_b)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "gen.pyx":94
 *             sage_free(<void*> self.b)
 * 
 *     def TestBesselk(self,long n11=10000, long precision=0):             # <<<<<<<<<<<<<<
 *          pari_catch_sig_on()
 *          cdef GEN b	  #/[inserted by cython to avoid comment start]* vec *[inserted by cython to avoid comment closer]/
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("gen.gen.TestBesselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":107
 *          return P.new_gen(b)
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         cdef char *c
 *         pari_catch_sig_on()
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_7__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_7__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_6__repr__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_6__repr__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  char *__pyx_v_c;
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__repr__", 0);

  /* "gen.pyx":109
 *     def __repr__(self):
 *         cdef char *c
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # Use sig_block(), which is needed because GENtostr() uses
 *         # malloc(), which is dangerous inside sig_on()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":112
 *         # Use sig_block(), which is needed because GENtostr() uses
 *         # malloc(), which is dangerous inside sig_on()
 *         sig_block()             # <<<<<<<<<<<<<<
 *         c = GENtostr(self.g)
 *         sig_unblock()
 */
  sig_block();

  /* "gen.pyx":113
 *         # malloc(), which is dangerous inside sig_on()
 *         sig_block()
 *         c = GENtostr(self.g)             # <<<<<<<<<<<<<<
 *         sig_unblock()
 *         pari_catch_sig_off()
 */
  __pyx_v_c = GENtostr(__pyx_v_self->g);

  /* "gen.pyx":114
 *         sig_block()
 *         c = GENtostr(self.g)
 *         sig_unblock()             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 * 
 */
  sig_unblock();

  /* "gen.pyx":115
 *         c = GENtostr(self.g)
 *         sig_unblock()
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 * 
 *         s = str(c)
 */
  pari_catch_sig_off();

  /* "gen.pyx":117
 *         pari_catch_sig_off()
 * 
 *         s = str(c)             # <<<<<<<<<<<<<<
 *         pari_free(c)
 *         return s
 */
  __pyx_t_2 = __Pyx_PyBytes_FromString(__pyx_v_c); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "gen.pyx":118
 * 
 *         s = str(c)
 *         pari_free(c)             # <<<<<<<<<<<<<<
 *         return s
 * 
 */
  pari_free(__pyx_v_c);

  /* "gen.pyx":119
 *         s = str(c)
 *         pari_free(c)
 *         return s             # <<<<<<<<<<<<<<
 * 
 *     def __hash__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_s);
  __pyx_r = __pyx_v_s;
  goto __pyx_L0;

  /* "gen.pyx":107
 *          return P.new_gen(b)
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         cdef char *c
 *         pari_catch_sig_on()
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("gen.gen.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":121
 *         return s
 * 
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hash of self, computed using PARI's hash_GEN().
 */

/* Python wrapper */
static Py_hash_t __pyx_pw_3gen_3gen_9__hash__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_3gen_3gen_8__hash__[] = "\n        Return the hash of self, computed using PARI's hash_GEN().\n\n        TESTS::\n\n            sage: type(pari('1 + 2.0*I').__hash__())\n            <type 'int'>\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_8__hash__;
#endif
static Py_hash_t __pyx_pw_3gen_3gen_9__hash__(PyObject *__pyx_v_self) {
  Py_hash_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__hash__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_8__hash__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static Py_hash_t __pyx_pf_3gen_3gen_8__hash__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_h;
  Py_hash_t __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__hash__", 0);

  /* "gen.pyx":131
 *         """
 *         cdef long h
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         h = hash_GEN(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":132
 *         cdef long h
 *         pari_catch_sig_on()
 *         h = hash_GEN(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return h
 */
  __pyx_v_h = hash_GEN(__pyx_v_self->g);

  /* "gen.pyx":133
 *         pari_catch_sig_on()
 *         h = hash_GEN(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return h
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":134
 *         h = hash_GEN(self.g)
 *         pari_catch_sig_off()
 *         return h             # <<<<<<<<<<<<<<
 * 
 *     def _testclass(self):
 */
  __pyx_r = __pyx_v_h;
  goto __pyx_L0;

  /* "gen.pyx":121
 *         return s
 * 
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hash of self, computed using PARI's hash_GEN().
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_AddTraceback("gen.gen.__hash__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  if (unlikely(__pyx_r == -1) && !PyErr_Occurred()) __pyx_r = -2;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":136
 *         return h
 * 
 *     def _testclass(self):             # <<<<<<<<<<<<<<
 *         import test
 *         T = test.testclass()
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_11_testclass(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_11_testclass(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_testclass (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_10_testclass(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_10_testclass(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_v_test = NULL;
  PyObject *__pyx_v_T = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_testclass", 0);

  /* "gen.pyx":137
 * 
 *     def _testclass(self):
 *         import test             # <<<<<<<<<<<<<<
 *         T = test.testclass()
 *         T._init(self)
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_test, 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_test = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "gen.pyx":138
 *     def _testclass(self):
 *         import test
 *         T = test.testclass()             # <<<<<<<<<<<<<<
 *         T._init(self)
 *         return T
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_test, __pyx_n_s_testclass); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_T = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "gen.pyx":139
 *         import test
 *         T = test.testclass()
 *         T._init(self)             # <<<<<<<<<<<<<<
 *         return T
 * 
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_T, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __Pyx_GIVEREF(__pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_self));
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_self));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "gen.pyx":140
 *         T = test.testclass()
 *         T._init(self)
 *         return T             # <<<<<<<<<<<<<<
 * 
 *     def list(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_T);
  __pyx_r = __pyx_v_T;
  goto __pyx_L0;

  /* "gen.pyx":136
 *         return h
 * 
 *     def _testclass(self):             # <<<<<<<<<<<<<<
 *         import test
 *         T = test.testclass()
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen._testclass", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_test);
  __Pyx_XDECREF(__pyx_v_T);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":142
 *         return T
 * 
 *     def list(self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert self to a list of PARI gens.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_13list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_12list[] = "\n        Convert self to a list of PARI gens.\n\n        EXAMPLES:\n\n        A PARI vector becomes a Sage list::\n\n            sage: L = pari(\"vector(10,i,i^2)\").list()\n            sage: L\n            [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n            sage: type(L)\n            <type 'list'>\n            sage: type(L[0])\n            <type 'gen.gen'>\n\n        For polynomials, list() behaves as for ordinary Sage polynomials::\n\n            sage: pol = pari(\"x^3 + 5/3*x\"); pol.list()\n            [0, 5/3, 0, 1]\n\n        For power series or Laurent series, we get all coefficients starting\n        from the lowest degree term.  This includes trailing zeros::\n\n            sage: R.<x> = LaurentSeriesRing(QQ)\n            sage: s = x^2 + O(x^8)\n            sage: s.list()\n            [1]\n            sage: pari(s).list()\n            [1, 0, 0, 0, 0, 0]\n            sage: s = x^-2 + O(x^0)\n            sage: s.list()\n            [1]\n            sage: pari(s).list()\n            [1, 0]\n\n        For matrices, we get a list of columns::\n\n            sage: M = matrix(ZZ,3,2,[1,4,2,5,3,6]); M\n            [1 4]\n            [2 5]\n            [3 6]\n            sage: pari(M).list()\n            [[1, 2, 3]~, [4, 5, 6]~]\n\n        For \"scalar\" types, we get a 1-element list containing ``self``::\n\n            sage: pari(\"42\").list()\n            [42]\n        ";
static PyObject *__pyx_pw_3gen_3gen_13list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("list (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_12list(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_12list(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("list", 0);

  /* "gen.pyx":192
 *             [42]
 *         """
 *         if typ(self.g) == t_POL:             # <<<<<<<<<<<<<<
 *             return list(self.Vecrev())
 *         return list(self.Vec())
 */
  __pyx_t_1 = ((typ(__pyx_v_self->g) == t_POL) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":193
 *         """
 *         if typ(self.g) == t_POL:
 *             return list(self.Vecrev())             # <<<<<<<<<<<<<<
 *         return list(self.Vec())
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_Vecrev); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":194
 *         if typ(self.g) == t_POL:
 *             return list(self.Vecrev())
 *         return list(self.Vec())             # <<<<<<<<<<<<<<
 * 
 *     def __reduce__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_Vec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":142
 *         return T
 * 
 *     def list(self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert self to a list of PARI gens.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":196
 *         return list(self.Vec())
 * 
 *     def __reduce__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_15__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_14__reduce__[] = "\n        EXAMPLES::\n\n            sage: f = pari('x^3 - 3')\n            sage: loads(dumps(f)) == f\n            True\n        ";
static PyObject *__pyx_pw_3gen_3gen_15__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_14__reduce__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_14__reduce__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_gen_py = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce__", 0);

  /* "gen.pyx":204
 *             True
 *         """
 *         s = str(self)             # <<<<<<<<<<<<<<
 *         import gen_py
 *         return gen_py.pari, (s,)
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "gen.pyx":205
 *         """
 *         s = str(self)
 *         import gen_py             # <<<<<<<<<<<<<<
 *         return gen_py.pari, (s,)
 * 
 */
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_gen_py, 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_gen_py = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "gen.pyx":206
 *         s = str(self)
 *         import gen_py
 *         return gen_py.pari, (s,)             # <<<<<<<<<<<<<<
 * 
 *     def  _add_(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_gen_py, __pyx_n_s_pari); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_v_s);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_s);
  __Pyx_GIVEREF(__pyx_v_s);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "gen.pyx":196
 *         return list(self.Vec())
 * 
 *     def __reduce__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("gen.gen.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XDECREF(__pyx_v_gen_py);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":208
 *         return gen_py.pari, (s,)
 * 
 *     def  _add_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gadd(self.g, (<gen>right).g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_17_add_(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_17_add_(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_add_ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_16_add_(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_right));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_16_add_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_add_", 0);

  /* "gen.pyx":209
 * 
 *     def  _add_(self,  right):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gadd(self.g, (<gen>right).g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":210
 *     def  _add_(self,  right):
 *         pari_catch_sig_on()
 *         return P.new_gen(gadd(self.g, (<gen>right).g))             # <<<<<<<<<<<<<<
 * 
 *     def  _sub_(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gadd(__pyx_v_self->g, ((struct __pyx_obj_3gen_gen *)__pyx_v_right)->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":208
 *         return gen_py.pari, (s,)
 * 
 *     def  _add_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gadd(self.g, (<gen>right).g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen._add_", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":212
 *         return P.new_gen(gadd(self.g, (<gen>right).g))
 * 
 *     def  _sub_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsub(self.g, (<gen> right).g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_19_sub_(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_19_sub_(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_sub_ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_18_sub_(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_right));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_18_sub_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_sub_", 0);

  /* "gen.pyx":213
 * 
 *     def  _sub_(self,  right):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsub(self.g, (<gen> right).g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":214
 *     def  _sub_(self,  right):
 *         pari_catch_sig_on()
 *         return P.new_gen(gsub(self.g, (<gen> right).g))             # <<<<<<<<<<<<<<
 * 
 *     def  _mul_(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsub(__pyx_v_self->g, ((struct __pyx_obj_3gen_gen *)__pyx_v_right)->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":212
 *         return P.new_gen(gadd(self.g, (<gen>right).g))
 * 
 *     def  _sub_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsub(self.g, (<gen> right).g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen._sub_", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":216
 *         return P.new_gen(gsub(self.g, (<gen> right).g))
 * 
 *     def  _mul_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul(self.g, (<gen>right).g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_21_mul_(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_21_mul_(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_mul_ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_20_mul_(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_right));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_20_mul_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_mul_", 0);

  /* "gen.pyx":217
 * 
 *     def  _mul_(self,  right):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmul(self.g, (<gen>right).g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":218
 *     def  _mul_(self,  right):
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul(self.g, (<gen>right).g))             # <<<<<<<<<<<<<<
 * 
 *     def  _div_(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmul(__pyx_v_self->g, ((struct __pyx_obj_3gen_gen *)__pyx_v_right)->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":216
 *         return P.new_gen(gsub(self.g, (<gen> right).g))
 * 
 *     def  _mul_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul(self.g, (<gen>right).g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen._mul_", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":220
 *         return P.new_gen(gmul(self.g, (<gen>right).g))
 * 
 *     def  _div_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_23_div_(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_23_div_(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_div_ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_22_div_(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_right));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_22_div_(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_div_", 0);

  /* "gen.pyx":221
 * 
 *     def  _div_(self,  right):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":222
 *     def  _div_(self,  right):
 *         pari_catch_sig_on()
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))             # <<<<<<<<<<<<<<
 * 
 *     def _add_one(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gdiv(__pyx_v_self->g, ((struct __pyx_obj_3gen_gen *)__pyx_v_right)->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":220
 *         return P.new_gen(gmul(self.g, (<gen>right).g))
 * 
 *     def  _div_(self,  right):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen._div_", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":224
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))
 * 
 *     def _add_one(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return self + 1.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_25_add_one(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_24_add_one[] = "\n        Return self + 1.\n\n        OUTPUT: pari gen\n\n        EXAMPLES::\n\n            sage: n = pari(5)\n            sage: n._add_one()\n            6\n            sage: n = pari('x^3')\n            sage: n._add_one()\n            x^3 + 1\n        ";
static PyObject *__pyx_pw_3gen_3gen_25_add_one(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_add_one (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_24_add_one(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_24_add_one(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_add_one", 0);

  /* "gen.pyx":239
 *             x^3 + 1
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gaddsg(1, self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":240
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gaddsg(1, self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __mod__(self, other):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gaddsg(1, __pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":224
 *         return P.new_gen(gdiv(self.g, (<gen>right).g))
 * 
 *     def _add_one(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return self + 1.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen._add_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":242
 *         return P.new_gen(gaddsg(1, self.g))
 * 
 *     def __mod__(self, other):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``self`` modulo ``other``.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_27__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static char __pyx_doc_3gen_3gen_26__mod__[] = "\n        Return ``self`` modulo ``other``.\n\n        EXAMPLES::\n\n            sage: pari(15) % pari(6)\n            3\n            sage: pari(\"x^3+x^2+x+1\") % pari(\"x^2\")\n            x + 1\n            sage: pari(-2) % int(3)\n            1\n            sage: int(-2) % pari(3)\n            1\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_26__mod__;
#endif
static PyObject *__pyx_pw_3gen_3gen_27__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__mod__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_26__mod__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_26__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_3gen_gen *__pyx_v_selfgen = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_othergen = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__mod__", 0);

  /* "gen.pyx":257
 *             1
 *         """
 *         cdef gen selfgen = objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen othergen = objtogen(other)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_selfgen = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":258
 *         """
 *         cdef gen selfgen = objtogen(self)
 *         cdef gen othergen = objtogen(other)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmod(selfgen.g, othergen.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_other)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_othergen = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":259
 *         cdef gen selfgen = objtogen(self)
 *         cdef gen othergen = objtogen(other)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmod(selfgen.g, othergen.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":260
 *         cdef gen othergen = objtogen(other)
 *         pari_catch_sig_on()
 *         return P.new_gen(gmod(selfgen.g, othergen.g))             # <<<<<<<<<<<<<<
 * 
 *     def __pow__(self, n, m):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmod(__pyx_v_selfgen->g, __pyx_v_othergen->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":242
 *         return P.new_gen(gaddsg(1, self.g))
 * 
 *     def __mod__(self, other):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``self`` modulo ``other``.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__mod__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_selfgen);
  __Pyx_XDECREF((PyObject *)__pyx_v_othergen);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":262
 *         return P.new_gen(gmod(selfgen.g, othergen.g))
 * 
 *     def __pow__(self, n, m):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``self`` to the power ``n`` (if ``m`` is ``None``) or
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_29__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m); /*proto*/
static char __pyx_doc_3gen_3gen_28__pow__[] = "\n        Return ``self`` to the power ``n`` (if ``m`` is ``None``) or\n        ``Mod(self, m)^n`` if ``m`` is not ``None``.\n\n        EXAMPLES::\n\n            sage: pari(5) ^ pari(3)\n            125\n            sage: pari(\"x-1\") ^ 3\n            x^3 - 3*x^2 + 3*x - 1\n            sage: pow(pari(5), pari(28), int(29))\n            Mod(1, 29)\n            sage: int(2) ^ pari(-5)\n            1/32\n            sage: pari(2) ^ int(-5)\n            1/32\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_28__pow__;
#endif
static PyObject *__pyx_pw_3gen_3gen_29__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__pow__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_28__pow__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_n), ((PyObject *)__pyx_v_m));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_28__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__pow__", 0);

  /* "gen.pyx":280
 *             1/32
 *         """
 *         cdef gen t0 = objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(n)
 *         if m is not None:
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":281
 *         """
 *         cdef gen t0 = objtogen(self)
 *         cdef gen t1 = objtogen(n)             # <<<<<<<<<<<<<<
 *         if m is not None:
 *             t0 = t0.Mod(m)
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":282
 *         cdef gen t0 = objtogen(self)
 *         cdef gen t1 = objtogen(n)
 *         if m is not None:             # <<<<<<<<<<<<<<
 *             t0 = t0.Mod(m)
 *         pari_catch_sig_on()
 */
  __pyx_t_2 = (__pyx_v_m != Py_None);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {

    /* "gen.pyx":283
 *         cdef gen t1 = objtogen(n)
 *         if m is not None:
 *             t0 = t0.Mod(m)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gpow(t0.g, t1.g, prec_bits_to_words(0)))
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_t0), __pyx_n_s_Mod); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_m); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_v_m);
      PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_v_m);
      __Pyx_GIVEREF(__pyx_v_m);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_3gen_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF_SET(__pyx_v_t0, ((struct __pyx_obj_3gen_gen *)__pyx_t_1));
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "gen.pyx":284
 *         if m is not None:
 *             t0 = t0.Mod(m)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gpow(t0.g, t1.g, prec_bits_to_words(0)))
 * 
 */
  __pyx_t_7 = pari_catch_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":285
 *             t0 = t0.Mod(m)
 *         pari_catch_sig_on()
 *         return P.new_gen(gpow(t0.g, t1.g, prec_bits_to_words(0)))             # <<<<<<<<<<<<<<
 * 
 *     def __neg__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gpow(__pyx_v_t0->g, __pyx_v_t1->g, __pyx_f_13pari_instance_prec_bits_to_words(0, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":262
 *         return P.new_gen(gmod(selfgen.g, othergen.g))
 * 
 *     def __pow__(self, n, m):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``self`` to the power ``n`` (if ``m`` is ``None``) or
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("gen.gen.__pow__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":287
 *         return P.new_gen(gpow(t0.g, t1.g, prec_bits_to_words(0)))
 * 
 *     def __neg__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gneg(self.g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_31__neg__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_31__neg__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__neg__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_30__neg__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_30__neg__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__neg__", 0);

  /* "gen.pyx":288
 * 
 *     def __neg__(gen self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gneg(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":289
 *     def __neg__(gen self):
 *         pari_catch_sig_on()
 *         return P.new_gen(gneg(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __xor__(gen self, n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gneg(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":287
 *         return P.new_gen(gpow(t0.g, t1.g, prec_bits_to_words(0)))
 * 
 *     def __neg__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gneg(self.g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__neg__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":291
 *         return P.new_gen(gneg(self.g))
 * 
 *     def __xor__(gen self, n):             # <<<<<<<<<<<<<<
 *         raise RuntimeError, "Use ** for exponentiation, not '^', which means xor\n"+\
 *               "in Python, and has the wrong precedence."
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_33__xor__(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_33__xor__(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__xor__ (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_self), __pyx_ptype_3gen_gen, 1, "self", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_3gen_3gen_32__xor__(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_32__xor__(CYTHON_UNUSED struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__xor__", 0);

  /* "gen.pyx":292
 * 
 *     def __xor__(gen self, n):
 *         raise RuntimeError, "Use ** for exponentiation, not '^', which means xor\n"+\             # <<<<<<<<<<<<<<
 *               "in Python, and has the wrong precedence."
 * 
 */
  __pyx_t_1 = PyNumber_Add(__pyx_kp_s_Use_for_exponentiation_not_which, __pyx_kp_s_in_Python_and_has_the_wrong_prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_Raise(__pyx_builtin_RuntimeError, __pyx_t_1, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":291
 *         return P.new_gen(gneg(self.g))
 * 
 *     def __xor__(gen self, n):             # <<<<<<<<<<<<<<
 *         raise RuntimeError, "Use ** for exponentiation, not '^', which means xor\n"+\
 *               "in Python, and has the wrong precedence."
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__xor__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":295
 *               "in Python, and has the wrong precedence."
 * 
 *     def __rshift__(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Divide ``self`` by `2^n` (truncating or not, depending on the
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_35__rshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_3gen_3gen_34__rshift__[] = "\n        Divide ``self`` by `2^n` (truncating or not, depending on the\n        input type).\n\n        EXAMPLES::\n\n            sage: pari(25) >> 3\n            3\n            sage: pari(25/2) >> 2\n            25/8\n            sage: pari(\"x\") >> 3\n            1/8*x\n            sage: pari(1.0) >> 100\n            7.88860905221012 E-31\n            sage: int(33) >> pari(2)\n            8\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_34__rshift__;
#endif
static PyObject *__pyx_pw_3gen_3gen_35__rshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__rshift__ (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 295; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.__rshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_34__rshift__(((PyObject *)__pyx_v_self), ((long)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_34__rshift__(PyObject *__pyx_v_self, long __pyx_v_n) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__rshift__", 0);

  /* "gen.pyx":313
 *             8
 *         """
 *         cdef gen t0 = objtogen(self)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gshift(t0.g, -n))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":314
 *         """
 *         cdef gen t0 = objtogen(self)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(t0.g, -n))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":315
 *         cdef gen t0 = objtogen(self)
 *         pari_catch_sig_on()
 *         return P.new_gen(gshift(t0.g, -n))             # <<<<<<<<<<<<<<
 * 
 *     def __lshift__(self, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gshift(__pyx_v_t0->g, (-__pyx_v_n)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":295
 *               "in Python, and has the wrong precedence."
 * 
 *     def __rshift__(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Divide ``self`` by `2^n` (truncating or not, depending on the
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__rshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":317
 *         return P.new_gen(gshift(t0.g, -n))
 * 
 *     def __lshift__(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Multiply ``self`` by `2^n`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_37__lshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_3gen_3gen_36__lshift__[] = "\n        Multiply ``self`` by `2^n`.\n\n        EXAMPLES::\n\n            sage: pari(25) << 3\n            200\n            sage: pari(25/32) << 2\n            25/8\n            sage: pari(\"x\") << 3\n            8*x\n            sage: pari(1.0) << 100\n            1.26765060022823 E30\n            sage: int(33) << pari(2)\n            132\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_36__lshift__;
#endif
static PyObject *__pyx_pw_3gen_3gen_37__lshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__lshift__ (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.__lshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_36__lshift__(((PyObject *)__pyx_v_self), ((long)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_36__lshift__(PyObject *__pyx_v_self, long __pyx_v_n) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__lshift__", 0);

  /* "gen.pyx":334
 *             132
 *         """
 *         cdef gen t0 = objtogen(self)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gshift(t0.g, n))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":335
 *         """
 *         cdef gen t0 = objtogen(self)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(t0.g, n))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":336
 *         cdef gen t0 = objtogen(self)
 *         pari_catch_sig_on()
 *         return P.new_gen(gshift(t0.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def __invert__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gshift(__pyx_v_t0->g, __pyx_v_n))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":317
 *         return P.new_gen(gshift(t0.g, -n))
 * 
 *     def __lshift__(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Multiply ``self`` by `2^n`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__lshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":338
 *         return P.new_gen(gshift(t0.g, n))
 * 
 *     def __invert__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ginv(self.g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_39__invert__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_39__invert__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__invert__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_38__invert__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_38__invert__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__invert__", 0);

  /* "gen.pyx":339
 * 
 *     def __invert__(gen self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ginv(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":340
 *     def __invert__(gen self):
 *         pari_catch_sig_on()
 *         return P.new_gen(ginv(self.g))             # <<<<<<<<<<<<<<
 * 
 *     ######################################## Arithmetic Operator
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ginv(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":338
 *         return P.new_gen(gshift(t0.g, n))
 * 
 *     def __invert__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ginv(self.g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__invert__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":343
 * 
 *     ######################################## Arithmetic Operator
 *     def __add__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_41__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_41__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__add__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_40__add__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_40__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__add__", 0);

  /* "gen.pyx":344
 *     ######################################## Arithmetic Operator
 *     def __add__(self,other):
 *         cdef gen t0=objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":345
 *     def __add__(self,other):
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gadd(t0.g,t1.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_other)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":346
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gadd(t0.g,t1.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":347
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 *         return P.new_gen(gadd(t0.g,t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def __sub__(self,other):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gadd(__pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":343
 * 
 *     ######################################## Arithmetic Operator
 *     def __add__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__add__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":349
 *         return P.new_gen(gadd(t0.g,t1.g))
 * 
 *     def __sub__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_43__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_43__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__sub__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_42__sub__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_42__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__sub__", 0);

  /* "gen.pyx":350
 * 
 *     def __sub__(self,other):
 *         cdef gen t0=objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":351
 *     def __sub__(self,other):
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsub(t0.g,t1.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_other)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":352
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsub(t0.g,t1.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":353
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 *         return P.new_gen(gsub(t0.g,t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def __mul__(self,other):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsub(__pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":349
 *         return P.new_gen(gadd(t0.g,t1.g))
 * 
 *     def __sub__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__sub__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":355
 *         return P.new_gen(gsub(t0.g,t1.g))
 * 
 *     def __mul__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_45__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_45__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__mul__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_44__mul__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_44__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__mul__", 0);

  /* "gen.pyx":356
 * 
 *     def __mul__(self,other):
 *         cdef gen t0=objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":357
 *     def __mul__(self,other):
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul(t0.g,t1.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_other)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":358
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmul(t0.g,t1.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 358; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":359
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul(t0.g,t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def __div__(self,other):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmul(__pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":355
 *         return P.new_gen(gsub(t0.g,t1.g))
 * 
 *     def __mul__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__mul__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":361
 *         return P.new_gen(gmul(t0.g,t1.g))
 * 
 *     def __div__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_3gen_3gen_47__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_47__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__div__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_46__div__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_46__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__div__", 0);

  /* "gen.pyx":362
 * 
 *     def __div__(self,other):
 *         cdef gen t0=objtogen(self)             # <<<<<<<<<<<<<<
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_self)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":363
 *     def __div__(self,other):
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gdiv(t0.g,t1.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_other)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":364
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gdiv(t0.g,t1.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":365
 *         cdef gen t1=objtogen(other)
 *         pari_catch_sig_on()
 *         return P.new_gen(gdiv(t0.g,t1.g))             # <<<<<<<<<<<<<<
 * 
 *     ######################################## Numeric Magic
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gdiv(__pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":361
 *         return P.new_gen(gmul(t0.g,t1.g))
 * 
 *     def __div__(self,other):             # <<<<<<<<<<<<<<
 *         cdef gen t0=objtogen(self)
 *         cdef gen t1=objtogen(other)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__div__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "gen.pyx":375
 * 
 * 
 *     def getattr(gen self, attr):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI attribute with the given name.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_49getattr(PyObject *__pyx_v_self, PyObject *__pyx_v_attr); /*proto*/
static char __pyx_doc_3gen_3gen_48getattr[] = "\n        Return the PARI attribute with the given name.\n\n        EXAMPLES::\n\n            sage: K = pari(\"nfinit(x^2 - x - 1)\")\n            sage: K.getattr(\"pol\")\n            x^2 - x - 1\n            sage: K.getattr(\"disc\")\n            5\n\n            sage: K.getattr(\"reg\")\n            Traceback (most recent call last):\n            ...\n            PariError: _.reg: incorrect type in reg\n            sage: K.getattr(\"zzz\")\n            Traceback (most recent call last):\n            ...\n            PariError: no function named \"_.zzz\"\n\n        ";
static PyObject *__pyx_pw_3gen_3gen_49getattr(PyObject *__pyx_v_self, PyObject *__pyx_v_attr) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getattr (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_48getattr(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_attr));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_48getattr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_attr) {
  PyObject *__pyx_v_s = 0;
  char *__pyx_v_t;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  char *__pyx_t_2;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getattr", 0);

  /* "gen.pyx":397
 * 
 *         """
 *         cdef bytes s = "_." + attr             # <<<<<<<<<<<<<<
 *         cdef char *t = s
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = PyNumber_Add(__pyx_kp_s__2, __pyx_v_attr); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_s = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":398
 *         """
 *         cdef bytes s = "_." + attr
 *         cdef char *t = s             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(closure_callgen1(strtofunction(t), self.g))
 */
  __pyx_t_2 = __Pyx_PyObject_AsString(__pyx_v_s); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_t = __pyx_t_2;

  /* "gen.pyx":399
 *         cdef bytes s = "_." + attr
 *         cdef char *t = s
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(closure_callgen1(strtofunction(t), self.g))
 * 
 */
  __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":400
 *         cdef char *t = s
 *         pari_catch_sig_on()
 *         return P.new_gen(closure_callgen1(strtofunction(t), self.g))             # <<<<<<<<<<<<<<
 * 
 *     def mod(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, closure_callgen1(strtofunction(__pyx_v_t), __pyx_v_self->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":375
 * 
 * 
 *     def getattr(gen self, attr):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI attribute with the given name.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.getattr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":402
 *         return P.new_gen(closure_callgen1(strtofunction(t), self.g))
 * 
 *     def mod(self):             # <<<<<<<<<<<<<<
 *         """
 *         Given an INTMOD or POLMOD ``Mod(a,m)``, return the modulus `m`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_51mod(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_50mod[] = "\n        Given an INTMOD or POLMOD ``Mod(a,m)``, return the modulus `m`.\n\n        EXAMPLES::\n\n            sage: pari(4).Mod(5).mod()\n            5\n            sage: pari(\"Mod(x, x*y)\").mod()\n            y*x\n            sage: pari(\"[Mod(4,5)]\").mod()\n            Traceback (most recent call last):\n            ...\n            TypeError: Not an INTMOD or POLMOD in mod()\n        ";
static PyObject *__pyx_pw_3gen_3gen_51mod(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("mod (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_50mod(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_50mod(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("mod", 0);

  /* "gen.pyx":417
 *             TypeError: Not an INTMOD or POLMOD in mod()
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:             # <<<<<<<<<<<<<<
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")
 *         pari_catch_sig_on()
 */
  __pyx_t_2 = ((typ(__pyx_v_self->g) != t_INTMOD) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((typ(__pyx_v_self->g) != t_POLMOD) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {

    /* "gen.pyx":418
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         # The hardcoded 1 below refers to the position in the internal
 */
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":419
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # The hardcoded 1 below refers to the position in the internal
 *         # representation of a INTMOD or POLDMOD where the modulus is
 */
  __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":423
 *         # representation of a INTMOD or POLDMOD where the modulus is
 *         # stored.
 *         return P.new_gen(gel(self.g, 1))             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_pol(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gel(__pyx_v_self->g, 1))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "gen.pyx":402
 *         return P.new_gen(closure_callgen1(strtofunction(t), self.g))
 * 
 *     def mod(self):             # <<<<<<<<<<<<<<
 *         """
 *         Given an INTMOD or POLMOD ``Mod(a,m)``, return the modulus `m`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("gen.gen.mod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":425
 *         return P.new_gen(gel(self.g, 1))
 * 
 *     def nf_get_pol(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the defining polynomial of this number field.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_53nf_get_pol(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_52nf_get_pol[] = "\n        Returns the defining polynomial of this number field.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_pol()\n            y^4 - 4*y^2 + 1\n            sage: bnr = pari(\"K = bnfinit(x^4 - 4*x^2 + 1); bnrinit(K, 2*x)\")\n            sage: bnr.nf_get_pol()\n            x^4 - 4*x^2 + 1\n\n        For relative extensions, this returns the absolute polynomial,\n        not the relative one::\n\n            sage: L.<b> = K.extension(x^2 - 5)\n            sage: pari(L).nf_get_pol()   # Absolute polynomial\n            y^8 - 28*y^6 + 208*y^4 - 408*y^2 + 36\n            sage: L.pari_rnf().nf_get_pol()\n            x^8 - 28*x^6 + 208*x^4 - 408*x^2 + 36\n\n        TESTS::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: K.pari_nf().nf_get_pol()\n            y^4 - 4*y^2 + 1\n            sage: K.pari_bnf().nf_get_pol()\n            y^4 - 4*y^2 + 1\n\n        An error is raised for invalid input::\n\n            sage: pari(\"[0]\").nf_get_pol()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in pol\n        ";
static PyObject *__pyx_pw_3gen_3gen_53nf_get_pol(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_pol (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_52nf_get_pol(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_52nf_get_pol(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_pol", 0);

  /* "gen.pyx":468
 *             PariError: incorrect type in pol
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(member_pol(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":469
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(member_pol(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_diff(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, member_pol(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":425
 *         return P.new_gen(gel(self.g, 1))
 * 
 *     def nf_get_pol(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the defining polynomial of this number field.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.nf_get_pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":471
 *         return P.new_gen(member_pol(self.g))
 * 
 *     def nf_get_diff(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the different of this number field as a PARI ideal.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_55nf_get_diff(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_54nf_get_diff[] = "\n        Returns the different of this number field as a PARI ideal.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_diff()\n            [12, 0, 0, 0; 0, 12, 8, 0; 0, 0, 4, 0; 0, 0, 0, 4]\n        ";
static PyObject *__pyx_pw_3gen_3gen_55nf_get_diff(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_diff (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_54nf_get_diff(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_54nf_get_diff(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_diff", 0);

  /* "gen.pyx":486
 *             [12, 0, 0, 0; 0, 12, 8, 0; 0, 0, 4, 0; 0, 0, 0, 4]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(member_diff(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":487
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(member_diff(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_sign(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, member_diff(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":471
 *         return P.new_gen(member_pol(self.g))
 * 
 *     def nf_get_diff(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the different of this number field as a PARI ideal.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.nf_get_diff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":489
 *         return P.new_gen(member_diff(self.g))
 * 
 *     def nf_get_sign(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a Python list ``[r1, r2]``, where ``r1`` and ``r2`` are
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_57nf_get_sign(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_56nf_get_sign[] = "\n        Returns a Python list ``[r1, r2]``, where ``r1`` and ``r2`` are\n        Python ints representing the number of real embeddings and pairs\n        of complex embeddings of this number field, respectively.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: s = K.pari_nf().nf_get_sign(); s\n            [4, 0]\n            sage: type(s); type(s[0])\n            <type 'list'>\n            <type 'int'>\n            sage: CyclotomicField(15).pari_nf().nf_get_sign()\n            [0, 4]\n        ";
static PyObject *__pyx_pw_3gen_3gen_57nf_get_sign(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_sign (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_56nf_get_sign(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_56nf_get_sign(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_r1;
  long __pyx_v_r2;
  GEN __pyx_v_sign;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_sign", 0);

  /* "gen.pyx":514
 *         cdef long r2
 *         cdef GEN sign
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         sign = member_sign(self.g)
 *         r1 = itos(gel(sign, 1))
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":515
 *         cdef GEN sign
 *         pari_catch_sig_on()
 *         sign = member_sign(self.g)             # <<<<<<<<<<<<<<
 *         r1 = itos(gel(sign, 1))
 *         r2 = itos(gel(sign, 2))
 */
  __pyx_v_sign = member_sign(__pyx_v_self->g);

  /* "gen.pyx":516
 *         pari_catch_sig_on()
 *         sign = member_sign(self.g)
 *         r1 = itos(gel(sign, 1))             # <<<<<<<<<<<<<<
 *         r2 = itos(gel(sign, 2))
 *         pari_catch_sig_off()
 */
  __pyx_v_r1 = itos(gel(__pyx_v_sign, 1));

  /* "gen.pyx":517
 *         sign = member_sign(self.g)
 *         r1 = itos(gel(sign, 1))
 *         r2 = itos(gel(sign, 2))             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return [r1, r2]
 */
  __pyx_v_r2 = itos(gel(__pyx_v_sign, 2));

  /* "gen.pyx":518
 *         r1 = itos(gel(sign, 1))
 *         r2 = itos(gel(sign, 2))
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return [r1, r2]
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":519
 *         r2 = itos(gel(sign, 2))
 *         pari_catch_sig_off()
 *         return [r1, r2]             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_zk(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_r1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_r2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "gen.pyx":489
 *         return P.new_gen(member_diff(self.g))
 * 
 *     def nf_get_sign(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a Python list ``[r1, r2]``, where ``r1`` and ``r2`` are
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.nf_get_sign", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":521
 *         return [r1, r2]
 * 
 *     def nf_get_zk(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector with a `\ZZ`-basis for the ring of integers of
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_59nf_get_zk(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_58nf_get_zk[] = "\n        Returns a vector with a `\\ZZ`-basis for the ring of integers of\n        this number field. The first element is always `1`.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_zk()\n            [1, y, y^3 - 4*y, y^2 - 2]\n        ";
static PyObject *__pyx_pw_3gen_3gen_59nf_get_zk(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_zk (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_58nf_get_zk(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_58nf_get_zk(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_zk", 0);

  /* "gen.pyx":537
 *             [1, y, y^3 - 4*y, y^2 - 2]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(member_zk(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":538
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(member_zk(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_no(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, member_zk(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":521
 *         return [r1, r2]
 * 
 *     def nf_get_zk(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector with a `\ZZ`-basis for the ring of integers of
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.nf_get_zk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":540
 *         return P.new_gen(member_zk(self.g))
 * 
 *     def bnf_get_no(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the class number of ``self``, a "big number field" (``bnf``).
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_61bnf_get_no(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_60bnf_get_no[] = "\n        Returns the class number of ``self``, a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: K.pari_bnf().bnf_get_no()\n            8\n        ";
static PyObject *__pyx_pw_3gen_3gen_61bnf_get_no(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_no (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_60bnf_get_no(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_60bnf_get_no(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_no", 0);

  /* "gen.pyx":550
 *             8
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnf_get_no(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":551
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_no(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_cyc(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnf_get_no(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":540
 *         return P.new_gen(member_zk(self.g))
 * 
 *     def bnf_get_no(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the class number of ``self``, a "big number field" (``bnf``).
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bnf_get_no", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":553
 *         return P.new_gen(bnf_get_no(self.g))
 * 
 *     def bnf_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the class group of this number field as
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_63bnf_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_62bnf_get_cyc[] = "\n        Returns the structure of the class group of this number field as\n        a vector of SNF invariants.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: K.pari_bnf().bnf_get_cyc()\n            [4, 2]\n        ";
static PyObject *__pyx_pw_3gen_3gen_63bnf_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_cyc (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_62bnf_get_cyc(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_62bnf_get_cyc(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_cyc", 0);

  /* "gen.pyx":566
 *             [4, 2]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnf_get_cyc(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":567
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_cyc(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnf_get_cyc(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 567; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":553
 *         return P.new_gen(bnf_get_no(self.g))
 * 
 *     def bnf_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the class group of this number field as
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bnf_get_cyc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":569
 *         return P.new_gen(bnf_get_cyc(self.g))
 * 
 *     def bnf_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the class group of this
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_65bnf_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_64bnf_get_gen[] = "\n        Returns a vector of generators of the class group of this\n        number field.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: G = K.pari_bnf().bnf_get_gen(); G\n            [[3, 2; 0, 1], [2, 1; 0, 1]]\n            sage: map(lambda J: K.ideal(J), G)\n            [Fractional ideal (3, a + 2), Fractional ideal (2, a + 1)]\n        ";
static PyObject *__pyx_pw_3gen_3gen_65bnf_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_64bnf_get_gen(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_64bnf_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_gen", 0);

  /* "gen.pyx":584
 *             [Fractional ideal (3, a + 2), Fractional ideal (2, a + 1)]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnf_get_gen(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":585
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_reg(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnf_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":569
 *         return P.new_gen(bnf_get_cyc(self.g))
 * 
 *     def bnf_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the class group of this
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bnf_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":587
 *         return P.new_gen(bnf_get_gen(self.g))
 * 
 *     def bnf_get_reg(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the regulator of this number field.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_67bnf_get_reg(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_66bnf_get_reg[] = "\n        Returns the regulator of this number field.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: K.pari_bnf().bnf_get_reg()\n            2.66089858019037...\n        ";
static PyObject *__pyx_pw_3gen_3gen_67bnf_get_reg(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_reg (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_66bnf_get_reg(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_66bnf_get_reg(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_reg", 0);

  /* "gen.pyx":599
 *             2.66089858019037...
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnf_get_reg(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":600
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_reg(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_p(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnf_get_reg(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":587
 *         return P.new_gen(bnf_get_gen(self.g))
 * 
 *     def bnf_get_reg(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the regulator of this number field.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bnf_get_reg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":602
 *         return P.new_gen(bnf_get_reg(self.g))
 * 
 *     def pr_get_p(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the prime of `\ZZ` lying below this prime ideal.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_69pr_get_p(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_68pr_get_p[] = "\n        Returns the prime of `\\ZZ` lying below this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: F = pari(K).idealfactor(K.ideal(5)); F\n            [[5, [-2, 1]~, 1, 1, [2, 1]~], 1; [5, [2, 1]~, 1, 1, [-2, 1]~], 1]\n            sage: F[0,0].pr_get_p()\n            5\n        ";
static PyObject *__pyx_pw_3gen_3gen_69pr_get_p(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_p (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_68pr_get_p(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_68pr_get_p(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_p", 0);

  /* "gen.pyx":617
 *             5
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pr_get_p(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":618
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(pr_get_p(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_e(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, pr_get_p(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":602
 *         return P.new_gen(bnf_get_reg(self.g))
 * 
 *     def pr_get_p(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the prime of `\ZZ` lying below this prime ideal.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.pr_get_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":620
 *         return P.new_gen(pr_get_p(self.g))
 * 
 *     def pr_get_e(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the ramification index (over `\QQ`) of this prime ideal.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_71pr_get_e(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_70pr_get_e[] = "\n        Returns the ramification index (over `\\QQ`) of this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: pari(K).idealfactor(K.ideal(2))[0,0].pr_get_e()\n            2\n            sage: pari(K).idealfactor(K.ideal(3))[0,0].pr_get_e()\n            1\n            sage: pari(K).idealfactor(K.ideal(5))[0,0].pr_get_e()\n            1\n        ";
static PyObject *__pyx_pw_3gen_3gen_71pr_get_e(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_e (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_70pr_get_e(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_70pr_get_e(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_e;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_e", 0);

  /* "gen.pyx":638
 *         """
 *         cdef long e
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         e = pr_get_e(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":639
 *         cdef long e
 *         pari_catch_sig_on()
 *         e = pr_get_e(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return e
 */
  __pyx_v_e = pr_get_e(__pyx_v_self->g);

  /* "gen.pyx":640
 *         pari_catch_sig_on()
 *         e = pr_get_e(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return e
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":641
 *         e = pr_get_e(self.g)
 *         pari_catch_sig_off()
 *         return e             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_f(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_e); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":620
 *         return P.new_gen(pr_get_p(self.g))
 * 
 *     def pr_get_e(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the ramification index (over `\QQ`) of this prime ideal.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.pr_get_e", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":643
 *         return e
 * 
 *     def pr_get_f(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the residue class degree (over `\QQ`) of this prime ideal.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_73pr_get_f(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_72pr_get_f[] = "\n        Returns the residue class degree (over `\\QQ`) of this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: pari(K).idealfactor(K.ideal(2))[0,0].pr_get_f()\n            1\n            sage: pari(K).idealfactor(K.ideal(3))[0,0].pr_get_f()\n            2\n            sage: pari(K).idealfactor(K.ideal(5))[0,0].pr_get_f()\n            1\n        ";
static PyObject *__pyx_pw_3gen_3gen_73pr_get_f(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_f (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_72pr_get_f(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_72pr_get_f(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_f;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_f", 0);

  /* "gen.pyx":661
 *         """
 *         cdef long f
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         f = pr_get_f(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":662
 *         cdef long f
 *         pari_catch_sig_on()
 *         f = pr_get_f(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return f
 */
  __pyx_v_f = pr_get_f(__pyx_v_self->g);

  /* "gen.pyx":663
 *         pari_catch_sig_on()
 *         f = pr_get_f(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return f
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":664
 *         f = pr_get_f(self.g)
 *         pari_catch_sig_off()
 *         return f             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_f); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":643
 *         return e
 * 
 *     def pr_get_f(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the residue class degree (over `\QQ`) of this prime ideal.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.pr_get_f", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":666
 *         return f
 * 
 *     def pr_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the second generator of this PARI prime ideal, where the
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_75pr_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_74pr_get_gen[] = "\n        Returns the second generator of this PARI prime ideal, where the\n        first generator is ``self.pr_get_p()``.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: g = pari(K).idealfactor(K.ideal(2))[0,0].pr_get_gen(); g; K(g)\n            [1, 1]~\n            i + 1\n            sage: g = pari(K).idealfactor(K.ideal(3))[0,0].pr_get_gen(); g; K(g)\n            [3, 0]~\n            3\n            sage: g = pari(K).idealfactor(K.ideal(5))[0,0].pr_get_gen(); g; K(g)\n            [-2, 1]~\n            i - 2\n        ";
static PyObject *__pyx_pw_3gen_3gen_75pr_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_74pr_get_gen(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_74pr_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_gen", 0);

  /* "gen.pyx":687
 *             i - 2
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pr_get_gen(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":688
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(pr_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bid_get_cyc(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, pr_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":666
 *         return f
 * 
 *     def pr_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the second generator of this PARI prime ideal, where the
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.pr_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":690
 *         return P.new_gen(pr_get_gen(self.g))
 * 
 *     def bid_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the group `(O_K/I)^*`, where `I` is the
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_77bid_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_76bid_get_cyc[] = "\n        Returns the structure of the group `(O_K/I)^*`, where `I` is the\n        ideal represented by ``self``.\n\n        NOTE: ``self`` must be a \"big ideal\" (``bid``) as returned by\n        ``idealstar`` for example.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: J = pari(K).idealstar(K.ideal(4*i + 2))\n            sage: J.bid_get_cyc()\n            [4, 2]\n        ";
static PyObject *__pyx_pw_3gen_3gen_77bid_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bid_get_cyc (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_76bid_get_cyc(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_76bid_get_cyc(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bid_get_cyc", 0);

  /* "gen.pyx":705
 *             [4, 2]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bid_get_cyc(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":706
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bid_get_cyc(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bid_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bid_get_cyc(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":690
 *         return P.new_gen(pr_get_gen(self.g))
 * 
 *     def bid_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the group `(O_K/I)^*`, where `I` is the
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bid_get_cyc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":708
 *         return P.new_gen(bid_get_cyc(self.g))
 * 
 *     def bid_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the group `(O_K/I)^*`, where
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_79bid_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_78bid_get_gen[] = "\n        Returns a vector of generators of the group `(O_K/I)^*`, where\n        `I` is the ideal represented by ``self``.\n\n        NOTE: ``self`` must be a \"big ideal\" (``bid``) with generators,\n        as returned by ``idealstar`` with ``flag`` = 2.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: J = pari(K).idealstar(K.ideal(4*i + 2), 2)\n            sage: J.bid_get_gen()\n            [7, [-2, -1]~]\n\n        We get an exception if we do not supply ``flag = 2`` to\n        ``idealstar``::\n\n            sage: J = pari(K).idealstar(K.ideal(3))\n            sage: J.bid_get_gen()\n            Traceback (most recent call last):\n            ...\n            PariError: missing bid generators. Use idealstar(,,2)\n        ";
static PyObject *__pyx_pw_3gen_3gen_79bid_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bid_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_78bid_get_gen(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_78bid_get_gen(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bid_get_gen", 0);

  /* "gen.pyx":732
 *             PariError: missing bid generators. Use idealstar(,,2)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bid_get_gen(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":733
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bid_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __getitem__(gen self, n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bid_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":708
 *         return P.new_gen(bid_get_cyc(self.g))
 * 
 *     def bid_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the group `(O_K/I)^*`, where
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.bid_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":735
 *         return P.new_gen(bid_get_gen(self.g))
 * 
 *     def __getitem__(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the nth entry of self. The indexing is 0-based, like in
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_81__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
static char __pyx_doc_3gen_3gen_80__getitem__[] = "\n        Return the nth entry of self. The indexing is 0-based, like in\n        Python. Note that this is *different* than the default behavior\n        of the PARI/GP interpreter.\n\n        EXAMPLES::\n\n            sage: p = pari('1 + 2*x + 3*x^2')\n            sage: p[0]\n            1\n            sage: p[2]\n            3\n            sage: p[100]\n            0\n            sage: p[-1]\n            0\n            sage: q = pari('x^2 + 3*x^3 + O(x^6)')\n            sage: q[3]\n            3\n            sage: q[5]\n            0\n            sage: q[6]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: m = pari('[1,2;3,4]')\n            sage: m[0]\n            [1, 3]~\n            sage: m[1,0]\n            3\n            sage: l = pari('List([1,2,3])')\n            sage: l[1]\n            2\n            sage: s = pari('\"hello, world!\"')\n            sage: s[0]\n            'h'\n            sage: s[4]\n            'o'\n            sage: s[12]\n            '!'\n            sage: s[13]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: v = pari('[1,2,3]')\n            sage: v[0]\n            1\n            sage: c = pari('Col([1,2,3])')\n            sage: c[1]\n            2\n            sage: sv = pari('Vecsmall([1,2,3])')\n            sage: sv[2]\n            3\n            sage: type(sv[2])\n            <type 'int'>\n            sage: tuple(pari(3/5))\n            (3, 5)\n            sage: tuple(pari('1 + 5*I'))\n            (1, 5)\n            sage: tuple(pari('Qfb(1, 2, 3)'))\n            (1, 2, 3)\n            sage: pari(57)[0]\n            Traceback (most recent call last):\n            ...\n            TypeError: unindexable object\n            sage: m = pari(\"[[1,2;3,4],5]\") ; m[0][1,0]\n            3\n            sage: v = pari(xrange(20))\n            sage: v[2:5]\n            [2, 3, 4]\n     ""       sage: v[:]\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[10:]\n            [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[:5]\n            [0, 1, 2, 3, 4]\n            sage: v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[-1]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: v[:-3]\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n            sage: v[5:]\n            [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: pari([])[::]\n            []\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_80__getitem__;
#endif
static PyObject *__pyx_pw_3gen_3gen_81__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__getitem__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_80__getitem__(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_80__getitem__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n) {
  int __pyx_v_pari_type;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_ind = NULL;
  struct __pyx_obj_3gen_gen *__pyx_v_val = NULL;
  long __pyx_v_l;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_stop = NULL;
  PyObject *__pyx_v_step = NULL;
  PyObject *__pyx_v_inds = NULL;
  Py_ssize_t __pyx_v_k;
  PyObject *__pyx_v_v = NULL;
  long __pyx_v_bound;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  Py_ssize_t __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  long __pyx_t_7;
  long __pyx_t_8;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *(*__pyx_t_13)(PyObject *);
  int __pyx_t_14;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__getitem__", 0);

  /* "gen.pyx":827
 *         cdef int pari_type
 * 
 *         pari_type = typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *         if isinstance(n, tuple):
 */
  __pyx_v_pari_type = typ(__pyx_v_self->g);

  /* "gen.pyx":829
 *         pari_type = typ(self.g)
 * 
 *         if isinstance(n, tuple):             # <<<<<<<<<<<<<<
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"
 */
  __pyx_t_1 = PyTuple_Check(__pyx_v_n); 
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":830
 * 
 *         if isinstance(n, tuple):
 *             if pari_type != t_MAT:             # <<<<<<<<<<<<<<
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:
 */
    __pyx_t_2 = ((__pyx_v_pari_type != t_MAT) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":831
 *         if isinstance(n, tuple):
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"             # <<<<<<<<<<<<<<
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 */
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_self_must_be_of_pari_type_t_MAT, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":832
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_n); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = ((__pyx_t_3 != 2) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":833
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"             # <<<<<<<<<<<<<<
 *             i = int(n[0])
 *             j = int(n[1])
 */
      __Pyx_Raise(__pyx_builtin_IndexError, __pyx_kp_s_index_must_be_an_integer_or_a_2, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":834
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])             # <<<<<<<<<<<<<<
 *             j = int(n[1])
 * 
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_n, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_i = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "gen.pyx":835
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])
 *             j = int(n[1])             # <<<<<<<<<<<<<<
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 */
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_n, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_j = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "gen.pyx":837
 *             j = int(n[1])
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):
 */
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (!__pyx_t_1) {
    } else {
      __pyx_t_2 = __pyx_t_1;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_4 = __Pyx_PyInt_From_long(glength(((GEN)(__pyx_v_self->g[1])))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_4, Py_GE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = __pyx_t_1;
    __pyx_L7_bool_binop_done:;
    if (__pyx_t_2) {

      /* "gen.pyx":838
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                 raise IndexError, "row index out of bounds"             # <<<<<<<<<<<<<<
 *             if j < 0 or j >= glength(self.g):
 *                 raise IndexError, "column index out of bounds"
 */
      __Pyx_Raise(__pyx_builtin_IndexError, __pyx_kp_s_row_index_out_of_bounds, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":839
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "column index out of bounds"
 * 
 */
    __pyx_t_5 = PyObject_RichCompare(__pyx_v_j, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (!__pyx_t_1) {
    } else {
      __pyx_t_2 = __pyx_t_1;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_5 = __Pyx_PyInt_From_long(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_j, __pyx_t_5, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __pyx_t_1;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_2) {

      /* "gen.pyx":840
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):
 *                 raise IndexError, "column index out of bounds"             # <<<<<<<<<<<<<<
 * 
 *             ind = (i,j)
 */
      __Pyx_Raise(__pyx_builtin_IndexError, __pyx_kp_s_column_index_out_of_bounds, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":842
 *                 raise IndexError, "column index out of bounds"
 * 
 *             ind = (i,j)             # <<<<<<<<<<<<<<
 * 
 *             if self.refers_to is not None and ind in self.refers_to:
 */
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __Pyx_INCREF(__pyx_v_j);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
    __Pyx_GIVEREF(__pyx_v_j);
    __pyx_v_ind = ((PyObject*)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":844
 *             ind = (i,j)
 * 
 *             if self.refers_to is not None and ind in self.refers_to:             # <<<<<<<<<<<<<<
 *                 return self.refers_to[ind]
 *             else:
 */
    __pyx_t_1 = (__pyx_v_self->refers_to != ((PyObject*)Py_None));
    __pyx_t_6 = (__pyx_t_1 != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_2 = __pyx_t_6;
      goto __pyx_L13_bool_binop_done;
    }
    if (unlikely(__pyx_v_self->refers_to == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_6 = (__Pyx_PyDict_Contains(__pyx_v_ind, __pyx_v_self->refers_to, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 844; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = (__pyx_t_6 != 0);
    __pyx_t_2 = __pyx_t_1;
    __pyx_L13_bool_binop_done:;
    if (__pyx_t_2) {

      /* "gen.pyx":845
 * 
 *             if self.refers_to is not None and ind in self.refers_to:
 *                 return self.refers_to[ind]             # <<<<<<<<<<<<<<
 *             else:
 *                 ## In this case, we're being asked to return
 */
      __Pyx_XDECREF(__pyx_r);
      if (unlikely(__pyx_v_self->refers_to == Py_None)) {
        PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_self->refers_to, __pyx_v_ind); if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":851
 *                 ## we need to create such a gen, add it to
 *                 ## self.refers_to, and return it.
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)             # <<<<<<<<<<<<<<
 *                 if self.refers_to is None:
 *                     self.refers_to = {ind: val}
 */
      __pyx_t_4 = PyNumber_Add(__pyx_v_j, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_7 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_7 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Add(__pyx_v_i, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_ref(__pyx_v_3gen_P, gmael(__pyx_v_self->g, __pyx_t_7, __pyx_t_8), __pyx_v_self)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_val = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":852
 *                 ## self.refers_to, and return it.
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)
 *                 if self.refers_to is None:             # <<<<<<<<<<<<<<
 *                     self.refers_to = {ind: val}
 *                 else:
 */
      __pyx_t_2 = (__pyx_v_self->refers_to == ((PyObject*)Py_None));
      __pyx_t_1 = (__pyx_t_2 != 0);
      if (__pyx_t_1) {

        /* "gen.pyx":853
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)
 *                 if self.refers_to is None:
 *                     self.refers_to = {ind: val}             # <<<<<<<<<<<<<<
 *                 else:
 *                     self.refers_to[ind] = val
 */
        __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        if (PyDict_SetItem(__pyx_t_4, __pyx_v_ind, ((PyObject *)__pyx_v_val)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GIVEREF(__pyx_t_4);
        __Pyx_GOTREF(__pyx_v_self->refers_to);
        __Pyx_DECREF(__pyx_v_self->refers_to);
        __pyx_v_self->refers_to = ((PyObject*)__pyx_t_4);
        __pyx_t_4 = 0;
        goto __pyx_L15;
      }
      /*else*/ {

        /* "gen.pyx":855
 *                     self.refers_to = {ind: val}
 *                 else:
 *                     self.refers_to[ind] = val             # <<<<<<<<<<<<<<
 *                 return val
 * 
 */
        if (unlikely(__pyx_v_self->refers_to == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        if (unlikely(PyDict_SetItem(__pyx_v_self->refers_to, __pyx_v_ind, ((PyObject *)__pyx_v_val)) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __pyx_L15:;

      /* "gen.pyx":856
 *                 else:
 *                     self.refers_to[ind] = val
 *                 return val             # <<<<<<<<<<<<<<
 * 
 *         elif isinstance(n, slice):
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_val));
      __pyx_r = ((PyObject *)__pyx_v_val);
      goto __pyx_L0;
    }
  }

  /* "gen.pyx":858
 *                 return val
 * 
 *         elif isinstance(n, slice):             # <<<<<<<<<<<<<<
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)
 */
  __pyx_t_1 = PySlice_Check(__pyx_v_n); 
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":859
 * 
 *         elif isinstance(n, slice):
 *             l = glength(self.g)             # <<<<<<<<<<<<<<
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)
 */
    __pyx_v_l = glength(__pyx_v_self->g);

    /* "gen.pyx":860
 *         elif isinstance(n, slice):
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)             # <<<<<<<<<<<<<<
 *             inds = xrange(start,stop,step)
 *             k = len(inds)
 */
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_n, __pyx_n_s_indices); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_9 = __Pyx_PyInt_From_long(__pyx_v_l); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_10 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_10) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_10); __Pyx_GIVEREF(__pyx_t_10); __pyx_t_10 = NULL;
      PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
      PyObject* sequence = __pyx_t_4;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 3)) {
        if (size > 3) __Pyx_RaiseTooManyValuesError(3);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_11 = PyTuple_GET_ITEM(sequence, 1); 
        __pyx_t_9 = PyTuple_GET_ITEM(sequence, 2); 
      } else {
        __pyx_t_5 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_11 = PyList_GET_ITEM(sequence, 1); 
        __pyx_t_9 = PyList_GET_ITEM(sequence, 2); 
      }
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_11);
      __Pyx_INCREF(__pyx_t_9);
      #else
      __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_11 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_9 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      #endif
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_10 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_10);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)->tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_5)) goto __pyx_L16_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_5);
      index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_11)) goto __pyx_L16_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_11);
      index = 2; __pyx_t_9 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L16_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_9);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_12 = NULL;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L17_unpacking_done;
      __pyx_L16_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_L17_unpacking_done:;
    }
    __pyx_v_start = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_stop = __pyx_t_11;
    __pyx_t_11 = 0;
    __pyx_v_step = __pyx_t_9;
    __pyx_t_9 = 0;

    /* "gen.pyx":861
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)             # <<<<<<<<<<<<<<
 *             k = len(inds)
 *             # fast exit
 */
    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_start);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_start);
    __Pyx_GIVEREF(__pyx_v_start);
    __Pyx_INCREF(__pyx_v_stop);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_stop);
    __Pyx_GIVEREF(__pyx_v_stop);
    __Pyx_INCREF(__pyx_v_step);
    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_step);
    __Pyx_GIVEREF(__pyx_v_step);
    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_xrange, __pyx_t_4, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_inds = __pyx_t_9;
    __pyx_t_9 = 0;

    /* "gen.pyx":862
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)
 *             k = len(inds)             # <<<<<<<<<<<<<<
 *             # fast exit
 *             if k==0:
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_inds); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 862; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_k = __pyx_t_3;

    /* "gen.pyx":864
 *             k = len(inds)
 *             # fast exit
 *             if k==0:             # <<<<<<<<<<<<<<
 *                 return P.vector(0)
 *             # fast call, beware pari is one based
 */
    __pyx_t_2 = ((__pyx_v_k == 0) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":865
 *             # fast exit
 *             if k==0:
 *                 return P.vector(0)             # <<<<<<<<<<<<<<
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_vector); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":867
 *                 return P.vector(0)
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:             # <<<<<<<<<<<<<<
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 */
    __pyx_t_2 = ((__pyx_v_pari_type == t_VEC) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":868
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 *                 if step==1:             # <<<<<<<<<<<<<<
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:
 */
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_step, __pyx_int_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_2) {

        /* "gen.pyx":869
 *             if pari_type == t_VEC:
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')             # <<<<<<<<<<<<<<
 *                 if step==-1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_vecextract); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_11 = PyNumber_Add(__pyx_v_start, __pyx_int_1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_5, NULL); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(__pyx_kp_s__5, __pyx_t_11); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Add(__pyx_t_5, __pyx_kp_s__6); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_INCREF(__pyx_v_stop);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_stop);
        __Pyx_GIVEREF(__pyx_v_stop);
        __pyx_t_10 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_5, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = PyNumber_Add(__pyx_t_5, __pyx_kp_s__5); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_9);
          if (likely(__pyx_t_5)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
            __Pyx_INCREF(__pyx_t_5);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_9, function);
          }
        }
        if (!__pyx_t_5) {
          __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __Pyx_GOTREF(__pyx_t_4);
        } else {
          __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_11);
          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
          PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_t_10);
          __Pyx_GIVEREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }

      /* "gen.pyx":870
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:             # <<<<<<<<<<<<<<
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 *             # slow call
 */
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_step, __pyx_int_neg_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 870; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 870; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_2) {

        /* "gen.pyx":871
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')             # <<<<<<<<<<<<<<
 *             # slow call
 *             v = P.vector(k)
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_vecextract); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_11 = PyNumber_Add(__pyx_v_start, __pyx_int_1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_10, NULL); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = PyNumber_Add(__pyx_kp_s__5, __pyx_t_11); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Add(__pyx_t_10, __pyx_kp_s__6); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = PyNumber_Add(__pyx_v_stop, __pyx_int_2); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_5, NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = PyNumber_Add(__pyx_t_5, __pyx_kp_s__5); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
          __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_9);
          if (likely(__pyx_t_5)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
            __Pyx_INCREF(__pyx_t_5);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_9, function);
          }
        }
        if (!__pyx_t_5) {
          __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          __Pyx_GOTREF(__pyx_t_4);
        } else {
          __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_11);
          PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
          PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_t_10);
          __Pyx_GIVEREF(__pyx_t_10);
          __pyx_t_10 = 0;
          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        }
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }
      goto __pyx_L19;
    }
    __pyx_L19:;

    /* "gen.pyx":873
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 *             # slow call
 *             v = P.vector(k)             # <<<<<<<<<<<<<<
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]
 */
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_vector); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_11 = PyInt_FromSsize_t(__pyx_v_k); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_10 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_10)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_10);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_10) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_10); __Pyx_GIVEREF(__pyx_t_10); __pyx_t_10 = NULL;
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_11);
      __Pyx_GIVEREF(__pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_v = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "gen.pyx":874
 *             # slow call
 *             v = P.vector(k)
 *             for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                 v[i] = self[j]
 *             return v
 */
    __Pyx_INCREF(__pyx_int_0);
    __pyx_t_4 = __pyx_int_0;
    if (likely(PyList_CheckExact(__pyx_v_inds)) || PyTuple_CheckExact(__pyx_v_inds)) {
      __pyx_t_9 = __pyx_v_inds; __Pyx_INCREF(__pyx_t_9); __pyx_t_3 = 0;
      __pyx_t_13 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_v_inds); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_13 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    for (;;) {
      if (likely(!__pyx_t_13)) {
        if (likely(PyList_CheckExact(__pyx_t_9))) {
          if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_9, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        } else {
          if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_5 = PySequence_ITEM(__pyx_t_9, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_13(__pyx_t_9);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = PyErr_Occurred();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
            else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF_SET(__pyx_v_j, __pyx_t_5);
      __pyx_t_5 = 0;
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
      __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_4);
      __pyx_t_4 = __pyx_t_5;
      __pyx_t_5 = 0;

      /* "gen.pyx":875
 *             v = P.vector(k)
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]             # <<<<<<<<<<<<<<
 *             return v
 * 
 */
      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_j); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_5);
      if (unlikely(PyObject_SetItem(__pyx_v_v, __pyx_v_i, __pyx_t_5) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "gen.pyx":874
 *             # slow call
 *             v = P.vector(k)
 *             for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                 v[i] = self[j]
 *             return v
 */
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "gen.pyx":876
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]
 *             return v             # <<<<<<<<<<<<<<
 * 
 *         ## there are no "out of bounds" problems
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_v);
    __pyx_r = __pyx_v_v;
    goto __pyx_L0;
  }

  /* "gen.pyx":881
 *         ## for a polynomial or power series, so these go before
 *         ## bounds testing
 *         if pari_type == t_POL:             # <<<<<<<<<<<<<<
 *             return self.polcoeff(n)
 * 
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_POL) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":882
 *         ## bounds testing
 *         if pari_type == t_POL:
 *             return self.polcoeff(n)             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_SER:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_polcoeff); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_5)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_5);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_n); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_11 = PyTuple_New(1+1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
      __Pyx_INCREF(__pyx_v_n);
      PyTuple_SET_ITEM(__pyx_t_11, 0+1, __pyx_v_n);
      __Pyx_GIVEREF(__pyx_v_n);
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":884
 *             return self.polcoeff(n)
 * 
 *         elif pari_type == t_SER:             # <<<<<<<<<<<<<<
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_SER) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":885
 * 
 *         elif pari_type == t_SER:
 *             bound = valp(self.g) + lg(self.g) - 2             # <<<<<<<<<<<<<<
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"
 */
    __pyx_v_bound = ((valp(__pyx_v_self->g) + lg(__pyx_v_self->g)) - 2);

    /* "gen.pyx":886
 *         elif pari_type == t_SER:
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index out of bounds"
 *             return self.polcoeff(n)
 */
    __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_bound); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = PyObject_RichCompare(__pyx_v_n, __pyx_t_4, Py_GE); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_2) {

      /* "gen.pyx":887
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"             # <<<<<<<<<<<<<<
 *             return self.polcoeff(n)
 * 
 */
      __Pyx_Raise(__pyx_builtin_IndexError, __pyx_kp_s_index_out_of_bounds, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":888
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"
 *             return self.polcoeff(n)             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_polcoeff); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_n); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_11); __Pyx_GIVEREF(__pyx_t_11); __pyx_t_11 = NULL;
      __Pyx_INCREF(__pyx_v_n);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_n);
      __Pyx_GIVEREF(__pyx_v_n);
      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":890
 *             return self.polcoeff(n)
 * 
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):             # <<<<<<<<<<<<<<
 *             # these are definitely scalar!
 *             raise TypeError, "unindexable object"
 */
  __pyx_t_14 = __pyx_v_pari_type;
  __pyx_t_1 = ((__pyx_t_14 == t_INT) != 0);
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L26_bool_binop_done;
  }
  __pyx_t_1 = ((__pyx_t_14 == t_REAL) != 0);
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L26_bool_binop_done;
  }
  __pyx_t_1 = ((__pyx_t_14 == t_PADIC) != 0);
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L26_bool_binop_done;
  }
  __pyx_t_1 = ((__pyx_t_14 == t_QUAD) != 0);
  __pyx_t_2 = __pyx_t_1;
  __pyx_L26_bool_binop_done:;
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":892
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):
 *             # these are definitely scalar!
 *             raise TypeError, "unindexable object"             # <<<<<<<<<<<<<<
 * 
 *         elif n < 0 or n >= glength(self.g):
 */
    __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_unindexable_object, 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 892; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":894
 *             raise TypeError, "unindexable object"
 * 
 *         elif n < 0 or n >= glength(self.g):             # <<<<<<<<<<<<<<
 *             raise IndexError, "index out of bounds"
 * 
 */
  __pyx_t_9 = PyObject_RichCompare(__pyx_v_n, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_9); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L30_bool_binop_done;
  }
  __pyx_t_9 = __Pyx_PyInt_From_long(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_4 = PyObject_RichCompare(__pyx_v_n, __pyx_t_9, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = __pyx_t_2;
  __pyx_L30_bool_binop_done:;
  if (__pyx_t_1) {

    /* "gen.pyx":895
 * 
 *         elif n < 0 or n >= glength(self.g):
 *             raise IndexError, "index out of bounds"             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_VEC or pari_type == t_MAT:
 */
    __Pyx_Raise(__pyx_builtin_IndexError, __pyx_kp_s_index_out_of_bounds, 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":897
 *             raise IndexError, "index out of bounds"
 * 
 *         elif pari_type == t_VEC or pari_type == t_MAT:             # <<<<<<<<<<<<<<
 *             #t_VEC    : row vector        [ code ] [  x_1  ] ... [  x_k  ]
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_VEC) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L32_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_pari_type == t_MAT) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L32_bool_binop_done:;
  if (__pyx_t_1) {

    /* "gen.pyx":900
 *             #t_VEC    : row vector        [ code ] [  x_1  ] ... [  x_k  ]
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 *             if self.refers_to is not None and n in self.refers_to:             # <<<<<<<<<<<<<<
 *                 return self.refers_to[n]
 *             else:
 */
    __pyx_t_2 = (__pyx_v_self->refers_to != ((PyObject*)Py_None));
    __pyx_t_6 = (__pyx_t_2 != 0);
    if (__pyx_t_6) {
    } else {
      __pyx_t_1 = __pyx_t_6;
      goto __pyx_L35_bool_binop_done;
    }
    if (unlikely(__pyx_v_self->refers_to == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_6 = (__Pyx_PyDict_Contains(__pyx_v_n, __pyx_v_self->refers_to, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = (__pyx_t_6 != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L35_bool_binop_done:;
    if (__pyx_t_1) {

      /* "gen.pyx":901
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 *             if self.refers_to is not None and n in self.refers_to:
 *                 return self.refers_to[n]             # <<<<<<<<<<<<<<
 *             else:
 *                 ## In this case, we're being asked to return
 */
      __Pyx_XDECREF(__pyx_r);
      if (unlikely(__pyx_v_self->refers_to == Py_None)) {
        PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_self->refers_to, __pyx_v_n); if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 901; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":907
 *                 ## we need to create such a gen, add it to
 *                 ## self.refers_to, and return it.
 *                 val = P.new_ref(gel(self.g, n+1), self)             # <<<<<<<<<<<<<<
 *                 if self.refers_to is None:
 *                     self.refers_to = {n: val}
 */
      __pyx_t_4 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_ref(__pyx_v_3gen_P, gel(__pyx_v_self->g, __pyx_t_8), __pyx_v_self)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_val = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":908
 *                 ## self.refers_to, and return it.
 *                 val = P.new_ref(gel(self.g, n+1), self)
 *                 if self.refers_to is None:             # <<<<<<<<<<<<<<
 *                     self.refers_to = {n: val}
 *                 else:
 */
      __pyx_t_1 = (__pyx_v_self->refers_to == ((PyObject*)Py_None));
      __pyx_t_2 = (__pyx_t_1 != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":909
 *                 val = P.new_ref(gel(self.g, n+1), self)
 *                 if self.refers_to is None:
 *                     self.refers_to = {n: val}             # <<<<<<<<<<<<<<
 *                 else:
 *                     self.refers_to[n] = val
 */
        __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        if (PyDict_SetItem(__pyx_t_4, __pyx_v_n, ((PyObject *)__pyx_v_val)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 909; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GIVEREF(__pyx_t_4);
        __Pyx_GOTREF(__pyx_v_self->refers_to);
        __Pyx_DECREF(__pyx_v_self->refers_to);
        __pyx_v_self->refers_to = ((PyObject*)__pyx_t_4);
        __pyx_t_4 = 0;
        goto __pyx_L37;
      }
      /*else*/ {

        /* "gen.pyx":911
 *                     self.refers_to = {n: val}
 *                 else:
 *                     self.refers_to[n] = val             # <<<<<<<<<<<<<<
 *                 return val
 * 
 */
        if (unlikely(__pyx_v_self->refers_to == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        if (unlikely(PyDict_SetItem(__pyx_v_self->refers_to, __pyx_v_n, ((PyObject *)__pyx_v_val)) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __pyx_L37:;

      /* "gen.pyx":912
 *                 else:
 *                     self.refers_to[n] = val
 *                 return val             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_VECSMALL:
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_val));
      __pyx_r = ((PyObject *)__pyx_v_val);
      goto __pyx_L0;
    }
  }

  /* "gen.pyx":914
 *                 return val
 * 
 *         elif pari_type == t_VECSMALL:             # <<<<<<<<<<<<<<
 *             #t_VECSMALL: vec. small ints  [ code ] [ x_1 ] ... [ x_k ]
 *             return self.g[n+1]
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_VECSMALL) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":916
 *         elif pari_type == t_VECSMALL:
 *             #t_VECSMALL: vec. small ints  [ code ] [ x_1 ] ... [ x_k ]
 *             return self.g[n+1]             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_STR:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyInt_From_long((__pyx_v_self->g[__pyx_t_3])); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 916; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":918
 *             return self.g[n+1]
 * 
 *         elif pari_type == t_STR:             # <<<<<<<<<<<<<<
 *             #t_STR    : string            [ code ] [ man_1 ] ... [ man_k ]
 *             return chr( (<char *>(self.g+1))[n] )
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_STR) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":920
 *         elif pari_type == t_STR:
 *             #t_STR    : string            [ code ] [ man_1 ] ... [ man_k ]
 *             return chr( (<char *>(self.g+1))[n] )             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_LIST:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_v_n); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = __Pyx_PyInt_From_char((((char *)(__pyx_v_self->g + 1))[__pyx_t_3])); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_chr, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":922
 *             return chr( (<char *>(self.g+1))[n] )
 * 
 *         elif pari_type == t_LIST:             # <<<<<<<<<<<<<<
 *             #t_LIST   : list              [ code ] [ n ] [ nmax ][ vec ]
 *             return self.component(n+1)
 */
  __pyx_t_2 = ((__pyx_v_pari_type == t_LIST) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":924
 *         elif pari_type == t_LIST:
 *             #t_LIST   : list              [ code ] [ n ] [ nmax ][ vec ]
 *             return self.component(n+1)             # <<<<<<<<<<<<<<
 *             #code from previous version, now segfaults:
 *             #return P.new_ref(gel(self.g,n+2), self)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_component); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_5 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_9))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_9);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_GOTREF(__pyx_t_4);
    } else {
      __pyx_t_10 = PyTuple_New(1+1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_10);
      PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_11); __Pyx_GIVEREF(__pyx_t_11); __pyx_t_11 = NULL;
      PyTuple_SET_ITEM(__pyx_t_10, 0+1, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    }
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":928
 *             #return P.new_ref(gel(self.g,n+2), self)
 * 
 *         elif pari_type in (t_INTMOD, t_POLMOD):             # <<<<<<<<<<<<<<
 *             #t_INTMOD : integermods       [ code ] [ mod  ] [ integer ]
 *             #t_POLMOD : poly mod          [ code ] [ mod  ] [ polynomial ]
 */
  __pyx_t_14 = __pyx_v_pari_type;
  __pyx_t_1 = ((__pyx_t_14 == t_INTMOD) != 0);
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L38_bool_binop_done;
  }
  __pyx_t_1 = ((__pyx_t_14 == t_POLMOD) != 0);
  __pyx_t_2 = __pyx_t_1;
  __pyx_L38_bool_binop_done:;
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":936
 *             #   [1] = lift to t_INT or t_POL
 *             # do we want this? maybe the other way around?
 *             raise TypeError, "unindexable object"             # <<<<<<<<<<<<<<
 * 
 *         #elif pari_type in (t_FRAC, t_RFRAC):
 */
    __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_unindexable_object, 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  /*else*/ {

    /* "gen.pyx":954
 *             ## generic code, which currently handles cases
 *             ## as mentioned above
 *             return P.new_ref(gel(self.g,n+1), self)             # <<<<<<<<<<<<<<
 * 
 *     def __setitem__(gen self, n, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = __Pyx_PyInt_As_long(__pyx_t_4); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_ref(__pyx_v_3gen_P, gel(__pyx_v_self->g, __pyx_t_8), __pyx_v_self)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":735
 *         return P.new_gen(bid_get_gen(self.g))
 * 
 *     def __getitem__(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the nth entry of self. The indexing is 0-based, like in
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_AddTraceback("gen.gen.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_ind);
  __Pyx_XDECREF((PyObject *)__pyx_v_val);
  __Pyx_XDECREF(__pyx_v_start);
  __Pyx_XDECREF(__pyx_v_stop);
  __Pyx_XDECREF(__pyx_v_step);
  __Pyx_XDECREF(__pyx_v_inds);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":956
 *             return P.new_ref(gel(self.g,n+1), self)
 * 
 *     def __setitem__(gen self, n, y):             # <<<<<<<<<<<<<<
 *         r"""
 *         Set the nth entry to a reference to y.
 */

/* Python wrapper */
static int __pyx_pw_3gen_3gen_83__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_3gen_3gen_82__setitem__[] = "\n        Set the nth entry to a reference to y.\n\n\n            -  The indexing is 0-based, like everywhere else in Python, but\n               *unlike* in PARI/GP.\n\n            -  Assignment sets the nth entry to a reference to y, assuming y is\n               an object of type gen. This is the same as in Python, but\n               *different* than what happens in the gp interpreter, where\n               assignment makes a copy of y.\n\n            -  Because setting creates references it is *possible* to make\n               circular references, unlike in GP. Do *not* do this (see the\n               example below). If you need circular references, work at the Python\n               level (where they work well), not the PARI object level.\n\n\n\n        EXAMPLES::\n\n            sage: v = pari(range(10))\n            sage: v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[0] = 10\n            sage: w = pari([5,8,-20])\n            sage: v\n            [10, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[1] = w\n            sage: v\n            [10, [5, 8, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: w[0] = -30\n            sage: v\n            [10, [-30, 8, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: t = v[1]; t[1] = 10 ; v\n            [10, [-30, 10, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[1][0] = 54321 ; v\n            [10, [54321, 10, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: w\n            [54321, 10, -20]\n            sage: v = pari([[[[0,1],2],3],4]) ; v[0][0][0][1] = 12 ; v\n            [[[[0, 12], 2], 3], 4]\n            sage: m = pari(matrix(2,2,range(4))) ; l = pari([5,6]) ; n = pari(matrix(2,2,[7,8,9,0])) ; m[1,0] = l ; l[1] = n ; m[1,0][1][1,1] = 1111 ; m\n            [0, 1; [5, [7, 8; 9, 1111]], 3]\n            sage: m = pari(\"[[1,2;3,4],5,6]\") ; m[0][1,1] = 11 ; m\n            [[1, 2; 3, 11], 5, 6]\n\n        Finally, we create a circular reference::\n\n            sage: v = pari([0])\n            s""age: w = pari([v])\n            sage: v\n            [0]\n            sage: w\n            [[0]]\n            sage: v[0] = w\n\n        Now there is a circular reference. Accessing v[0] will crash Sage.\n\n        ::\n\n            sage: s=pari.vector(2,[0,0])\n            sage: s[:1]\n            [0]\n            sage: s[:1]=[1]\n            sage: s\n            [1, 0]\n            sage: type(s[0])\n            <type 'gen.gen'>\n            sage: s = pari(range(20)) ; s\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: s[0:10:2] = range(50,55) ; s\n            [50, 1, 51, 3, 52, 5, 53, 7, 54, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: s[10:20:3] = range(100,150) ; s\n            [50, 1, 51, 3, 52, 5, 53, 7, 54, 9, 100, 11, 12, 101, 14, 15, 102, 17, 18, 103]\n\n        TESTS::\n\n            sage: v = pari(xrange(10)) ; v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[:] = [20..29]\n            sage: v\n            [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]\n            sage: type(v[0])\n            <type 'gen.gen'>\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_82__setitem__;
#endif
static int __pyx_pw_3gen_3gen_83__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setitem__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_82__setitem__(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n), ((PyObject *)__pyx_v_y));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_3gen_3gen_82__setitem__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y) {
  int __pyx_v_i;
  int __pyx_v_j;
  struct __pyx_obj_3gen_gen *__pyx_v_x = 0;
  long __pyx_v_l;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_inds = NULL;
  Py_ssize_t __pyx_v_k;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  Py_ssize_t __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  int __pyx_t_11;
  char const *__pyx_t_12;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17 = NULL;
  PyObject *__pyx_t_18 = NULL;
  int __pyx_t_19;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setitem__", 0);

  /* "gen.pyx":1044
 *         """
 *         cdef int i, j
 *         cdef gen x = objtogen(y)             # <<<<<<<<<<<<<<
 *         cdef long l
 *         cdef Py_ssize_t ii, jj, step
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1044; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_x = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1048
 *         cdef Py_ssize_t ii, jj, step
 * 
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         try:
 *             if isinstance(n, tuple):
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1048; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1049
 * 
 *         pari_catch_sig_on()
 *         try:             # <<<<<<<<<<<<<<
 *             if isinstance(n, tuple):
 *                 if typ(self.g) != t_MAT:
 */
  /*try:*/ {

    /* "gen.pyx":1050
 *         pari_catch_sig_on()
 *         try:
 *             if isinstance(n, tuple):             # <<<<<<<<<<<<<<
 *                 if typ(self.g) != t_MAT:
 *                     raise TypeError, "cannot index PARI type %s by tuple"%typ(self.g)
 */
    __pyx_t_3 = PyTuple_Check(__pyx_v_n); 
    __pyx_t_4 = (__pyx_t_3 != 0);
    if (__pyx_t_4) {

      /* "gen.pyx":1051
 *         try:
 *             if isinstance(n, tuple):
 *                 if typ(self.g) != t_MAT:             # <<<<<<<<<<<<<<
 *                     raise TypeError, "cannot index PARI type %s by tuple"%typ(self.g)
 * 
 */
      __pyx_t_4 = ((typ(__pyx_v_self->g) != t_MAT) != 0);
      if (__pyx_t_4) {

        /* "gen.pyx":1052
 *             if isinstance(n, tuple):
 *                 if typ(self.g) != t_MAT:
 *                     raise TypeError, "cannot index PARI type %s by tuple"%typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *                 if len(n) != 2:
 */
        __pyx_t_1 = __Pyx_PyInt_From_long(typ(__pyx_v_self->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1052; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_cannot_index_PARI_type_s_by_tupl, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1052; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_5, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1052; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }

      /* "gen.pyx":1054
 *                     raise TypeError, "cannot index PARI type %s by tuple"%typ(self.g)
 * 
 *                 if len(n) != 2:             # <<<<<<<<<<<<<<
 *                     raise ValueError, "matrix index must be of the form [row, column]"
 * 
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_n); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1054; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __pyx_t_4 = ((__pyx_t_6 != 2) != 0);
      if (__pyx_t_4) {

        /* "gen.pyx":1055
 * 
 *                 if len(n) != 2:
 *                     raise ValueError, "matrix index must be of the form [row, column]"             # <<<<<<<<<<<<<<
 * 
 *                 i = int(n[0])
 */
        __Pyx_Raise(__pyx_builtin_ValueError, __pyx_kp_s_matrix_index_must_be_of_the_form, 0, 0);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }

      /* "gen.pyx":1057
 *                     raise ValueError, "matrix index must be of the form [row, column]"
 * 
 *                 i = int(n[0])             # <<<<<<<<<<<<<<
 *                 j = int(n[1])
 *                 ind = (i,j)
 */
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_n, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1057; __pyx_clineno = __LINE__; goto __pyx_L4_error;};
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1057; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1057; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_i = __pyx_t_2;

      /* "gen.pyx":1058
 * 
 *                 i = int(n[0])
 *                 j = int(n[1])             # <<<<<<<<<<<<<<
 *                 ind = (i,j)
 * 
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_n, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L4_error;};
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_5 = PyNumber_Int(__pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_j = __pyx_t_2;

      /* "gen.pyx":1059
 *                 i = int(n[0])
 *                 j = int(n[1])
 *                 ind = (i,j)             # <<<<<<<<<<<<<<
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 */
      __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1059; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_j); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1059; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1059; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_1 = 0;
      __pyx_v_ind = __pyx_t_7;
      __pyx_t_7 = 0;

      /* "gen.pyx":1061
 *                 ind = (i,j)
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):             # <<<<<<<<<<<<<<
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):
 */
      __pyx_t_3 = ((__pyx_v_i < 0) != 0);
      if (!__pyx_t_3) {
      } else {
        __pyx_t_4 = __pyx_t_3;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_3 = ((__pyx_v_i >= glength(((GEN)(__pyx_v_self->g[1])))) != 0);
      __pyx_t_4 = __pyx_t_3;
      __pyx_L10_bool_binop_done:;
      if (__pyx_t_4) {

        /* "gen.pyx":1062
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)             # <<<<<<<<<<<<<<
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 */
        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nrows); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_8 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_5);
          if (likely(__pyx_t_8)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
            __Pyx_INCREF(__pyx_t_8);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_5, function);
          }
        }
        if (__pyx_t_8) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        } else {
          __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        }
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_7 = 0;
        __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_row_i_s_must_be_between_0_and_s, __pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, __pyx_t_5, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }

      /* "gen.pyx":1063
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):             # <<<<<<<<<<<<<<
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 *                 if self.refers_to is None:
 */
      __pyx_t_3 = ((__pyx_v_j < 0) != 0);
      if (!__pyx_t_3) {
      } else {
        __pyx_t_4 = __pyx_t_3;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_3 = ((__pyx_v_j >= glength(__pyx_v_self->g)) != 0);
      __pyx_t_4 = __pyx_t_3;
      __pyx_L13_bool_binop_done:;
      if (__pyx_t_4) {

        /* "gen.pyx":1064
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)             # <<<<<<<<<<<<<<
 *                 if self.refers_to is None:
 *                     self.refers_to = {ind: x}
 */
        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_j); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_ncols); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_8)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_8);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
          }
        }
        if (__pyx_t_8) {
          __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        } else {
          __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        }
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = PyNumber_Subtract(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_7);
        __pyx_t_5 = 0;
        __pyx_t_7 = 0;
        __pyx_t_7 = __Pyx_PyString_Format(__pyx_kp_s_column_j_s_must_be_between_0_and, __pyx_t_1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, __pyx_t_7, 0, 0);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }

      /* "gen.pyx":1065
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 *                 if self.refers_to is None:             # <<<<<<<<<<<<<<
 *                     self.refers_to = {ind: x}
 *                 else:
 */
      __pyx_t_4 = (__pyx_v_self->refers_to == ((PyObject*)Py_None));
      __pyx_t_3 = (__pyx_t_4 != 0);
      if (__pyx_t_3) {

        /* "gen.pyx":1066
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 *                 if self.refers_to is None:
 *                     self.refers_to = {ind: x}             # <<<<<<<<<<<<<<
 *                 else:
 *                     self.refers_to[ind] = x
 */
        __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1066; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        if (PyDict_SetItem(__pyx_t_7, __pyx_v_ind, ((PyObject *)__pyx_v_x)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1066; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GIVEREF(__pyx_t_7);
        __Pyx_GOTREF(__pyx_v_self->refers_to);
        __Pyx_DECREF(__pyx_v_self->refers_to);
        __pyx_v_self->refers_to = ((PyObject*)__pyx_t_7);
        __pyx_t_7 = 0;
        goto __pyx_L15;
      }
      /*else*/ {

        /* "gen.pyx":1068
 *                     self.refers_to = {ind: x}
 *                 else:
 *                     self.refers_to[ind] = x             # <<<<<<<<<<<<<<
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)
 */
        if (unlikely(__pyx_v_self->refers_to == Py_None)) {
          PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1068; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        }
        if (unlikely(PyDict_SetItem(__pyx_v_self->refers_to, __pyx_v_ind, ((PyObject *)__pyx_v_x)) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1068; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }
      __pyx_L15:;

      /* "gen.pyx":1070
 *                     self.refers_to[ind] = x
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)             # <<<<<<<<<<<<<<
 *                 return
 * 
 */
      (((GEN)(__pyx_v_self->g[(__pyx_v_j + 1)]))[(__pyx_v_i + 1)]) = ((long)__pyx_v_x->g);

      /* "gen.pyx":1071
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)
 *                 return             # <<<<<<<<<<<<<<
 * 
 *             elif isinstance(n, slice):
 */
      __pyx_r = 0;
      goto __pyx_L3_return;
    }

    /* "gen.pyx":1073
 *                 return
 * 
 *             elif isinstance(n, slice):             # <<<<<<<<<<<<<<
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))
 */
    __pyx_t_3 = PySlice_Check(__pyx_v_n); 
    __pyx_t_4 = (__pyx_t_3 != 0);
    if (__pyx_t_4) {

      /* "gen.pyx":1074
 * 
 *             elif isinstance(n, slice):
 *                 l = glength(self.g)             # <<<<<<<<<<<<<<
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)
 */
      __pyx_v_l = glength(__pyx_v_self->g);

      /* "gen.pyx":1075
 *             elif isinstance(n, slice):
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))             # <<<<<<<<<<<<<<
 *                 k = len(inds)
 *                 if k > len(y):
 */
      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_n, __pyx_n_s_indices); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_l); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
        __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
        if (likely(__pyx_t_8)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
          __Pyx_INCREF(__pyx_t_8);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_GOTREF(__pyx_t_7);
      } else {
        __pyx_t_9 = PyTuple_New(1+1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __Pyx_GIVEREF(__pyx_t_8); __pyx_t_8 = NULL;
        PyTuple_SET_ITEM(__pyx_t_9, 0+1, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PySequence_Tuple(__pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_xrange, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_inds = __pyx_t_7;
      __pyx_t_7 = 0;

      /* "gen.pyx":1076
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)             # <<<<<<<<<<<<<<
 *                 if k > len(y):
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_inds); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __pyx_v_k = __pyx_t_6;

      /* "gen.pyx":1077
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)
 *                 if k > len(y):             # <<<<<<<<<<<<<<
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)
 * 
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __pyx_t_4 = ((__pyx_v_k > __pyx_t_6) != 0);
      if (__pyx_t_4) {

        /* "gen.pyx":1078
 *                 k = len(inds)
 *                 if k > len(y):
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)             # <<<<<<<<<<<<<<
 * 
 *                 # actually set the values
 */
        __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __pyx_t_7 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_k); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_1);
        __pyx_t_7 = 0;
        __pyx_t_1 = 0;
        __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_attempt_to_assign_sequence_of_si, __pyx_t_9); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_Raise(__pyx_builtin_ValueError, __pyx_t_1, 0, 0);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }

      /* "gen.pyx":1081
 * 
 *                 # actually set the values
 *                 for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                     self[j] = y[i]
 *                 return
 */
      __pyx_t_2 = 0;
      if (likely(PyList_CheckExact(__pyx_v_inds)) || PyTuple_CheckExact(__pyx_v_inds)) {
        __pyx_t_1 = __pyx_v_inds; __Pyx_INCREF(__pyx_t_1); __pyx_t_6 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_inds); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_10 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(PyList_CheckExact(__pyx_t_1))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_9); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
            #else
            __pyx_t_9 = PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
            #endif
          }
        } else {
          __pyx_t_9 = __pyx_t_10(__pyx_t_1);
          if (unlikely(!__pyx_t_9)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_9);
        }
        __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_t_9); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_v_j = __pyx_t_11;
        __pyx_v_i = __pyx_t_2;
        __pyx_t_2 = (__pyx_t_2 + 1);

        /* "gen.pyx":1082
 *                 # actually set the values
 *                 for i,j in enumerate(inds):
 *                     self[j] = y[i]             # <<<<<<<<<<<<<<
 *                 return
 * 
 */
        __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_y, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L4_error;};
        __Pyx_GOTREF(__pyx_t_9);
        if (unlikely(__Pyx_SetItemInt(((PyObject *)__pyx_v_self), __pyx_v_j, __pyx_t_9, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

        /* "gen.pyx":1081
 * 
 *                 # actually set the values
 *                 for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                     self[j] = y[i]
 *                 return
 */
      }
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "gen.pyx":1083
 *                 for i,j in enumerate(inds):
 *                     self[j] = y[i]
 *                 return             # <<<<<<<<<<<<<<
 * 
 *             i = int(n)
 */
      __pyx_r = 0;
      goto __pyx_L3_return;
    }

    /* "gen.pyx":1085
 *                 return
 * 
 *             i = int(n)             # <<<<<<<<<<<<<<
 * 
 *             if i < 0 or i >= glength(self.g):
 */
    __pyx_t_1 = PyNumber_Int(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_i = __pyx_t_2;

    /* "gen.pyx":1087
 *             i = int(n)
 * 
 *             if i < 0 or i >= glength(self.g):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index (%s) must be between 0 and %s"%(i,glength(self.g)-1)
 * 
 */
    __pyx_t_3 = ((__pyx_v_i < 0) != 0);
    if (!__pyx_t_3) {
    } else {
      __pyx_t_4 = __pyx_t_3;
      goto __pyx_L20_bool_binop_done;
    }
    __pyx_t_3 = ((__pyx_v_i >= glength(__pyx_v_self->g)) != 0);
    __pyx_t_4 = __pyx_t_3;
    __pyx_L20_bool_binop_done:;
    if (__pyx_t_4) {

      /* "gen.pyx":1088
 * 
 *             if i < 0 or i >= glength(self.g):
 *                 raise IndexError, "index (%s) must be between 0 and %s"%(i,glength(self.g)-1)             # <<<<<<<<<<<<<<
 * 
 *             # so python memory manager will work correctly
 */
      __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1088; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = __Pyx_PyInt_From_long((glength(__pyx_v_self->g) - 1)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1088; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1088; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_9);
      __Pyx_GIVEREF(__pyx_t_9);
      __pyx_t_1 = 0;
      __pyx_t_9 = 0;
      __pyx_t_9 = __Pyx_PyString_Format(__pyx_kp_s_index_s_must_be_between_0_and_s, __pyx_t_7); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1088; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_Raise(__pyx_builtin_IndexError, __pyx_t_9, 0, 0);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1088; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
    }

    /* "gen.pyx":1093
 *             # and not free x if PARI part of self is the
 *             # only thing pointing to it.
 *             if self.refers_to is None:             # <<<<<<<<<<<<<<
 *                 self.refers_to = {i: x}
 *             else:
 */
    __pyx_t_4 = (__pyx_v_self->refers_to == ((PyObject*)Py_None));
    __pyx_t_3 = (__pyx_t_4 != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":1094
 *             # only thing pointing to it.
 *             if self.refers_to is None:
 *                 self.refers_to = {i: x}             # <<<<<<<<<<<<<<
 *             else:
 *                 self.refers_to[i] = x
 */
      __pyx_t_9 = PyDict_New(); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_7);
      if (PyDict_SetItem(__pyx_t_9, __pyx_t_7, ((PyObject *)__pyx_v_x)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_GIVEREF(__pyx_t_9);
      __Pyx_GOTREF(__pyx_v_self->refers_to);
      __Pyx_DECREF(__pyx_v_self->refers_to);
      __pyx_v_self->refers_to = ((PyObject*)__pyx_t_9);
      __pyx_t_9 = 0;
      goto __pyx_L22;
    }
    /*else*/ {

      /* "gen.pyx":1096
 *                 self.refers_to = {i: x}
 *             else:
 *                 self.refers_to[i] = x             # <<<<<<<<<<<<<<
 * 
 *             ## correct indexing for t_POLs
 */
      if (unlikely(__pyx_v_self->refers_to == Py_None)) {
        PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      }
      __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_GOTREF(__pyx_t_9);
      if (unlikely(PyDict_SetItem(__pyx_v_self->refers_to, __pyx_t_9, ((PyObject *)__pyx_v_x)) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_L22:;

    /* "gen.pyx":1099
 * 
 *             ## correct indexing for t_POLs
 *             if typ(self.g) == t_POL:             # <<<<<<<<<<<<<<
 *                 i = i + 1
 * 
 */
    __pyx_t_3 = ((typ(__pyx_v_self->g) == t_POL) != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":1100
 *             ## correct indexing for t_POLs
 *             if typ(self.g) == t_POL:
 *                 i = i + 1             # <<<<<<<<<<<<<<
 * 
 *             ## actually set the value
 */
      __pyx_v_i = (__pyx_v_i + 1);
      goto __pyx_L23;
    }
    __pyx_L23:;

    /* "gen.pyx":1103
 * 
 *             ## actually set the value
 *             (self.g)[i+1] = <long>(x.g)             # <<<<<<<<<<<<<<
 *             return
 *         finally:
 */
    (__pyx_v_self->g[(__pyx_v_i + 1)]) = ((long)__pyx_v_x->g);

    /* "gen.pyx":1104
 *             ## actually set the value
 *             (self.g)[i+1] = <long>(x.g)
 *             return             # <<<<<<<<<<<<<<
 *         finally:
 *             pari_catch_sig_off()
 */
    __pyx_r = 0;
    goto __pyx_L3_return;
  }

  /* "gen.pyx":1106
 *             return
 *         finally:
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 * 
 *     def __len__(gen self):
 */
  /*finally:*/ {
    /*exception exit:*/{
      __pyx_L4_error:;
      __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0;
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (PY_MAJOR_VERSION >= 3) __Pyx_ExceptionSwap(&__pyx_t_16, &__pyx_t_17, &__pyx_t_18);
      if ((PY_MAJOR_VERSION < 3) || unlikely(__Pyx_GetException(&__pyx_t_13, &__pyx_t_14, &__pyx_t_15) < 0)) __Pyx_ErrFetch(&__pyx_t_13, &__pyx_t_14, &__pyx_t_15);
      __Pyx_XGOTREF(__pyx_t_13);
      __Pyx_XGOTREF(__pyx_t_14);
      __Pyx_XGOTREF(__pyx_t_15);
      __Pyx_XGOTREF(__pyx_t_16);
      __Pyx_XGOTREF(__pyx_t_17);
      __Pyx_XGOTREF(__pyx_t_18);
      __pyx_t_2 = __pyx_lineno; __pyx_t_11 = __pyx_clineno; __pyx_t_12 = __pyx_filename;
      {
        pari_catch_sig_off();
      }
      if (PY_MAJOR_VERSION >= 3) {
        __Pyx_XGIVEREF(__pyx_t_16);
        __Pyx_XGIVEREF(__pyx_t_17);
        __Pyx_XGIVEREF(__pyx_t_18);
        __Pyx_ExceptionReset(__pyx_t_16, __pyx_t_17, __pyx_t_18);
      }
      __Pyx_XGIVEREF(__pyx_t_13);
      __Pyx_XGIVEREF(__pyx_t_14);
      __Pyx_XGIVEREF(__pyx_t_15);
      __Pyx_ErrRestore(__pyx_t_13, __pyx_t_14, __pyx_t_15);
      __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0;
      __pyx_lineno = __pyx_t_2; __pyx_clineno = __pyx_t_11; __pyx_filename = __pyx_t_12;
      goto __pyx_L1_error;
    }
    __pyx_L3_return: {
      __pyx_t_19 = __pyx_r;
      pari_catch_sig_off();
      __pyx_r = __pyx_t_19;
      goto __pyx_L0;
    }
  }

  /* "gen.pyx":956
 *             return P.new_ref(gel(self.g,n+1), self)
 * 
 *     def __setitem__(gen self, n, y):             # <<<<<<<<<<<<<<
 *         r"""
 *         Set the nth entry to a reference to y.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("gen.gen.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_ind);
  __Pyx_XDECREF(__pyx_v_inds);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1108
 *             pari_catch_sig_off()
 * 
 *     def __len__(gen self):             # <<<<<<<<<<<<<<
 *         return glength(self.g)
 * 
 */

/* Python wrapper */
static Py_ssize_t __pyx_pw_3gen_3gen_85__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_3gen_3gen_85__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_84__len__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static Py_ssize_t __pyx_pf_3gen_3gen_84__len__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__len__", 0);

  /* "gen.pyx":1109
 * 
 *     def __len__(gen self):
 *         return glength(self.g)             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
  __pyx_r = glength(__pyx_v_self->g);
  goto __pyx_L0;

  /* "gen.pyx":1108
 *             pari_catch_sig_off()
 * 
 *     def __len__(gen self):             # <<<<<<<<<<<<<<
 *         return glength(self.g)
 * 
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1118
 *     ###########################################
 * 
 *     def __richcmp__(left, right, int op):             # <<<<<<<<<<<<<<
 *         return _richcmp_(left,right, op)
 * 
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_87__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_87__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__richcmp__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_86__richcmp__(((PyObject *)__pyx_v_left), ((PyObject *)__pyx_v_right), ((int)__pyx_v_op));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_86__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__richcmp__", 0);

  /* "gen.pyx":1119
 * 
 *     def __richcmp__(left, right, int op):
 *         return _richcmp_(left,right, op)             # <<<<<<<<<<<<<<
 * 
 *     #cdef int _cmp_c_impl(left, gen right) except -2
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __pyx_f_3gen__richcmp_(__pyx_v_left, __pyx_v_right, __pyx_v_op); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1118
 *     ###########################################
 * 
 *     def __richcmp__(left, right, int op):             # <<<<<<<<<<<<<<
 *         return _richcmp_(left,right, op)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1122
 * 
 *     #cdef int _cmp_c_impl(left, gen right) except -2
 *     def  _cmp_c_impl(left, gen right):# except -2:             # <<<<<<<<<<<<<<
 *         """
 *         Comparisons
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_89_cmp_c_impl(PyObject *__pyx_v_left, PyObject *__pyx_v_right); /*proto*/
static char __pyx_doc_3gen_3gen_88_cmp_c_impl[] = "\n        Comparisons\n\n        First uses PARI's cmp routine; if it decides the objects are not\n        comparable, it then compares the underlying strings (since in\n        Python all objects are supposed to be comparable).\n\n        EXAMPLES::\n\n            sage: a = pari(5)\n            sage: b = 10\n            sage: a < b\n            True\n            sage: a <= b\n            True\n            sage: a <= 5\n            True\n            sage: a > b\n            False\n            sage: a >= b\n            False\n            sage: a >= pari(10)\n            False\n            sage: a == 5\n            True\n            sage: a is 5\n            False\n\n        ::\n\n            sage: pari(2.5) > None\n            True\n            sage: pari(3) == pari(3)\n            True\n            sage: pari('x^2 + 1') == pari('I-1')\n            False\n            sage: pari(I) == pari(I)\n            True\n        ";
static PyObject *__pyx_pw_3gen_3gen_89_cmp_c_impl(PyObject *__pyx_v_left, PyObject *__pyx_v_right) {
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_cmp_c_impl (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_right), __pyx_ptype_3gen_gen, 1, "right", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_3gen_3gen_88_cmp_c_impl(((struct __pyx_obj_3gen_gen *)__pyx_v_left), ((struct __pyx_obj_3gen_gen *)__pyx_v_right));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_88_cmp_c_impl(struct __pyx_obj_3gen_gen *__pyx_v_left, struct __pyx_obj_3gen_gen *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_cmp_c_impl", 0);

  /* "gen.pyx":1162
 *             True
 *         """
 *         return gcmp_sage(left.g, (<gen>right).g)             # <<<<<<<<<<<<<<
 * 
 *     def __copy__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(gcmp_sage(__pyx_v_left->g, __pyx_v_right->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1122
 * 
 *     #cdef int _cmp_c_impl(left, gen right) except -2
 *     def  _cmp_c_impl(left, gen right):# except -2:             # <<<<<<<<<<<<<<
 *         """
 *         Comparisons
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen._cmp_c_impl", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1164
 *         return gcmp_sage(left.g, (<gen>right).g)
 * 
 *     def __copy__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gcopy(self.g))
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_91__copy__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_3gen_3gen_91__copy__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__copy__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_90__copy__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_90__copy__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__copy__", 0);

  /* "gen.pyx":1165
 * 
 *     def __copy__(gen self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcopy(self.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1166
 *     def __copy__(gen self):
 *         pari_catch_sig_on()
 *         return P.new_gen(gcopy(self.g))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gcopy(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1164
 *         return gcmp_sage(left.g, (<gen>right).g)
 * 
 *     def __copy__(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gcopy(self.g))
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__copy__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1174
 *     ###########################################
 * 
 *     def list_str(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return str that might correctly evaluate to a Python-list.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_93list_str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_92list_str[] = "\n        Return str that might correctly evaluate to a Python-list.\n        ";
static PyObject *__pyx_pw_3gen_3gen_93list_str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("list_str (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_92list_str(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_92list_str(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("list_str", 0);

  /* "gen.pyx":1178
 *         Return str that might correctly evaluate to a Python-list.
 *         """
 *         s = str(self)             # <<<<<<<<<<<<<<
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "gen.pyx":1179
 *         """
 *         s = str(self)
 *         if s[:4] == "Mat(":             # <<<<<<<<<<<<<<
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 */
  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_s, 0, 4, NULL, NULL, &__pyx_slice__7, 0, 1, 1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = (__Pyx_PyString_Equals(__pyx_t_2, __pyx_kp_s_Mat, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "gen.pyx":1180
 *         s = str(self)
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"             # <<<<<<<<<<<<<<
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 */
    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_s, 4, -1, NULL, NULL, &__pyx_slice__9, 1, 1, 1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyNumber_Add(__pyx_kp_s__8, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_kp_s__10); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_s, __pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "gen.pyx":1181
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")             # <<<<<<<<<<<<<<
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 */
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_replace); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF_SET(__pyx_v_s, __pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1182
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 *         if s.find(";") != -1:             # <<<<<<<<<<<<<<
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_find); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, __pyx_int_neg_1, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_3) {

    /* "gen.pyx":1183
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")             # <<<<<<<<<<<<<<
 *             s = "[" + s + "]"
 *             return eval(s)
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_replace); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF_SET(__pyx_v_s, __pyx_t_2);
    __pyx_t_2 = 0;

    /* "gen.pyx":1184
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"             # <<<<<<<<<<<<<<
 *             return eval(s)
 *         else:
 */
    __pyx_t_2 = PyNumber_Add(__pyx_kp_s__8, __pyx_v_s); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_kp_s__10); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF_SET(__pyx_v_s, __pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":1185
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 *             return eval(s)             # <<<<<<<<<<<<<<
 *         else:
 *             return eval(s)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_Globals(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    if (__pyx_v_s) {
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_s, __pyx_v_s) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    if (((PyObject *)__pyx_v_self)) {
      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_self, ((PyObject *)__pyx_v_self)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_eval, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
  /*else*/ {

    /* "gen.pyx":1187
 *             return eval(s)
 *         else:
 *             return eval(s)             # <<<<<<<<<<<<<<
 * 
 *     def __hex__(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_Globals(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    if (__pyx_v_s) {
      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_s, __pyx_v_s) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    if (((PyObject *)__pyx_v_self)) {
      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_self, ((PyObject *)__pyx_v_self)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_eval, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":1174
 *     ###########################################
 * 
 *     def list_str(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return str that might correctly evaluate to a Python-list.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.list_str", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1189
 *             return eval(s)
 * 
 *     def __hex__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hexadecimal digits of self in lower case.
 */

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_3gen_3gen_95__hex__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_3gen_3gen_94__hex__[] = "\n        Return the hexadecimal digits of self in lower case.\n\n        EXAMPLES::\n\n            sage: print hex(pari(0))\n            0\n            sage: print hex(pari(15))\n            f\n            sage: print hex(pari(16))\n            10\n            sage: print hex(pari(16938402384092843092843098243))\n            36bb1e3929d1a8fe2802f083\n            sage: print hex(long(16938402384092843092843098243))\n            0x36bb1e3929d1a8fe2802f083L\n            sage: print hex(pari(-16938402384092843092843098243))\n            -36bb1e3929d1a8fe2802f083\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_94__hex__;
#endif
static PyObject *__pyx_pw_3gen_3gen_95__hex__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__hex__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_94__hex__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_94__hex__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  GEN __pyx_v_x;
  long __pyx_v_lx;
  long *__pyx_v_xp;
  long __pyx_v_w;
  char *__pyx_v_s;
  char *__pyx_v_sp;
  char *__pyx_v_hexdigits;
  CYTHON_UNUSED int __pyx_v_i;
  CYTHON_UNUSED int __pyx_v_j;
  int __pyx_v_size;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  long __pyx_t_3;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__hex__", 0);

  /* "gen.pyx":1213
 *         cdef char *s, *sp
 *         cdef char *hexdigits
 *         hexdigits = "0123456789abcdef"             # <<<<<<<<<<<<<<
 *         cdef int i, j
 *         cdef int size
 */
  __pyx_v_hexdigits = __pyx_k_0123456789abcdef;

  /* "gen.pyx":1216
 *         cdef int i, j
 *         cdef int size
 *         x = self.g             # <<<<<<<<<<<<<<
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"
 */
  __pyx_t_1 = __pyx_v_self->g;
  __pyx_v_x = __pyx_t_1;

  /* "gen.pyx":1217
 *         cdef int size
 *         x = self.g
 *         if typ(x) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):
 */
  __pyx_t_2 = ((typ(__pyx_v_x) != t_INT) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":1218
 *         x = self.g
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"             # <<<<<<<<<<<<<<
 *         if not signe(x):
 *             return "0"
 */
    __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_gen_must_be_of_PARI_type_t_INT, 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":1219
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):             # <<<<<<<<<<<<<<
 *             return "0"
 *         lx = lgefint(x)-2  # number of words
 */
  __pyx_t_2 = ((!(signe(__pyx_v_x) != 0)) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":1220
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):
 *             return "0"             # <<<<<<<<<<<<<<
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_kp_s_0);
    __pyx_r = __pyx_kp_s_0;
    goto __pyx_L0;
  }

  /* "gen.pyx":1221
 *         if not signe(x):
 *             return "0"
 *         lx = lgefint(x)-2  # number of words             # <<<<<<<<<<<<<<
 *         size = lx*2*sizeof(long)
 *         s = <char *>sage_malloc(size+2) # 1 char for sign, 1 char for '\0'
 */
  __pyx_v_lx = (lgefint(__pyx_v_x) - 2);

  /* "gen.pyx":1222
 *             return "0"
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)             # <<<<<<<<<<<<<<
 *         s = <char *>sage_malloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1
 */
  __pyx_v_size = ((__pyx_v_lx * 2) * (sizeof(long)));

  /* "gen.pyx":1223
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)
 *         s = <char *>sage_malloc(size+2) # 1 char for sign, 1 char for '\0'             # <<<<<<<<<<<<<<
 *         sp = s + size+1
 *         sp[0] = 0
 */
  __pyx_v_s = ((char *)sage_malloc((__pyx_v_size + 2)));

  /* "gen.pyx":1224
 *         size = lx*2*sizeof(long)
 *         s = <char *>sage_malloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1             # <<<<<<<<<<<<<<
 *         sp[0] = 0
 *         xp = int_LSW(x)
 */
  __pyx_v_sp = ((__pyx_v_s + __pyx_v_size) + 1);

  /* "gen.pyx":1225
 *         s = <char *>sage_malloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1
 *         sp[0] = 0             # <<<<<<<<<<<<<<
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:
 */
  (__pyx_v_sp[0]) = 0;

  /* "gen.pyx":1226
 *         sp = s + size+1
 *         sp[0] = 0
 *         xp = int_LSW(x)             # <<<<<<<<<<<<<<
 *         for i from 0 <= i < lx:
 *             w = xp[0]
 */
  __pyx_v_xp = int_LSW(__pyx_v_x);

  /* "gen.pyx":1227
 *         sp[0] = 0
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:             # <<<<<<<<<<<<<<
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):
 */
  __pyx_t_3 = __pyx_v_lx;
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {

    /* "gen.pyx":1228
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:
 *             w = xp[0]             # <<<<<<<<<<<<<<
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1
 */
    __pyx_v_w = (__pyx_v_xp[0]);

    /* "gen.pyx":1229
 *         for i from 0 <= i < lx:
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):             # <<<<<<<<<<<<<<
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]
 */
    __pyx_t_4 = (2 * (sizeof(long)));
    for (__pyx_v_j = 0; __pyx_v_j < __pyx_t_4; __pyx_v_j++) {

      /* "gen.pyx":1230
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1             # <<<<<<<<<<<<<<
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4
 */
      __pyx_v_sp = (__pyx_v_sp - 1);

      /* "gen.pyx":1231
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]             # <<<<<<<<<<<<<<
 *                 w = w>>4
 *             xp = int_nextW(xp)
 */
      (__pyx_v_sp[0]) = (__pyx_v_hexdigits[(__pyx_v_w & 15)]);

      /* "gen.pyx":1232
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4             # <<<<<<<<<<<<<<
 *             xp = int_nextW(xp)
 *         # remove leading zeros!
 */
      __pyx_v_w = (__pyx_v_w >> 4);
    }

    /* "gen.pyx":1233
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4
 *             xp = int_nextW(xp)             # <<<<<<<<<<<<<<
 *         # remove leading zeros!
 *         while sp[0] == c'0':
 */
    __pyx_v_xp = int_nextW(__pyx_v_xp);
  }

  /* "gen.pyx":1235
 *             xp = int_nextW(xp)
 *         # remove leading zeros!
 *         while sp[0] == c'0':             # <<<<<<<<<<<<<<
 *             sp = sp+1
 *         if signe(x) < 0:
 */
  while (1) {
    __pyx_t_2 = (((__pyx_v_sp[0]) == '0') != 0);
    if (!__pyx_t_2) break;

    /* "gen.pyx":1236
 *         # remove leading zeros!
 *         while sp[0] == c'0':
 *             sp = sp+1             # <<<<<<<<<<<<<<
 *         if signe(x) < 0:
 *             sp = sp-1
 */
    __pyx_v_sp = (__pyx_v_sp + 1);
  }

  /* "gen.pyx":1237
 *         while sp[0] == c'0':
 *             sp = sp+1
 *         if signe(x) < 0:             # <<<<<<<<<<<<<<
 *             sp = sp-1
 *             sp[0] = c'-'
 */
  __pyx_t_2 = ((signe(__pyx_v_x) < 0) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":1238
 *             sp = sp+1
 *         if signe(x) < 0:
 *             sp = sp-1             # <<<<<<<<<<<<<<
 *             sp[0] = c'-'
 *         k = <object>sp
 */
    __pyx_v_sp = (__pyx_v_sp - 1);

    /* "gen.pyx":1239
 *         if signe(x) < 0:
 *             sp = sp-1
 *             sp[0] = c'-'             # <<<<<<<<<<<<<<
 *         k = <object>sp
 *         sage_free(s)
 */
    (__pyx_v_sp[0]) = '-';
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "gen.pyx":1240
 *             sp = sp-1
 *             sp[0] = c'-'
 *         k = <object>sp             # <<<<<<<<<<<<<<
 *         sage_free(s)
 *         return k
 */
  __pyx_t_5 = __Pyx_PyBytes_FromString(__pyx_v_sp); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __pyx_t_5;
  __Pyx_INCREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_k = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "gen.pyx":1241
 *             sp[0] = c'-'
 *         k = <object>sp
 *         sage_free(s)             # <<<<<<<<<<<<<<
 *         return k
 * 
 */
  sage_free(__pyx_v_s);

  /* "gen.pyx":1242
 *         k = <object>sp
 *         sage_free(s)
 *         return k             # <<<<<<<<<<<<<<
 * 
 *     def __int__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_k);
  __pyx_r = __pyx_v_k;
  goto __pyx_L0;

  /* "gen.pyx":1189
 *             return eval(s)
 * 
 *     def __hex__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hexadecimal digits of self in lower case.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("gen.gen.__hex__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "gen.pyx":1244
 *         return k
 * 
 *     def __int__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert ``self`` to a Python integer.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_97__int__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_3gen_3gen_96__int__[] = "\n        Convert ``self`` to a Python integer.\n\n        If the number is too large to fit into a Pyhon ``int``, a\n        Python ``long`` is returned instead.\n\n        EXAMPLES::\n\n            sage: int(pari(0))\n            0\n            sage: int(pari(10))\n            10\n            sage: int(pari(-10))\n            -10\n            sage: int(pari(123456789012345678901234567890))\n            123456789012345678901234567890L\n            sage: int(pari(-123456789012345678901234567890))\n            -123456789012345678901234567890L\n            sage: int(pari(2^31-1))\n            2147483647\n            sage: int(pari(-2^31))\n            -2147483648\n            sage: int(pari(\"Pol(10)\"))\n            10\n            sage: int(pari(\"Mod(2, 7)\"))\n            2\n            sage: int(pari(RealField(63)(2^63-1)))\n            9223372036854775807L  # 32-bit\n            9223372036854775807   # 64-bit\n            sage: int(pari(RealField(63)(2^63+2)))\n            9223372036854775810L\n\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_96__int__;
#endif
static PyObject *__pyx_pw_3gen_3gen_97__int__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__int__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_96__int__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_96__int__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__int__", 0);

  /* "gen.pyx":1283
 *         #    Integer = sage.rings.integer.Integer
 *         cdef int i
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         i = <int>gtolong(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1284
 *         cdef int i
 *         pari_catch_sig_on()
 *         i = <int>gtolong(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return i
 */
  __pyx_v_i = ((int)gtolong(__pyx_v_self->g));

  /* "gen.pyx":1285
 *         pari_catch_sig_on()
 *         i = <int>gtolong(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return i
 *         #return int(self)
 */
  pari_catch_sig_off();

  /* "gen.pyx":1286
 *         i = <int>gtolong(self.g)
 *         pari_catch_sig_off()
 *         return i             # <<<<<<<<<<<<<<
 *         #return int(self)
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_i); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1244
 *         return k
 * 
 *     def __int__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert ``self`` to a Python integer.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__int__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1289
 *         #return int(self)
 * 
 *     def python_list_small(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_99python_list_small(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_98python_list_small[] = "\n        Return a Python list of the PARI gens. This object must be of type\n        t_VECSMALL, and the resulting list contains python 'int's.\n\n        EXAMPLES::\n\n            sage: v=pari([1,2,3,10,102,10]).Vecsmall()\n            sage: w = v.python_list_small()\n            sage: w\n            [1, 2, 3, 10, 102, 10]\n            sage: type(w[0])\n            <type 'int'>\n        ";
static PyObject *__pyx_pw_3gen_3gen_99python_list_small(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("python_list_small (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_98python_list_small(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_98python_list_small(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_n;
  long __pyx_v_m;
  PyObject *__pyx_v_V = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  long __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("python_list_small", 0);

  /* "gen.pyx":1304
 *         """
 *         cdef long n, m
 *         if typ(self.g) != t_VECSMALL:             # <<<<<<<<<<<<<<
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []
 */
  __pyx_t_1 = ((typ(__pyx_v_self->g) != t_VECSMALL) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":1305
 *         cdef long n, m
 *         if typ(self.g) != t_VECSMALL:
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self             # <<<<<<<<<<<<<<
 *         V = []
 *         m = glength(self.g)
 */
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Object_s_must_be_of_type_t_VECSM, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_2, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":1306
 *         if typ(self.g) != t_VECSMALL:
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []             # <<<<<<<<<<<<<<
 *         m = glength(self.g)
 *         for n from 0 <= n < m:
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_V = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "gen.pyx":1307
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []
 *         m = glength(self.g)             # <<<<<<<<<<<<<<
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])
 */
  __pyx_v_m = glength(__pyx_v_self->g);

  /* "gen.pyx":1308
 *         V = []
 *         m = glength(self.g)
 *         for n from 0 <= n < m:             # <<<<<<<<<<<<<<
 *             V.append(self.g[n+1])
 *         return V
 */
  __pyx_t_3 = __pyx_v_m;
  for (__pyx_v_n = 0; __pyx_v_n < __pyx_t_3; __pyx_v_n++) {

    /* "gen.pyx":1309
 *         m = glength(self.g)
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])             # <<<<<<<<<<<<<<
 *         return V
 * 
 */
    __pyx_t_2 = __Pyx_PyInt_From_long((__pyx_v_self->g[(__pyx_v_n + 1)])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyList_Append(__pyx_v_V, __pyx_t_2); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }

  /* "gen.pyx":1310
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])
 *         return V             # <<<<<<<<<<<<<<
 * 
 *     def python_list(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_V);
  __pyx_r = __pyx_v_V;
  goto __pyx_L0;

  /* "gen.pyx":1289
 *         #return int(self)
 * 
 *     def python_list_small(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.python_list_small", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_V);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1312
 *         return V
 * 
 *     def python_list(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_101python_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_100python_list[] = "\n        Return a Python list of the PARI gens. This object must be of type\n        t_VEC.\n\n        INPUT: None\n\n        OUTPUT:\n\n        -  ``list`` - Python list whose elements are the\n           elements of the input gen.\n\n\n        EXAMPLES::\n\n            sage: v=pari([1,2,3,10,102,10])\n            sage: w = v.python_list()\n            sage: w\n            [1, 2, 3, 10, 102, 10]\n            sage: type(w[0])\n            <type 'gen.gen'>\n            sage: pari(\"[1,2,3]\").python_list()\n            [1, 2, 3]\n        ";
static PyObject *__pyx_pw_3gen_3gen_101python_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("python_list (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_100python_list(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_100python_list(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_n;
  long __pyx_v_m;
  PyObject *__pyx_v_V = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  long __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_t_8;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("python_list", 0);

  /* "gen.pyx":1339
 *         cdef gen t
 * 
 *         if typ(self.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)
 */
  __pyx_t_1 = ((typ(__pyx_v_self->g) != t_VEC) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":1340
 * 
 *         if typ(self.g) != t_VEC:
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self             # <<<<<<<<<<<<<<
 *         m = glength(self.g)
 *         V = []
 */
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_Object_s_must_be_of_type_t_VEC, ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_2, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "gen.pyx":1341
 *         if typ(self.g) != t_VEC:
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)             # <<<<<<<<<<<<<<
 *         V = []
 *         for n from 0 <= n < m:
 */
  __pyx_v_m = glength(__pyx_v_self->g);

  /* "gen.pyx":1342
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)
 *         V = []             # <<<<<<<<<<<<<<
 *         for n from 0 <= n < m:
 *             V.append(self.__getitem__(n))
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_V = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "gen.pyx":1343
 *         m = glength(self.g)
 *         V = []
 *         for n from 0 <= n < m:             # <<<<<<<<<<<<<<
 *             V.append(self.__getitem__(n))
 *         return V
 */
  __pyx_t_3 = __pyx_v_m;
  for (__pyx_v_n = 0; __pyx_v_n < __pyx_t_3; __pyx_v_n++) {

    /* "gen.pyx":1344
 *         V = []
 *         for n from 0 <= n < m:
 *             V.append(self.__getitem__(n))             # <<<<<<<<<<<<<<
 *         return V
 * 
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_getitem); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __Pyx_GIVEREF(__pyx_t_6); __pyx_t_6 = NULL;
      PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = __Pyx_PyList_Append(__pyx_v_V, __pyx_t_2); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }

  /* "gen.pyx":1345
 *         for n from 0 <= n < m:
 *             V.append(self.__getitem__(n))
 *         return V             # <<<<<<<<<<<<<<
 * 
 *     def python(self, locals=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_V);
  __pyx_r = __pyx_v_V;
  goto __pyx_L0;

  /* "gen.pyx":1312
 *         return V
 * 
 *     def python_list(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("gen.gen.python_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_V);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1347
 *         return V
 * 
 *     def python(self, locals=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python eval of self.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_103python(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_102python[] = "\n        Return Python eval of self.\n\n        Note: is self is a real (type t_REAL) the result will be a\n        RealField element of the equivalent precision; if self is a complex\n        (type t_COMPLEX) the result will be a ComplexField element of\n        precision the minimum precision of the real and imaginary parts.\n\n        EXAMPLES::\n\n            sage: pari('389/17').python()\n            389/17\n            sage: f = pari('(2/3)*x^3 + x - 5/7 + y'); f\n            2/3*x^3 + x + (y - 5/7)\n            sage: var('x,y')\n            (x, y)\n            sage: f.python({'x':x, 'y':y})\n            2/3*x^3 + x + y - 5/7\n\n        You can also use .sage, which is a psynonym::\n\n            sage: f.sage({'x':x, 'y':y})\n            2/3*x^3 + x + y - 5/7\n        ";
static PyObject *__pyx_pw_3gen_3gen_103python(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_locals = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("python (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_locals,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_locals);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "python") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_locals = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("python", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.python", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_102python(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_locals);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_102python(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_locals) {
  PyObject *__pyx_v_gen_py = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("python", 0);

  /* "gen.pyx":1372
 *             2/3*x^3 + x + y - 5/7
 *         """
 *         import gen_py             # <<<<<<<<<<<<<<
 *         return gen_py.python(self, locals=locals)
 * 
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_gen_py, 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_gen_py = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "gen.pyx":1373
 *         """
 *         import gen_py
 *         return gen_py.python(self, locals=locals)             # <<<<<<<<<<<<<<
 * 
 *     sage = python
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_gen_py, __pyx_n_s_python); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_locals, __pyx_v_locals) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1347
 *         return V
 * 
 *     def python(self, locals=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python eval of self.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.python", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_gen_py);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1379
 *     _sage_ = _eval_ = python
 * 
 *     def __long__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert ``self`` to a Python ``long``.
 */

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_3gen_3gen_105__long__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_3gen_3gen_104__long__[] = "\n        Convert ``self`` to a Python ``long``.\n\n        EXAMPLES::\n\n            sage: long(pari(0))\n            0L\n            sage: long(pari(10))\n            10L\n            sage: long(pari(-10))\n            -10L\n            sage: long(pari(123456789012345678901234567890))\n            123456789012345678901234567890L\n            sage: long(pari(-123456789012345678901234567890))\n            -123456789012345678901234567890L\n            sage: long(pari(2^31-1))\n            2147483647L\n            sage: long(pari(-2^31))\n            -2147483648L\n            sage: long(pari(\"Pol(10)\"))\n            10L\n            sage: long(pari(\"Mod(2, 7)\"))\n            2L\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_104__long__;
#endif
static PyObject *__pyx_pw_3gen_3gen_105__long__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__long__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_104__long__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_3gen_3gen_104__long__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  long __pyx_v_f;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__long__", 0);

  /* "gen.pyx":1409
 *         #    Integer = sage.rings.integer.Integer
 *         cdef long f
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         f = gtolong(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1410
 *         cdef long f
 *         pari_catch_sig_on()
 *         f = gtolong(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return f
 */
  __pyx_v_f = gtolong(__pyx_v_self->g);

  /* "gen.pyx":1411
 *         pari_catch_sig_on()
 *         f = gtolong(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return f
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1412
 *         f = gtolong(self.g)
 *         pari_catch_sig_off()
 *         return f             # <<<<<<<<<<<<<<
 * 
 *     def __float__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_f); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1379
 *     _sage_ = _eval_ = python
 * 
 *     def __long__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert ``self`` to a Python ``long``.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__long__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "gen.pyx":1414
 *         return f
 * 
 *     def __float__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python float.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_107__float__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_3gen_3gen_106__float__[] = "\n        Return Python float.\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_3gen_3gen_106__float__;
#endif
static PyObject *__pyx_pw_3gen_3gen_107__float__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__float__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_106__float__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_106__float__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  double __pyx_v_d;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__float__", 0);

  /* "gen.pyx":1419
 *         """
 *         cdef double d
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         d = gtodouble(self.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1420
 *         cdef double d
 *         pari_catch_sig_on()
 *         d = gtodouble(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return d
 */
  __pyx_v_d = gtodouble(__pyx_v_self->g);

  /* "gen.pyx":1421
 *         pari_catch_sig_on()
 *         d = gtodouble(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return d
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1422
 *         d = gtodouble(self.g)
 *         pari_catch_sig_off()
 *         return d             # <<<<<<<<<<<<<<
 * 
 *     def __complex__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_d); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1414
 *         return f
 * 
 *     def __float__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python float.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.__float__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1424
 *         return d
 * 
 *     def __complex__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return ``self`` as a Python ``complex``
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_109__complex__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_108__complex__[] = "\n        Return ``self`` as a Python ``complex``\n        value.\n\n        EXAMPLES::\n\n            sage: g = pari(-1.0)^(1/5); g\n            0.809016994374947 + 0.587785252292473*I\n            sage: g.__complex__()\n            (0.8090169943749475+0.5877852522924731j)\n            sage: complex(g)\n            (0.8090169943749475+0.5877852522924731j)\n\n        ::\n\n            sage: g = pari(Integers(5)(3)); g\n            Mod(3, 5)\n            sage: complex(g)\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in greal/gimag\n        ";
static PyObject *__pyx_pw_3gen_3gen_109__complex__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__complex__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_108__complex__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_108__complex__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  double __pyx_v_re;
  double __pyx_v_im;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__complex__", 0);

  /* "gen.pyx":1448
 *         """
 *         cdef double re, im
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1448; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1449
 *         cdef double re, im
 *         pari_catch_sig_on()
 *         re = gtodouble(greal(self.g))             # <<<<<<<<<<<<<<
 *         im = gtodouble(gimag(self.g))
 *         pari_catch_sig_off()
 */
  __pyx_v_re = gtodouble(greal(__pyx_v_self->g));

  /* "gen.pyx":1450
 *         pari_catch_sig_on()
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return complex(re, im)
 */
  __pyx_v_im = gtodouble(gimag(__pyx_v_self->g));

  /* "gen.pyx":1451
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return complex(re, im)
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1452
 *         im = gtodouble(gimag(self.g))
 *         pari_catch_sig_off()
 *         return complex(re, im)             # <<<<<<<<<<<<<<
 * 
 *     def __nonzero__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_re); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_im); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_7complex_complex)), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1424
 *         return d
 * 
 *     def __complex__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return ``self`` as a Python ``complex``
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.__complex__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1454
 *         return complex(re, im)
 * 
 *     def __nonzero__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

/* Python wrapper */
static int __pyx_pw_3gen_3gen_111__nonzero__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_3gen_3gen_111__nonzero__(PyObject *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__nonzero__ (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_110__nonzero__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_3gen_3gen_110__nonzero__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__nonzero__", 0);

  /* "gen.pyx":1468
 *             False
 *         """
 *         return not gequal0(self.g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = (!(gequal0(__pyx_v_self->g) != 0));
  goto __pyx_L0;

  /* "gen.pyx":1454
 *         return complex(re, im)
 * 
 *     def __nonzero__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1475
 *     ###########################################
 * 
 *     def gequal(gen a, b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` and `b` are equal using PARI's ``gequal``.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_113gequal(PyObject *__pyx_v_a, PyObject *__pyx_v_b); /*proto*/
static char __pyx_doc_3gen_3gen_112gequal[] = "\n        Check whether `a` and `b` are equal using PARI's ``gequal``.\n\n        EXAMPLES::\n\n            sage: a = pari(1); b = pari(1.0); c = pari('\"some_string\"')\n            sage: a.gequal(a)\n            True\n            sage: b.gequal(b)\n            True\n            sage: c.gequal(c)\n            True\n            sage: a.gequal(b)\n            True\n            sage: a.gequal(c)\n            False\n\n        WARNING: this relation is not transitive::\n\n            sage: a = pari('[0]'); b = pari(0); c = pari('[0,0]')\n            sage: a.gequal(b)\n            True\n            sage: b.gequal(c)\n            True\n            sage: a.gequal(c)\n            False\n        ";
static PyObject *__pyx_pw_3gen_3gen_113gequal(PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_112gequal(((struct __pyx_obj_3gen_gen *)__pyx_v_a), ((PyObject *)__pyx_v_b));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_112gequal(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal", 0);

  /* "gen.pyx":1503
 *             False
 *         """
 *         cdef gen t0 = objtogen(b)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef int ret = gequal(a.g, t0.g)
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1504
 *         """
 *         cdef gen t0 = objtogen(b)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequal(a.g, t0.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1505
 *         cdef gen t0 = objtogen(b)
 *         pari_catch_sig_on()
 *         cdef int ret = gequal(a.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequal(__pyx_v_a->g, __pyx_v_t0->g);

  /* "gen.pyx":1506
 *         pari_catch_sig_on()
 *         cdef int ret = gequal(a.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1507
 *         cdef int ret = gequal(a.g, t0.g)
 *         pari_catch_sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 *     def gequal0(gen a):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1475
 *     ###########################################
 * 
 *     def gequal(gen a, b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` and `b` are equal using PARI's ``gequal``.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.gequal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1509
 *         return ret != 0
 * 
 *     def gequal0(gen a):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to zero.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_115gequal0(PyObject *__pyx_v_a, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_114gequal0[] = "\n        Check whether `a` is equal to zero.\n\n        EXAMPLES::\n\n            sage: pari(0).gequal0()\n            True\n            sage: pari(1).gequal0()\n            False\n            sage: pari(1e-100).gequal0()\n            False\n            sage: pari(\"0.0 + 0.0*I\").gequal0()\n            True\n            sage: pari(GF(3^20,'t')(0)).gequal0()\n            True\n        ";
static PyObject *__pyx_pw_3gen_3gen_115gequal0(PyObject *__pyx_v_a, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal0 (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_114gequal0(((struct __pyx_obj_3gen_gen *)__pyx_v_a));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_114gequal0(struct __pyx_obj_3gen_gen *__pyx_v_a) {
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal0", 0);

  /* "gen.pyx":1526
 *             True
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequal0(a.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1527
 *         """
 *         pari_catch_sig_on()
 *         cdef int ret = gequal0(a.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequal0(__pyx_v_a->g);

  /* "gen.pyx":1528
 *         pari_catch_sig_on()
 *         cdef int ret = gequal0(a.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1529
 *         cdef int ret = gequal0(a.g)
 *         pari_catch_sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 *     def gequal_long(gen a, long b):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1509
 *         return ret != 0
 * 
 *     def gequal0(gen a):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to zero.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.gequal0", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1531
 *         return ret != 0
 * 
 *     def gequal_long(gen a, long b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to the ``long int`` `b` using PARI's ``gequalsg``.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_117gequal_long(PyObject *__pyx_v_a, PyObject *__pyx_arg_b); /*proto*/
static char __pyx_doc_3gen_3gen_116gequal_long[] = "\n        Check whether `a` is equal to the ``long int`` `b` using PARI's ``gequalsg``.\n\n        EXAMPLES::\n\n            sage: a = pari(1); b = pari(2.0); c = pari('3*matid(3)')\n            sage: a.gequal_long(1)\n            True\n            sage: a.gequal_long(-1)\n            False\n            sage: a.gequal_long(0)\n            False\n            sage: b.gequal_long(2)\n            True\n            sage: b.gequal_long(-2)\n            False\n            sage: c.gequal_long(3)\n            True\n            sage: c.gequal_long(-3)\n            False\n        ";
static PyObject *__pyx_pw_3gen_3gen_117gequal_long(PyObject *__pyx_v_a, PyObject *__pyx_arg_b) {
  long __pyx_v_b;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal_long (wrapper)", 0);
  assert(__pyx_arg_b); {
    __pyx_v_b = __Pyx_PyInt_As_long(__pyx_arg_b); if (unlikely((__pyx_v_b == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1531; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.gequal_long", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_116gequal_long(((struct __pyx_obj_3gen_gen *)__pyx_v_a), ((long)__pyx_v_b));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_116gequal_long(struct __pyx_obj_3gen_gen *__pyx_v_a, long __pyx_v_b) {
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal_long", 0);

  /* "gen.pyx":1553
 *             False
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequalsg(b, a.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1554
 *         """
 *         pari_catch_sig_on()
 *         cdef int ret = gequalsg(b, a.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequalsg(__pyx_v_b, __pyx_v_a->g);

  /* "gen.pyx":1555
 *         pari_catch_sig_on()
 *         cdef int ret = gequalsg(b, a.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1556
 *         cdef int ret = gequalsg(b, a.g)
 *         pari_catch_sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1531
 *         return ret != 0
 * 
 *     def gequal_long(gen a, long b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to the ``long int`` `b` using PARI's ``gequalsg``.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.gequal_long", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1562
 *     # arith1.c
 *     ###########################################
 *     def isprime(gen self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         isprime(x, flag=0): Returns True if x is a PROVEN prime number, and
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_119isprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_118isprime[] = "\n        isprime(x, flag=0): Returns True if x is a PROVEN prime number, and\n        False otherwise.\n\n        INPUT:\n\n\n        -  ``flag`` - int 0 (default): use a combination of\n           algorithms. 1: certify primality using the Pocklington-Lehmer Test.\n           2: certify primality using the APRCL test.\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - True or False\n\n\n        EXAMPLES::\n\n            sage: pari(9).isprime()\n            False\n            sage: pari(17).isprime()\n            True\n            sage: n = pari(561)    # smallest Carmichael number\n            sage: n.isprime()      # not just a pseudo-primality test!\n            False\n            sage: n.isprime(1)\n            False\n            sage: n.isprime(2)\n            False\n            sage: n = pari(2^31-1)\n            sage: n.isprime(1)\n            (True, [2, 3, 1; 3, 5, 1; 7, 3, 1; 11, 3, 1; 31, 2, 1; 151, 3, 1; 331, 3, 1])\n        ";
static PyObject *__pyx_pw_3gen_3gen_119isprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_flag;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("isprime (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "isprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1562; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1562; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_flag = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("isprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1562; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.isprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_118isprime(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_118isprime(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
  GEN __pyx_v_x;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("isprime", 0);

  /* "gen.pyx":1599
 *         """
 *         cdef GEN x
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         x = gisprime(self.g, flag)
 *         if typ(x) != t_INT:
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1600
 *         cdef GEN x
 *         pari_catch_sig_on()
 *         x = gisprime(self.g, flag)             # <<<<<<<<<<<<<<
 *         if typ(x) != t_INT:
 *             # case flag=1 with prime input: x is the certificate
 */
  __pyx_v_x = gisprime(__pyx_v_self->g, __pyx_v_flag);

  /* "gen.pyx":1601
 *         pari_catch_sig_on()
 *         x = gisprime(self.g, flag)
 *         if typ(x) != t_INT:             # <<<<<<<<<<<<<<
 *             # case flag=1 with prime input: x is the certificate
 *             return True, P.new_gen(x)
 */
  __pyx_t_2 = ((typ(__pyx_v_x) != t_INT) != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":1603
 *         if typ(x) != t_INT:
 *             # case flag=1 with prime input: x is the certificate
 *             return True, P.new_gen(x)             # <<<<<<<<<<<<<<
 *         else:
 *             pari_catch_sig_off()
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_x)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(Py_True);
    PyTuple_SET_ITEM(__pyx_t_4, 0, Py_True);
    __Pyx_GIVEREF(Py_True);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
  /*else*/ {

    /* "gen.pyx":1605
 *             return True, P.new_gen(x)
 *         else:
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *             return signe(x) != 0
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":1606
 *         else:
 *             pari_catch_sig_off()
 *             return signe(x) != 0             # <<<<<<<<<<<<<<
 * 
 *     def qfbhclassno(gen n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyBool_FromLong((signe(__pyx_v_x) != 0)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":1562
 *     # arith1.c
 *     ###########################################
 *     def isprime(gen self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         isprime(x, flag=0): Returns True if x is a PROVEN prime number, and
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.isprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1608
 *             return signe(x) != 0
 * 
 *     def qfbhclassno(gen n):             # <<<<<<<<<<<<<<
 *         r"""
 *         Computes the Hurwitz-Kronecker class number of `n`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_121qfbhclassno(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_120qfbhclassno[] = "\n        Computes the Hurwitz-Kronecker class number of `n`.\n\n        INPUT:\n\n        - `n` (gen) -- a non-negative integer\n\n        .. note::\n\n           If `n` is large (more than `5*10^5`), the result is\n           conditional upon GRH.\n\n        EXAMPLES:\n\n        The Hurwitx class number is 0 is n is congruent to 1 or 2 modulo 4::\n            sage: pari(-10007).qfbhclassno()\n            0\n            sage: pari(-2).qfbhclassno()\n            0\n\n        It is -1/12 for n=0::\n\n            sage: pari(0).qfbhclassno()\n            -1/12\n\n        Otherwise it is the number of classes of positive definite\n        binary quadratic forms with discriminant `-n`, weighted by\n        `1/m` where `m` is the number of automorphisms of the form::\n\n            sage: pari(4).qfbhclassno()\n            1/2\n            sage: pari(3).qfbhclassno()\n            1/3\n            sage: pari(23).qfbhclassno()\n            3\n\n        ";
static PyObject *__pyx_pw_3gen_3gen_121qfbhclassno(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("qfbhclassno (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_120qfbhclassno(((struct __pyx_obj_3gen_gen *)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_120qfbhclassno(struct __pyx_obj_3gen_gen *__pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("qfbhclassno", 0);

  /* "gen.pyx":1646
 * 
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hclassno(n.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1647
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(hclassno(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def ispseudoprime(gen self, long flag=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hclassno(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1608
 *             return signe(x) != 0
 * 
 *     def qfbhclassno(gen n):             # <<<<<<<<<<<<<<
 *         r"""
 *         Computes the Hurwitz-Kronecker class number of `n`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.qfbhclassno", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1649
 *         return P.new_gen(hclassno(n.g))
 * 
 *     def ispseudoprime(gen self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         ispseudoprime(x, flag=0): Returns True if x is a pseudo-prime
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_123ispseudoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_122ispseudoprime[] = "\n        ispseudoprime(x, flag=0): Returns True if x is a pseudo-prime\n        number, and False otherwise.\n\n        INPUT:\n\n\n        -  ``flag`` - int 0 (default): checks whether x is a\n           Baillie-Pomerance-Selfridge-Wagstaff pseudo prime (strong\n           Rabin-Miller pseudo prime for base 2, followed by strong Lucas test\n           for the sequence (P,-1), P smallest positive integer such that\n           `P^2 - 4` is not a square mod x). 0: checks whether x is a\n           strong Miller-Rabin pseudo prime for flag randomly chosen bases\n           (with end-matching to catch square roots of -1).\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - True or False, or when flag=1, either False or a tuple\n           (True, cert) where ``cert`` is a primality certificate.\n\n\n        EXAMPLES::\n\n            sage: pari(9).ispseudoprime()\n            False\n            sage: pari(17).ispseudoprime()\n            True\n            sage: n = pari(561)     # smallest Carmichael number\n            sage: n.ispseudoprime(2)\n            False\n        ";
static PyObject *__pyx_pw_3gen_3gen_123ispseudoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_flag;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ispseudoprime (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ispseudoprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1649; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1649; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_flag = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("ispseudoprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1649; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.ispseudoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_122ispseudoprime(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_122ispseudoprime(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
  long __pyx_v_t;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("ispseudoprime", 0);

  /* "gen.pyx":1683
 *             False
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long t = ispseudoprime(self.g, flag)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1684
 *         """
 *         pari_catch_sig_on()
 *         cdef long t = ispseudoprime(self.g, flag)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return t != 0
 */
  __pyx_v_t = ispseudoprime(__pyx_v_self->g, __pyx_v_flag);

  /* "gen.pyx":1685
 *         pari_catch_sig_on()
 *         cdef long t = ispseudoprime(self.g, flag)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return t != 0
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1686
 *         cdef long t = ispseudoprime(self.g, flag)
 *         pari_catch_sig_off()
 *         return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def ispower(gen self, k=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1649
 *         return P.new_gen(hclassno(n.g))
 * 
 *     def ispseudoprime(gen self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         ispseudoprime(x, flag=0): Returns True if x is a pseudo-prime
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.ispseudoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1688
 *         return t != 0
 * 
 *     def ispower(gen self, k=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         Determine whether or not self is a perfect k-th power. If k is not
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_125ispower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_124ispower[] = "\n        Determine whether or not self is a perfect k-th power. If k is not\n        specified, find the largest k so that self is a k-th power.\n\n        INPUT:\n\n\n        -  ``k`` - int (optional)\n\n\n        OUTPUT:\n\n\n        -  ``power`` - int, what power it is\n\n        -  ``g`` - what it is a power of\n\n\n        EXAMPLES::\n\n            sage: pari(9).ispower()\n            (2, 3)\n            sage: pari(17).ispower()\n            (1, 17)\n            sage: pari(17).ispower(2)\n            (False, None)\n            sage: pari(17).ispower(1)\n            (1, 17)\n            sage: pari(2).ispower()\n            (1, 2)\n        ";
static PyObject *__pyx_pw_3gen_3gen_125ispower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ispower (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ispower") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1688; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_k = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("ispower", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1688; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.ispower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_124ispower(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_k);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_124ispower(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_k) {
  int __pyx_v_n;
  GEN __pyx_v_x;
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("ispower", 0);

  /* "gen.pyx":1724
 *         cdef gen t0
 * 
 *         if k is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             n = gisanypower(self.g, &x)
 */
  __pyx_t_1 = (__pyx_v_k == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "gen.pyx":1725
 * 
 *         if k is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             n = gisanypower(self.g, &x)
 *             if n == 0:
 */
    __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":1726
 *         if k is None:
 *             pari_catch_sig_on()
 *             n = gisanypower(self.g, &x)             # <<<<<<<<<<<<<<
 *             if n == 0:
 *                 pari_catch_sig_off()
 */
    __pyx_v_n = gisanypower(__pyx_v_self->g, (&__pyx_v_x));

    /* "gen.pyx":1727
 *             pari_catch_sig_on()
 *             n = gisanypower(self.g, &x)
 *             if n == 0:             # <<<<<<<<<<<<<<
 *                 pari_catch_sig_off()
 *                 return 1, self
 */
    __pyx_t_2 = ((__pyx_v_n == 0) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":1728
 *             n = gisanypower(self.g, &x)
 *             if n == 0:
 *                 pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *                 return 1, self
 *             else:
 */
      pari_catch_sig_off();

      /* "gen.pyx":1729
 *             if n == 0:
 *                 pari_catch_sig_off()
 *                 return 1, self             # <<<<<<<<<<<<<<
 *             else:
 *                 return n, P.new_gen(x)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      __Pyx_INCREF(((PyObject *)__pyx_v_self));
      PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_self));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":1731
 *                 return 1, self
 *             else:
 *                 return n, P.new_gen(x)             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(k)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_x)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_5);
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L0;
    }
  }
  /*else*/ {

    /* "gen.pyx":1733
 *                 return n, P.new_gen(x)
 *         else:
 *             t0 = objtogen(k)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             n = ispower(self.g, t0.g, &x)
 */
    __pyx_t_6 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_k)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_6);
    __pyx_t_6 = 0;

    /* "gen.pyx":1734
 *         else:
 *             t0 = objtogen(k)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             n = ispower(self.g, t0.g, &x)
 *             if n == 0:
 */
    __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":1735
 *             t0 = objtogen(k)
 *             pari_catch_sig_on()
 *             n = ispower(self.g, t0.g, &x)             # <<<<<<<<<<<<<<
 *             if n == 0:
 *                 pari_catch_sig_off()
 */
    __pyx_v_n = ispower(__pyx_v_self->g, __pyx_v_t0->g, (&__pyx_v_x));

    /* "gen.pyx":1736
 *             pari_catch_sig_on()
 *             n = ispower(self.g, t0.g, &x)
 *             if n == 0:             # <<<<<<<<<<<<<<
 *                 pari_catch_sig_off()
 *                 return False, None
 */
    __pyx_t_2 = ((__pyx_v_n == 0) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":1737
 *             n = ispower(self.g, t0.g, &x)
 *             if n == 0:
 *                 pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *                 return False, None
 *             else:
 */
      pari_catch_sig_off();

      /* "gen.pyx":1738
 *             if n == 0:
 *                 pari_catch_sig_off()
 *                 return False, None             # <<<<<<<<<<<<<<
 *             else:
 *                 return k, P.new_gen(x)
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_tuple__18);
      __pyx_r = __pyx_tuple__18;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":1740
 *                 return False, None
 *             else:
 *                 return k, P.new_gen(x)             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_6 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_x)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_k);
      __Pyx_GIVEREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_6);
      __Pyx_GIVEREF(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
    }
  }

  /* "gen.pyx":1688
 *         return t != 0
 * 
 *     def ispower(gen self, k=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         Determine whether or not self is a perfect k-th power. If k is not
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("gen.gen.ispower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1745
 *     # 1: Standard monadic or dyadic OPERATORS
 *     ###########################################
 *     def divrem(gen x, y, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         divrem(x, y, v): Euclidean division of x by y giving as a
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_127divrem(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_126divrem[] = "\n        divrem(x, y, v): Euclidean division of x by y giving as a\n        2-dimensional column vector the quotient and the remainder, with\n        respect to v (to main variable if v is omitted).\n        ";
static PyObject *__pyx_pw_3gen_3gen_127divrem(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_var = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("divrem (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_var,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "divrem") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y = values[0];
    __pyx_v_var = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("divrem", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.divrem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_126divrem(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_var);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_126divrem(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_var) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("divrem", 0);

  /* "gen.pyx":1751
 *         respect to v (to main variable if v is omitted).
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(divrem(x.g, t0.g, P.get_var(var)))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1752
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(divrem(x.g, t0.g, P.get_var(var)))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1753
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(divrem(x.g, t0.g, P.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def lex(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, divrem(__pyx_v_x->g, __pyx_v_t0->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1745
 *     # 1: Standard monadic or dyadic OPERATORS
 *     ###########################################
 *     def divrem(gen x, y, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         divrem(x, y, v): Euclidean division of x by y giving as a
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.divrem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1755
 *         return P.new_gen(divrem(x.g, t0.g, P.get_var(var)))
 * 
 *     def lex(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         lex(x,y): Compare x and y lexicographically (1 if xy, 0 if x==y, -1
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_129lex(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_3gen_3gen_128lex[] = "\n        lex(x,y): Compare x and y lexicographically (1 if xy, 0 if x==y, -1\n        if xy)\n        ";
static PyObject *__pyx_pw_3gen_3gen_129lex(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lex (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_128lex(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_128lex(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  int __pyx_v_r;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("lex", 0);

  /* "gen.pyx":1760
 *         if xy)
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         r = lexcmp(x.g, t0.g)
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1761
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         r = lexcmp(x.g, t0.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1762
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         r = lexcmp(x.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return r
 */
  __pyx_v_r = lexcmp(__pyx_v_x->g, __pyx_v_t0->g);

  /* "gen.pyx":1763
 *         pari_catch_sig_on()
 *         r = lexcmp(x.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1764
 *         r = lexcmp(x.g, t0.g)
 *         pari_catch_sig_off()
 *         return r             # <<<<<<<<<<<<<<
 * 
 *     def max(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_r); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1755
 *         return P.new_gen(divrem(x.g, t0.g, P.get_var(var)))
 * 
 *     def lex(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         lex(x,y): Compare x and y lexicographically (1 if xy, 0 if x==y, -1
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.lex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1766
 *         return r
 * 
 *     def max(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         max(x,y): Return the maximum of x and y.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_131max(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_3gen_3gen_130max[] = "\n        max(x,y): Return the maximum of x and y.\n        ";
static PyObject *__pyx_pw_3gen_3gen_131max(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("max (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_130max(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_130max(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("max", 0);

  /* "gen.pyx":1770
 *         max(x,y): Return the maximum of x and y.
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmax(x.g, t0.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1771
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmax(x.g, t0.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1772
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gmax(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def min(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmax(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1766
 *         return r
 * 
 *     def max(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         max(x,y): Return the maximum of x and y.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.max", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1774
 *         return P.new_gen(gmax(x.g, t0.g))
 * 
 *     def min(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         min(x,y): Return the minimum of x and y.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_133min(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_3gen_3gen_132min[] = "\n        min(x,y): Return the minimum of x and y.\n        ";
static PyObject *__pyx_pw_3gen_3gen_133min(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("min (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_132min(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_132min(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("min", 0);

  /* "gen.pyx":1778
 *         min(x,y): Return the minimum of x and y.
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmin(x.g, t0.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":1779
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmin(x.g, t0.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1780
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gmin(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def shift(gen x, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmin(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1774
 *         return P.new_gen(gmax(x.g, t0.g))
 * 
 *     def min(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         min(x,y): Return the minimum of x and y.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.min", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1782
 *         return P.new_gen(gmin(x.g, t0.g))
 * 
 *     def shift(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shift(x,n): shift x left n bits if n=0, right -n bits if n0.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_135shift(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_3gen_3gen_134shift[] = "\n        shift(x,n): shift x left n bits if n=0, right -n bits if n0.\n        ";
static PyObject *__pyx_pw_3gen_3gen_135shift(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("shift (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1782; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_134shift(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((long)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_134shift(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("shift", 0);

  /* "gen.pyx":1786
 *         shift(x,n): shift x left n bits if n=0, right -n bits if n0.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(x.g, n))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1787
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gshift(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def shiftmul(gen x, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gshift(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1782
 *         return P.new_gen(gmin(x.g, t0.g))
 * 
 *     def shift(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shift(x,n): shift x left n bits if n=0, right -n bits if n0.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1789
 *         return P.new_gen(gshift(x.g, n))
 * 
 *     def shiftmul(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shiftmul(x,n): Return the product of x by `2^n`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_137shiftmul(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_3gen_3gen_136shiftmul[] = "\n        shiftmul(x,n): Return the product of x by `2^n`.\n        ";
static PyObject *__pyx_pw_3gen_3gen_137shiftmul(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("shiftmul (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.shiftmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_136shiftmul(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((long)__pyx_v_n));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_136shiftmul(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("shiftmul", 0);

  /* "gen.pyx":1793
 *         shiftmul(x,n): Return the product of x by `2^n`.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmul2n(x.g, n))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1794
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gmul2n(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     # def moebius(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmul2n(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1789
 *         return P.new_gen(gshift(x.g, n))
 * 
 *     def shiftmul(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shiftmul(x,n): Return the product of x by `2^n`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.shiftmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1803
 *     #     return P.new_gen(gmoebius(x.g))
 * 
 *     def sign(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sign of x, where x is of type integer, real or
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_139sign(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_138sign[] = "\n        Return the sign of x, where x is of type integer, real or\n        fraction.\n\n        EXAMPLES::\n\n            sage: pari(pi).sign()\n            1\n            sage: pari(0).sign()\n            0\n            sage: pari(-1/2).sign()\n            -1\n\n        PARI throws an error if you attempt to take the sign of a\n        complex number::\n\n            sage: pari(I).sign()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in gsigne\n\n        ";
static PyObject *__pyx_pw_3gen_3gen_139sign(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("sign (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_138sign(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_138sign(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  int __pyx_v_r;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("sign", 0);

  /* "gen.pyx":1826
 * 
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         r = gsigne(x.g)
 *         pari_catch_sig_off()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1827
 *         """
 *         pari_catch_sig_on()
 *         r = gsigne(x.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return r
 */
  __pyx_v_r = gsigne(__pyx_v_x->g);

  /* "gen.pyx":1828
 *         pari_catch_sig_on()
 *         r = gsigne(x.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
  pari_catch_sig_off();

  /* "gen.pyx":1829
 *         r = gsigne(x.g)
 *         pari_catch_sig_off()
 *         return r             # <<<<<<<<<<<<<<
 * 
 *     def vecmax(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_r); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1803
 *     #     return P.new_gen(gmoebius(x.g))
 * 
 *     def sign(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sign of x, where x is of type integer, real or
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.sign", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1831
 *         return r
 * 
 *     def vecmax(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmax(x): Return the maximum of the elements of the vector/matrix
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_141vecmax(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_140vecmax[] = "\n        vecmax(x): Return the maximum of the elements of the vector/matrix\n        x.\n        ";
static PyObject *__pyx_pw_3gen_3gen_141vecmax(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vecmax (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_140vecmax(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_140vecmax(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("vecmax", 0);

  /* "gen.pyx":1836
 *         x.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(vecmax(x.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1837
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(vecmax(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, vecmax(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1831
 *         return r
 * 
 *     def vecmax(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmax(x): Return the maximum of the elements of the vector/matrix
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.vecmax", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1840
 * 
 * 
 *     def vecmin(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmin(x): Return the maximum of the elements of the vector/matrix
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_143vecmin(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_142vecmin[] = "\n        vecmin(x): Return the maximum of the elements of the vector/matrix\n        x.\n        ";
static PyObject *__pyx_pw_3gen_3gen_143vecmin(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vecmin (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_142vecmin(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_142vecmin(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("vecmin", 0);

  /* "gen.pyx":1845
 *         x.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(vecmin(x.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1846
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(vecmin(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, vecmin(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1840
 * 
 * 
 *     def vecmin(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmin(x): Return the maximum of the elements of the vector/matrix
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.vecmin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1854
 *     ###########################################
 * 
 *     def Col(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_145Col(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_144Col[] = "\n        Transform the object `x` into a column vector with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the column vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI column vector (type ``t_COL``)\n\n        EXAMPLES::\n\n            sage: pari(1.5).Col()\n            [1.50000000000000]~\n            sage: pari([1,2,3,4]).Col()\n            [1, 2, 3, 4]~\n            sage: pari('[1,2; 3,4]').Col()\n            [[1, 2], [3, 4]]~\n            sage: pari('\"Sage\"').Col()\n            [\"S\", \"a\", \"g\", \"e\"]~\n            sage: pari('x + 3*x^3').Col()\n            [3, 0, 1, 0]~\n            sage: pari('x + 3*x^3 + O(x^5)').Col()\n            [1, 0, 3, 0]~\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Col(2)\n            [1, 2, 3, 4]~\n            sage: pari([1,2,3,4]).Col(-2)\n            [1, 2, 3, 4]~\n            sage: pari([1,2,3,4]).Col(6)\n            [1, 2, 3, 4, 0, 0]~\n            sage: pari([1,2,3,4]).Col(-6)\n            [0, 0, 1, 2, 3, 4]~\n\n        See also :meth:`Vec` (create a row vector) for more examples\n        and :meth:`Colrev` (create a column in reversed order).\n        ";
static PyObject *__pyx_pw_3gen_3gen_145Col(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Col (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Col") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1854; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1854; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_n = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Col", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1854; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Col", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_144Col(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_144Col(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Col", 0);

  /* "gen.pyx":1898
 *         and :meth:`Colrev` (create a column in reversed order).
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1899
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))             # <<<<<<<<<<<<<<
 * 
 *     def Colrev(gen x, long n = 0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_f_3gen__Vec_append(gtocol(__pyx_v_x->g), gen_0, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1854
 *     ###########################################
 * 
 *     def Col(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Col", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1901
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))
 * 
 *     def Colrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_147Colrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_146Colrev[] = "\n        Transform the object `x` into a column vector with minimal size `|n|`.\n        The order of the resulting vector is reversed compared to :meth:`Col`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          prepend zeros; if `n < 0`, append zeros.\n\n        OUTPUT:\n\n        A PARI column vector (type ``t_COL``)\n\n        EXAMPLES::\n\n            sage: pari(1.5).Colrev()\n            [1.50000000000000]~\n            sage: pari([1,2,3,4]).Colrev()\n            [4, 3, 2, 1]~\n            sage: pari('[1,2; 3,4]').Colrev()\n            [[3, 4], [1, 2]]~\n            sage: pari('x + 3*x^3').Colrev()\n            [0, 1, 0, 3]~\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Colrev(2)\n            [4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(-2)\n            [4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(6)\n            [0, 0, 4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(-6)\n            [4, 3, 2, 1, 0, 0]~\n        ";
static PyObject *__pyx_pw_3gen_3gen_147Colrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Colrev (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Colrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1901; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1901; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_n = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Colrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1901; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Colrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_146Colrev(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_146Colrev(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
  GEN __pyx_v_v;
  GEN __pyx_v_L;
  GEN __pyx_v_R;
  long __pyx_v_t;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Colrev", 0);

  /* "gen.pyx":1939
 *             [4, 3, 2, 1, 0, 0]~
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # Create a non-reversed column vector
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1941
 *         pari_catch_sig_on()
 *         # Create a non-reversed column vector
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)             # <<<<<<<<<<<<<<
 *         # Reverse it in-place
 *         cdef GEN L = v + 1
 */
  __pyx_v_v = __pyx_f_3gen__Vec_append(gtocol(__pyx_v_x->g), gen_0, __pyx_v_n);

  /* "gen.pyx":1943
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)
 *         # Reverse it in-place
 *         cdef GEN L = v + 1             # <<<<<<<<<<<<<<
 *         cdef GEN R = v + (lg(v)-1)
 *         cdef long t
 */
  __pyx_v_L = (__pyx_v_v + 1);

  /* "gen.pyx":1944
 *         # Reverse it in-place
 *         cdef GEN L = v + 1
 *         cdef GEN R = v + (lg(v)-1)             # <<<<<<<<<<<<<<
 *         cdef long t
 *         while (L < R):
 */
  __pyx_v_R = (__pyx_v_v + (lg(__pyx_v_v) - 1));

  /* "gen.pyx":1946
 *         cdef GEN R = v + (lg(v)-1)
 *         cdef long t
 *         while (L < R):             # <<<<<<<<<<<<<<
 *             t = L[0]
 *             L[0] = R[0]
 */
  while (1) {
    __pyx_t_2 = ((__pyx_v_L < __pyx_v_R) != 0);
    if (!__pyx_t_2) break;

    /* "gen.pyx":1947
 *         cdef long t
 *         while (L < R):
 *             t = L[0]             # <<<<<<<<<<<<<<
 *             L[0] = R[0]
 *             R[0] = t
 */
    __pyx_v_t = (__pyx_v_L[0]);

    /* "gen.pyx":1948
 *         while (L < R):
 *             t = L[0]
 *             L[0] = R[0]             # <<<<<<<<<<<<<<
 *             R[0] = t
 *             L += 1
 */
    (__pyx_v_L[0]) = (__pyx_v_R[0]);

    /* "gen.pyx":1949
 *             t = L[0]
 *             L[0] = R[0]
 *             R[0] = t             # <<<<<<<<<<<<<<
 *             L += 1
 *             R -= 1
 */
    (__pyx_v_R[0]) = __pyx_v_t;

    /* "gen.pyx":1950
 *             L[0] = R[0]
 *             R[0] = t
 *             L += 1             # <<<<<<<<<<<<<<
 *             R -= 1
 *         return P.new_gen(v)
 */
    __pyx_v_L = (__pyx_v_L + 1);

    /* "gen.pyx":1951
 *             R[0] = t
 *             L += 1
 *             R -= 1             # <<<<<<<<<<<<<<
 *         return P.new_gen(v)
 * 
 */
    __pyx_v_R = (__pyx_v_R - 1);
  }

  /* "gen.pyx":1952
 *             L += 1
 *             R -= 1
 *         return P.new_gen(v)             # <<<<<<<<<<<<<<
 * 
 *     def List(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_v)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1901
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))
 * 
 *     def Colrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("gen.gen.Colrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1954
 *         return P.new_gen(v)
 * 
 *     def List(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         List(x): transforms the PARI vector or list x into a list.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_149List(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_148List[] = "\n        List(x): transforms the PARI vector or list x into a list.\n\n        EXAMPLES::\n\n            sage: v = pari([1,2,3])\n            sage: v\n            [1, 2, 3]\n            sage: v.type()\n            't_VEC'\n            sage: w = v.List()\n            sage: w\n            List([1, 2, 3])\n            sage: w.type()\n            't_LIST'\n        ";
static PyObject *__pyx_pw_3gen_3gen_149List(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("List (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_148List(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_148List(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("List", 0);

  /* "gen.pyx":1971
 *             't_LIST'
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtolist(x.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":1972
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtolist(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Mat(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtolist(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1954
 *         return P.new_gen(v)
 * 
 *     def List(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         List(x): transforms the PARI vector or list x into a list.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.List", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":1974
 *         return P.new_gen(gtolist(x.g))
 * 
 *     def Mat(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Mat(x): Returns the matrix defined by x.
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_151Mat(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_150Mat[] = "\n        Mat(x): Returns the matrix defined by x.\n\n        - If x is already a matrix, a copy of x is created and returned.\n\n        - If x is not a vector or a matrix, this function returns a 1x1\n          matrix.\n\n        - If x is a row (resp. column) vector, this functions returns\n          a 1-row (resp. 1-column) matrix, *unless* all elements are\n          column (resp. row) vectors of the same length, in which case\n          the vectors are concatenated sideways and the associated big\n          matrix is returned.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI matrix\n\n\n        EXAMPLES::\n\n            sage: x = pari(5)\n            sage: x.type()\n            't_INT'\n            sage: y = x.Mat()\n            sage: y\n            Mat(5)\n            sage: y.type()\n            't_MAT'\n            sage: x = pari('[1,2;3,4]')\n            sage: x.type()\n            't_MAT'\n            sage: x = pari('[1,2,3,4]')\n            sage: x.type()\n            't_VEC'\n            sage: y = x.Mat()\n            sage: y\n            Mat([1, 2, 3, 4])\n            sage: y.type()\n            't_MAT'\n\n        ::\n\n            sage: v = pari('[1,2;3,4]').Vec(); v\n            [[1, 3]~, [2, 4]~]\n            sage: v.Mat()\n            [1, 2; 3, 4]\n            sage: v = pari('[1,2;3,4]').Col(); v\n            [[1, 2], [3, 4]]~\n            sage: v.Mat()\n            [1, 2; 3, 4]\n        ";
static PyObject *__pyx_pw_3gen_3gen_151Mat(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Mat (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_150Mat(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_150Mat(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Mat", 0);

  /* "gen.pyx":2034
 *             [1, 2; 3, 4]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtomat(x.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2035
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtomat(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Mod(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtomat(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2035; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":1974
 *         return P.new_gen(gtolist(x.g))
 * 
 *     def Mat(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Mat(x): Returns the matrix defined by x.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Mat", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2037
 *         return P.new_gen(gtomat(x.g))
 * 
 *     def Mod(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Mod(x, y): Returns the object x modulo y, denoted Mod(x, y).
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_153Mod(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_3gen_3gen_152Mod[] = "\n        Mod(x, y): Returns the object x modulo y, denoted Mod(x, y).\n\n        The input y must be a an integer or a polynomial:\n\n        - If y is an INTEGER, x must also be an integer, a rational\n          number, or a p-adic number compatible with the modulus y.\n\n        - If y is a POLYNOMIAL, x must be a scalar (which is not a\n          polmod), a polynomial, a rational function, or a power\n          series.\n\n        .. warning::\n\n           This function is not the same as ``x % y`` which is an\n           integer or a polynomial.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``y`` - integer or polynomial\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - intmod or polmod\n\n\n        EXAMPLES::\n\n            sage: z = pari(3)\n            sage: x = z.Mod(pari(7))\n            sage: x\n            Mod(3, 7)\n            sage: x^2\n            Mod(2, 7)\n            sage: x^100\n            Mod(4, 7)\n            sage: x.type()\n            't_INTMOD'\n\n        ::\n\n            sage: f = pari(\"x^2 + x + 1\")\n            sage: g = pari(\"x\")\n            sage: a = g.Mod(f)\n            sage: a\n            Mod(x, x^2 + x + 1)\n            sage: a*a\n            Mod(-x - 1, x^2 + x + 1)\n            sage: a.type()\n            't_POLMOD'\n        ";
static PyObject *__pyx_pw_3gen_3gen_153Mod(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Mod (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_152Mod(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_152Mod(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Mod", 0);

  /* "gen.pyx":2094
 *             't_POLMOD'
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gmodulo(x.g, t0.g))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":2095
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmodulo(x.g, t0.g))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2096
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gmodulo(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def Pol(self, v=-1):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gmodulo(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":2037
 *         return P.new_gen(gtomat(x.g))
 * 
 *     def Mod(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Mod(x, y): Returns the object x modulo y, denoted Mod(x, y).
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.Mod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2098
 *         return P.new_gen(gmodulo(x.g, t0.g))
 * 
 *     def Pol(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Pol(x, v): convert x into a polynomial with main variable v and
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_155Pol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_154Pol[] = "\n        Pol(x, v): convert x into a polynomial with main variable v and\n        return the result.\n\n        - If x is a scalar, returns a constant polynomial.\n\n        - If x is a power series, the effect is identical to\n          ``truncate``, i.e. it chops off the `O(X^k)`.\n\n        - If x is a vector, this function creates the polynomial whose\n          coefficients are given in x, with x[0] being the leading\n          coefficient (which can be zero).\n\n        .. warning::\n\n           This is *not* a substitution function. It will not\n           transform an object containing variables of higher priority\n           than v::\n\n               sage: pari('x+y').Pol('y')\n               Traceback (most recent call last):\n               ...\n               PariError: variable must have higher priority in gtopoly\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - (optional) which variable, defaults to 'x'\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a polynomial\n\n\n        EXAMPLES::\n\n            sage: v = pari(\"[1,2,3,4]\")\n            sage: f = v.Pol()\n            sage: f\n            x^3 + 2*x^2 + 3*x + 4\n            sage: f*f\n            x^6 + 4*x^5 + 10*x^4 + 20*x^3 + 25*x^2 + 24*x + 16\n\n        ::\n\n            sage: v = pari(\"[1,2;3,4]\")\n            sage: v.Pol()\n            [1, 3]~*x + [2, 4]~\n        ";
static PyObject *__pyx_pw_3gen_3gen_155Pol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Pol (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Pol") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Pol", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_154Pol(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_v);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_154Pol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Pol", 0);

  /* "gen.pyx":2152
 *             [1, 3]~*x + [2, 4]~
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2153
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def Polrev(self, v=-1):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtopoly(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":2098
 *         return P.new_gen(gmodulo(x.g, t0.g))
 * 
 *     def Pol(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Pol(x, v): convert x into a polynomial with main variable v and
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2155
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))
 * 
 *     def Polrev(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Polrev(x, v): Convert x into a polynomial with main variable v and
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_157Polrev(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_156Polrev[] = "\n        Polrev(x, v): Convert x into a polynomial with main variable v and\n        return the result. This is the reverse of Pol if x is a vector,\n        otherwise it is identical to Pol. By \"reverse\" we mean that the\n        coefficients are reversed.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT:\n\n        -  ``gen`` - a polynomial\n\n        EXAMPLES::\n\n            sage: v = pari(\"[1,2,3,4]\")\n            sage: f = v.Polrev()\n            sage: f\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: v.Pol()\n            x^3 + 2*x^2 + 3*x + 4\n            sage: v.Polrev('y')\n            4*y^3 + 3*y^2 + 2*y + 1\n\n        Note that Polrev does *not* reverse the coefficients of a\n        polynomial! ::\n\n            sage: f\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: f.Polrev()\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: v = pari(\"[1,2;3,4]\")\n            sage: v.Polrev()\n            [2, 4]~*x + [1, 3]~\n        ";
static PyObject *__pyx_pw_3gen_3gen_157Polrev(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Polrev (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Polrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Polrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Polrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_156Polrev(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_v);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_156Polrev(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Polrev", 0);

  /* "gen.pyx":2192
 *             [2, 4]~*x + [1, 3]~
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2193
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def Qfb(gen a, b, c, D=0, unsigned long precision=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtopolyrev(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":2155
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))
 * 
 *     def Polrev(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Polrev(x, v): Convert x into a polynomial with main variable v and
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Polrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2195
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))
 * 
 *     def Qfb(gen a, b, c, D=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Qfb(a,b,c,D=0.): Returns the binary quadratic form
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_159Qfb(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_158Qfb[] = "\n        Qfb(a,b,c,D=0.): Returns the binary quadratic form\n\n        .. math::\n\n                                ax^2 + bxy + cy^2.\n\n\n        The optional D is 0 by default and initializes Shank's distance if\n        `b^2 - 4ac > 0`.  The discriminant of the quadratic form must not\n        be a perfect square.\n\n        .. note::\n\n           Negative definite forms are not implemented, so use their\n           positive definite counterparts instead. (I.e., if f is a\n           negative definite quadratic form, then -f is positive\n           definite.)\n\n        INPUT:\n\n\n        -  ``a`` - gen\n\n        -  ``b`` - gen\n\n        -  ``c`` - gen\n\n        -  ``D`` - gen (optional, defaults to 0)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - binary quadratic form\n\n\n        EXAMPLES::\n\n            sage: pari(3).Qfb(7, 1)\n            Qfb(3, 7, 1, 0.E-19)\n            sage: pari(3).Qfb(7, 2)  # discriminant is 25\n            Traceback (most recent call last):\n            ...\n            PariError: square discriminant in Qfb\n        ";
static PyObject *__pyx_pw_3gen_3gen_159Qfb(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_b = 0;
  PyObject *__pyx_v_c = 0;
  PyObject *__pyx_v_D = 0;
  unsigned long __pyx_v_precision;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Qfb (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_b,&__pyx_n_s_c,&__pyx_n_s_D,&__pyx_n_s_precision,0};
    PyObject* values[4] = {0,0,0,0};
    values[2] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_c)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("Qfb", 0, 2, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2195; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_D);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Qfb") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2195; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_b = values[0];
    __pyx_v_c = values[1];
    __pyx_v_D = values[2];
    if (values[3]) {
      __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[3]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2195; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_precision = ((unsigned long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Qfb", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2195; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Qfb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_158Qfb(((struct __pyx_obj_3gen_gen *)__pyx_v_a), __pyx_v_b, __pyx_v_c, __pyx_v_D, __pyx_v_precision);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_158Qfb(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_D, unsigned long __pyx_v_precision) {
  struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
  struct __pyx_obj_3gen_gen *__pyx_v_t2 = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Qfb", 0);

  /* "gen.pyx":2242
 *             PariError: square discriminant in Qfb
 *         """
 *         cdef gen t0 = objtogen(b)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(c)
 *         cdef gen t2 = objtogen(D)
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2242; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":2243
 *         """
 *         cdef gen t0 = objtogen(b)
 *         cdef gen t1 = objtogen(c)             # <<<<<<<<<<<<<<
 *         cdef gen t2 = objtogen(D)
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_c)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":2244
 *         cdef gen t0 = objtogen(b)
 *         cdef gen t1 = objtogen(c)
 *         cdef gen t2 = objtogen(D)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(Qfb0(a.g, t0.g, t1.g, t2.g, prec_bits_to_words(precision)))
 */
  __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_D)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_t2 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "gen.pyx":2245
 *         cdef gen t1 = objtogen(c)
 *         cdef gen t2 = objtogen(D)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Qfb0(a.g, t0.g, t1.g, t2.g, prec_bits_to_words(precision)))
 * 
 */
  __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2246
 *         cdef gen t2 = objtogen(D)
 *         pari_catch_sig_on()
 *         return P.new_gen(Qfb0(a.g, t0.g, t1.g, t2.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def Ser(gen f, v=-1, long precision=-1):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, Qfb0(__pyx_v_a->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_v_t2->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "gen.pyx":2195
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))
 * 
 *     def Qfb(gen a, b, c, D=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Qfb(a,b,c,D=0.): Returns the binary quadratic form
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("gen.gen.Qfb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_t0);
  __Pyx_XDECREF((PyObject *)__pyx_v_t1);
  __Pyx_XDECREF((PyObject *)__pyx_v_t2);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2248
 *         return P.new_gen(Qfb0(a.g, t0.g, t1.g, t2.g, prec_bits_to_words(precision)))
 * 
 *     def Ser(gen f, v=-1, long precision=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Return a power series or Laurent series in the variable `v`
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_161Ser(PyObject *__pyx_v_f, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3gen_3gen_160Ser[] = "\n        Return a power series or Laurent series in the variable `v`\n        constructed from the object `f`.\n\n        INPUT:\n\n        - ``f`` -- PARI gen\n\n        - ``v`` -- PARI variable (default: `x`)\n\n        - ``precision`` -- the desired relative precision (default:\n          the value returned by ``pari.get_series_precision()``).\n          This is the absolute precision minus the `v`-adic valuation.\n\n        OUTPUT:\n\n        - PARI object of type ``t_SER``\n\n        The series is constructed from `f` in the following way:\n\n        - If `f` is a scalar, a constant power series is returned.\n\n        - If `f` is a polynomial, it is converted into a power series\n          in the obvious way.\n\n        - If `f` is a rational function, it will be expanded in a\n          Laurent series around `v = 0`.\n\n        - If `f` is a vector, its coefficients become the coefficients\n          of the power series, starting from the constant term.  This\n          is the convention used by the function ``Polrev()``, and the\n          reverse of that used by ``Pol()``.\n\n        .. warning::\n\n           This function will not transform objects containing\n           variables of higher priority than `v`.\n\n        EXAMPLES::\n\n            sage: pari(2).Ser()\n            2 + O(x^16)\n            sage: pari(Mod(0, 7)).Ser()\n            O(x^16)\n\n            sage: x = pari([1, 2, 3, 4, 5])\n            sage: x.Ser()\n            1 + 2*x + 3*x^2 + 4*x^3 + 5*x^4 + O(x^16)\n            sage: f = x.Ser('v'); print f\n            1 + 2*v + 3*v^2 + 4*v^3 + 5*v^4 + O(v^16)\n            sage: pari(1)/f\n            1 - 2*v + v^2 + 6*v^5 - 17*v^6 + 16*v^7 - 5*v^8 + 36*v^10 - 132*v^11 + 181*v^12 - 110*v^13 + 25*v^14 + 216*v^15 + O(v^16)\n\n            sage: pari('x^5').Ser(precision=20)\n            x^5 + O(x^25)\n            sage: pari('1/x').Ser(precision=1)\n            x^-1 + O(x^0)\n\n        ";
static PyObject *__pyx_pw_3gen_3gen_161Ser(PyObject *__pyx_v_f, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  long __pyx_v_precision;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Ser (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,&__pyx_n_s_precision,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Ser") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
    if (values[1]) {
      __pyx_v_precision = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_precision = ((long)-1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Ser", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2248; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("gen.gen.Ser", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3gen_3gen_160Ser(((struct __pyx_obj_3gen_gen *)__pyx_v_f), __pyx_v_v, __pyx_v_precision);

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_160Ser(struct __pyx_obj_3gen_gen *__pyx_v_f, PyObject *__pyx_v_v, long __pyx_v_precision) {
  long __pyx_v_vn;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  long __pyx_t_5;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Ser", 0);

  /* "gen.pyx":2308
 * 
 *         """
 *         if precision < 0:             # <<<<<<<<<<<<<<
 *             precision = P.get_series_precision()
 *         pari_catch_sig_on()
 */
  __pyx_t_1 = ((__pyx_v_precision < 0) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":2309
 *         """
 *         if precision < 0:
 *             precision = P.get_series_precision()             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef long vn = P.get_var(v)
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_get_series_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_As_long(__pyx_t_2); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_precision = __pyx_t_5;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "gen.pyx":2310
 *         if precision < 0:
 *             precision = P.get_series_precision()
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long vn = P.get_var(v)
 *         if isexactzero(f.g):
 */
  __pyx_t_6 = pari_catch_sig_on(); if (unlikely(__pyx_t_6 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2311
 *             precision = P.get_series_precision()
 *         pari_catch_sig_on()
 *         cdef long vn = P.get_var(v)             # <<<<<<<<<<<<<<
 *         if isexactzero(f.g):
 *             # Special case for f = 0, because scalarser() is broken
 */
  __pyx_v_vn = ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v);

  /* "gen.pyx":2312
 *         pari_catch_sig_on()
 *         cdef long vn = P.get_var(v)
 *         if isexactzero(f.g):             # <<<<<<<<<<<<<<
 *             # Special case for f = 0, because scalarser() is broken
 *             # in PARI 2.5.5, causing e.g. Ser(gen_0) to give O(x^0).
 */
  __pyx_t_1 = (isexactzero(__pyx_v_f->g) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":2316
 *             # in PARI 2.5.5, causing e.g. Ser(gen_0) to give O(x^0).
 *             # This is fixed in PARI 2.6.
 *             if vn == -1:             # <<<<<<<<<<<<<<
 *                 vn = 0  # otherwise the variable will be called '#'
 *             return P.new_gen(zeroser(vn, precision))
 */
    __pyx_t_1 = ((__pyx_v_vn == -1) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":2317
 *             # This is fixed in PARI 2.6.
 *             if vn == -1:
 *                 vn = 0  # otherwise the variable will be called '#'             # <<<<<<<<<<<<<<
 *             return P.new_gen(zeroser(vn, precision))
 *         elif typ(f.g) == t_VEC:
 */
      __pyx_v_vn = 0;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "gen.pyx":2318
 *             if vn == -1:
 *                 vn = 0  # otherwise the variable will be called '#'
 *             return P.new_gen(zeroser(vn, precision))             # <<<<<<<<<<<<<<
 *         elif typ(f.g) == t_VEC:
 *             # The precision flag is ignored for vectors, so we first
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, zeroser(__pyx_v_vn, __pyx_v_precision))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":2319
 *                 vn = 0  # otherwise the variable will be called '#'
 *             return P.new_gen(zeroser(vn, precision))
 *         elif typ(f.g) == t_VEC:             # <<<<<<<<<<<<<<
 *             # The precision flag is ignored for vectors, so we first
 *             # convert the vector to a polynomial.
 */
  __pyx_t_1 = ((typ(__pyx_v_f->g) == t_VEC) != 0);
  if (__pyx_t_1) {

    /* "gen.pyx":2322
 *             # The precision flag is ignored for vectors, so we first
 *             # convert the vector to a polynomial.
 *             return P.new_gen(gtoser(gtopolyrev(f.g, vn), vn, precision))             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(gtoser(f.g, vn, precision))
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtoser(gtopolyrev(__pyx_v_f->g, __pyx_v_vn), __pyx_v_vn, __pyx_v_precision))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
  /*else*/ {

    /* "gen.pyx":2324
 *             return P.new_gen(gtoser(gtopolyrev(f.g, vn), vn, precision))
 *         else:
 *             return P.new_gen(gtoser(f.g, vn, precision))             # <<<<<<<<<<<<<<
 * 
 *     def Set(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtoser(__pyx_v_f->g, __pyx_v_vn, __pyx_v_precision))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }

  /* "gen.pyx":2248
 *         return P.new_gen(Qfb0(a.g, t0.g, t1.g, t2.g, prec_bits_to_words(precision)))
 * 
 *     def Ser(gen f, v=-1, long precision=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Return a power series or Laurent series in the variable `v`
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("gen.gen.Ser", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2326
 *             return P.new_gen(gtoser(f.g, vn, precision))
 * 
 *     def Set(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Set(x): convert x into a set, i.e. a row vector of strings in
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_163Set(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_162Set[] = "\n        Set(x): convert x into a set, i.e. a row vector of strings in\n        increasing lexicographic order.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a vector of strings in increasing\n           lexicographic order.\n\n\n        EXAMPLES::\n\n            sage: pari([1,5,2]).Set()\n            [\"1\", \"2\", \"5\"]\n            sage: pari([]).Set()     # the empty set\n            []\n            sage: pari([1,1,-1,-1,3,3]).Set()\n            [\"-1\", \"1\", \"3\"]\n            sage: pari(1).Set()\n            [\"1\"]\n            sage: pari('1/(x*y)').Set()\n            [\"1/(y*x)\"]\n            sage: pari('[\"bc\",\"ab\",\"bc\"]').Set()\n            [\"\"ab\"\", \"\"bc\"\"]\n        ";
static PyObject *__pyx_pw_3gen_3gen_163Set(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Set (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_162Set(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_162Set(struct __pyx_obj_3gen_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Set", 0);

  /* "gen.pyx":2359
 *             ["\"ab\"", "\"bc\""]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtoset(x.g))
 * 
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2360
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtoset(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtoset(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* "gen.pyx":2326
 *             return P.new_gen(gtoser(f.g, vn, precision))
 * 
 *     def Set(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Set(x): convert x into a set, i.e. a row vector of strings in
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2363
 * 
 * 
 *     def Str(self):             # <<<<<<<<<<<<<<
 *         """
 *         Str(self): Return the print representation of self as a PARI
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_165Str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_164Str[] = "\n        Str(self): Return the print representation of self as a PARI\n        object.\n\n        INPUT:\n\n\n        -  ``self`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI gen of type t_STR, i.e., a PARI\n           string\n\n\n        EXAMPLES::\n\n            sage: pari([1,2,['abc',1]]).Str()\n            \"[1, 2, [abc, 1]]\"\n            sage: pari([1,1, 1.54]).Str()\n            \"[1, 1, 1.54000000000000]\"\n            sage: pari(1).Str()       # 1 is automatically converted to string rep\n            \"1\"\n            sage: x = pari('x')       # PARI variable \"x\"\n            sage: x.Str()             # is converted to string rep.\n            \"x\"\n            sage: x.Str().type()\n            't_STR'\n        ";
static PyObject *__pyx_pw_3gen_3gen_165Str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Str (wrapper)", 0);
  __pyx_r = __pyx_pf_3gen_3gen_164Str(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_3gen_3gen_164Str(struct __pyx_obj_3gen_gen *__pyx_v_self) {
  char *__pyx_v_c;
  struct __pyx_obj_3gen_gen *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Str", 0);

  /* "gen.pyx":2396
 *         """
 *         cdef char* c
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # Use sig_block(), which is needed because GENtostr() uses
 *         # malloc(), which is dangerous inside sig_on()
 */
  __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":2399
 *         # Use sig_block(), which is needed because GENtostr() uses
 *         # malloc(), which is dangerous inside sig_on()
 *         sig_block()             # <<<<<<<<<<<<<<
 *         c = GENtostr(self.g)
 *         sig_unblock()
 */
  sig_block();

  /* "gen.pyx":2400
 *         # malloc(), which is dangerous inside sig_on()
 *         sig_block()
 *         c = GENtostr(self.g)             # <<<<<<<<<<<<<<
 *         sig_unblock()
 *         v = P.new_gen(strtoGENstr(c))
 */
  __pyx_v_c = GENtostr(__pyx_v_self->g);

  /* "gen.pyx":2401
 *         sig_block()
 *         c = GENtostr(self.g)
 *         sig_unblock()             # <<<<<<<<<<<<<<
 *         v = P.new_gen(strtoGENstr(c))
 *         pari_free(c)
 */
  sig_unblock();

  /* "gen.pyx":2402
 *         c = GENtostr(self.g)
 *         sig_unblock()
 *         v = P.new_gen(strtoGENstr(c))             # <<<<<<<<<<<<<<
 *         pari_free(c)
 *         return v
 */
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, strtoGENstr(__pyx_v_c))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_v = ((struct __pyx_obj_3gen_gen *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "gen.pyx":2403
 *         sig_unblock()
 *         v = P.new_gen(strtoGENstr(c))
 *         pari_free(c)             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
  pari_free(__pyx_v_c);

  /* "gen.pyx":2404
 *         v = P.new_gen(strtoGENstr(c))
 *         pari_free(c)
 *         return v             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_v));
  __pyx_r = ((PyObject *)__pyx_v_v);
  goto __pyx_L0;

  /* "gen.pyx":2363
 * 
 * 
 *     def Str(self):             # <<<<<<<<<<<<<<
 *         """
 *         Str(self): Return the print representation of self as a PARI
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("gen.gen.Str", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "gen.pyx":2407
 * 
 * 
 *     def Strchr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strchr(x): converts x to a string, translating each integer into a
 */

/* Python wrapper */
static PyObject *__pyx_pw_3gen_3gen_167Strchr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_3gen_3gen_166Strchr[] = "\n        Strchr(x): converts x to a string, translating each integer into a\n        character (in ASCII).\n\n        .. note::\n\n           :meth:`.Vecsmall` is (essentially) the inverse to :meth:`.Strchr`.\n\n        INPUT:\n\n\n        -  ``x`` - PARI vector of integers\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI string\n\n\n        EXAMPLES::\n\n            sage: pari([65,66,123]).Strchr()\n            \"AB{\"\n            sage: pari('\"Sage\"').Vecsmall()   # pari('\"Sage\"') --> PARI t_STR\n            Vecsmall([83, 97, 103, 101])\n            sage: _.Strchr()\n            \"Sage\"\n            sage: pari([83, 97, 103, 101]).Strchr()\n            \"Sage\"\n        ";
  static PyObject *__pyx_pw_3gen_3gen_167Strchr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strchr (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_166Strchr(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_166Strchr(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strchr", 0);

    /* "gen.pyx":2439
 *             "Sage"
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strchr(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2440
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(Strchr(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Strexpand(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, Strchr(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2407
 * 
 * 
 *     def Strchr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strchr(x): converts x to a string, translating each integer into a
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.Strchr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2442
 *         return P.new_gen(Strchr(x.g))
 * 
 *     def Strexpand(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strexpand(x): Concatenate the entries of the vector x into a single
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_169Strexpand(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_168Strexpand[] = "\n        Strexpand(x): Concatenate the entries of the vector x into a single\n        string, performing tilde expansion.\n\n        .. note::\n\n           I have no clue what the point of this function is. - William\n        ";
  static PyObject *__pyx_pw_3gen_3gen_169Strexpand(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strexpand (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_168Strexpand(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_168Strexpand(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strexpand", 0);

    /* "gen.pyx":2451
 *            I have no clue what the point of this function is. - William
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x must be of type t_VEC."
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((typ(__pyx_v_x->g) != t_VEC) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":2452
 *         """
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x must be of type t_VEC."             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(Strexpand(x.g))
 */
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_x_must_be_of_type_t_VEC, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":2453
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x must be of type t_VEC."
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strexpand(x.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2454
 *             raise TypeError, "x must be of type t_VEC."
 *         pari_catch_sig_on()
 *         return P.new_gen(Strexpand(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, Strexpand(__pyx_v_x->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2442
 *         return P.new_gen(Strchr(x.g))
 * 
 *     def Strexpand(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strexpand(x): Concatenate the entries of the vector x into a single
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.Strexpand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2457
 * 
 * 
 *     def Strtex(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Strtex(x): Translates the vector x of PARI gens to TeX format and
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_171Strtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_170Strtex[] = "\n        Strtex(x): Translates the vector x of PARI gens to TeX format and\n        returns the resulting concatenated strings as a PARI t_STR.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - PARI t_STR (string)\n\n\n        EXAMPLES::\n\n            sage: v=pari('x^2')\n            sage: v.Strtex()\n            \"x^2\"\n            sage: v=pari(['1/x^2','x'])\n            sage: v.Strtex()\n            \"\\\\frac{1}{x^2}x\"\n            sage: v=pari(['1 + 1/x + 1/(y+1)','x-1'])\n            sage: v.Strtex()\n            \"\\\\frac{ \\\\left(y\\n + 2\\\\right)  x\\n + \\\\left(y\\n + 1\\\\right) }{ \\\\left(y\\n + 1\\\\right)  x}x\\n - 1\"\n        ";
  static PyObject *__pyx_pw_3gen_3gen_171Strtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strtex (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_170Strtex(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_170Strtex(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    Py_ssize_t __pyx_t_6;
    PyObject *__pyx_t_7 = NULL;
    int __pyx_t_8;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strtex", 0);
    __Pyx_INCREF((PyObject *)__pyx_v_x);

    /* "gen.pyx":2486
 *             "\\frac{ \\left(y\n + 2\\right)  x\n + \\left(y\n + 1\\right) }{ \\left(y\n + 1\\right)  x}x\n - 1"
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             x = P.vector(1, [x])
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((typ(__pyx_v_x->g) != t_VEC) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":2487
 *         """
 *         if typ(x.g) != t_VEC:
 *             x = P.vector(1, [x])             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(Strtex(x.g))
 */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_vector); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyList_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_5)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_5);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
          __pyx_t_6 = 1;
        }
      }
      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      if (__pyx_t_5) {
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __Pyx_GIVEREF(__pyx_t_5); __pyx_t_5 = NULL;
      }
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_3gen_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF_SET(__pyx_v_x, ((struct __pyx_obj_3gen_gen *)__pyx_t_2));
      __pyx_t_2 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "gen.pyx":2488
 *         if typ(x.g) != t_VEC:
 *             x = P.vector(1, [x])
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strtex(x.g))
 * 
 */
    __pyx_t_8 = pari_catch_sig_on(); if (unlikely(__pyx_t_8 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2489
 *             x = P.vector(1, [x])
 *         pari_catch_sig_on()
 *         return P.new_gen(Strtex(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def printtex(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, Strtex(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2457
 * 
 * 
 *     def Strtex(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Strtex(x): Translates the vector x of PARI gens to TeX format and
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_AddTraceback("gen.gen.Strtex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2491
 *         return P.new_gen(Strtex(x.g))
 * 
 *     def printtex(gen x):             # <<<<<<<<<<<<<<
 *         return x.Strtex()
 * 
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_173printtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_173printtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("printtex (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_172printtex(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_172printtex(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("printtex", 0);

    /* "gen.pyx":2492
 * 
 *     def printtex(gen x):
 *         return x.Strtex()             # <<<<<<<<<<<<<<
 * 
 *     def Vec(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_x), __pyx_n_s_Strtex); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2491
 *         return P.new_gen(Strtex(x.g))
 * 
 *     def printtex(gen x):             # <<<<<<<<<<<<<<
 *         return x.Strtex()
 * 
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.printtex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2494
 *         return x.Strtex()
 * 
 *     def Vec(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_175Vec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_174Vec[] = "\n        Transform the object `x` into a vector with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI vector (type ``t_VEC``)\n\n        EXAMPLES::\n\n            sage: pari(1).Vec()\n            [1]\n            sage: pari('x^3').Vec()\n            [1, 0, 0, 0]\n            sage: pari('x^3 + 3*x - 2').Vec()\n            [1, 0, 3, -2]\n            sage: pari([1,2,3]).Vec()\n            [1, 2, 3]\n            sage: pari('[1, 2; 3, 4]').Vec()\n            [[1, 3]~, [2, 4]~]\n            sage: pari('\"Sage\"').Vec()\n            [\"S\", \"a\", \"g\", \"e\"]\n            sage: pari('2*x^2 + 3*x^3 + O(x^5)').Vec()\n            [2, 3, 0]\n            sage: pari('2*x^-2 + 3*x^3 + O(x^5)').Vec()\n            [2, 0, 0, 0, 0, 3, 0]\n\n        Note the different term ordering for polynomials and series::\n\n            sage: pari('1 + x + 3*x^3 + O(x^5)').Vec()\n            [1, 1, 0, 3, 0]\n            sage: pari('1 + x + 3*x^3').Vec()\n            [3, 0, 1, 1]\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Vec(2)\n            [1, 2, 3, 4]\n            sage: pari([1,2,3,4]).Vec(-2)\n            [1, 2, 3, 4]\n            sage: pari([1,2,3,4]).Vec(6)\n            [1, 2, 3, 4, 0, 0]\n            sage: pari([1,2,3,4]).Vec(-6)\n            [0, 0, 1, 2, 3, 4]\n\n        See also :meth:`Col` (create a column vector) and :meth:`Vecrev`\n        (create a vector in reversed order).\n        ";
  static PyObject *__pyx_pw_3gen_3gen_175Vec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vec (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vec") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vec", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.Vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_174Vec(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_174Vec(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vec", 0);

    /* "gen.pyx":2549
 *         (create a vector in reversed order).
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2550
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))             # <<<<<<<<<<<<<<
 * 
 *     def Vecrev(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_f_3gen__Vec_append(gtovec(__pyx_v_x->g), gen_0, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2494
 *         return x.Strtex()
 * 
 *     def Vec(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.Vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2552
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))
 * 
 *     def Vecrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_177Vecrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_176Vecrev[] = "\n        Transform the object `x` into a vector with minimal size `|n|`.\n        The order of the resulting vector is reversed compared to :meth:`Vec`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          prepend zeros; if `n < 0`, append zeros.\n\n        OUTPUT:\n\n        A PARI vector (type ``t_VEC``)\n\n        EXAMPLES::\n\n            sage: pari(1).Vecrev()\n            [1]\n            sage: pari('x^3').Vecrev()\n            [0, 0, 0, 1]\n            sage: pari('x^3 + 3*x - 2').Vecrev()\n            [-2, 3, 0, 1]\n            sage: pari([1, 2, 3]).Vecrev()\n            [3, 2, 1]\n            sage: pari('Col([1, 2, 3])').Vecrev()\n            [3, 2, 1]\n            sage: pari('[1, 2; 3, 4]').Vecrev()\n            [[2, 4]~, [1, 3]~]\n            sage: pari('\"Sage\"').Vecrev()\n            [\"e\", \"g\", \"a\", \"S\"]\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Vecrev(2)\n            [4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(-2)\n            [4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(6)\n            [0, 0, 4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(-6)\n            [4, 3, 2, 1, 0, 0]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_177Vecrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vecrev (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vecrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2552; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2552; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vecrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2552; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.Vecrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_176Vecrev(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_176Vecrev(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vecrev", 0);

    /* "gen.pyx":2596
 *             [4, 3, 2, 1, 0, 0]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2597
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))             # <<<<<<<<<<<<<<
 * 
 *     def Vecsmall(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_f_3gen__Vec_append(gtovecrev(__pyx_v_x->g), gen_0, (-__pyx_v_n)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2552
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))
 * 
 *     def Vecrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.Vecrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2599
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))
 * 
 *     def Vecsmall(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a ``t_VECSMALL`` with minimal size `|n|`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_179Vecsmall(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_178Vecsmall[] = "\n        Transform the object `x` into a ``t_VECSMALL`` with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI vector of small integers (type ``t_VECSMALL``)\n\n        EXAMPLES::\n\n            sage: pari([1,2,3]).Vecsmall()\n            Vecsmall([1, 2, 3])\n            sage: pari('\"Sage\"').Vecsmall()\n            Vecsmall([83, 97, 103, 101])\n            sage: pari(1234).Vecsmall()\n            Vecsmall([1234])\n            sage: pari('x^2 + 2*x + 3').Vecsmall()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in vectosmall\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3]).Vecsmall(2)\n            Vecsmall([1, 2, 3])\n            sage: pari([1,2,3]).Vecsmall(-2)\n            Vecsmall([1, 2, 3])\n            sage: pari([1,2,3]).Vecsmall(6)\n            Vecsmall([1, 2, 3, 0, 0, 0])\n            sage: pari([1,2,3]).Vecsmall(-6)\n            Vecsmall([0, 0, 0, 1, 2, 3])\n        ";
  static PyObject *__pyx_pw_3gen_3gen_179Vecsmall(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vecsmall (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vecsmall") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vecsmall", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.Vecsmall", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_178Vecsmall(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_178Vecsmall(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vecsmall", 0);

    /* "gen.pyx":2638
 *             Vecsmall([0, 0, 0, 1, 2, 3])
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2639
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))             # <<<<<<<<<<<<<<
 * 
 *     def binary(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_f_3gen__Vec_append(gtovecsmall(__pyx_v_x->g), ((GEN)0), __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2599
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))
 * 
 *     def Vecsmall(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a ``t_VECSMALL`` with minimal size `|n|`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.Vecsmall", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2641
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))
 * 
 *     def binary(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         binary(x): gives the vector formed by the binary digits of abs(x),
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_181binary(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_180binary[] = "\n        binary(x): gives the vector formed by the binary digits of abs(x),\n        where x is of type t_INT.\n\n        INPUT:\n\n\n        -  ``x`` - gen of type t_INT\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type t_VEC\n\n\n        EXAMPLES::\n\n            sage: pari(0).binary()\n            [0]\n            sage: pari(-5).binary()\n            [1, 0, 1]\n            sage: pari(5).binary()\n            [1, 0, 1]\n            sage: pari(2005).binary()\n            [1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1]\n\n        ::\n\n            sage: pari('\"2\"').binary()\n            Traceback (most recent call last):\n            ...\n            TypeError: x (=\"2\") must be of type t_INT, but is of type t_STR.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_181binary(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("binary (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_180binary(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_180binary(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("binary", 0);

    /* "gen.pyx":2676
 *             TypeError: x (="2") must be of type t_INT, but is of type t_STR.
 *         """
 *         if typ(x.g) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((typ(__pyx_v_x->g) != t_INT) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":2677
 *         """
 *         if typ(x.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(binaire(x.g))
 */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_x), __pyx_n_s_type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_x_s_must_be_of_type_t_INT_but_is, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_2, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":2678
 *         if typ(x.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(binaire(x.g))
 * 
 */
    __pyx_t_5 = pari_catch_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2679
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()
 *         return P.new_gen(binaire(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def bitand(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, binaire(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2641
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))
 * 
 *     def binary(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         binary(x): gives the vector formed by the binary digits of abs(x),
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.binary", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2681
 *         return P.new_gen(binaire(x.g))
 * 
 *     def bitand(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitand(x,y): Bitwise and of two integers x and y. Negative numbers
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_183bitand(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_182bitand[] = "\n        bitand(x,y): Bitwise and of two integers x and y. Negative numbers\n        behave as if modulo some large power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(8).bitand(4)\n            0\n            sage: pari(8).bitand(8)\n            8\n            sage: pari(6).binary()\n            [1, 1, 0]\n            sage: pari(7).binary()\n            [1, 1, 1]\n            sage: pari(6).bitand(7)\n            6\n            sage: pari(19).bitand(-1)\n            19\n            sage: pari(-1).bitand(-1)\n            -1\n        ";
  static PyObject *__pyx_pw_3gen_3gen_183bitand(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitand (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_182bitand(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_182bitand(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitand", 0);

    /* "gen.pyx":2717
 *             -1
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitand(x.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":2718
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitand(x.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2719
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitand(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gbitand(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2681
 *         return P.new_gen(binaire(x.g))
 * 
 *     def bitand(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitand(x,y): Bitwise and of two integers x and y. Negative numbers
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bitand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2722
 * 
 * 
 *     def bitneg(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         bitneg(x,n=-1): Bitwise negation of the integer x truncated to n
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_185bitneg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_184bitneg[] = "\n        bitneg(x,n=-1): Bitwise negation of the integer x truncated to n\n        bits. n=-1 (the default) represents an infinite sequence of the bit\n        1. Negative numbers behave as if modulo some large power of 2.\n\n        With n=-1, this function returns -n-1. With n = 0, it returns a\n        number a such that `a\\cong -n-1 \\pmod{2^n}`.\n\n        INPUT:\n\n\n        -  ``x`` - gen (t_INT)\n\n        -  ``n`` - long, default = -1\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(10).bitneg()\n            -11\n            sage: pari(1).bitneg()\n            -2\n            sage: pari(-2).bitneg()\n            1\n            sage: pari(-1).bitneg()\n            0\n            sage: pari(569).bitneg()\n            -570\n            sage: pari(569).bitneg(10)\n            454\n            sage: 454 % 2^10\n            454\n            sage: -570 % 2^10\n            454\n        ";
  static PyObject *__pyx_pw_3gen_3gen_185bitneg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitneg (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bitneg") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2722; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2722; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bitneg", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2722; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bitneg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_184bitneg(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_184bitneg(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitneg", 0);

    /* "gen.pyx":2764
 *             454
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitneg(x.g,n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2764; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2765
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitneg(x.g,n))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gbitneg(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2765; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2722
 * 
 * 
 *     def bitneg(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         bitneg(x,n=-1): Bitwise negation of the integer x truncated to n
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.bitneg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2768
 * 
 * 
 *     def bitnegimply(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitnegimply(x,y): Bitwise negated imply of two integers x and y, in
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_187bitnegimply(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_186bitnegimply[] = "\n        bitnegimply(x,y): Bitwise negated imply of two integers x and y, in\n        other words, x BITAND BITNEG(y). Negative numbers behave as if\n        modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(14).bitnegimply(0)\n            14\n            sage: pari(8).bitnegimply(8)\n            0\n            sage: pari(8+4).bitnegimply(8)\n            4\n        ";
  static PyObject *__pyx_pw_3gen_3gen_187bitnegimply(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitnegimply (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_186bitnegimply(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_186bitnegimply(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitnegimply", 0);

    /* "gen.pyx":2797
 *             4
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitnegimply(x.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":2798
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitnegimply(x.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2799
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitnegimply(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gbitnegimply(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2768
 * 
 * 
 *     def bitnegimply(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitnegimply(x,y): Bitwise negated imply of two integers x and y, in
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bitnegimply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2802
 * 
 * 
 *     def bitor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitor(x,y): Bitwise or of two integers x and y. Negative numbers
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_189bitor(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_188bitor[] = "\n        bitor(x,y): Bitwise or of two integers x and y. Negative numbers\n        behave as if modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(14).bitor(0)\n            14\n            sage: pari(8).bitor(4)\n            12\n            sage: pari(12).bitor(1)\n            13\n            sage: pari(13).bitor(1)\n            13\n        ";
  static PyObject *__pyx_pw_3gen_3gen_189bitor(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitor (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_188bitor(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_188bitor(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitor", 0);

    /* "gen.pyx":2832
 *             13
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitor(x.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":2833
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitor(x.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2834
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitor(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gbitor(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2802
 * 
 * 
 *     def bitor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitor(x,y): Bitwise or of two integers x and y. Negative numbers
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bitor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2837
 * 
 * 
 *     def bittest(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         bittest(x, long n): Returns bit number n (coefficient of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_191bittest(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_3gen_3gen_190bittest[] = "\n        bittest(x, long n): Returns bit number n (coefficient of\n        `2^n` in binary) of the integer x. Negative numbers behave\n        as if modulo a big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (pari integer)\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - a Python bool\n\n\n        EXAMPLES::\n\n            sage: x = pari(6)\n            sage: x.bittest(0)\n            False\n            sage: x.bittest(1)\n            True\n            sage: x.bittest(2)\n            True\n            sage: x.bittest(3)\n            False\n            sage: pari(-3).bittest(0)\n            True\n            sage: pari(-3).bittest(1)\n            False\n            sage: [pari(-3).bittest(n) for n in range(10)]\n            [True, False, True, True, True, True, True, True, True, True]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_191bittest(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bittest (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bittest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_190bittest(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((long)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_190bittest(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    long __pyx_v_b;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bittest", 0);

    /* "gen.pyx":2873
 *             [True, False, True, True, True, True, True, True, True, True]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long b = bittest(x.g, n)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2874
 *         """
 *         pari_catch_sig_on()
 *         cdef long b = bittest(x.g, n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return b != 0
 */
    __pyx_v_b = bittest(__pyx_v_x->g, __pyx_v_n);

    /* "gen.pyx":2875
 *         pari_catch_sig_on()
 *         cdef long b = bittest(x.g, n)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return b != 0
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":2876
 *         cdef long b = bittest(x.g, n)
 *         pari_catch_sig_off()
 *         return b != 0             # <<<<<<<<<<<<<<
 * 
 *     def bitxor(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_b != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2837
 * 
 * 
 *     def bittest(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         bittest(x, long n): Returns bit number n (coefficient of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.bittest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2878
 *         return b != 0
 * 
 *     def bitxor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitxor(x,y): Bitwise exclusive or of two integers x and y. Negative
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_193bitxor(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_192bitxor[] = "\n        bitxor(x,y): Bitwise exclusive or of two integers x and y. Negative\n        numbers behave as if modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(6).bitxor(4)\n            2\n            sage: pari(0).bitxor(4)\n            4\n            sage: pari(6).bitxor(0)\n            6\n        ";
  static PyObject *__pyx_pw_3gen_3gen_193bitxor(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitxor (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_192bitxor(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_192bitxor(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitxor", 0);

    /* "gen.pyx":2906
 *             6
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitxor(x.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2906; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":2907
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitxor(x.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2908
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(gbitxor(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gbitxor(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2878
 *         return b != 0
 * 
 *     def bitxor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitxor(x,y): Bitwise exclusive or of two integers x and y. Negative
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bitxor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2911
 * 
 * 
 *     def ceil(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the smallest integer = x. For rational
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_195ceil(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_194ceil[] = "\n        For real x: return the smallest integer = x. For rational\n        functions: the quotient of numerator by denominator. For lists:\n        apply componentwise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - depends on type of x\n\n\n        EXAMPLES::\n\n            sage: pari(1.4).ceil()\n            2\n            sage: pari(-1.4).ceil()\n            -1\n            sage: pari(3/4).ceil()\n            1\n            sage: pari(x).ceil()\n            x\n            sage: pari((x^2+x+1)/x).ceil()\n            x + 1\n\n        This may be unexpected: but it is correct, treating the argument as\n        a rational function in RR(x).\n\n        ::\n\n            sage: pari(x^2+5*x+2.5).ceil()\n            x^2 + 5*x + 2.50000000000000\n        ";
  static PyObject *__pyx_pw_3gen_3gen_195ceil(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ceil (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_194ceil(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_194ceil(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ceil", 0);

    /* "gen.pyx":2950
 *             x^2 + 5*x + 2.50000000000000
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gceil(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2951
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gceil(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def centerlift(gen x, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gceil(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2911
 * 
 * 
 *     def ceil(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the smallest integer = x. For rational
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ceil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2953
 *         return P.new_gen(gceil(x.g))
 * 
 *     def centerlift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         centerlift(x,v): Centered lift of x. This function returns exactly
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_197centerlift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_196centerlift[] = "\n        centerlift(x,v): Centered lift of x. This function returns exactly\n        the same thing as lift, except if x is an integer mod.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - var (default: x)\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: x = pari(-2).Mod(5)\n            sage: x.centerlift()\n            -2\n            sage: x.lift()\n            3\n            sage: f = pari('x-1').Mod('x^2 + 1')\n            sage: f.centerlift()\n            x - 1\n            sage: f.lift()\n            x - 1\n            sage: f = pari('x-y').Mod('x^2+1')\n            sage: f\n            Mod(x - y, x^2 + 1)\n            sage: f.centerlift('x')\n            x - y\n            sage: f.centerlift('y')\n            Mod(x - y, x^2 + 1)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_197centerlift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("centerlift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "centerlift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2953; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("centerlift", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2953; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.centerlift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_196centerlift(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_196centerlift(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("centerlift", 0);

    /* "gen.pyx":2988
 *             Mod(x - y, x^2 + 1)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(centerlift0(x.g, P.get_var(v)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":2989
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(centerlift0(x.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, centerlift0(__pyx_v_x->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2989; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2953
 *         return P.new_gen(gceil(x.g))
 * 
 *     def centerlift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         centerlift(x,v): Centered lift of x. This function returns exactly
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.centerlift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":2992
 * 
 * 
 *     def component(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         component(x, long n): Return n'th component of the internal
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_199component(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_3gen_3gen_198component[] = "\n        component(x, long n): Return n'th component of the internal\n        representation of x. This function is 1-based instead of 0-based.\n\n        .. note::\n\n           For vectors or matrices, it is simpler to use x[n-1]. For\n           list objects such as is output by nfinit, it is easier to\n           use member functions.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - C long (coercible to)\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari([0,1,2,3,4]).component(1)\n            0\n            sage: pari([0,1,2,3,4]).component(2)\n            1\n            sage: pari([0,1,2,3,4]).component(4)\n            3\n            sage: pari('x^3 + 2').component(1)\n            2\n            sage: pari('x^3 + 2').component(2)\n            0\n            sage: pari('x^3 + 2').component(4)\n            1\n\n        ::\n\n            sage: pari('x').component(0)\n            Traceback (most recent call last):\n            ...\n            PariError: nonexistent component\n        ";
  static PyObject *__pyx_pw_3gen_3gen_199component(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("component (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2992; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.component", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_198component(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((long)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_198component(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("component", 0);

    /* "gen.pyx":3035
 *             PariError: nonexistent component
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(compo(x.g, n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3035; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3036
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(compo(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def conj(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, compo(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":2992
 * 
 * 
 *     def component(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         component(x, long n): Return n'th component of the internal
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.component", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3038
 *         return P.new_gen(compo(x.g, n))
 * 
 *     def conj(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         conj(x): Return the algebraic conjugate of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_201conj(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_200conj[] = "\n        conj(x): Return the algebraic conjugate of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('x+1').conj()\n            x + 1\n            sage: pari('x+I').conj()\n            x - I\n            sage: pari('1/(2*x+3*I)').conj()\n            1/(2*x - 3*I)\n            sage: pari([1,2,'2-I','Mod(x,x^2+1)', 'Mod(x,x^2-2)']).conj()\n            [1, 2, 2 + I, Mod(-x, x^2 + 1), Mod(-x, x^2 - 2)]\n            sage: pari('Mod(x,x^2-2)').conj()\n            Mod(-x, x^2 - 2)\n            sage: pari('Mod(x,x^3-3)').conj()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in gconj\n        ";
  static PyObject *__pyx_pw_3gen_3gen_201conj(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("conj (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_200conj(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_200conj(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("conj", 0);

    /* "gen.pyx":3067
 *             PariError: incorrect type in gconj
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gconj(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3067; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3068
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gconj(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def conjvec(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gconj(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3068; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3038
 *         return P.new_gen(compo(x.g, n))
 * 
 *     def conj(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         conj(x): Return the algebraic conjugate of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.conj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3070
 *         return P.new_gen(gconj(x.g))
 * 
 *     def conjvec(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         conjvec(x): Returns the vector of all conjugates of the algebraic
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_203conjvec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_202conjvec[] = "\n        conjvec(x): Returns the vector of all conjugates of the algebraic\n        number x. An algebraic number is a polynomial over Q modulo an\n        irreducible polynomial.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('Mod(1+x,x^2-2)').conjvec()\n            [-0.414213562373095, 2.41421356237310]~\n            sage: pari('Mod(x,x^3-3)').conjvec()\n            [1.44224957030741, -0.721124785153704 + 1.24902476648341*I, -0.721124785153704 - 1.24902476648341*I]~\n            sage: pari('Mod(1+x,x^2-2)').conjvec(precision=192)[0].sage()\n            -0.414213562373095048801688724209698078569671875376948073177\n        ";
  static PyObject *__pyx_pw_3gen_3gen_203conjvec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("conjvec (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conjvec") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3070; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3070; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("conjvec", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3070; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.conjvec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_202conjvec(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_202conjvec(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("conjvec", 0);

    /* "gen.pyx":3093
 *             -0.414213562373095048801688724209698078569671875376948073177
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(conjvec(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3094
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(conjvec(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def denominator(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, conjvec(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3070
 *         return P.new_gen(gconj(x.g))
 * 
 *     def conjvec(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         conjvec(x): Returns the vector of all conjugates of the algebraic
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.conjvec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3096
 *         return P.new_gen(conjvec(x.g, prec_bits_to_words(precision)))
 * 
 *     def denominator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         denominator(x): Return the denominator of x. When x is a vector,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_205denominator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_204denominator[] = "\n        denominator(x): Return the denominator of x. When x is a vector,\n        this is the least common multiple of the denominators of the\n        components of x.\n\n        what about poly? INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('5/9').denominator()\n            9\n            sage: pari('(x+1)/(x-2)').denominator()\n            x - 2\n            sage: pari('2/3 + 5/8*x + 7/3*x^2 + 1/5*y').denominator()\n            1\n            sage: pari('2/3*x').denominator()\n            1\n            sage: pari('[2/3, 5/8, 7/3, 1/5]').denominator()\n            120\n        ";
  static PyObject *__pyx_pw_3gen_3gen_205denominator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("denominator (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_204denominator(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_204denominator(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("denominator", 0);

    /* "gen.pyx":3123
 *             120
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(denom(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3124
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(denom(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def floor(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, denom(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3096
 *         return P.new_gen(conjvec(x.g, prec_bits_to_words(precision)))
 * 
 *     def denominator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         denominator(x): Return the denominator of x. When x is a vector,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.denominator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3126
 *         return P.new_gen(denom(x.g))
 * 
 *     def floor(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the largest integer = x. For rational functions:
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_207floor(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_206floor[] = "\n        For real x: return the largest integer = x. For rational functions:\n        the quotient of numerator by denominator. For lists: apply\n        componentwise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari(5/9).floor()\n            0\n            sage: pari(11/9).floor()\n            1\n            sage: pari(1.17).floor()\n            1\n            sage: pari([1.5,2.3,4.99]).floor()\n            [1, 2, 4]\n            sage: pari([[1.1,2.2],[3.3,4.4]]).floor()\n            [[1, 2], [3, 4]]\n            sage: pari(x).floor()\n            x\n            sage: pari((x^2+x+1)/x).floor()\n            x + 1\n            sage: pari(x^2+5*x+2.5).floor()\n            x^2 + 5*x + 2.50000000000000\n\n        ::\n\n            sage: pari('\"hello world\"').floor()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in gfloor\n        ";
  static PyObject *__pyx_pw_3gen_3gen_207floor(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("floor (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_206floor(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_206floor(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("floor", 0);

    /* "gen.pyx":3166
 *             PariError: incorrect type in gfloor
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gfloor(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3167
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gfloor(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def frac(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gfloor(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3126
 *         return P.new_gen(denom(x.g))
 * 
 *     def floor(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the largest integer = x. For rational functions:
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.floor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3169
 *         return P.new_gen(gfloor(x.g))
 * 
 *     def frac(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         frac(x): Return the fractional part of x, which is x - floor(x).
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_209frac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_208frac[] = "\n        frac(x): Return the fractional part of x, which is x - floor(x).\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari(1.75).frac()\n            0.750000000000000\n            sage: pari(sqrt(2)).frac()\n            0.414213562373095\n            sage: pari('sqrt(-2)').frac()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in gfloor\n        ";
  static PyObject *__pyx_pw_3gen_3gen_209frac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("frac (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_208frac(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_208frac(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("frac", 0);

    /* "gen.pyx":3192
 *             PariError: incorrect type in gfloor
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gfrac(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3193
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gfrac(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def imag(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gfrac(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3169
 *         return P.new_gen(gfloor(x.g))
 * 
 *     def frac(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         frac(x): Return the fractional part of x, which is x - floor(x).
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.frac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3195
 *         return P.new_gen(gfrac(x.g))
 * 
 *     def imag(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         imag(x): Return the imaginary part of x. This function also works
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_211imag(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_210imag[] = "\n        imag(x): Return the imaginary part of x. This function also works\n        component-wise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('1+2*I').imag()\n            2\n            sage: pari(sqrt(-2)).imag()\n            1.41421356237310\n            sage: pari('x+I').imag()\n            1\n            sage: pari('x+2*I').imag()\n            2\n            sage: pari('(1+I)*x^2+2*I').imag()\n            x^2 + 2\n            sage: pari('[1,2,3] + [4*I,5,6]').imag()\n            [4, 0, 0]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_211imag(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("imag (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_210imag(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_210imag(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("imag", 0);

    /* "gen.pyx":3223
 *             [4, 0, 0]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gimag(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3224
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gimag(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def length(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gimag(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3195
 *         return P.new_gen(gfrac(x.g))
 * 
 *     def imag(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         imag(x): Return the imaginary part of x. This function also works
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.imag", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3226
 *         return P.new_gen(gimag(x.g))
 * 
 *     def length(self):             # <<<<<<<<<<<<<<
 *         """
 * 
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_213length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_212length[] = "\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_213length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("length (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_212length(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_212length(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("length", 0);

    /* "gen.pyx":3230
 * 
 *         """
 *         return glength(self.g)             # <<<<<<<<<<<<<<
 * 
 *     def lift(gen x, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3226
 *         return P.new_gen(gimag(x.g))
 * 
 *     def length(self):             # <<<<<<<<<<<<<<
 *         """
 * 
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.length", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3232
 *         return glength(self.g)
 * 
 *     def lift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         lift(x,v): Returns the lift of an element of Z/nZ to Z or R[x]/(P)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_215lift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_214lift[] = "\n        lift(x,v): Returns the lift of an element of Z/nZ to Z or R[x]/(P)\n        to R[x] for a type R if v is omitted. If v is given, lift only\n        polymods with main variable v. If v does not occur in x, lift only\n        intmods.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - (optional) variable\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: x = pari(\"x\")\n            sage: a = x.Mod('x^3 + 17*x + 3')\n            sage: a\n            Mod(x, x^3 + 17*x + 3)\n            sage: b = a^4; b\n            Mod(-17*x^2 - 3*x, x^3 + 17*x + 3)\n            sage: b.lift()\n            -17*x^2 - 3*x\n\n        \077\077? more examples\n        ";
  static PyObject *__pyx_pw_3gen_3gen_215lift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lift", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3232; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_214lift(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_214lift(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lift", 0);

    /* "gen.pyx":3262
 *         ??? more examples
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if v == -1:
 *             return P.new_gen(lift(x.g))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3263
 *         """
 *         pari_catch_sig_on()
 *         if v == -1:             # <<<<<<<<<<<<<<
 *             return P.new_gen(lift(x.g))
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 */
    __pyx_t_2 = PyObject_RichCompare(__pyx_v_v, __pyx_int_neg_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_3) {

      /* "gen.pyx":3264
 *         pari_catch_sig_on()
 *         if v == -1:
 *             return P.new_gen(lift(x.g))             # <<<<<<<<<<<<<<
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, lift(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":3265
 *         if v == -1:
 *             return P.new_gen(lift(x.g))
 *         return P.new_gen(lift0(x.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def numbpart(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, lift0(__pyx_v_x->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3232
 *         return glength(self.g)
 * 
 *     def lift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         lift(x,v): Returns the lift of an element of Z/nZ to Z or R[x]/(P)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3267
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 * 
 *     def numbpart(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numbpart(x): returns the number of partitions of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_217numbpart(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_216numbpart[] = "\n        numbpart(x): returns the number of partitions of x.\n\n        EXAMPLES::\n\n            sage: pari(20).numbpart()\n            627\n            sage: pari(100).numbpart()\n            190569292\n        ";
  static PyObject *__pyx_pw_3gen_3gen_217numbpart(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numbpart (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_216numbpart(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_216numbpart(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numbpart", 0);

    /* "gen.pyx":3278
 *             190569292
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numbpart(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3279
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(numbpart(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def numerator(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, numbpart(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3267
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 * 
 *     def numbpart(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numbpart(x): returns the number of partitions of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.numbpart", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3281
 *         return P.new_gen(numbpart(x.g))
 * 
 *     def numerator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numerator(x): Returns the numerator of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_219numerator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_218numerator[] = "\n        numerator(x): Returns the numerator of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_219numerator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numerator (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_218numerator(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_218numerator(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numerator", 0);

    /* "gen.pyx":3295
 *         EXAMPLES:
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numer(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3296
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(numer(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, numer(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3281
 *         return P.new_gen(numbpart(x.g))
 * 
 *     def numerator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numerator(x): Returns the numerator of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.numerator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3299
 * 
 * 
 *     def numtoperm(gen k, long n):             # <<<<<<<<<<<<<<
 *         """
 *         numtoperm(k, n): Return the permutation number k (mod n!) of n
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_221numtoperm(PyObject *__pyx_v_k, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_3gen_3gen_220numtoperm[] = "\n        numtoperm(k, n): Return the permutation number k (mod n!) of n\n        letters, where n is an integer.\n\n        INPUT:\n\n\n        -  ``k`` - gen, integer\n\n        -  ``n`` - int\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - vector (permutation of 1,...,n)\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_221numtoperm(PyObject *__pyx_v_k, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numtoperm (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3299; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.numtoperm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_220numtoperm(((struct __pyx_obj_3gen_gen *)__pyx_v_k), ((long)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_220numtoperm(struct __pyx_obj_3gen_gen *__pyx_v_k, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numtoperm", 0);

    /* "gen.pyx":3320
 *         EXAMPLES:
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numtoperm(n, k.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3321
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(numtoperm(n, k.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, numtoperm(__pyx_v_n, __pyx_v_k->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3299
 * 
 * 
 *     def numtoperm(gen k, long n):             # <<<<<<<<<<<<<<
 *         """
 *         numtoperm(k, n): Return the permutation number k (mod n!) of n
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.numtoperm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3324
 * 
 * 
 *     def padicprec(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         padicprec(x,p): Return the absolute p-adic precision of the object
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_223padicprec(PyObject *__pyx_v_x, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_222padicprec[] = "\n        padicprec(x,p): Return the absolute p-adic precision of the object\n        x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: int\n\n        EXAMPLES::\n\n            sage: K = Qp(11,5)\n            sage: x = K(11^-10 + 5*11^-7 + 11^-6)\n            sage: y = pari(x)\n            sage: y.padicprec(11)\n            -5\n            sage: y.padicprec(17)\n            Traceback (most recent call last):\n            ...\n            PariError: not the same prime in padicprec\n\n        This works for polynomials too::\n\n            sage: R.<t> = PolynomialRing(Zp(3))\n            sage: pol = R([O(3^4), O(3^6), O(3^5)])\n            sage: pari(pol).padicprec(3)\n            4\n        ";
  static PyObject *__pyx_pw_3gen_3gen_223padicprec(PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicprec (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_222padicprec(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_222padicprec(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    long __pyx_v_prec;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicprec", 0);

    /* "gen.pyx":3356
 *             4
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef long prec = padicprec(x.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":3357
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long prec = padicprec(x.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3358
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         cdef long prec = padicprec(x.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return prec
 */
    __pyx_v_prec = padicprec(__pyx_v_x->g, __pyx_v_t0->g);

    /* "gen.pyx":3359
 *         pari_catch_sig_on()
 *         cdef long prec = padicprec(x.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return prec
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":3360
 *         cdef long prec = padicprec(x.g, t0.g)
 *         pari_catch_sig_off()
 *         return prec             # <<<<<<<<<<<<<<
 * 
 *     def padicprime(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3324
 * 
 * 
 *     def padicprec(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         padicprec(x,p): Return the absolute p-adic precision of the object
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.padicprec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3362
 *         return prec
 * 
 *     def padicprime(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         The uniformizer of the p-adic ring this element lies in, as a t_INT.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_225padicprime(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_224padicprime[] = "\n        The uniformizer of the p-adic ring this element lies in, as a t_INT.\n\n        INPUT:\n\n        - ``x`` - gen, of type t_PADIC\n\n        OUTPUT:\n\n        - ``p`` - gen, of type t_INT\n\n        EXAMPLES::\n\n            sage: K = Qp(11,5)\n            sage: x = K(11^-10 + 5*11^-7 + 11^-6)\n            sage: y = pari(x)\n            sage: y.padicprime()\n            11\n            sage: y.padicprime().type()\n            't_INT'\n        ";
  static PyObject *__pyx_pw_3gen_3gen_225padicprime(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicprime (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_224padicprime(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_224padicprime(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicprime", 0);

    /* "gen.pyx":3384
 *             't_INT'
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gel(x.g, 2))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3385
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gel(x.g, 2))             # <<<<<<<<<<<<<<
 * 
 *     def permtonum(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gel(__pyx_v_x->g, 2))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3362
 *         return prec
 * 
 *     def padicprime(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         The uniformizer of the p-adic ring this element lies in, as a t_INT.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.padicprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3387
 *         return P.new_gen(gel(x.g, 2))
 * 
 *     def permtonum(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         permtonum(x): Return the ordinal (between 1 and n!) of permutation
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_227permtonum(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_226permtonum[] = "\n        permtonum(x): Return the ordinal (between 1 and n!) of permutation\n        vector x. \077\077? Huh \077\077? say more. what is a perm vector. 0 to n-1 or\n        1-n.\n\n        INPUT:\n\n\n        -  ``x`` - gen (vector of integers)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_227permtonum(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("permtonum (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_226permtonum(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_226permtonum(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("permtonum", 0);

    /* "gen.pyx":3407
 *         EXAMPLES:
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((typ(__pyx_v_x->g) != t_VEC) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":3408
 *         """
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(permtonum(x.g))
 */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_x), __pyx_n_s_type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_x_s_must_be_of_type_t_VEC_but_is, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_2, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":3409
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(permtonum(x.g))
 * 
 */
    __pyx_t_5 = pari_catch_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3410
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         pari_catch_sig_on()
 *         return P.new_gen(permtonum(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def precision(gen x, long n=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, permtonum(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3410; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3387
 *         return P.new_gen(gel(x.g, 2))
 * 
 *     def permtonum(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         permtonum(x): Return the ordinal (between 1 and n!) of permutation
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.permtonum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3412
 *         return P.new_gen(permtonum(x.g))
 * 
 *     def precision(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         """
 *         precision(x,n): Change the precision of x to be n, where n is a
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_229precision(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_228precision[] = "\n        precision(x,n): Change the precision of x to be n, where n is a\n        C-integer). If n is omitted, output the real precision of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - (optional) int\n\n\n        OUTPUT: nothing or gen if n is omitted\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_229precision(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("precision (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "precision") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3412; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3412; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("precision", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3412; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_228precision(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_228precision(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("precision", 0);

    /* "gen.pyx":3429
 *         EXAMPLES:
 *         """
 *         if n <= -1:             # <<<<<<<<<<<<<<
 *             return precision(x.g)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((__pyx_v_n <= -1) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":3430
 *         """
 *         if n <= -1:
 *             return precision(x.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(precision0(x.g, n))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_PyInt_From_long(precision(__pyx_v_x->g)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":3431
 *         if n <= -1:
 *             return precision(x.g)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(precision0(x.g, n))
 * 
 */
    __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3432
 *             return precision(x.g)
 *         pari_catch_sig_on()
 *         return P.new_gen(precision0(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def random(gen N):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, precision0(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3412
 *         return P.new_gen(permtonum(x.g))
 * 
 *     def precision(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         """
 *         precision(x,n): Change the precision of x to be n, where n is a
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3434
 *         return P.new_gen(precision0(x.g, n))
 * 
 *     def random(gen N):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``random(N=2^31)``: Return a pseudo-random integer
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_231random(PyObject *__pyx_v_N, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_230random[] = "\n        ``random(N=2^31)``: Return a pseudo-random integer\n        between 0 and `N-1`.\n\n        INPUT:\n\n\n        -``N`` - gen, integer\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_231random(PyObject *__pyx_v_N, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("random (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_230random(((struct __pyx_obj_3gen_gen *)__pyx_v_N));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_230random(struct __pyx_obj_3gen_gen *__pyx_v_N) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("random", 0);

    /* "gen.pyx":3453
 *         EXAMPLES:
 *         """
 *         if typ(N.g) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((typ(__pyx_v_N->g) != t_INT) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":3454
 *         """
 *         if typ(N.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(genrand(N.g))
 */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_N), __pyx_n_s_type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (__pyx_t_4) {
        __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_N));
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_N));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_N));
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_x_s_must_be_of_type_t_INT_but_is, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_2, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":3455
 *         if typ(N.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(genrand(N.g))
 * 
 */
    __pyx_t_5 = pari_catch_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3456
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         pari_catch_sig_on()
 *         return P.new_gen(genrand(N.g))             # <<<<<<<<<<<<<<
 * 
 *     def real(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, genrand(__pyx_v_N->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3434
 *         return P.new_gen(precision0(x.g, n))
 * 
 *     def random(gen N):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``random(N=2^31)``: Return a pseudo-random integer
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.random", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3458
 *         return P.new_gen(genrand(N.g))
 * 
 *     def real(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         real(x): Return the real part of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_233real(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_232real[] = "\n        real(x): Return the real part of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_233real(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("real (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_232real(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_232real(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("real", 0);

    /* "gen.pyx":3472
 *         EXAMPLES:
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(greal(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3473
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(greal(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def round(gen x, estimate=False):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, greal(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3458
 *         return P.new_gen(genrand(N.g))
 * 
 *     def real(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         real(x): Return the real part of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.real", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3475
 *         return P.new_gen(greal(x.g))
 * 
 *     def round(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         round(x,estimate=False): If x is a real number, returns x rounded
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_235round(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_234round[] = "\n        round(x,estimate=False): If x is a real number, returns x rounded\n        to the nearest integer (rounding up). If the optional argument\n        estimate is True, also returns the binary exponent e of the\n        difference between the original and the rounded value (the\n        \"fractional part\") (this is the integer ceiling of log_2(error)).\n\n        When x is a general PARI object, this function returns the result\n        of rounding every coefficient at every level of PARI object. Note\n        that this is different than what the truncate function does (see\n        the example below).\n\n        One use of round is to get exact results after a long approximate\n        computation, when theory tells you that the coefficients must be\n        integers.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``estimate`` - (optional) bool, False by default\n\n\n        OUTPUT:\n\n        - if estimate is False, return a single gen.\n\n        - if estimate is True, return rounded version of x and error\n          estimate in bits, both as gens.\n\n        EXAMPLES::\n\n            sage: pari('1.5').round()\n            2\n            sage: pari('1.5').round(True)\n            (2, -1)\n            sage: pari('1.5 + 2.1*I').round()\n            2 + 2*I\n            sage: pari('1.0001').round(True)\n            (1, -14)\n            sage: pari('(2.4*x^2 - 1.7)/x').round()\n            (2*x^2 - 2)/x\n            sage: pari('(2.4*x^2 - 1.7)/x').truncate()\n            2.40000000000000*x\n        ";
  static PyObject *__pyx_pw_3gen_3gen_235round(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_estimate = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("round (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_estimate,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_False);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_estimate);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "round") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3475; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_estimate = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("round", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3475; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.round", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_234round(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_estimate);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_234round(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_estimate) {
    long __pyx_v_e;
    struct __pyx_obj_3gen_gen *__pyx_v_y = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("round", 0);

    /* "gen.pyx":3525
 *         cdef long e
 *         cdef gen y
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if not estimate:
 *             return P.new_gen(ground(x.g))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3526
 *         cdef gen y
 *         pari_catch_sig_on()
 *         if not estimate:             # <<<<<<<<<<<<<<
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_estimate); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((!__pyx_t_2) != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":3527
 *         pari_catch_sig_on()
 *         if not estimate:
 *             return P.new_gen(ground(x.g))             # <<<<<<<<<<<<<<
 *         y = P.new_gen(grndtoi(x.g, &e))
 *         return y, e
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ground(__pyx_v_x->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":3528
 *         if not estimate:
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))             # <<<<<<<<<<<<<<
 *         return y, e
 * 
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, grndtoi(__pyx_v_x->g, (&__pyx_v_e)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_y = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":3529
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))
 *         return y, e             # <<<<<<<<<<<<<<
 * 
 *     def simplify(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_e); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_y));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3475
 *         return P.new_gen(greal(x.g))
 * 
 *     def round(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         round(x,estimate=False): If x is a real number, returns x rounded
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen.gen.round", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_y);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3531
 *         return y, e
 * 
 *     def simplify(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         simplify(x): Simplify the object x as much as possible, and return
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_237simplify(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_236simplify[] = "\n        simplify(x): Simplify the object x as much as possible, and return\n        the result.\n\n        A complex or quadratic number whose imaginary part is an exact 0\n        (i.e., not an approximate one such as O(3) or 0.E-28) is converted\n        to its real part, and a a polynomial of degree 0 is converted to\n        its constant term. Simplification occurs recursively.\n\n        This function is useful before using arithmetic functions, which\n        expect integer arguments:\n\n        EXAMPLES::\n\n            sage: y = pari('y')\n            sage: x = pari('9') + y - y\n            sage: x\n            9\n            sage: x.type()\n            't_POL'\n            sage: x.factor()\n            matrix(0,2)\n            sage: pari('9').factor()\n            Mat([3, 2])\n            sage: x.simplify()\n            9\n            sage: x.simplify().factor()\n            Mat([3, 2])\n            sage: x = pari('1.5 + 0*I')\n            sage: x.type()\n            't_REAL'\n            sage: x.simplify()\n            1.50000000000000\n            sage: y = x.simplify()\n            sage: y.type()\n            't_REAL'\n        ";
  static PyObject *__pyx_pw_3gen_3gen_237simplify(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("simplify (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_236simplify(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_236simplify(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("simplify", 0);

    /* "gen.pyx":3569
 *             't_REAL'
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(simplify(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3570
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(simplify(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def sizeword(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, simplify(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3531
 *         return y, e
 * 
 *     def simplify(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         simplify(x): Simplify the object x as much as possible, and return
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.simplify", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3572
 *         return P.new_gen(simplify(x.g))
 * 
 *     def sizeword(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of machine words occupied by the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_239sizeword(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_238sizeword[] = "\n        Return the total number of machine words occupied by the\n        complete tree of the object x.  A machine word is 32 or\n        64 bits, depending on the computer.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT: int (a Python int)\n\n        EXAMPLES::\n\n            sage: pari('0').sizeword()\n            2\n            sage: pari('1').sizeword()\n            3\n            sage: pari('1000000').sizeword()\n            3\n            sage: pari('10^100').sizeword()\n            13      # 32-bit\n            8       # 64-bit\n            sage: pari(RDF(1.0)).sizeword()\n            4       # 32-bit\n            3       # 64-bit\n            sage: pari('x').sizeword()\n            9\n            sage: pari('x^20').sizeword()\n            66\n            sage: pari('[x, I]').sizeword()\n            20\n        ";
  static PyObject *__pyx_pw_3gen_3gen_239sizeword(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizeword (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_238sizeword(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_238sizeword(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizeword", 0);

    /* "gen.pyx":3605
 *             20
 *         """
 *         return gsizeword(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def sizebyte(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(gsizeword(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3572
 *         return P.new_gen(simplify(x.g))
 * 
 *     def sizeword(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of machine words occupied by the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.sizeword", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3607
 *         return gsizeword(x.g)
 * 
 *     def sizebyte(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of bytes occupied by the complete tree
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_241sizebyte(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_240sizebyte[] = "\n        Return the total number of bytes occupied by the complete tree\n        of the object x. Note that this number depends on whether the\n        computer is 32-bit or 64-bit.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT: int (a Python int)\n\n        EXAMPLE::\n\n            sage: pari('1').sizebyte()\n            12           # 32-bit\n            24           # 64-bit\n        ";
  static PyObject *__pyx_pw_3gen_3gen_241sizebyte(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizebyte (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_240sizebyte(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_240sizebyte(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizebyte", 0);

    /* "gen.pyx":3625
 *             24           # 64-bit
 *         """
 *         return gsizebyte(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def sizedigit(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(gsizebyte(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3607
 *         return gsizeword(x.g)
 * 
 *     def sizebyte(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of bytes occupied by the complete tree
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.sizebyte", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3627
 *         return gsizebyte(x.g)
 * 
 *     def sizedigit(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         sizedigit(x): Return a quick estimate for the maximal number of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_243sizedigit(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_242sizedigit[] = "\n        sizedigit(x): Return a quick estimate for the maximal number of\n        decimal digits before the decimal point of any component of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``int`` - Python integer\n\n\n        EXAMPLES::\n\n            sage: x = pari('10^100')\n            sage: x.Str().length()\n            101\n            sage: x.sizedigit()\n            101\n\n        Note that digits after the decimal point are ignored.\n\n        ::\n\n            sage: x = pari('1.234')\n            sage: x\n            1.23400000000000\n            sage: x.sizedigit()\n            1\n\n        The estimate can be one too big::\n\n            sage: pari('7234.1').sizedigit()\n            4\n            sage: pari('9234.1').sizedigit()\n            5\n        ";
  static PyObject *__pyx_pw_3gen_3gen_243sizedigit(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizedigit (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_242sizedigit(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_242sizedigit(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizedigit", 0);

    /* "gen.pyx":3669
 *             5
 *         """
 *         return sizedigit(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def truncate(gen x, estimate=False):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(sizedigit(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3627
 *         return gsizebyte(x.g)
 * 
 *     def sizedigit(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         sizedigit(x): Return a quick estimate for the maximal number of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.sizedigit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3671
 *         return sizedigit(x.g)
 * 
 *     def truncate(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         truncate(x,estimate=False): Return the truncation of x. If estimate
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_245truncate(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_244truncate[] = "\n        truncate(x,estimate=False): Return the truncation of x. If estimate\n        is True, also return the number of error bits.\n\n        When x is in the real numbers, this means that the part after the\n        decimal point is chopped away, e is the binary exponent of the\n        difference between the original and truncated value (the\n        \"fractional part\"). If x is a rational function, the result is the\n        integer part (Euclidean quotient of numerator by denominator) and\n        if requested the error estimate is 0.\n\n        When truncate is applied to a power series (in X), it transforms it\n        into a polynomial or a rational function with denominator a power\n        of X, by chopping away the `O(X^k)`. Similarly, when\n        applied to a p-adic number, it transforms it into an integer or a\n        rational number by chopping away the `O(p^k)`.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``estimate`` - (optional) bool, which is False by\n           default\n\n\n        OUTPUT:\n\n        - if estimate is False, return a single gen.\n\n        - if estimate is True, return rounded version of x and error\n          estimate in bits, both as gens.\n\n        EXAMPLES::\n\n            sage: pari('(x^2+1)/x').round()\n            (x^2 + 1)/x\n            sage: pari('(x^2+1)/x').truncate()\n            x\n            sage: pari('1.043').truncate()\n            1\n            sage: pari('1.043').truncate(True)\n            (1, -5)\n            sage: pari('1.6').truncate()\n            1\n            sage: pari('1.6').round()\n            2\n            sage: pari('1/3 + 2 + 3^2 + O(3^3)').truncate()\n            34/3\n            sage: pari('sin(x+O(x^10))').truncate()\n            1/362880*x^9 - 1/5040*x^7 + 1/120*x^5 - 1/6*x^3 + x\n            sage: pari('sin(x+O(x^10))').round()   # each coefficient has abs < 1\n            x + O(x^10)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_245truncate(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_estimate = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("truncate (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_estimate,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_False);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_estimate);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "truncate") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3671; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_estimate = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("truncate", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3671; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.truncate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_244truncate(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_estimate);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_244truncate(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_estimate) {
    long __pyx_v_e;
    struct __pyx_obj_3gen_gen *__pyx_v_y = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("truncate", 0);

    /* "gen.pyx":3728
 *         cdef long e
 *         cdef gen y
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3729
 *         cdef gen y
 *         pari_catch_sig_on()
 *         if not estimate:             # <<<<<<<<<<<<<<
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_estimate); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((!__pyx_t_2) != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":3730
 *         pari_catch_sig_on()
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))             # <<<<<<<<<<<<<<
 *         y = P.new_gen(gcvtoi(x.g, &e))
 *         return y, e
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtrunc(__pyx_v_x->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":3731
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))             # <<<<<<<<<<<<<<
 *         return y, e
 * 
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gcvtoi(__pyx_v_x->g, (&__pyx_v_e)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_y = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":3732
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))
 *         return y, e             # <<<<<<<<<<<<<<
 * 
 *     def valuation(gen x, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_e); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_y));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3671
 *         return sizedigit(x.g)
 * 
 *     def truncate(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         truncate(x,estimate=False): Return the truncation of x. If estimate
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen.gen.truncate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_y);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3734
 *         return y, e
 * 
 *     def valuation(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         valuation(x,p): Return the valuation of x with respect to p.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_247valuation(PyObject *__pyx_v_x, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_246valuation[] = "\n        valuation(x,p): Return the valuation of x with respect to p.\n\n        The valuation is the highest exponent of p dividing x.\n\n        - If p is an integer, x must be an integer, an intmod whose\n          modulus is divisible by p, a rational number, a p-adic\n          number, or a polynomial or power series in which case the\n          valuation is the minimum of the valuations of the\n          coefficients.\n\n        - If p is a polynomial, x must be a polynomial or a rational\n          function. If p is a monomial then x may also be a power\n          series.\n\n        - If x is a vector, complex or quadratic number, then the\n          valuation is the minimum of the component valuations.\n\n        - If x = 0, the result is `2^31-1` on 32-bit machines or\n          `2^63-1` on 64-bit machines if x is an exact\n          object. If x is a p-adic number or power series, the result\n          is the exponent of the zero.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``p`` - coercible to gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES::\n\n            sage: pari(9).valuation(3)\n            2\n            sage: pari(9).valuation(9)\n            1\n            sage: x = pari(9).Mod(27); x.valuation(3)\n            2\n            sage: pari('5/3').valuation(3)\n            -1\n            sage: pari('9 + 3*x + 15*x^2').valuation(3)\n            1\n            sage: pari([9,3,15]).valuation(3)\n            1\n            sage: pari('9 + 3*x + 15*x^2 + O(x^5)').valuation(3)\n            1\n\n        ::\n\n            sage: pari('x^2*(x+1)^3').valuation(pari('x+1'))\n            3\n            sage: pari('x + O(x^5)').valuation('x')\n            1\n            sage: pari('2*x^2 + O(x^5)').valuation('x')\n            2\n\n        ::\n\n            sage: pari(0).valuation(3)\n            2147483647            # 32-bit\n            9223372036854775807   # 64-bit\n        ";
  static PyObject *__pyx_pw_3gen_3gen_247valuation(PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("valuation (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_246valuation(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_246valuation(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("valuation", 0);

    /* "gen.pyx":3804
 *             9223372036854775807   # 64-bit
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         v = ggval(x.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":3805
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         v = ggval(x.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3806
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         v = ggval(x.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return v
 */
    __pyx_v_v = ggval(__pyx_v_x->g, __pyx_v_t0->g);

    /* "gen.pyx":3807
 *         pari_catch_sig_on()
 *         v = ggval(x.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":3808
 *         v = ggval(x.g, t0.g)
 *         pari_catch_sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def _valp(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3734
 *         return y, e
 * 
 *     def valuation(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         valuation(x,p): Return the valuation of x with respect to p.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.valuation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3810
 *         return v
 * 
 *     def _valp(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the valuation of x where x is a p-adic number (t_PADIC)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_249_valp(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_248_valp[] = "\n        Return the valuation of x where x is a p-adic number (t_PADIC)\n        or a Laurent series (t_SER).  If x is a different type, this\n        will give a bogus number.\n\n        EXAMPLES::\n\n            sage: pari('1/x^2 + O(x^10)')._valp()\n            -2\n            sage: pari('O(x^10)')._valp()\n            10\n            sage: pari('(1145234796 + O(3^10))/771966234')._valp()\n            -2\n            sage: pari('O(2^10)')._valp()\n            10\n            sage: pari('x')._valp()   # random\n            -35184372088832\n        ";
  static PyObject *__pyx_pw_3gen_3gen_249_valp(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("_valp (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_248_valp(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_248_valp(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_valp", 0);

    /* "gen.pyx":3830
 *         """
 *         # This is a simple macro, so we don't need pari_catch_sig_on()
 *         return valp(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def variable(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(valp(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3810
 *         return v
 * 
 *     def _valp(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the valuation of x where x is a p-adic number (t_PADIC)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen._valp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3832
 *         return valp(x.g)
 * 
 *     def variable(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         variable(x): Return the main variable of the object x, or p if x is
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_251variable(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_250variable[] = "\n        variable(x): Return the main variable of the object x, or p if x is\n        a p-adic number.\n\n        This function raises a TypeError exception on scalars, i.e., on\n        objects with no variable associated to them.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('x^2 + x -2').variable()\n            x\n            sage: pari('1+2^3 + O(2^5)').variable()\n            2\n            sage: pari('x+y0').variable()\n            x\n            sage: pari('y0+z0').variable()\n            y0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_251variable(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("variable (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_250variable(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_250variable(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("variable", 0);

    /* "gen.pyx":3859
 *             y0
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gpolvar(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3860
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gpolvar(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gpolvar(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3832
 *         return valp(x.g)
 * 
 *     def variable(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         variable(x): Return the main variable of the object x, or p if x is
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.variable", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3869
 *     ###########################################
 * 
 *     def abs(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the absolute value of x (its modulus, if x is complex).
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_253abs(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_252abs[] = "\n        Returns the absolute value of x (its modulus, if x is complex).\n        Rational functions are not allowed. Contrary to most transcendental\n        functions, an exact argument is not converted to a real number\n        before applying abs and an exact result is returned if possible.\n\n        EXAMPLES::\n\n            sage: x = pari(\"-27.1\")\n            sage: x.abs()\n            27.1000000000000\n            sage: pari('1 + I').abs(precision=128).sage()\n            1.4142135623730950488016887242096980786\n\n        If x is a polynomial, returns -x if the leading coefficient is real\n        and negative else returns x. For a power series, the constant\n        coefficient is considered instead.\n\n        EXAMPLES::\n\n            sage: pari('x-1.2*x^2').abs()\n            1.20000000000000*x^2 - x\n            sage: pari('-2 + t + O(t^2)').abs()\n            2 - t + O(t^2)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_253abs(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("abs (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "abs") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("abs", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.abs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_252abs(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_252abs(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("abs", 0);

    /* "gen.pyx":3895
 *             2 - t + O(t^2)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gabs(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3896
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gabs(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def acos(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gabs(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3896; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3869
 *     ###########################################
 * 
 *     def abs(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the absolute value of x (its modulus, if x is complex).
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.abs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3898
 *         return P.new_gen(gabs(x.g, prec_bits_to_words(precision)))
 * 
 *     def acos(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cos^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_255acos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_254acos[] = "\n        The principal branch of `\\cos^{-1}(x)`, so that\n        `\\RR e(\\mathrm{acos}(x))` belongs to `[0,Pi]`. If `x`\n        is real and `|x| > 1`, then `\\mathrm{acos}(x)` is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).acos()\n            1.04719755119660\n            sage: pari(1/2).acos()\n            1.04719755119660\n            sage: pari(1.1).acos()\n            0.443568254385115*I\n            sage: C.<i> = ComplexField()\n            sage: pari(1.1+i).acos()\n            0.849343054245252 - 1.09770986682533*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_255acos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("acos (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "acos") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3898; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3898; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("acos", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3898; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.acos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_254acos(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_254acos(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("acos", 0);

    /* "gen.pyx":3921
 *             0.849343054245252 - 1.09770986682533*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gacos(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3921; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3922
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gacos(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def acosh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gacos(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3898
 *         return P.new_gen(gabs(x.g, prec_bits_to_words(precision)))
 * 
 *     def acos(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cos^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.acos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3924
 *         return P.new_gen(gacos(x.g, prec_bits_to_words(precision)))
 * 
 *     def acosh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cosh^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_257acosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_256acosh[] = "\n        The principal branch of `\\cosh^{-1}(x)`, so that\n        `\\Im(\\mathrm{acosh}(x))` belongs to `[0,Pi]`. If\n        `x` is real and `x < 1`, then\n        `\\mathrm{acosh}(x)` is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).acosh()\n            1.31695789692482\n            sage: pari(0).acosh()\n            1.57079632679490*I\n            sage: C.<i> = ComplexField()\n            sage: pari(i).acosh()\n            0.881373587019543 + 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_257acosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("acosh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "acosh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3924; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3924; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("acosh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3924; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.acosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_256acosh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_256acosh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("acosh", 0);

    /* "gen.pyx":3946
 *             0.881373587019543 + 1.57079632679490*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gach(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3947
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gach(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def agm(gen x, y, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gach(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3947; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3924
 *         return P.new_gen(gacos(x.g, prec_bits_to_words(precision)))
 * 
 *     def acosh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cosh^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.acosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3949
 *         return P.new_gen(gach(x.g, prec_bits_to_words(precision)))
 * 
 *     def agm(gen x, y, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The arithmetic-geometric mean of x and y. In the case of complex or
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_259agm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_258agm[] = "\n        The arithmetic-geometric mean of x and y. In the case of complex or\n        negative numbers, the principal square root is always chosen.\n        p-adic or power series arguments are also allowed. Note that a\n        p-adic AGM exists only if x/y is congruent to 1 modulo p (modulo 16\n        for p=2). x and y cannot both be vectors or matrices.\n\n        If any of `x` or `y` is an exact argument, it is\n        first converted to a real or complex number using the optional\n        parameter precision (in bits). If the arguments are inexact (e.g.\n        real), the smallest of their two precisions is used in the\n        computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).agm(2)\n            2.00000000000000\n            sage: pari(0).agm(1)\n            0\n            sage: pari(1).agm(2)\n            1.45679103104691\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).agm(-3)\n            -0.964731722290876 + 1.15700282952632*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_259agm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("agm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "agm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3949; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3949; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("agm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3949; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.agm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_258agm(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_258agm(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("agm", 0);

    /* "gen.pyx":3975
 *             -0.964731722290876 + 1.15700282952632*I
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(agm(x.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":3976
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(agm(x.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3977
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(agm(x.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def arg(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, agm(__pyx_v_x->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3977; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3949
 *         return P.new_gen(gach(x.g, prec_bits_to_words(precision)))
 * 
 *     def agm(gen x, y, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The arithmetic-geometric mean of x and y. In the case of complex or
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.agm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3979
 *         return P.new_gen(agm(x.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def arg(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         arg(x): argument of x,such that `-\pi < \arg(x) \leq \pi`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_261arg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_260arg[] = "\n        arg(x): argument of x,such that `-\\pi < \\arg(x) \\leq \\pi`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).arg()\n            0.463647609000806\n        ";
  static PyObject *__pyx_pw_3gen_3gen_261arg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("arg (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "arg") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("arg", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3979; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.arg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_260arg(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_260arg(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("arg", 0);

    /* "gen.pyx":3994
 *             0.463647609000806
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(garg(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":3995
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(garg(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def asin(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, garg(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3995; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3979
 *         return P.new_gen(agm(x.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def arg(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         arg(x): argument of x,such that `-\pi < \arg(x) \leq \pi`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.arg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":3997
 *         return P.new_gen(garg(x.g, prec_bits_to_words(precision)))
 * 
 *     def asin(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sin^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_263asin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_262asin[] = "\n        The principal branch of `\\sin^{-1}(x)`, so that\n        `\\RR e(\\mathrm{asin}(x))` belongs to `[-\\pi/2,\\pi/2]`. If\n        `x` is real and `|x| > 1` then `\\mathrm{asin}(x)`\n        is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(pari(0.5).sin()).asin()\n            0.500000000000000\n            sage: pari(2).asin()\n            1.57079632679490 - 1.31695789692482*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_263asin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("asin (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asin") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3997; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3997; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("asin", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3997; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.asin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_262asin(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_262asin(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("asin", 0);

    /* "gen.pyx":4016
 *             1.57079632679490 - 1.31695789692482*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gasin(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4017
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gasin(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def asinh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gasin(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4017; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":3997
 *         return P.new_gen(garg(x.g, prec_bits_to_words(precision)))
 * 
 *     def asin(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sin^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.asin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4019
 *         return P.new_gen(gasin(x.g, prec_bits_to_words(precision)))
 * 
 *     def asinh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sinh^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_265asinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_264asinh[] = "\n        The principal branch of `\\sinh^{-1}(x)`, so that\n        `\\Im(\\mathrm{asinh}(x))` belongs to `[-\\pi/2,\\pi/2]`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).asinh()\n            1.44363547517881\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).asinh()\n            1.52857091948100 + 0.427078586392476*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_265asinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("asinh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asinh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4019; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4019; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("asinh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4019; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.asinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_264asinh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_264asinh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("asinh", 0);

    /* "gen.pyx":4037
 *             1.52857091948100 + 0.427078586392476*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gash(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4037; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4038
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gash(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def atan(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gash(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4038; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4019
 *         return P.new_gen(gasin(x.g, prec_bits_to_words(precision)))
 * 
 *     def asinh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sinh^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.asinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4040
 *         return P.new_gen(gash(x.g, prec_bits_to_words(precision)))
 * 
 *     def atan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tan^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_267atan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_266atan[] = "\n        The principal branch of `\\tan^{-1}(x)`, so that\n        `\\RR e(\\mathrm{atan}(x))` belongs to `]-\\pi/2, \\pi/2[`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).atan()\n            0.785398163397448\n            sage: C.<i> = ComplexField()\n            sage: pari(1.5+i).atan()\n            1.10714871779409 + 0.255412811882995*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_267atan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("atan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "atan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4040; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4040; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("atan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4040; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.atan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_266atan(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_266atan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("atan", 0);

    /* "gen.pyx":4058
 *             1.10714871779409 + 0.255412811882995*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gatan(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4059
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gatan(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def atanh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gatan(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4059; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4040
 *         return P.new_gen(gash(x.g, prec_bits_to_words(precision)))
 * 
 *     def atan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tan^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.atan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4061
 *         return P.new_gen(gatan(x.g, prec_bits_to_words(precision)))
 * 
 *     def atanh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tanh^{-1}(x)`, so that
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_269atanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_268atanh[] = "\n        The principal branch of `\\tanh^{-1}(x)`, so that\n        `\\Im(\\mathrm{atanh}(x))` belongs to `]-\\pi/2,\\pi/2]`. If\n        `x` is real and `|x| > 1` then `\\mathrm{atanh}(x)`\n        is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).atanh()\n            0.E-19\n            sage: pari(2).atanh()\n            0.549306144334055 - 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_269atanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("atanh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "atanh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4061; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4061; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("atanh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4061; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.atanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_268atanh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_268atanh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("atanh", 0);

    /* "gen.pyx":4080
 *             0.549306144334055 - 1.57079632679490*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gath(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4081
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gath(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bernfrac(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gath(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4061
 *         return P.new_gen(gatan(x.g, prec_bits_to_words(precision)))
 * 
 *     def atanh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tanh^{-1}(x)`, so that
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.atanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4083
 *         return P.new_gen(gath(x.g, prec_bits_to_words(precision)))
 * 
 *     def bernfrac(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, where `B_0 = 1`,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_271bernfrac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_270bernfrac[] = "\n        The Bernoulli number `B_x`, where `B_0 = 1`,\n        `B_1 = -1/2`, `B_2 = 1/6,\\ldots,` expressed as a\n        rational number. The argument `x` should be of type\n        integer.\n\n        EXAMPLES::\n\n            sage: pari(18).bernfrac()\n            43867/798\n            sage: [pari(n).bernfrac() for n in range(10)]\n            [1, -1/2, 1/6, 0, -1/30, 0, 1/42, 0, -1/30, 0]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_271bernfrac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernfrac (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_270bernfrac(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_270bernfrac(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernfrac", 0);

    /* "gen.pyx":4097
 *             [1, -1/2, 1/6, 0, -1/30, 0, 1/42, 0, -1/30, 0]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bernfrac(x))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4098
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bernfrac(x))             # <<<<<<<<<<<<<<
 * 
 *     def bernreal(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_As_long(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bernfrac(__pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4083
 *         return P.new_gen(gath(x.g, prec_bits_to_words(precision)))
 * 
 *     def bernfrac(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, where `B_0 = 1`,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.bernfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4100
 *         return P.new_gen(bernfrac(x))
 * 
 *     def bernreal(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, as for the function bernfrac,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_273bernreal(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_272bernreal[] = "\n        The Bernoulli number `B_x`, as for the function bernfrac,\n        but `B_x` is returned as a real number (with the current\n        precision).\n\n        EXAMPLES::\n\n            sage: pari(18).bernreal()\n            54.9711779448622\n            sage: pari(18).bernreal(precision=192).sage()\n            54.9711779448621553884711779448621553884711779448621553885\n        ";
  static PyObject *__pyx_pw_3gen_3gen_273bernreal(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernreal (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bernreal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4100; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4100; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bernreal", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4100; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bernreal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_272bernreal(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_272bernreal(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernreal", 0);

    /* "gen.pyx":4113
 *             54.9711779448621553884711779448621553884711779448621553885
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bernreal(x, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4114
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bernreal(x, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bernvec(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_As_long(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bernreal(__pyx_t_2, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4100
 *         return P.new_gen(bernfrac(x))
 * 
 *     def bernreal(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, as for the function bernfrac,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.bernreal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4116
 *         return P.new_gen(bernreal(x, prec_bits_to_words(precision)))
 * 
 *     def bernvec(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Creates a vector containing, as rational numbers, the Bernoulli
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_275bernvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_274bernvec[] = "\n        Creates a vector containing, as rational numbers, the Bernoulli\n        numbers `B_0, B_2,\\ldots, B_{2x}`. This routine is\n        obsolete. Use bernfrac instead each time you need a Bernoulli\n        number in exact form.\n\n        Note: this routine is implemented using repeated independent calls\n        to bernfrac, which is faster than the standard recursion in exact\n        arithmetic.\n\n        EXAMPLES::\n\n            sage: pari(8).bernvec()\n            [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]\n            sage: [pari(2*n).bernfrac() for n in range(9)]\n            [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_275bernvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernvec (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_274bernvec(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_274bernvec(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernvec", 0);

    /* "gen.pyx":4134
 *             [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bernvec(x))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4135
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(bernvec(x))             # <<<<<<<<<<<<<<
 * 
 *     def besselh1(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_As_long(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bernvec(__pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4116
 *         return P.new_gen(bernreal(x, prec_bits_to_words(precision)))
 * 
 *     def bernvec(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Creates a vector containing, as rational numbers, the Bernoulli
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.bernvec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4137
 *         return P.new_gen(bernvec(x))
 * 
 *     def besselh1(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^1`-Bessel function of index `\nu` and
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_277besselh1(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_276besselh1[] = "\n        The `H^1`-Bessel function of index `\\nu` and\n        argument `x`.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselh1(3)\n            0.486091260585891 - 0.160400393484924*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_277besselh1(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselh1 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselh1") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4137; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4137; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselh1", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4137; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besselh1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_276besselh1(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_276besselh1(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselh1", 0);

    /* "gen.pyx":4153
 *             0.486091260585891 - 0.160400393484924*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(hbessel1(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4154
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hbessel1(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4155
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(hbessel1(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselh2(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hbessel1(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4137
 *         return P.new_gen(bernvec(x))
 * 
 *     def besselh1(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^1`-Bessel function of index `\nu` and
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besselh1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4157
 *         return P.new_gen(hbessel1(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselh2(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^2`-Bessel function of index `\nu` and
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_279besselh2(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_278besselh2[] = "\n        The `H^2`-Bessel function of index `\\nu` and\n        argument `x`.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselh2(3)\n            0.486091260585891 + 0.160400393484924*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_279besselh2(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselh2 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselh2") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselh2", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besselh2", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_278besselh2(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_278besselh2(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselh2", 0);

    /* "gen.pyx":4173
 *             0.486091260585891 + 0.160400393484924*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(hbessel2(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4174
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hbessel2(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4175
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(hbessel2(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselj(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hbessel2(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4157
 *         return P.new_gen(hbessel1(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselh2(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^2`-Bessel function of index `\nu` and
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besselh2", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4177
 *         return P.new_gen(hbessel2(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselj(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel J function (Bessel function of the first kind), with index
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_281besselj(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_280besselj[] = "\n        Bessel J function (Bessel function of the first kind), with index\n        `\\nu` and argument `x`. If `x` converts to\n        a power series, the initial factor\n        `(x/2)^{\\nu}/\\Gamma(\\nu+1)` is omitted (since it cannot be\n        represented in PARI when `\\nu` is not integral).\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselj(3)\n            0.486091260585891\n        ";
  static PyObject *__pyx_pw_3gen_3gen_281besselj(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselj (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselj") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4177; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4177; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselj", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4177; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besselj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_280besselj(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_280besselj(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselj", 0);

    /* "gen.pyx":4196
 *             0.486091260585891
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(jbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4197
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4198
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(jbessel(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseljh(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, jbessel(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4177
 *         return P.new_gen(hbessel2(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselj(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel J function (Bessel function of the first kind), with index
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besselj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4200
 *         return P.new_gen(jbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseljh(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         J-Bessel function of half integral index (Spherical Bessel
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_283besseljh(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_282besseljh[] = "\n        J-Bessel function of half integral index (Spherical Bessel\n        function of the first kind). More precisely, besseljh(n,x) computes\n        `J_{n+1/2}(x)` where n must an integer, and x is any\n        complex value. In the current implementation (PARI, version\n        2.2.11), this function is not very accurate when `x` is\n        small.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besseljh(3)\n            0.4127100324          # 32-bit\n            0.412710032209716     # 64-bit\n        ";
  static PyObject *__pyx_pw_3gen_3gen_283besseljh(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseljh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseljh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseljh", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4200; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besseljh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_282besseljh(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_282besseljh(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseljh", 0);

    /* "gen.pyx":4221
 *             0.412710032209716     # 64-bit
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(jbesselh(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4222
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jbesselh(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4223
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(jbesselh(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseli(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, jbesselh(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4200
 *         return P.new_gen(jbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseljh(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         J-Bessel function of half integral index (Spherical Bessel
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besseljh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4225
 *         return P.new_gen(jbesselh(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseli(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel I function (Bessel function of the second kind), with index
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_285besseli(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_284besseli[] = "\n        Bessel I function (Bessel function of the second kind), with index\n        `\\nu` and argument `x`. If `x` converts to\n        a power series, the initial factor\n        `(x/2)^{\\nu}/\\Gamma(\\nu+1)` is omitted (since it cannot be\n        represented in PARI when `\\nu` is not integral).\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besseli(3)\n            2.24521244092995\n            sage: C.<i> = ComplexField()\n            sage: pari(2).besseli(3+i)\n            1.12539407613913 + 2.08313822670661*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_285besseli(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseli (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseli") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4225; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4225; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseli", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4225; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besseli", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_284besseli(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_284besseli(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseli", 0);

    /* "gen.pyx":4247
 *             1.12539407613913 + 2.08313822670661*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ibessel(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4248
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ibessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4249
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(ibessel(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselk(gen nu, x, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ibessel(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4225
 *         return P.new_gen(jbesselh(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseli(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel I function (Bessel function of the second kind), with index
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besseli", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4251
 *         return P.new_gen(ibessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselk(gen nu, x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besselk(x, flag=0): K-Bessel function (modified Bessel function
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_287besselk(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_286besselk[] = "\n        nu.besselk(x, flag=0): K-Bessel function (modified Bessel function\n        of the second kind) of index nu, which can be complex, and argument\n        x.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        INPUT:\n\n\n        -  ``nu`` - a complex number\n\n        -  ``x`` - real number (positive or negative)\n\n        -  ``flag`` - default: 0 or 1: use hyperu (hyperu is\n           much slower for small x, and doesn't work for negative x).\n\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).besselk(3)\n            0.0455907718407551 + 0.0289192946582081*I\n\n        ::\n\n            sage: pari(2+i).besselk(-3)\n            -4.34870874986752 - 5.38744882697109*I\n\n        ::\n\n            sage: pari(2+i).besselk(300, flag=1)\n            3.74224603319728 E-132 + 2.49071062641525 E-134*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_287besselk(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    CYTHON_UNUSED long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselk (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselk", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4251; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_286besselk(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_286besselk(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselk", 0);

    /* "gen.pyx":4290
 *             3.74224603319728 E-132 + 2.49071062641525 E-134*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(kbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4291
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(kbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4292
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(kbessel(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseln(gen nu, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, kbessel(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4251
 *         return P.new_gen(ibessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besselk(gen nu, x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besselk(x, flag=0): K-Bessel function (modified Bessel function
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4294
 *         return P.new_gen(kbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseln(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besseln(x): Bessel N function (Spherical Bessel function of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_289besseln(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_288besseln[] = "\n        nu.besseln(x): Bessel N function (Spherical Bessel function of the\n        second kind) of index nu and argument x.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).besseln(3)\n            -0.280775566958244 - 0.486708533223726*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_289besseln(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseln (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseln") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseln", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4294; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.besseln", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_288besseln(((struct __pyx_obj_3gen_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_288besseln(struct __pyx_obj_3gen_gen *__pyx_v_nu, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseln", 0);

    /* "gen.pyx":4311
 *             -0.280775566958244 - 0.486708533223726*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4312
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4313
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(nbessel(nu.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cos(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nbessel(__pyx_v_nu->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4294
 *         return P.new_gen(kbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def besseln(gen nu, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besseln(x): Bessel N function (Spherical Bessel function of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.besseln", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4315
 *         return P.new_gen(nbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def cos(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cosine function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_291cos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_290cos[] = "\n        The cosine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1.5).cos()\n            0.0707372016677029\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).cos()\n            0.833730025131149 - 0.988897705762865*I\n            sage: pari('x+O(x^8)').cos()\n            1 - 1/2*x^2 + 1/24*x^4 - 1/720*x^6 + 1/40320*x^8 + O(x^9)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_291cos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cos (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cos") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4315; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4315; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cos", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4315; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.cos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_290cos(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_290cos(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cos", 0);

    /* "gen.pyx":4334
 *             1 - 1/2*x^2 + 1/24*x^4 - 1/720*x^6 + 1/40320*x^8 + O(x^9)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcos(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4335
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gcos(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cosh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gcos(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4315
 *         return P.new_gen(nbessel(nu.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def cos(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cosine function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.cos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4337
 *         return P.new_gen(gcos(x.g, prec_bits_to_words(precision)))
 * 
 *     def cosh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic cosine function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_293cosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_292cosh[] = "\n        The hyperbolic cosine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1.5).cosh()\n            2.35240961524325\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).cosh()\n            0.833730025131149 + 0.988897705762865*I\n            sage: pari('x+O(x^8)').cosh()\n            1 + 1/2*x^2 + 1/24*x^4 + 1/720*x^6 + O(x^8)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_293cosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cosh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cosh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4337; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4337; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cosh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4337; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.cosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_292cosh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_292cosh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cosh", 0);

    /* "gen.pyx":4356
 *             1 + 1/2*x^2 + 1/24*x^4 + 1/720*x^6 + O(x^8)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gch(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4357
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gch(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cotan(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gch(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4337
 *         return P.new_gen(gcos(x.g, prec_bits_to_words(precision)))
 * 
 *     def cosh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic cosine function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.cosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4359
 *         return P.new_gen(gch(x.g, prec_bits_to_words(precision)))
 * 
 *     def cotan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cotangent of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_295cotan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_294cotan[] = "\n        The cotangent of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(5).cotan()\n            -0.295812915532746\n\n        Computing the cotangent of `\\pi` doesn't raise an error,\n        but instead just returns a very large (positive or negative)\n        number.\n\n        ::\n\n            sage: x = RR(pi)\n            sage: pari(x).cotan()         # random\n            -8.17674825 E15\n        ";
  static PyObject *__pyx_pw_3gen_3gen_295cotan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cotan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cotan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cotan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.cotan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_294cotan(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_294cotan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cotan", 0);

    /* "gen.pyx":4383
 *             -8.17674825 E15
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcotan(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4384
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gcotan(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def dilog(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gcotan(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4359
 *         return P.new_gen(gch(x.g, prec_bits_to_words(precision)))
 * 
 *     def cotan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cotangent of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.cotan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4386
 *         return P.new_gen(gcotan(x.g, prec_bits_to_words(precision)))
 * 
 *     def dilog(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of the dilogarithm of `x`, i.e. the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_297dilog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_296dilog[] = "\n        The principal branch of the dilogarithm of `x`, i.e. the\n        analytic continuation of the power series\n        `\\log_2(x) = \\sum_{n>=1} x^n/n^2`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).dilog()\n            1.64493406684823\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).dilog()\n            0.616850275068085 + 1.46036211675312*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_297dilog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("dilog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dilog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("dilog", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4386; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.dilog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_296dilog(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_296dilog(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("dilog", 0);

    /* "gen.pyx":4405
 *             0.616850275068085 + 1.46036211675312*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(dilog(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4406
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(dilog(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def eint1(gen x, long n=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, dilog(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4386
 *         return P.new_gen(gcotan(x.g, prec_bits_to_words(precision)))
 * 
 *     def dilog(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of the dilogarithm of `x`, i.e. the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.dilog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4408
 *         return P.new_gen(dilog(x.g, prec_bits_to_words(precision)))
 * 
 *     def eint1(gen x, long n=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eint1(n): exponential integral E1(x):
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_299eint1(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_298eint1[] = "\n        x.eint1(n): exponential integral E1(x):\n\n        .. math::\n\n                         \\int_{x}^{\\infty} \\frac{e^{-t}}{t} dt\n\n\n        If n is present, output the vector [eint1(x), eint1(2\\*x), ...,\n        eint1(n\\*x)]. This is faster than repeatedly calling eint1(i\\*x).\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        REFERENCE:\n\n        - See page 262, Prop 5.6.12, of Cohen's book \"A Course in\n          Computational Algebraic Number Theory\".\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_299eint1(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eint1 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eint1") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4408; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4408; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4408; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("eint1", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4408; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.eint1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_298eint1(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_298eint1(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_n, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eint1", 0);

    /* "gen.pyx":4432
 *         EXAMPLES:
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if n <= 0:
 *             return P.new_gen(eint1(x.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4433
 *         """
 *         pari_catch_sig_on()
 *         if n <= 0:             # <<<<<<<<<<<<<<
 *             return P.new_gen(eint1(x.g, prec_bits_to_words(precision)))
 *         else:
 */
    __pyx_t_2 = ((__pyx_v_n <= 0) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":4434
 *         pari_catch_sig_on()
 *         if n <= 0:
 *             return P.new_gen(eint1(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(veceint1(x.g, stoi(n), prec_bits_to_words(precision)))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, eint1(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":4436
 *             return P.new_gen(eint1(x.g, prec_bits_to_words(precision)))
 *         else:
 *             return P.new_gen(veceint1(x.g, stoi(n), prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def erfc(gen x, unsigned long precision=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, veceint1(__pyx_v_x->g, stoi(__pyx_v_n), __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":4408
 *         return P.new_gen(dilog(x.g, prec_bits_to_words(precision)))
 * 
 *     def eint1(gen x, long n=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eint1(n): exponential integral E1(x):
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.eint1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4438
 *             return P.new_gen(veceint1(x.g, stoi(n), prec_bits_to_words(precision)))
 * 
 *     def erfc(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the complementary error function:
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_301erfc(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_300erfc[] = "\n        Return the complementary error function:\n\n        .. math::\n\n            (2/\\sqrt{\\pi}) \\int_{x}^{\\infty} e^{-t^2} dt.\n\n\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).erfc()\n            0.157299207050285\n        ";
  static PyObject *__pyx_pw_3gen_3gen_301erfc(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("erfc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "erfc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("erfc", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4438; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.erfc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_300erfc(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_300erfc(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("erfc", 0);

    /* "gen.pyx":4458
 *             0.157299207050285
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gerfc(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4459
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gerfc(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def eta(gen x, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gerfc(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4438
 *             return P.new_gen(veceint1(x.g, stoi(n), prec_bits_to_words(precision)))
 * 
 *     def erfc(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the complementary error function:
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.erfc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4461
 *         return P.new_gen(gerfc(x.g, prec_bits_to_words(precision)))
 * 
 *     def eta(gen x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eta(flag=0): if flag=0, `\eta` function without the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_303eta(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_302eta[] = "\n        x.eta(flag=0): if flag=0, `\\eta` function without the\n        `q^{1/24}`; otherwise `\\eta` of the complex number\n        `x` in the upper half plane intelligently computed using\n        `\\mathrm{SL}(2,\\ZZ)` transformations.\n\n        DETAILS: This functions computes the following. If the input\n        `x` is a complex number with positive imaginary part, the\n        result is `\\prod_{n=1}^{\\infty} (q-1^n)`, where\n        `q=e^{2 i \\pi x}`. If `x` is a power series\n        (or can be converted to a power series) with positive valuation,\n        the result is `\\prod_{n=1}^{\\infty} (1-x^n)`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(i).eta()\n            0.998129069925959\n        ";
  static PyObject *__pyx_pw_3gen_3gen_303eta(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("eta", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.eta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_302eta(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_302eta(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eta", 0);

    /* "gen.pyx":4486
 *             0.998129069925959
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4487
 *         """
 *         pari_catch_sig_on()
 *         if flag == 1:             # <<<<<<<<<<<<<<
 *             return P.new_gen(trueeta(x.g, prec_bits_to_words(precision)))
 *         return P.new_gen(eta(x.g, prec_bits_to_words(precision)))
 */
    __pyx_t_2 = ((__pyx_v_flag == 1) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":4488
 *         pari_catch_sig_on()
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(eta(x.g, prec_bits_to_words(precision)))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, trueeta(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":4489
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, prec_bits_to_words(precision)))
 *         return P.new_gen(eta(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def exp(gen self, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, eta(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4461
 *         return P.new_gen(gerfc(x.g, prec_bits_to_words(precision)))
 * 
 *     def eta(gen x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eta(flag=0): if flag=0, `\eta` function without the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.eta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4491
 *         return P.new_gen(eta(x.g, prec_bits_to_words(precision)))
 * 
 *     def exp(gen self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.exp(): exponential of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_305exp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_304exp[] = "\n        x.exp(): exponential of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).exp()\n            1.00000000000000\n            sage: pari(1).exp()\n            2.71828182845905\n            sage: pari('x+O(x^8)').exp()\n            1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + 1/720*x^6 + 1/5040*x^7 + O(x^8)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_305exp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("exp (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "exp") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4491; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4491; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("exp", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4491; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.exp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_304exp(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_304exp(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("exp", 0);

    /* "gen.pyx":4509
 *             1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + 1/720*x^6 + 1/5040*x^7 + O(x^8)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gexp(self.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4510
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gexp(self.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def gamma(gen s, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gexp(__pyx_v_self->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4491
 *         return P.new_gen(eta(x.g, prec_bits_to_words(precision)))
 * 
 *     def exp(gen self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.exp(): exponential of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.exp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4512
 *         return P.new_gen(gexp(self.g, prec_bits_to_words(precision)))
 * 
 *     def gamma(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gamma(precision): Gamma function at s.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_307gamma(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_306gamma[] = "\n        s.gamma(precision): Gamma function at s.\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).gamma()\n            1.00000000000000\n            sage: pari(5).gamma()\n            24.0000000000000\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).gamma()\n            0.498015668118356 - 0.154949828301811*I\n\n        TESTS::\n\n            sage: pari(-1).gamma()\n            Traceback (most recent call last):\n            ...\n            PariError: non-positive integer argument in ggamma\n        ";
  static PyObject *__pyx_pw_3gen_3gen_307gamma(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4512; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4512; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4512; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_306gamma(((struct __pyx_obj_3gen_gen *)__pyx_v_s), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_306gamma(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gamma", 0);

    /* "gen.pyx":4538
 *             PariError: non-positive integer argument in ggamma
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ggamma(s.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4539
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ggamma(s.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def gammah(gen s, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ggamma(__pyx_v_s->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4512
 *         return P.new_gen(gexp(self.g, prec_bits_to_words(precision)))
 * 
 *     def gamma(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gamma(precision): Gamma function at s.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4541
 *         return P.new_gen(ggamma(s.g, prec_bits_to_words(precision)))
 * 
 *     def gammah(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gammah(): Gamma function evaluated at the argument x+1/2.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_309gammah(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_308gammah[] = "\n        s.gammah(): Gamma function evaluated at the argument x+1/2.\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).gammah()\n            1.32934038817914\n            sage: pari(5).gammah()\n            52.3427777845535\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).gammah()\n            0.575315188063452 + 0.0882106775440939*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_309gammah(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gammah (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gammah") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4541; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4541; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gammah", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4541; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.gammah", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_308gammah(((struct __pyx_obj_3gen_gen *)__pyx_v_s), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_308gammah(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gammah", 0);

    /* "gen.pyx":4560
 *             0.575315188063452 + 0.0882106775440939*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ggamd(s.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4561
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ggamd(s.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def hyperu(gen a, b, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ggamd(__pyx_v_s->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4541
 *         return P.new_gen(ggamma(s.g, prec_bits_to_words(precision)))
 * 
 *     def gammah(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gammah(): Gamma function evaluated at the argument x+1/2.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.gammah", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4563
 *         return P.new_gen(ggamd(s.g, prec_bits_to_words(precision)))
 * 
 *     def hyperu(gen a, b, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         a.hyperu(b,x): U-confluent hypergeometric function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_311hyperu(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_310hyperu[] = "\n        a.hyperu(b,x): U-confluent hypergeometric function.\n\n        If `a`, `b`, or `x` is an exact argument,\n        it is first converted to a real or complex number using the\n        optional parameter precision (in bits). If the arguments are\n        inexact (e.g. real), the smallest of their precisions is used in\n        the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).hyperu(2,3)\n            0.333333333333333\n        ";
  static PyObject *__pyx_pw_3gen_3gen_311hyperu(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("hyperu (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_b,&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("hyperu", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hyperu") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      __pyx_v_x = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("hyperu", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4563; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.hyperu", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_310hyperu(((struct __pyx_obj_3gen_gen *)__pyx_v_a), __pyx_v_b, __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_310hyperu(struct __pyx_obj_3gen_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("hyperu", 0);

    /* "gen.pyx":4578
 *             0.333333333333333
 *         """
 *         cdef gen t0 = objtogen(b)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4579
 *         """
 *         cdef gen t0 = objtogen(b)
 *         cdef gen t1 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(hyperu(a.g, t0.g, t1.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4580
 *         cdef gen t0 = objtogen(b)
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hyperu(a.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4581
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(hyperu(a.g, t0.g, t1.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def incgam(gen s, x, y=None, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hyperu(__pyx_v_a->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4563
 *         return P.new_gen(ggamd(s.g, prec_bits_to_words(precision)))
 * 
 *     def hyperu(gen a, b, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         a.hyperu(b,x): U-confluent hypergeometric function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.hyperu", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4583
 *         return P.new_gen(hyperu(a.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def incgam(gen s, x, y=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgam(x, y, precision): incomplete gamma function. y is optional
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_313incgam(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_312incgam[] = "\n        s.incgam(x, y, precision): incomplete gamma function. y is optional\n        and is the precomputed value of gamma(s).\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).incgam(3-i)\n            -0.0458297859919946 + 0.0433696818726677*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_313incgam(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("incgam (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "incgam") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4583; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4583; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("incgam", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4583; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.incgam", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_312incgam(((struct __pyx_obj_3gen_gen *)__pyx_v_s), __pyx_v_x, __pyx_v_y, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_312incgam(struct __pyx_obj_3gen_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_y, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("incgam", 0);

    /* "gen.pyx":4599
 *             -0.0458297859919946 + 0.0433696818726677*I
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1
 *         if y is None:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4601
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1
 *         if y is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(incgam(s.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_2 = (__pyx_v_y == Py_None);
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":4602
 *         cdef gen t1
 *         if y is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(incgam(s.g, t0.g, prec_bits_to_words(precision)))
 *         else:
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":4603
 *         if y is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(incgam(s.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             t1 = objtogen(y)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, incgam(__pyx_v_s->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":4605
 *             return P.new_gen(incgam(s.g, t0.g, prec_bits_to_words(precision)))
 *         else:
 *             t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(incgam0(s.g, t0.g, t1.g, prec_bits_to_words(precision)))
 */
      __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":4606
 *         else:
 *             t1 = objtogen(y)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(incgam0(s.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":4607
 *             t1 = objtogen(y)
 *             pari_catch_sig_on()
 *             return P.new_gen(incgam0(s.g, t0.g, t1.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def incgamc(gen s, x, unsigned long precision=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, incgam0(__pyx_v_s->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":4583
 *         return P.new_gen(hyperu(a.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def incgam(gen s, x, y=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgam(x, y, precision): incomplete gamma function. y is optional
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.incgam", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4609
 *             return P.new_gen(incgam0(s.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def incgamc(gen s, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgamc(x): complementary incomplete gamma function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_315incgamc(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_314incgamc[] = "\n        s.incgamc(x): complementary incomplete gamma function.\n\n        The arguments `x` and `s` are complex numbers such\n        that `s` is not a pole of `\\Gamma` and\n        `|x|/(|s|+1)` is not much larger than `1`\n        (otherwise, the convergence is very slow). The function returns the\n        value of the integral\n        `\\int_{0}^{x} e^{-t} t^{s-1} dt.`\n\n        If `s` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).incgamc(2)\n            0.864664716763387\n        ";
  static PyObject *__pyx_pw_3gen_3gen_315incgamc(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("incgamc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "incgamc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("incgamc", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.incgamc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_314incgamc(((struct __pyx_obj_3gen_gen *)__pyx_v_s), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_314incgamc(struct __pyx_obj_3gen_gen *__pyx_v_s, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("incgamc", 0);

    /* "gen.pyx":4631
 *             0.864664716763387
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(incgamc(s.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4632
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(incgamc(s.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4633
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(incgamc(s.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def log(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, incgamc(__pyx_v_s->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4609
 *             return P.new_gen(incgam0(s.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def incgamc(gen s, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgamc(x): complementary incomplete gamma function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.incgamc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4635
 *         return P.new_gen(incgamc(s.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def log(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.log(): natural logarithm of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_317log(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_316log[] = "\n        x.log(): natural logarithm of x.\n\n        This function returns the principal branch of the natural logarithm\n        of `x`, i.e., the branch such that\n        `\\Im(\\log(x)) \\in ]-\\pi, \\pi].` The result is\n        complex (with imaginary part equal to `\\pi`) if\n        `x\\in \\RR` and `x<0`. In general, the algorithm uses\n        the formula\n\n        .. math::\n\n                         \\log(x) \\simeq \\frac{\\pi}{2{\\rm agm}(1,4/s)} - m\\log(2),\n\n\n        if `s=x 2^m` is large enough. (The result is exact to\n        `B` bits provided that `s>2^{B/2}`.) At low\n        accuracies, this function computes `\\log` using the series\n        expansion near `1`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        Note that `p`-adic arguments can also be given as input,\n        with the convention that `\\log(p)=0`. Hence, in particular,\n        `\\exp(\\log(x))/x` is not in general equal to `1`\n        but instead to a `(p-1)`-st root of unity (or\n        `\\pm 1` if `p=2`) times a power of `p`.\n\n        EXAMPLES::\n\n            sage: pari(5).log()\n            1.60943791243410\n            sage: C.<i> = ComplexField()\n            sage: pari(i).log()\n            0.E-19 + 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_317log(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("log (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "log") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4635; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4635; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("log", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4635; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.log", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_316log(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_316log(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("log", 0);

    /* "gen.pyx":4675
 *             0.E-19 + 1.57079632679490*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(glog(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4676
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(glog(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def lngamma(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, glog(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4635
 *         return P.new_gen(incgamc(s.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def log(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.log(): natural logarithm of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.log", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4678
 *         return P.new_gen(glog(x.g, prec_bits_to_words(precision)))
 * 
 *     def lngamma(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         This method is deprecated, please use :meth:`.log_gamma` instead.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_319lngamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_318lngamma[] = "\n        This method is deprecated, please use :meth:`.log_gamma` instead.\n\n        See the :meth:`.log_gamma` method for documentation and examples.\n\n        EXAMPLES::\n\n            sage: pari(100).lngamma()\n            doctest:...: DeprecationWarning: The method lngamma() is deprecated. Use log_gamma() instead.\n            See http://trac.sagemath.org/6992 for details.\n            359.134205369575\n        ";
  static PyObject *__pyx_pw_3gen_3gen_319lngamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lngamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lngamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lngamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.lngamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_318lngamma(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_318lngamma(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_v_deprecation = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lngamma", 0);

    /* "gen.pyx":4691
 *             359.134205369575
 *         """
 *         from sage.misc.superseded import deprecation             # <<<<<<<<<<<<<<
 *         deprecation(6992, "The method lngamma() is deprecated. Use log_gamma() instead.")
 *         return x.log_gamma(precision)
 */
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4691; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_n_s_deprecation);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_deprecation);
    __Pyx_GIVEREF(__pyx_n_s_deprecation);
    __pyx_t_2 = __Pyx_Import(__pyx_n_s_sage_misc_superseded, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4691; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_deprecation); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4691; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_t_1);
    __pyx_v_deprecation = __pyx_t_1;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "gen.pyx":4692
 *         """
 *         from sage.misc.superseded import deprecation
 *         deprecation(6992, "The method lngamma() is deprecated. Use log_gamma() instead.")             # <<<<<<<<<<<<<<
 *         return x.log_gamma(precision)
 * 
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_deprecation, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4692; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "gen.pyx":4693
 *         from sage.misc.superseded import deprecation
 *         deprecation(6992, "The method lngamma() is deprecated. Use log_gamma() instead.")
 *         return x.log_gamma(precision)             # <<<<<<<<<<<<<<
 * 
 *     def log_gamma(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_x), __pyx_n_s_log_gamma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_From_unsigned_long(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __Pyx_GIVEREF(__pyx_t_4); __pyx_t_4 = NULL;
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4678
 *         return P.new_gen(glog(x.g, prec_bits_to_words(precision)))
 * 
 *     def lngamma(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         This method is deprecated, please use :meth:`.log_gamma` instead.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen.gen.lngamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_deprecation);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4695
 *         return x.log_gamma(precision)
 * 
 *     def log_gamma(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Logarithm of the gamma function of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_321log_gamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_320log_gamma[] = "\n        Logarithm of the gamma function of x.\n\n        This function returns the principal branch of the logarithm of the\n        gamma function of `x`. The function\n        `\\log(\\Gamma(x))` is analytic on the complex plane with\n        non-positive integers removed. This function can have much larger\n        inputs than `\\Gamma` itself.\n\n        The `p`-adic analogue of this function is unfortunately not\n        implemented.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(100).log_gamma()\n            359.134205369575\n        ";
  static PyObject *__pyx_pw_3gen_3gen_321log_gamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("log_gamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "log_gamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("log_gamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.log_gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_320log_gamma(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_320log_gamma(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("log_gamma", 0);

    /* "gen.pyx":4718
 *             359.134205369575
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(glngamma(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4719
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(glngamma(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def polylog(gen x, long m, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, glngamma(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4695
 *         return x.log_gamma(precision)
 * 
 *     def log_gamma(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Logarithm of the gamma function of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.log_gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4721
 *         return P.new_gen(glngamma(x.g, prec_bits_to_words(precision)))
 * 
 *     def polylog(gen x, long m, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.polylog(m,flag=0): m-th polylogarithm of x. flag is optional, and
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_323polylog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_322polylog[] = "\n        x.polylog(m,flag=0): m-th polylogarithm of x. flag is optional, and\n        can be 0: default, 1: D_m -modified m-th polylog of x, 2:\n        D_m-modified m-th polylog of x, 3: P_m-modified m-th polylog of\n        x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        TODO: Add more explanation, copied from the PARI manual.\n\n        EXAMPLES::\n\n            sage: pari(10).polylog(3)\n            5.64181141475134 - 8.32820207698027*I\n            sage: pari(10).polylog(3,0)\n            5.64181141475134 - 8.32820207698027*I\n            sage: pari(10).polylog(3,1)\n            0.523778453502411\n            sage: pari(10).polylog(3,2)\n            -0.400459056163451\n        ";
  static PyObject *__pyx_pw_3gen_3gen_323polylog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_m;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polylog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_m,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_m)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polylog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4721; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_m = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_m == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4721; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4721; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4721; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polylog", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4721; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polylog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_322polylog(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_m, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_322polylog(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_m, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polylog", 0);

    /* "gen.pyx":4746
 *             -0.400459056163451
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polylog0(m, x.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4747
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(polylog0(m, x.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def psi(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polylog0(__pyx_v_m, __pyx_v_x->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4721
 *         return P.new_gen(glngamma(x.g, prec_bits_to_words(precision)))
 * 
 *     def polylog(gen x, long m, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.polylog(m,flag=0): m-th polylogarithm of x. flag is optional, and
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polylog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4749
 *         return P.new_gen(polylog0(m, x.g, flag, prec_bits_to_words(precision)))
 * 
 *     def psi(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.psi(): psi-function at x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_325psi(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_324psi[] = "\n        x.psi(): psi-function at x.\n\n        Return the `\\psi`-function of `x`, i.e., the\n        logarithmic derivative `\\Gamma'(x)/\\Gamma(x)`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).psi()\n            -0.577215664901533\n        ";
  static PyObject *__pyx_pw_3gen_3gen_325psi(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("psi (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "psi") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4749; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4749; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("psi", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4749; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.psi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_324psi(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_324psi(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("psi", 0);

    /* "gen.pyx":4766
 *             -0.577215664901533
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gpsi(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4767
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gpsi(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sin(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gpsi(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4767; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4749
 *         return P.new_gen(polylog0(m, x.g, flag, prec_bits_to_words(precision)))
 * 
 *     def psi(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.psi(): psi-function at x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.psi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4769
 *         return P.new_gen(gpsi(x.g, prec_bits_to_words(precision)))
 * 
 *     def sin(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sin(): The sine of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_327sin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_326sin[] = "\n        x.sin(): The sine of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).sin()\n            0.841470984807897\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).sin()\n            1.29845758141598 + 0.634963914784736*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_327sin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sin (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sin") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4769; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4769; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sin", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4769; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.sin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_326sin(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_326sin(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sin", 0);

    /* "gen.pyx":4786
 *             1.29845758141598 + 0.634963914784736*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsin(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4787
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gsin(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sinh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsin(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4769
 *         return P.new_gen(gpsi(x.g, prec_bits_to_words(precision)))
 * 
 *     def sin(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sin(): The sine of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4789
 *         return P.new_gen(gsin(x.g, prec_bits_to_words(precision)))
 * 
 *     def sinh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic sine function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_329sinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_328sinh[] = "\n        The hyperbolic sine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).sinh()\n            0.E-19\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).sinh()\n            0.634963914784736 + 1.29845758141598*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_329sinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sinh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sinh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sinh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.sinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_328sinh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_328sinh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sinh", 0);

    /* "gen.pyx":4806
 *             0.634963914784736 + 1.29845758141598*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsh(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4807
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gsh(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sqr(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsh(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4789
 *         return P.new_gen(gsin(x.g, prec_bits_to_words(precision)))
 * 
 *     def sinh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic sine function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4809
 *         return P.new_gen(gsh(x.g, prec_bits_to_words(precision)))
 * 
 *     def sqr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqr(): square of x. Faster than, and most of the time (but not
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_331sqr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_330sqr[] = "\n        x.sqr(): square of x. Faster than, and most of the time (but not\n        always - see the examples) identical to x\\*x.\n\n        EXAMPLES::\n\n            sage: pari(2).sqr()\n            4\n\n        For `2`-adic numbers, x.sqr() may not be identical to x\\*x\n        (squaring a `2`-adic number increases its precision)::\n\n            sage: pari(\"1+O(2^5)\").sqr()\n            1 + O(2^6)\n            sage: pari(\"1+O(2^5)\")*pari(\"1+O(2^5)\")\n            1 + O(2^5)\n\n        However::\n\n            sage: x = pari(\"1+O(2^5)\"); x*x\n            1 + O(2^6)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_331sqr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqr (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_330sqr(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_330sqr(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqr", 0);

    /* "gen.pyx":4832
 *             1 + O(2^6)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsqr(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4833
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gsqr(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsqr(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4809
 *         return P.new_gen(gsh(x.g, prec_bits_to_words(precision)))
 * 
 *     def sqr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqr(): square of x. Faster than, and most of the time (but not
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sqr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4836
 * 
 * 
 *     def sqrt(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqrt(precision): The square root of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_333sqrt(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_332sqrt[] = "\n        x.sqrt(precision): The square root of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).sqrt()\n            1.41421356237310\n        ";
  static PyObject *__pyx_pw_3gen_3gen_333sqrt(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqrt (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqrt") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sqrt", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.sqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_332sqrt(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_332sqrt(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqrt", 0);

    /* "gen.pyx":4850
 *             1.41421356237310
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsqrt(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4850; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4851
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gsqrt(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sqrtint(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsqrt(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4836
 * 
 * 
 *     def sqrt(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqrt(precision): The square root of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4853
 *         return P.new_gen(gsqrt(x.g, prec_bits_to_words(precision)))
 * 
 *     def sqrtint(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the integer square root of the integer `x`, rounded
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_335sqrtint(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_334sqrtint[] = "\n        Return the integer square root of the integer `x`, rounded\n        towards zero.\n\n        EXAMPLES::\n\n            sage: pari(8).sqrtint()\n            2\n            sage: pari(10^100).sqrtint()\n            100000000000000000000000000000000000000000000000000\n        ";
  static PyObject *__pyx_pw_3gen_3gen_335sqrtint(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqrtint (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_334sqrtint(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_334sqrtint(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqrtint", 0);

    /* "gen.pyx":4865
 *             100000000000000000000000000000000000000000000000000
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sqrtint(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4866
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(sqrtint(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def sqrtn(gen x, n, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, sqrtint(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4853
 *         return P.new_gen(gsqrt(x.g, prec_bits_to_words(precision)))
 * 
 *     def sqrtint(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the integer square root of the integer `x`, rounded
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sqrtint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4868
 *         return P.new_gen(sqrtint(x.g))
 * 
 *     def sqrtn(gen x, n, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.sqrtn(n): return the principal branch of the n-th root of x,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_337sqrtn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_336sqrtn[] = "\n        x.sqrtn(n): return the principal branch of the n-th root of x,\n        i.e., the one such that\n        `\\arg(\\sqrt(x)) \\in ]-\\pi/n, \\pi/n]`. Also returns a second\n        argument which is a suitable root of unity allowing one to recover\n        all the other roots. If it was not possible to find such a number,\n        then this second return value is 0. If the argument is present and\n        no square root exists, return 0 instead of raising an error.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        .. note::\n\n           intmods (modulo a prime) and `p`-adic numbers are\n           allowed as arguments.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - integer\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - principal n-th root of x\n\n        -  ``gen`` - root of unity z that gives the other\n           roots\n\n\n        EXAMPLES::\n\n            sage: s, z = pari(2).sqrtn(5)\n            sage: z\n            0.309016994374947 + 0.951056516295154*I\n            sage: s\n            1.14869835499704\n            sage: s^5\n            2.00000000000000\n            sage: z^5\n            1.00000000000000 + 5.42101086 E-19*I        # 32-bit\n            1.00000000000000 + 5.96311194867027 E-19*I  # 64-bit\n            sage: (s*z)^5\n            2.00000000000000 + 1.409462824 E-18*I       # 32-bit\n            2.00000000000000 + 9.21571846612679 E-19*I  # 64-bit\n        ";
  static PyObject *__pyx_pw_3gen_3gen_337sqrtn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_n = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqrtn (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqrtn") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sqrtn", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.sqrtn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_336sqrtn(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_n, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_336sqrtn(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_n, unsigned long __pyx_v_precision) {
    GEN __pyx_v_zetan;
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_ans = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqrtn", 0);

    /* "gen.pyx":4923
 *         # TODO: ???  lots of good examples in the PARI docs ???
 *         cdef GEN zetan
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0.g, &zetan, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4924
 *         cdef GEN zetan
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0.g, &zetan, prec_bits_to_words(precision)))
 *         return ans, P.new_gen(zetan)
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4925
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0.g, &zetan, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         return ans, P.new_gen(zetan)
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, gsqrtn(__pyx_v_x->g, __pyx_v_t0->g, (&__pyx_v_zetan), __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4925; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_ans = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":4926
 *         pari_catch_sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0.g, &zetan, prec_bits_to_words(precision)))
 *         return ans, P.new_gen(zetan)             # <<<<<<<<<<<<<<
 * 
 *     def tan(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_zetan)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4926; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4926; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(((PyObject *)__pyx_v_ans));
    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_ans));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_ans));
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4868
 *         return P.new_gen(sqrtint(x.g))
 * 
 *     def sqrtn(gen x, n, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.sqrtn(n): return the principal branch of the n-th root of x,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.sqrtn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_ans);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4928
 *         return ans, P.new_gen(zetan)
 * 
 *     def tan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tan() - tangent of x
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_339tan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_338tan[] = "\n        x.tan() - tangent of x\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).tan()\n            -2.18503986326152\n            sage: C.<i> = ComplexField()\n            sage: pari(i).tan()\n            0.761594155955765*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_339tan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("tan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4928; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4928; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("tan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4928; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.tan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_338tan(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_338tan(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("tan", 0);

    /* "gen.pyx":4945
 *             0.761594155955765*I
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtan(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4946
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtan(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def tanh(gen x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtan(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4928
 *         return ans, P.new_gen(zetan)
 * 
 *     def tan(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tan() - tangent of x
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.tan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4948
 *         return P.new_gen(gtan(x.g, prec_bits_to_words(precision)))
 * 
 *     def tanh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tanh() - hyperbolic tangent of x
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_341tanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_340tanh[] = "\n        x.tanh() - hyperbolic tangent of x\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).tanh()\n            0.761594155955765\n            sage: C.<i> = ComplexField()\n            sage: z = pari(i); z\n            1.00000000000000*I\n            sage: result = z.tanh()\n            sage: result.real() <= 1e-18\n            True\n            sage: result.imag()\n            1.55740772465490\n        ";
  static PyObject *__pyx_pw_3gen_3gen_341tanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("tanh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tanh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4948; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4948; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("tanh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4948; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.tanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_340tanh(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_340tanh(struct __pyx_obj_3gen_gen *__pyx_v_x, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("tanh", 0);

    /* "gen.pyx":4970
 *             1.55740772465490
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gth(x.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4971
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gth(x.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def teichmuller(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gth(__pyx_v_x->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4948
 *         return P.new_gen(gtan(x.g, prec_bits_to_words(precision)))
 * 
 *     def tanh(gen x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tanh() - hyperbolic tangent of x
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.tanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4973
 *         return P.new_gen(gth(x.g, prec_bits_to_words(precision)))
 * 
 *     def teichmuller(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         teichmuller(x): teichmuller character of p-adic number x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_343teichmuller(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_342teichmuller[] = "\n        teichmuller(x): teichmuller character of p-adic number x.\n\n        This is the unique `(p-1)`-st root of unity congruent to\n        `x/p^{v_p(x)}` modulo `p`.\n\n        EXAMPLES::\n\n            sage: pari('2+O(7^5)').teichmuller()\n            2 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_343teichmuller(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("teichmuller (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_342teichmuller(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_342teichmuller(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("teichmuller", 0);

    /* "gen.pyx":4985
 *             2 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(teich(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":4986
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(teich(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def theta(gen q, z, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, teich(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4973
 *         return P.new_gen(gth(x.g, prec_bits_to_words(precision)))
 * 
 *     def teichmuller(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         teichmuller(x): teichmuller character of p-adic number x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.teichmuller", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":4988
 *         return P.new_gen(teich(x.g))
 * 
 *     def theta(gen q, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.theta(z): Jacobi sine theta-function.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_345theta(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_344theta[] = "\n        q.theta(z): Jacobi sine theta-function.\n\n        If `q` or `z` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).theta(2)\n            1.63202590295260\n        ";
  static PyObject *__pyx_pw_3gen_3gen_345theta(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("theta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "theta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4988; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4988; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("theta", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4988; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.theta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_344theta(((struct __pyx_obj_3gen_gen *)__pyx_v_q), __pyx_v_z, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_344theta(struct __pyx_obj_3gen_gen *__pyx_v_q, PyObject *__pyx_v_z, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("theta", 0);

    /* "gen.pyx":5003
 *             1.63202590295260
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(theta(q.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5004
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(theta(q.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5005
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(theta(q.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def thetanullk(gen q, long k, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, theta(__pyx_v_q->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":4988
 *         return P.new_gen(teich(x.g))
 * 
 *     def theta(gen q, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.theta(z): Jacobi sine theta-function.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.theta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5007
 *         return P.new_gen(theta(q.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def thetanullk(gen q, long k, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.thetanullk(k): return the k-th derivative at z=0 of theta(q,z).
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_347thetanullk(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_346thetanullk[] = "\n        q.thetanullk(k): return the k-th derivative at z=0 of theta(q,z).\n\n        If `q` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `q` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).thetanullk(1)\n            0.548978532560341\n        ";
  static PyObject *__pyx_pw_3gen_3gen_347thetanullk(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_k;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thetanullk (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thetanullk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_k = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thetanullk", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.thetanullk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_346thetanullk(((struct __pyx_obj_3gen_gen *)__pyx_v_q), __pyx_v_k, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_346thetanullk(struct __pyx_obj_3gen_gen *__pyx_v_q, long __pyx_v_k, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thetanullk", 0);

    /* "gen.pyx":5021
 *             0.548978532560341
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(thetanullk(q.g, k, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5022
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(thetanullk(q.g, k, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def weber(gen x, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, thetanullk(__pyx_v_q->g, __pyx_v_k, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5007
 *         return P.new_gen(theta(q.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def thetanullk(gen q, long k, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.thetanullk(k): return the k-th derivative at z=0 of theta(q,z).
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.thetanullk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5024
 *         return P.new_gen(thetanullk(q.g, k, prec_bits_to_words(precision)))
 * 
 *     def weber(gen x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.weber(flag=0): One of Weber's f functions of x. flag is optional,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_349weber(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_348weber[] = "\n        x.weber(flag=0): One of Weber's f functions of x. flag is optional,\n        and can be 0: default, function\n        f(x)=exp(-i\\*Pi/24)\\*eta((x+1)/2)/eta(x) such that\n        `j=(f^{24}-16)^3/f^{24}`, 1: function f1(x)=eta(x/2)/eta(x)\n        such that `j=(f1^24+16)^3/f2^{24}`, 2: function\n        f2(x)=sqrt(2)\\*eta(2\\*x)/eta(x) such that\n        `j=(f2^{24}+16)^3/f2^{24}`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        TODO: Add further explanation from PARI manual.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(i).weber()\n            1.18920711500272 + 0.E-19*I                 # 32-bit\n            1.18920711500272 + 2.71050543121376 E-20*I  # 64-bit\n            sage: pari(i).weber(1)\n            1.09050773266526\n            sage: pari(i).weber(2)\n            1.09050773266526\n        ";
  static PyObject *__pyx_pw_3gen_3gen_349weber(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("weber (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "weber") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("weber", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.weber", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_348weber(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_348weber(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("weber", 0);

    /* "gen.pyx":5052
 *             1.09050773266526
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(weber0(x.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5052; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5053
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(weber0(x.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def zeta(gen s, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, weber0(__pyx_v_x->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5053; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5024
 *         return P.new_gen(thetanullk(q.g, k, prec_bits_to_words(precision)))
 * 
 *     def weber(gen x, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.weber(flag=0): One of Weber's f functions of x. flag is optional,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.weber", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5055
 *         return P.new_gen(weber0(x.g, flag, prec_bits_to_words(precision)))
 * 
 *     def zeta(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         zeta(s): zeta function at s with s a complex or a p-adic number.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_351zeta(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_350zeta[] = "\n        zeta(s): zeta function at s with s a complex or a p-adic number.\n\n        If `s` is a complex number, this is the Riemann zeta\n        function `\\zeta(s)=\\sum_{n\\geq 1} n^{-s}`, computed either\n        using the Euler-Maclaurin summation formula (if `s` is not\n        an integer), or using Bernoulli numbers (if `s` is a\n        negative integer or an even nonnegative integer), or using modular\n        forms (if `s` is an odd nonnegative integer).\n\n        If `s` is a `p`-adic number, this is the\n        Kubota-Leopoldt zeta function, i.e. the unique continuous\n        `p`-adic function on the `p`-adic integers that\n        interpolates the values of `(1-p^{-k})\\zeta(k)` at negative\n        integers `k` such that `k\\equiv 1\\pmod{p-1}` if\n        `p` is odd, and at odd `k` if `p=2`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        INPUT:\n\n\n        -  ``s`` - gen (real, complex, or p-adic number)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - value of zeta at s.\n\n\n        EXAMPLES::\n\n            sage: pari(2).zeta()\n            1.64493406684823\n            sage: x = RR(pi)^2/6\n            sage: pari(x)\n            1.64493406684823\n            sage: pari(3).zeta()\n            1.20205690315959\n            sage: pari('1+5*7+2*7^2+O(7^3)').zeta()\n            4*7^-2 + 5*7^-1 + O(7^0)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_351zeta(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("zeta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "zeta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5055; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5055; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("zeta", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5055; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.zeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_350zeta(((struct __pyx_obj_3gen_gen *)__pyx_v_s), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_350zeta(struct __pyx_obj_3gen_gen *__pyx_v_s, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("zeta", 0);

    /* "gen.pyx":5102
 *             4*7^-2 + 5*7^-1 + O(7^0)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gzeta(s.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5103
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gzeta(s.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gzeta(__pyx_v_s->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5055
 *         return P.new_gen(weber0(x.g, flag, prec_bits_to_words(precision)))
 * 
 *     def zeta(gen s, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         zeta(s): zeta function at s with s a complex or a p-adic number.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.zeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5109
 *     ###########################################
 * 
 *     def bezout(gen x, y):             # <<<<<<<<<<<<<<
 *         cdef gen u, v, g
 *         cdef GEN U, V, G
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_353bezout(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_353bezout(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bezout (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_352bezout(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_352bezout(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_u = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_v = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_g = 0;
    GEN __pyx_v_U;
    GEN __pyx_v_V;
    GEN __pyx_v_G;
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bezout", 0);

    /* "gen.pyx":5112
 *         cdef gen u, v, g
 *         cdef GEN U, V, G
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         G = gbezout(x.g, t0.g, &U, &V)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5113
 *         cdef GEN U, V, G
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         G = gbezout(x.g, t0.g, &U, &V)
 *         g = P.new_gen_noclear(G)
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5114
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         G = gbezout(x.g, t0.g, &U, &V)             # <<<<<<<<<<<<<<
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)
 */
    __pyx_v_G = gbezout(__pyx_v_x->g, __pyx_v_t0->g, (&__pyx_v_U), (&__pyx_v_V));

    /* "gen.pyx":5115
 *         pari_catch_sig_on()
 *         G = gbezout(x.g, t0.g, &U, &V)
 *         g = P.new_gen_noclear(G)             # <<<<<<<<<<<<<<
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, __pyx_v_G)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_g = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5116
 *         G = gbezout(x.g, t0.g, &U, &V)
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)             # <<<<<<<<<<<<<<
 *         v = P.new_gen(V)
 *         return g, u, v
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, __pyx_v_U)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_u = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5117
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)             # <<<<<<<<<<<<<<
 *         return g, u, v
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_V)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_v = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5118
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)
 *         return g, u, v             # <<<<<<<<<<<<<<
 * 
 *     def binomial(gen x, long k):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_v_g));
    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_g));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_g));
    __Pyx_INCREF(((PyObject *)__pyx_v_u));
    PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_u));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_u));
    __Pyx_INCREF(((PyObject *)__pyx_v_v));
    PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_v));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_v));
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5109
 *     ###########################################
 * 
 *     def bezout(gen x, y):             # <<<<<<<<<<<<<<
 *         cdef gen u, v, g
 *         cdef GEN U, V, G
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bezout", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_u);
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XDECREF((PyObject *)__pyx_v_g);
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5120
 *         return g, u, v
 * 
 *     def binomial(gen x, long k):             # <<<<<<<<<<<<<<
 *         """
 *         binomial(x, k): return the binomial coefficient "x choose k".
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_355binomial(PyObject *__pyx_v_x, PyObject *__pyx_arg_k); /*proto*/
  static char __pyx_doc_3gen_3gen_354binomial[] = "\n        binomial(x, k): return the binomial coefficient \"x choose k\".\n\n        INPUT:\n\n\n        -  ``x`` - any PARI object (gen)\n\n        -  ``k`` - integer\n\n\n        EXAMPLES::\n\n            sage: pari(6).binomial(2)\n            15\n            sage: pari('x+1').binomial(3)\n            1/6*x^3 - 1/6*x\n            sage: pari('2+x+O(x^2)').binomial(3)\n            1/3*x + O(x^2)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_355binomial(PyObject *__pyx_v_x, PyObject *__pyx_arg_k) {
    long __pyx_v_k;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("binomial (wrapper)", 0);
    assert(__pyx_arg_k); {
      __pyx_v_k = __Pyx_PyInt_As_long(__pyx_arg_k); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5120; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.binomial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_354binomial(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((long)__pyx_v_k));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_354binomial(struct __pyx_obj_3gen_gen *__pyx_v_x, long __pyx_v_k) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("binomial", 0);

    /* "gen.pyx":5141
 *             1/3*x + O(x^2)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(binomial(x.g, k))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5142
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(binomial(x.g, k))             # <<<<<<<<<<<<<<
 * 
 *     def contfrac(gen x, b=0, long lmax=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, binomial(__pyx_v_x->g, __pyx_v_k))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5120
 *         return g, u, v
 * 
 *     def binomial(gen x, long k):             # <<<<<<<<<<<<<<
 *         """
 *         binomial(x, k): return the binomial coefficient "x choose k".
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.binomial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5144
 *         return P.new_gen(binomial(x.g, k))
 * 
 *     def contfrac(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfrac(x,b,lmax): continued fraction expansion of x (x rational,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_357contfrac(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_356contfrac[] = "\n        contfrac(x,b,lmax): continued fraction expansion of x (x rational,\n        real or rational function). b and lmax are both optional, where b\n        is the vector of numerators of the continued fraction, and lmax is\n        a bound for the number of terms in the continued fraction\n        expansion.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_357contfrac(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_b = 0;
    long __pyx_v_lmax;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("contfrac (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_b,&__pyx_n_s_lmax,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_lmax);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contfrac") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      if (values[1]) {
        __pyx_v_lmax = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_lmax == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_lmax = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("contfrac", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.contfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_356contfrac(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_b, __pyx_v_lmax);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_356contfrac(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_b, long __pyx_v_lmax) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("contfrac", 0);

    /* "gen.pyx":5152
 *         expansion.
 *         """
 *         cdef gen t0 = objtogen(b)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(contfrac0(x.g, t0.g, lmax))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5153
 *         """
 *         cdef gen t0 = objtogen(b)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(contfrac0(x.g, t0.g, lmax))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5154
 *         cdef gen t0 = objtogen(b)
 *         pari_catch_sig_on()
 *         return P.new_gen(contfrac0(x.g, t0.g, lmax))             # <<<<<<<<<<<<<<
 * 
 *     def contfracpnqn(gen x, b=0, long lmax=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, contfrac0(__pyx_v_x->g, __pyx_v_t0->g, __pyx_v_lmax))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5144
 *         return P.new_gen(binomial(x.g, k))
 * 
 *     def contfrac(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfrac(x,b,lmax): continued fraction expansion of x (x rational,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.contfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5156
 *         return P.new_gen(contfrac0(x.g, t0.g, lmax))
 * 
 *     def contfracpnqn(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfracpnqn(x): [p_n,p_n-1; q_n,q_n-1] corresponding to the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_359contfracpnqn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_358contfracpnqn[] = "\n        contfracpnqn(x): [p_n,p_n-1; q_n,q_n-1] corresponding to the\n        continued fraction x.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_359contfracpnqn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    CYTHON_UNUSED PyObject *__pyx_v_b = 0;
    CYTHON_UNUSED long __pyx_v_lmax;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("contfracpnqn (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_b,&__pyx_n_s_lmax,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_lmax);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contfracpnqn") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5156; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      if (values[1]) {
        __pyx_v_lmax = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_lmax == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5156; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_lmax = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("contfracpnqn", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5156; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.contfracpnqn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_358contfracpnqn(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_b, __pyx_v_lmax);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_358contfracpnqn(struct __pyx_obj_3gen_gen *__pyx_v_x, CYTHON_UNUSED PyObject *__pyx_v_b, CYTHON_UNUSED long __pyx_v_lmax) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("contfracpnqn", 0);

    /* "gen.pyx":5161
 *         continued fraction x.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pnqn(x.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5162
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(pnqn(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def ffgen(gen T, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, pnqn(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5156
 *         return P.new_gen(contfrac0(x.g, t0.g, lmax))
 * 
 *     def contfracpnqn(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfracpnqn(x): [p_n,p_n-1; q_n,q_n-1] corresponding to the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.contfracpnqn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5164
 *         return P.new_gen(pnqn(x.g))
 * 
 *     def ffgen(gen T, v=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the generator `g=x \bmod T` of the finite field defined
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_361ffgen(PyObject *__pyx_v_T, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_360ffgen[] = "\n        Return the generator `g=x \\bmod T` of the finite field defined\n        by the polynomial `T`.\n\n        INPUT:\n\n        - ``T`` -- a gen of type t_POL with coefficients of type t_INTMOD:\n                   a polynomial over a prime finite field\n\n        - ``v`` -- string: a variable name or -1 (optional)\n\n        If `v` is a string, then `g` will be a polynomial in `v`, else the\n        variable of the polynomial `T` is used.\n\n        EXAMPLES::\n\n            sage: x = GF(2)['x'].gen()\n            sage: pari(x^2+x+2).ffgen()\n            x\n            sage: pari(x^2+x+1).ffgen('a')\n            a\n        ";
  static PyObject *__pyx_pw_3gen_3gen_361ffgen(PyObject *__pyx_v_T, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ffgen (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ffgen") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ffgen", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5164; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ffgen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_360ffgen(((struct __pyx_obj_3gen_gen *)__pyx_v_T), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_360ffgen(struct __pyx_obj_3gen_gen *__pyx_v_T, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ffgen", 0);

    /* "gen.pyx":5187
 *             a
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ffgen(T.g, P.get_var(v)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5188
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ffgen(T.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def ffinit(gen p, long n, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ffgen(__pyx_v_T->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5164
 *         return P.new_gen(pnqn(x.g))
 * 
 *     def ffgen(gen T, v=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the generator `g=x \bmod T` of the finite field defined
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ffgen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5190
 *         return P.new_gen(ffgen(T.g, P.get_var(v)))
 * 
 *     def ffinit(gen p, long n, v=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a monic irreducible polynomial `g` of degree `n` over the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_363ffinit(PyObject *__pyx_v_p, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_362ffinit[] = "\n        Return a monic irreducible polynomial `g` of degree `n` over the\n        finite field of `p` elements.\n\n        INPUT:\n\n        - ``p`` -- a gen of type t_INT: a prime number\n\n        - ``n`` -- integer: the degree of the polynomial\n\n        - ``v`` -- string: a variable name or -1 (optional)\n\n        If `v \\geq 0', then `g` will be a polynomial in `v`, else the\n        variable `x` is used.\n\n        EXAMPLES::\n\n            sage: pari(7).ffinit(11)\n            Mod(1, 7)*x^11 + Mod(1, 7)*x^10 + Mod(4, 7)*x^9 + Mod(5, 7)*x^8 + Mod(1, 7)*x^7 + Mod(1, 7)*x^2 + Mod(1, 7)*x + Mod(6, 7)\n            sage: pari(2003).ffinit(3)\n            Mod(1, 2003)*x^3 + Mod(1, 2003)*x^2 + Mod(1993, 2003)*x + Mod(1995, 2003)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_363ffinit(PyObject *__pyx_v_p, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ffinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_v,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ffinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5190; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5190; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ffinit", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5190; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ffinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_362ffinit(((struct __pyx_obj_3gen_gen *)__pyx_v_p), __pyx_v_n, __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_362ffinit(struct __pyx_obj_3gen_gen *__pyx_v_p, long __pyx_v_n, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ffinit", 0);

    /* "gen.pyx":5213
 *             Mod(1, 2003)*x^3 + Mod(1, 2003)*x^2 + Mod(1993, 2003)*x + Mod(1995, 2003)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ffinit(p.g, n, P.get_var(v)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5214
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ffinit(p.g, n, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def fibonacci(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ffinit(__pyx_v_p->g, __pyx_v_n, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5190
 *         return P.new_gen(ffgen(T.g, P.get_var(v)))
 * 
 *     def ffinit(gen p, long n, v=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a monic irreducible polynomial `g` of degree `n` over the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ffinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5216
 *         return P.new_gen(ffinit(p.g, n, P.get_var(v)))
 * 
 *     def fibonacci(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the Fibonacci number of index x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_365fibonacci(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_364fibonacci[] = "\n        Return the Fibonacci number of index x.\n\n        EXAMPLES::\n\n            sage: pari(18).fibonacci()\n            2584\n            sage: [pari(n).fibonacci() for n in range(10)]\n            [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_365fibonacci(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("fibonacci (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_364fibonacci(((struct __pyx_obj_3gen_gen *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_364fibonacci(struct __pyx_obj_3gen_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("fibonacci", 0);

    /* "gen.pyx":5227
 *             [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(fibo(long(x)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5228
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(fibo(long(x)))             # <<<<<<<<<<<<<<
 * 
 *     def gcd(gen x, y=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(((PyObject *)__pyx_v_x));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_x));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
    __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyLong_Type))), __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_PyInt_As_long(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, fibo(__pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5216
 *         return P.new_gen(ffinit(p.g, n, P.get_var(v)))
 * 
 *     def fibonacci(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the Fibonacci number of index x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.fibonacci", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5230
 *         return P.new_gen(fibo(long(x)))
 * 
 *     def gcd(gen x, y=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return the greatest common divisor of `x` and `y`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_367gcd(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_366gcd[] = "\n        Return the greatest common divisor of `x` and `y`.\n\n        If `y` is ``None``, then `x` must be a list or tuple, and the\n        greatest common divisor of its components is returned.\n\n        EXAMPLES::\n\n            sage: pari(10).gcd(15)\n            5\n            sage: pari([5, 'y']).gcd()\n            1\n            sage: pari(['x', x^2]).gcd()      \n            x\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_367gcd(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gcd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gcd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gcd", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5230; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.gcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_366gcd(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_366gcd(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gcd", 0);

    /* "gen.pyx":5248
 *         """
 *         cdef gen t0
 *         if y is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(ggcd0(x.g, NULL))
 */
    __pyx_t_1 = (__pyx_v_y == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":5249
 *         cdef gen t0
 *         if y is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(ggcd0(x.g, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":5250
 *         if y is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(ggcd0(x.g, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(y)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ggcd0(__pyx_v_x->g, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":5252
 *             return P.new_gen(ggcd0(x.g, NULL))
 *         else:
 *             t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(ggcd0(x.g, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":5253
 *         else:
 *             t0 = objtogen(y)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(ggcd0(x.g, t0.g))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":5254
 *             t0 = objtogen(y)
 *             pari_catch_sig_on()
 *             return P.new_gen(ggcd0(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def issquare(gen x, find_root=False):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ggcd0(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5230
 *         return P.new_gen(fibo(long(x)))
 * 
 *     def gcd(gen x, y=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return the greatest common divisor of `x` and `y`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.gcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5256
 *             return P.new_gen(ggcd0(x.g, t0.g))
 * 
 *     def issquare(gen x, find_root=False):             # <<<<<<<<<<<<<<
 *         """
 *         issquare(x,n): ``True`` if x is a square, ``False`` if not. If
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_369issquare(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_368issquare[] = "\n        issquare(x,n): ``True`` if x is a square, ``False`` if not. If\n        ``find_root`` is given, also returns the exact square root.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_369issquare(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_find_root = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("issquare (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_find_root,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_False);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_find_root);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "issquare") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5256; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_find_root = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("issquare", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5256; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.issquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_368issquare(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_find_root);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_368issquare(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_find_root) {
    GEN __pyx_v_G;
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("issquare", 0);

    /* "gen.pyx":5264
 *         cdef long t
 *         cdef gen g
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if find_root:
 *             t = issquareall(x.g, &G)
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5265
 *         cdef gen g
 *         pari_catch_sig_on()
 *         if find_root:             # <<<<<<<<<<<<<<
 *             t = issquareall(x.g, &G)
 *             if t:
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_find_root); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "gen.pyx":5266
 *         pari_catch_sig_on()
 *         if find_root:
 *             t = issquareall(x.g, &G)             # <<<<<<<<<<<<<<
 *             if t:
 *                 return True, P.new_gen(G)
 */
      __pyx_v_t = issquareall(__pyx_v_x->g, (&__pyx_v_G));

      /* "gen.pyx":5267
 *         if find_root:
 *             t = issquareall(x.g, &G)
 *             if t:             # <<<<<<<<<<<<<<
 *                 return True, P.new_gen(G)
 *             else:
 */
      __pyx_t_2 = (__pyx_v_t != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":5268
 *             t = issquareall(x.g, &G)
 *             if t:
 *                 return True, P.new_gen(G)             # <<<<<<<<<<<<<<
 *             else:
 *                 P.clear_stack()
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_G)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_INCREF(Py_True);
        PyTuple_SET_ITEM(__pyx_t_4, 0, Py_True);
        __Pyx_GIVEREF(Py_True);
        PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }
      /*else*/ {

        /* "gen.pyx":5270
 *                 return True, P.new_gen(G)
 *             else:
 *                 P.clear_stack()             # <<<<<<<<<<<<<<
 *                 return False, None
 *         else:
 */
        ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->clear_stack(__pyx_v_3gen_P);

        /* "gen.pyx":5271
 *             else:
 *                 P.clear_stack()
 *                 return False, None             # <<<<<<<<<<<<<<
 *         else:
 *             t = issquare(x.g)
 */
        __Pyx_XDECREF(__pyx_r);
        __Pyx_INCREF(__pyx_tuple__20);
        __pyx_r = __pyx_tuple__20;
        goto __pyx_L0;
      }
    }
    /*else*/ {

      /* "gen.pyx":5273
 *                 return False, None
 *         else:
 *             t = issquare(x.g)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_off()
 *             return t != 0
 */
      __pyx_v_t = issquare(__pyx_v_x->g);

      /* "gen.pyx":5274
 *         else:
 *             t = issquare(x.g)
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *             return t != 0
 * 
 */
      pari_catch_sig_off();

      /* "gen.pyx":5275
 *             t = issquare(x.g)
 *             pari_catch_sig_off()
 *             return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def issquarefree(gen self):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5256
 *             return P.new_gen(ggcd0(x.g, t0.g))
 * 
 *     def issquare(gen x, find_root=False):             # <<<<<<<<<<<<<<
 *         """
 *         issquare(x,n): ``True`` if x is a square, ``False`` if not. If
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.issquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5277
 *             return t != 0
 * 
 *     def issquarefree(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_371issquarefree(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_370issquarefree[] = "\n        EXAMPLES::\n\n            sage: pari(10).issquarefree()\n            True\n            sage: pari(20).issquarefree()\n            False\n        ";
  static PyObject *__pyx_pw_3gen_3gen_371issquarefree(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("issquarefree (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_370issquarefree(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_370issquarefree(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("issquarefree", 0);

    /* "gen.pyx":5286
 *             False
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long t = issquarefree(self.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5287
 *         """
 *         pari_catch_sig_on()
 *         cdef long t = issquarefree(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return t != 0
 */
    __pyx_v_t = issquarefree(__pyx_v_self->g);

    /* "gen.pyx":5288
 *         pari_catch_sig_on()
 *         cdef long t = issquarefree(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return t != 0
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":5289
 *         cdef long t = issquarefree(self.g)
 *         pari_catch_sig_off()
 *         return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def lcm(gen x, y=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5277
 *             return t != 0
 * 
 *     def issquarefree(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.issquarefree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5291
 *         return t != 0
 * 
 *     def lcm(gen x, y=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return the least common multiple of `x` and `y`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_373lcm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_372lcm[] = "\n        Return the least common multiple of `x` and `y`.\n\n        If `y` is ``None``, then `x` must be a list or tuple, and the\n        least common multiple of its components is returned.\n\n        EXAMPLES::\n\n            sage: pari(10).lcm(15)\n            30\n            sage: pari([5, 'y']).lcm()\n            5*y\n            sage: pari([10, 'x', x^2]).lcm()\n            10*x^2\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_373lcm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lcm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lcm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5291; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lcm", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5291; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.lcm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_372lcm(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_372lcm(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lcm", 0);

    /* "gen.pyx":5309
 *         """
 *         cdef gen t0
 *         if y is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(glcm0(x.g, NULL))
 */
    __pyx_t_1 = (__pyx_v_y == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":5310
 *         cdef gen t0
 *         if y is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(glcm0(x.g, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":5311
 *         if y is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(glcm0(x.g, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(y)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, glcm0(__pyx_v_x->g, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":5313
 *             return P.new_gen(glcm0(x.g, NULL))
 *         else:
 *             t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(glcm0(x.g, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":5314
 *         else:
 *             t0 = objtogen(y)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(glcm0(x.g, t0.g))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":5315
 *             t0 = objtogen(y)
 *             pari_catch_sig_on()
 *             return P.new_gen(glcm0(x.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     # def numdiv(gen n):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, glcm0(__pyx_v_x->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5291
 *         return t != 0
 * 
 *     def lcm(gen x, y=None):             # <<<<<<<<<<<<<<
 *         """
 *         Return the least common multiple of `x` and `y`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.lcm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5339
 *     #     return P.new_gen(geulerphi(n.g))
 * 
 *     def primepi(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of primes less than or equal to self.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_375primepi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_374primepi[] = "\n        Return the number of primes less than or equal to self.\n\n        EXAMPLES::\n\n            sage: pari(7).primepi()\n            4\n            sage: pari(100).primepi()\n            25\n            sage: pari(1000).primepi()\n            168\n            sage: pari(100000).primepi()\n            9592\n            sage: pari(0).primepi()\n            0\n            sage: pari(-15).primepi()\n            0\n            sage: pari(500509).primepi()\n            41581\n        ";
  static PyObject *__pyx_pw_3gen_3gen_375primepi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("primepi (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_374primepi(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_374primepi(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("primepi", 0);

    /* "gen.pyx":5360
 *             41581
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if self > P._primelimit():
 *             P.init_primes(self + 10)
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5361
 *         """
 *         pari_catch_sig_on()
 *         if self > P._primelimit():             # <<<<<<<<<<<<<<
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_primelimit); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_RichCompare(((PyObject *)__pyx_v_self), __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_5) {

      /* "gen.pyx":5362
 *         pari_catch_sig_on()
 *         if self > P._primelimit():
 *             P.init_primes(self + 10)             # <<<<<<<<<<<<<<
 *         if signe(self.g) != 1:
 *             pari_catch_sig_off()
 */
      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_init_primes); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_self), __pyx_int_10); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __Pyx_GIVEREF(__pyx_t_6); __pyx_t_6 = NULL;
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "gen.pyx":5363
 *         if self > P._primelimit():
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_off()
 *             return P.PARI_ZERO
 */
    __pyx_t_5 = ((signe(__pyx_v_self->g) != 1) != 0);
    if (__pyx_t_5) {

      /* "gen.pyx":5364
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *             return P.PARI_ZERO
 *         return P.new_gen(primepi(self.g))
 */
      pari_catch_sig_off();

      /* "gen.pyx":5365
 *         if signe(self.g) != 1:
 *             pari_catch_sig_off()
 *             return P.PARI_ZERO             # <<<<<<<<<<<<<<
 *         return P.new_gen(primepi(self.g))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_3gen_P->PARI_ZERO));
      __pyx_r = ((PyObject *)__pyx_v_3gen_P->PARI_ZERO);
      goto __pyx_L0;
    }

    /* "gen.pyx":5366
 *             pari_catch_sig_off()
 *             return P.PARI_ZERO
 *         return P.new_gen(primepi(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def sumdiv(gen n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, primepi(__pyx_v_self->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5339
 *     #     return P.new_gen(geulerphi(n.g))
 * 
 *     def primepi(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of primes less than or equal to self.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_AddTraceback("gen.gen.primepi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5368
 *         return P.new_gen(primepi(self.g))
 * 
 *     def sumdiv(gen n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the divisors of `n`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_377sumdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_376sumdiv[] = "\n        Return the sum of the divisors of `n`.\n\n        EXAMPLES::\n\n            sage: pari(10).sumdiv()\n            18\n        ";
  static PyObject *__pyx_pw_3gen_3gen_377sumdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sumdiv (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_376sumdiv(((struct __pyx_obj_3gen_gen *)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_376sumdiv(struct __pyx_obj_3gen_gen *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sumdiv", 0);

    /* "gen.pyx":5377
 *             18
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sumdiv(n.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5378
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(sumdiv(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def sumdivk(gen n, long k):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, sumdiv(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5368
 *         return P.new_gen(primepi(self.g))
 * 
 *     def sumdiv(gen n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the divisors of `n`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sumdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5380
 *         return P.new_gen(sumdiv(n.g))
 * 
 *     def sumdivk(gen n, long k):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the k-th powers of the divisors of n.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_379sumdivk(PyObject *__pyx_v_n, PyObject *__pyx_arg_k); /*proto*/
  static char __pyx_doc_3gen_3gen_378sumdivk[] = "\n        Return the sum of the k-th powers of the divisors of n.\n\n        EXAMPLES::\n\n            sage: pari(10).sumdivk(2)\n            130\n        ";
  static PyObject *__pyx_pw_3gen_3gen_379sumdivk(PyObject *__pyx_v_n, PyObject *__pyx_arg_k) {
    long __pyx_v_k;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sumdivk (wrapper)", 0);
    assert(__pyx_arg_k); {
      __pyx_v_k = __Pyx_PyInt_As_long(__pyx_arg_k); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.sumdivk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_378sumdivk(((struct __pyx_obj_3gen_gen *)__pyx_v_n), ((long)__pyx_v_k));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_378sumdivk(struct __pyx_obj_3gen_gen *__pyx_v_n, long __pyx_v_k) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sumdivk", 0);

    /* "gen.pyx":5389
 *             130
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sumdivk(n.g, k))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5390
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(sumdivk(n.g, k))             # <<<<<<<<<<<<<<
 * 
 *     def xgcd(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, sumdivk(__pyx_v_n->g, __pyx_v_k))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5380
 *         return P.new_gen(sumdiv(n.g))
 * 
 *     def sumdivk(gen n, long k):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the k-th powers of the divisors of n.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.sumdivk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5392
 *         return P.new_gen(sumdivk(n.g, k))
 * 
 *     def xgcd(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Returns u,v,d such that d=gcd(x,y) and u\*x+v\*y=d.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_381xgcd(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_380xgcd[] = "\n        Returns u,v,d such that d=gcd(x,y) and u\\*x+v\\*y=d.\n\n        EXAMPLES::\n\n            sage: pari(10).xgcd(15)\n            (5, -1, 1)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_381xgcd(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("xgcd (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_380xgcd(((struct __pyx_obj_3gen_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_380xgcd(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("xgcd", 0);

    /* "gen.pyx":5401
 *             (5, -1, 1)
 *         """
 *         return x.bezout(y)             # <<<<<<<<<<<<<<
 * 
 *     def Zn_issquare(gen self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_x), __pyx_n_s_bezout); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __Pyx_GIVEREF(__pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_y);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_y);
      __Pyx_GIVEREF(__pyx_v_y);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5392
 *         return P.new_gen(sumdivk(n.g, k))
 * 
 *     def xgcd(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Returns u,v,d such that d=gcd(x,y) and u\*x+v\*y=d.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.xgcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5403
 *         return x.bezout(y)
 * 
 *     def Zn_issquare(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``True`` if ``self`` is a square modulo `n`, ``False``
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_383Zn_issquare(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static char __pyx_doc_3gen_3gen_382Zn_issquare[] = "\n        Return ``True`` if ``self`` is a square modulo `n`, ``False``\n        if not.\n\n        INPUT:\n\n        - ``self`` -- integer\n\n        - ``n`` -- integer or factorisation matrix\n\n        EXAMPLES::\n\n            sage: pari(3).Zn_issquare(4)\n            False\n            sage: pari(4).Zn_issquare(30.factor())\n            True\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_383Zn_issquare(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Zn_issquare (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_382Zn_issquare(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_382Zn_issquare(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Zn_issquare", 0);

    /* "gen.pyx":5422
 * 
 *         """
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef long t = Zn_issquare(self.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5423
 *         """
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long t = Zn_issquare(self.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5424
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 *         cdef long t = Zn_issquare(self.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return t != 0
 */
    __pyx_v_t = Zn_issquare(__pyx_v_self->g, __pyx_v_t0->g);

    /* "gen.pyx":5425
 *         pari_catch_sig_on()
 *         cdef long t = Zn_issquare(self.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return t != 0
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":5426
 *         cdef long t = Zn_issquare(self.g, t0.g)
 *         pari_catch_sig_off()
 *         return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def Zn_sqrt(gen self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5403
 *         return x.bezout(y)
 * 
 *     def Zn_issquare(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return ``True`` if ``self`` is a square modulo `n`, ``False``
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.Zn_issquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5428
 *         return t != 0
 * 
 *     def Zn_sqrt(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return a square root of ``self`` modulo `n`, if such a square
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_385Zn_sqrt(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static char __pyx_doc_3gen_3gen_384Zn_sqrt[] = "\n        Return a square root of ``self`` modulo `n`, if such a square\n        root exists; otherwise, raise a ``ValueError``.\n\n        INPUT:\n\n        - ``self`` -- integer\n\n        - ``n`` -- integer or factorisation matrix\n\n        EXAMPLES::\n\n            sage: pari(3).Zn_sqrt(4)\n            Traceback (most recent call last):\n            ...\n            ValueError: 3 is not a square modulo 4\n            sage: pari(4).Zn_sqrt(30.factor())\n            22\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_385Zn_sqrt(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Zn_sqrt (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_384Zn_sqrt(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_384Zn_sqrt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    GEN __pyx_v_s;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Zn_sqrt", 0);

    /* "gen.pyx":5449
 * 
 *         """
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         cdef GEN s
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5451
 *         cdef gen t0 = objtogen(n)
 *         cdef GEN s
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         s = Zn_sqrt(self.g, t0.g)
 *         if s == NULL:
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5451; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5452
 *         cdef GEN s
 *         pari_catch_sig_on()
 *         s = Zn_sqrt(self.g, t0.g)             # <<<<<<<<<<<<<<
 *         if s == NULL:
 *             pari_catch_sig_off()
 */
    __pyx_v_s = Zn_sqrt(__pyx_v_self->g, __pyx_v_t0->g);

    /* "gen.pyx":5453
 *         pari_catch_sig_on()
 *         s = Zn_sqrt(self.g, t0.g)
 *         if s == NULL:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_off()
 *             raise ValueError("%s is not a square modulo %s" % (self, n))
 */
    __pyx_t_3 = ((__pyx_v_s == NULL) != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":5454
 *         s = Zn_sqrt(self.g, t0.g)
 *         if s == NULL:
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *             raise ValueError("%s is not a square modulo %s" % (self, n))
 *         return P.new_gen(s)
 */
      pari_catch_sig_off();

      /* "gen.pyx":5455
 *         if s == NULL:
 *             pari_catch_sig_off()
 *             raise ValueError("%s is not a square modulo %s" % (self, n))             # <<<<<<<<<<<<<<
 *         return P.new_gen(s)
 * 
 */
      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(((PyObject *)__pyx_v_self));
      PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
      __Pyx_INCREF(__pyx_v_n);
      PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_n);
      __Pyx_GIVEREF(__pyx_v_n);
      __pyx_t_4 = __Pyx_PyString_Format(__pyx_kp_s_s_is_not_a_square_modulo_s, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_Raise(__pyx_t_4, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5455; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":5456
 *             pari_catch_sig_off()
 *             raise ValueError("%s is not a square modulo %s" % (self, n))
 *         return P.new_gen(s)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_s)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5456; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5428
 *         return t != 0
 * 
 *     def Zn_sqrt(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return a square root of ``self`` modulo `n`, if such a square
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.Zn_sqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5463
 *     ##################################################
 * 
 *     def ellinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI elliptic curve object with Weierstrass coefficients
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_387ellinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_386ellinit[] = "\n        Return the PARI elliptic curve object with Weierstrass coefficients\n        given by self, a list with 5 elements.\n\n        INPUT:\n\n\n        -  ``self`` - a list of 5 coefficients\n\n        -  ``flag (optional, default: 0)`` - if 0, ask for a PARI ell\n           structure with 19 components; if 1, ask for a shorted PARI\n           sell structure with only the first 13 components.\n\n        -  ``precision (optional, default: 0)`` - the real\n           precision to be used in the computation of the components of the\n           PARI (s)ell structure; if 0, use the default 64 bits.\n\n           .. note::\n\n              The parameter ``precision`` in ``ellinit`` controls not\n              only the real precision of the resulting (s)ell structure,\n              but in some cases also the precision of most subsequent\n              computations with this elliptic curve (if those rely on\n              the precomputations done by ``ellinit``).  You should\n              therefore set the precision from the start to the value\n              you require.\n\n        OUTPUT:\n\n\n        -  ``gen`` - either a PARI ell structure with 19 components\n           (if flag=0), or a PARI sell structure with 13 components\n           (if flag=1).\n\n\n        EXAMPLES: An elliptic curve with integer coefficients::\n\n            sage: e = pari([0,1,0,1,0]).ellinit(); e\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3, [0.E-28, -0.500000000000000 - 0.866025403784439*I, -0.500000000000000 + 0.866025403784439*I]~, 3.37150070962519, -1.68575035481260 - 2.15651564749964*I, 1.37451455785745 - 1.084202173 E-19*I,      -0.687257278928726 + 0.984434956803824*I, 7.27069403586288] # 32-bit\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3, [0.E-38, -0.500000000000000 - 0.866025403784439*I, -0.500000000000000 + 0.866025403784439*I]~, 3.37150070962519, -1.68575035481260 - 2.15651564749964*I, 1.37451455785745 - 5.42101086242752 E-19*I, -0.68725""7278928726 + 0.984434956803824*I, 7.27069403586288] # 64-bit\n\n        Its inexact components have the default precision of 53 bits::\n\n            sage: RR(e[14])\n            3.37150070962519\n\n        We can compute this to higher precision::\n\n            sage: R = RealField(150)\n            sage: e = pari([0,1,0,1,0]).ellinit(precision=150)\n            sage: R(e[14])\n            3.3715007096251920857424073155981539790016018\n\n        Using flag=1 returns a short elliptic curve PARI object::\n\n            sage: pari([0,1,0,1,0]).ellinit(flag=1)\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3]\n\n        The coefficients can be any ring elements that convert to PARI::\n\n            sage: pari([0,1/2,0,-3/4,0]).ellinit(flag=1)\n            [0, 1/2, 0, -3/4, 0, 2, -3/2, 0, -9/16, 40, -116, 117/4, 256000/117]\n            sage: pari([0,0.5,0,-0.75,0]).ellinit(flag=1)\n            [0, 0.500000000000000, 0, -0.750000000000000, 0, 2.00000000000000, -1.50000000000000, 0, -0.562500000000000, 40.0000000000000, -116.000000000000, 29.2500000000000, 2188.03418803419]\n            sage: pari([0,I,0,1,0]).ellinit(flag=1)\n            [0, I, 0, 1, 0, 4*I, 2, 0, -1, -64, 352*I, -80, 16384/5]\n            sage: pari([0,x,0,2*x,1]).ellinit(flag=1)\n            [0, x, 0, 2*x, 1, 4*x, 4*x, 4, -4*x^2 + 4*x, 16*x^2 - 96*x, -64*x^3 + 576*x^2 - 864, 64*x^4 - 576*x^3 + 576*x^2 - 432, (256*x^6 - 4608*x^5 + 27648*x^4 - 55296*x^3)/(4*x^4 - 36*x^3 + 36*x^2 - 27)]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_387ellinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    CYTHON_UNUSED long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_386ellinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_386ellinit(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellinit", 0);

    /* "gen.pyx":5533
 *             [0, x, 0, 2*x, 1, 4*x, 4*x, 4, -4*x^2 + 4*x, 16*x^2 - 96*x, -64*x^3 + 576*x^2 - 864, 64*x^4 - 576*x^3 + 576*x^2 - 432, (256*x^6 - 4608*x^5 + 27648*x^4 - 55296*x^3)/(4*x^4 - 36*x^3 + 36*x^2 - 27)]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellinit(self.g,NULL, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5534
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ellinit(self.g,NULL, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellglobalred(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellinit(__pyx_v_self->g, NULL, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5463
 *     ##################################################
 * 
 *     def ellinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI elliptic curve object with Weierstrass coefficients
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ellinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5536
 *         return P.new_gen(ellinit(self.g,NULL, prec_bits_to_words(precision)))
 * 
 *     def ellglobalred(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellglobalred(): return information related to the global minimal
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_389ellglobalred(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_388ellglobalred[] = "\n        e.ellglobalred(): return information related to the global minimal\n        model of the elliptic curve e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve (returned by ellinit)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the (arithmetic) conductor of e\n\n        -  ``gen`` - a vector giving the coordinate change over\n           Q from e to its minimal integral model (see also ellminimalmodel)\n\n        -  ``gen`` - the product of the local Tamagawa numbers\n           of e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, 5, 2, -1, 1]).ellinit()\n            sage: e.ellglobalred()\n            [20144, [1, -2, 0, -1], 1]\n            sage: e = pari(EllipticCurve('17a').a_invariants()).ellinit()\n            sage: e.ellglobalred()\n            [17, [1, 0, 0, 0], 4]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_389ellglobalred(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellglobalred (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_388ellglobalred(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_388ellglobalred(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellglobalred", 0);

    /* "gen.pyx":5568
 *             [17, [1, 0, 0, 0], 4]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellglobalred(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5569
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ellglobalred(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def elladd(self, z0, z1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellglobalred(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5536
 *         return P.new_gen(ellinit(self.g,NULL, prec_bits_to_words(precision)))
 * 
 *     def ellglobalred(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellglobalred(): return information related to the global minimal
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ellglobalred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5571
 *         return P.new_gen(ellglobalred(self.g))
 * 
 *     def elladd(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.elladd(z0, z1): return the sum of the points z0 and z1 on this
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_391elladd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_390elladd[] = "\n        e.elladd(z0, z1): return the sum of the points z0 and z1 on this\n        elliptic curve.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve E\n\n        -  ``z0`` - point on E\n\n        -  ``z1`` - point on E\n\n\n        OUTPUT: point on E\n\n        EXAMPLES: First we create an elliptic curve::\n\n            sage: e = pari([0, 1, 1, -2, 0]).ellinit()\n            sage: str(e)[:65]   # first part of output\n            '[0, 1, 1, -2, 0, 4, -4, 1, -3, 112, -856, 389, 1404928/389, [0.90'\n\n        Next we add two points on the elliptic curve. Notice that the\n        Python lists are automatically converted to PARI objects so you\n        don't have to do that explicitly in your code.\n\n        ::\n\n            sage: e.elladd([1,0], [-1,1])\n            [-3/4, -15/8]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_391elladd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elladd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z0,&__pyx_n_s_z1,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("elladd", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elladd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elladd", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elladd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_390elladd(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_390elladd(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elladd", 0);

    /* "gen.pyx":5603
 *             [-3/4, -15/8]
 *         """
 *         cdef gen t0 = objtogen(z0)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5604
 *         """
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(addell(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5605
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(addell(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5606
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 *         return P.new_gen(addell(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def ellak(self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, addell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5571
 *         return P.new_gen(ellglobalred(self.g))
 * 
 *     def elladd(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.elladd(z0, z1): return the sum of the points z0 and z1 on this
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.elladd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5608
 *         return P.new_gen(addell(self.g, t0.g, t1.g))
 * 
 *     def ellak(self, n):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellak(n): Returns the coefficient `a_n` of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_393ellak(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static char __pyx_doc_3gen_3gen_392ellak[] = "\n        e.ellak(n): Returns the coefficient `a_n` of the\n        `L`-function of the elliptic curve e, i.e. the\n        `n`-th Fourier coefficient of the weight 2 newform\n        associated to e (according to Shimura-Taniyama).\n\n            The curve `e` *must* be a medium or long vector of the type\n            given by ellinit. For this function to work for every n and not\n            just those prime to the conductor, e must be a minimal Weierstrass\n            equation. If this is not the case, use the function ellminimalmodel\n            first before using ellak (or you will get INCORRECT RESULTS!)\n\n\n        INPUT:\n\n\n        -  ``e`` - a PARI elliptic curve.\n\n        -  ``n`` - integer.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellak(6)\n            2\n            sage: e.ellak(2005)\n            2\n            sage: e.ellak(-1)\n            0\n            sage: e.ellak(0)\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_393ellak(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellak (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_392ellak(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_392ellak(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellak", 0);

    /* "gen.pyx":5642
 *             0
 *         """
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(akell(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5643
 *         """
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(akell(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5644
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 *         return P.new_gen(akell(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, akell(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5644; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5608
 *         return P.new_gen(addell(self.g, t0.g, t1.g))
 * 
 *     def ellak(self, n):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellak(n): Returns the coefficient `a_n` of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellak", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5647
 * 
 * 
 *     def ellan(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         """
 *         Return the first `n` Fourier coefficients of the modular
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_395ellan(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_394ellan[] = "\n        Return the first `n` Fourier coefficients of the modular\n        form attached to this elliptic curve. See ellak for more details.\n\n        INPUT:\n\n\n        -  ``n`` - a long integer\n\n        -  ``python_ints`` - bool (default is False); if True,\n           return a list of Python ints instead of a PARI gen wrapper.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellan(3)\n            [1, -2, -1]\n            sage: e.ellan(20)\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2, 1, -2, 4, 4, -1, -4, -2, 4, 0, 2]\n            sage: e.ellan(-1)\n            []\n            sage: v = e.ellan(10, python_ints=True); v\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2]\n            sage: type(v)\n            <type 'list'>\n            sage: type(v[0])\n            <type 'int'>\n        ";
  static PyObject *__pyx_pw_3gen_3gen_395ellan(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_python_ints = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_python_ints,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_False);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_python_ints);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_python_ints = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellan", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_394ellan(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_python_ints);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_394ellan(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints) {
    GEN __pyx_v_g;
    PyObject *__pyx_v_v = NULL;
    PyObject *__pyx_v_i = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    Py_ssize_t __pyx_t_6;
    PyObject *(*__pyx_t_7)(PyObject *);
    Py_ssize_t __pyx_t_8;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellan", 0);

    /* "gen.pyx":5677
 *             <type 'int'>
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef GEN g
 *         if python_ints:
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5679
 *         pari_catch_sig_on()
 *         cdef GEN g
 *         if python_ints:             # <<<<<<<<<<<<<<
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_python_ints); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "gen.pyx":5680
 *         cdef GEN g
 *         if python_ints:
 *             g = anell(self.g, n)             # <<<<<<<<<<<<<<
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             P.clear_stack()
 */
      __pyx_v_g = anell(__pyx_v_self->g, __pyx_v_n);

      /* "gen.pyx":5681
 *         if python_ints:
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]             # <<<<<<<<<<<<<<
 *             P.clear_stack()
 *             return v
 */
      __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyInt_From_long(glength(__pyx_v_g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
        __pyx_t_7 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_7)) {
          if (likely(PyList_CheckExact(__pyx_t_5))) {
            if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          } else {
            if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_7(__pyx_t_5);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(__pyx_v_i, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = __Pyx_PyInt_From_long(gtolong(((GEN)(__pyx_v_g[__pyx_t_8])))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_v = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "gen.pyx":5682
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             P.clear_stack()             # <<<<<<<<<<<<<<
 *             return v
 *         else:
 */
      ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->clear_stack(__pyx_v_3gen_P);

      /* "gen.pyx":5683
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             P.clear_stack()
 *             return v             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(anell(self.g, n))
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_v);
      __pyx_r = __pyx_v_v;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":5685
 *             return v
 *         else:
 *             return P.new_gen(anell(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def ellanalyticrank(self, unsigned long precision=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, anell(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5647
 * 
 * 
 *     def ellan(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         """
 *         Return the first `n` Fourier coefficients of the modular
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen.gen.ellan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_v);
    __Pyx_XDECREF(__pyx_v_i);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5687
 *             return P.new_gen(anell(self.g, n))
 * 
 *     def ellanalyticrank(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a 2-component vector with the order of vanishing at
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_397ellanalyticrank(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_396ellanalyticrank[] = "\n        Returns a 2-component vector with the order of vanishing at\n        `s = 1` of the L-function of the elliptic curve and the value\n        of the first non-zero derivative.\n\n        EXAMPLE::\n\n            sage: E = EllipticCurve('389a1')\n            sage: pari(E).ellanalyticrank()\n            [2, 1.51863300057685]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_397ellanalyticrank(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellanalyticrank (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellanalyticrank") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellanalyticrank", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellanalyticrank", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_396ellanalyticrank(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_396ellanalyticrank(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellanalyticrank", 0);

    /* "gen.pyx":5699
 *             [2, 1.51863300057685]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellanalyticrank(self.g, <GEN>0, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5700
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ellanalyticrank(self.g, <GEN>0, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellap(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellanalyticrank(__pyx_v_self->g, ((GEN)0), __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5687
 *             return P.new_gen(anell(self.g, n))
 * 
 *     def ellanalyticrank(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a 2-component vector with the order of vanishing at
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ellanalyticrank", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5702
 *         return P.new_gen(ellanalyticrank(self.g, <GEN>0, prec_bits_to_words(precision)))
 * 
 *     def ellap(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellap(p): Returns the prime-indexed coefficient `a_p` of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_399ellap(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_398ellap[] = "\n        e.ellap(p): Returns the prime-indexed coefficient `a_p` of the\n        `L`-function of the elliptic curve `e`, i.e. the `p`-th Fourier\n        coefficient of the newform attached to e.\n\n        The computation uses the Shanks--Mestre method, or the SEA\n        algorithm.\n\n        .. WARNING::\n\n            For this function to work for every n and not just those prime\n            to the conductor, e must be a minimal Weierstrass equation.\n            If this is not the case, use the function ellminimalmodel first\n            before using ellap (or you will get INCORRECT RESULTS!)\n\n\n        INPUT:\n\n\n        -  ``e`` - a PARI elliptic curve.\n\n        -  ``p`` - prime integer\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellap(2)\n            -2\n            sage: e.ellap(2003)\n            4\n            sage: e.ellak(-1)\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_399ellap(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellap (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_398ellap(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_398ellap(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellap", 0);

    /* "gen.pyx":5737
 *             0
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellap(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5738
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellap(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5739
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellap(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellap(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5739; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5702
 *         return P.new_gen(ellanalyticrank(self.g, <GEN>0, prec_bits_to_words(precision)))
 * 
 *     def ellap(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellap(p): Returns the prime-indexed coefficient `a_p` of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellap", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5742
 * 
 * 
 *     def ellaplist(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellaplist(n): Returns a PARI list of all the prime-indexed
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_401ellaplist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_400ellaplist[] = "\n        e.ellaplist(n): Returns a PARI list of all the prime-indexed\n        coefficients `a_p` (up to n) of the `L`-function\n        of the elliptic curve `e`, i.e. the Fourier coefficients of\n        the newform attached to `e`.\n\n        INPUT:\n\n        - ``self`` -- an elliptic curve\n\n        - ``n`` -- a long integer\n\n        - ``python_ints`` -- bool (default is False); if True,\n          return a list of Python ints instead of a PARI gen wrapper.\n\n        .. WARNING::\n\n            The curve e must be a medium or long vector of the type given by\n            ellinit. For this function to work for every n and not just those\n            prime to the conductor, e must be a minimal Weierstrass equation.\n            If this is not the case, use the function ellminimalmodel first\n            before using ellaplist (or you will get INCORRECT RESULTS!)\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: v = e.ellaplist(10); v\n            [-2, -1, 1, -2]\n            sage: type(v)\n            <type 'gen.gen'>\n            sage: v.type()\n            't_VEC'\n            sage: e.ellan(10)\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2]\n            sage: v = e.ellaplist(10, python_ints=True); v\n            [-2, -1, 1, -2]\n            sage: type(v)\n            <type 'list'>\n            sage: type(v[0])\n            <type 'int'>\n\n        TESTS::\n\n            sage: v = e.ellaplist(1)\n            sage: print v, type(v)\n            [] <type 'gen.gen'>\n            sage: v = e.ellaplist(1, python_ints=True)\n            sage: print v, type(v)\n            [] <type 'list'>\n        ";
  static PyObject *__pyx_pw_3gen_3gen_401ellaplist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_python_ints = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellaplist (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_python_ints,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_False);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_python_ints);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellaplist") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5742; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5742; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_python_ints = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellaplist", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5742; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellaplist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_400ellaplist(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_python_ints);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_400ellaplist(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    GEN __pyx_v_g;
    long __pyx_v_i;
    PyObject *__pyx_v_x = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    Py_ssize_t __pyx_t_8;
    PyObject *(*__pyx_t_9)(PyObject *);
    int __pyx_t_10;
    long __pyx_t_11;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellaplist", 0);

    /* "gen.pyx":5793
 *             [] <type 'list'>
 *         """
 *         if python_ints:             # <<<<<<<<<<<<<<
 *             return [int(x) for x in self.ellaplist(n)]
 * 
 */
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_python_ints); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_1) {

      /* "gen.pyx":5794
 *         """
 *         if python_ints:
 *             return [int(x) for x in self.ellaplist(n)]             # <<<<<<<<<<<<<<
 * 
 *         if n < 2:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_ellaplist); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
        if (likely(__pyx_t_6)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
          __Pyx_INCREF(__pyx_t_6);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_GOTREF(__pyx_t_3);
      } else {
        __pyx_t_7 = PyTuple_New(1+1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_7);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6); __Pyx_GIVEREF(__pyx_t_6); __pyx_t_6 = NULL;
        PyTuple_SET_ITEM(__pyx_t_7, 0+1, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
        __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_8 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      for (;;) {
        if (likely(!__pyx_t_9)) {
          if (likely(PyList_CheckExact(__pyx_t_4))) {
            if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          } else {
            if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          }
        } else {
          __pyx_t_3 = __pyx_t_9(__pyx_t_4);
          if (unlikely(!__pyx_t_3)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_3);
        }
        __Pyx_XDECREF_SET(__pyx_v_x, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Int(__pyx_v_x); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely(__Pyx_ListComp_Append(__pyx_t_2, (PyObject*)__pyx_t_3))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5796
 *             return [int(x) for x in self.ellaplist(n)]
 * 
 *         if n < 2:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(zerovec(0))
 */
    __pyx_t_1 = ((__pyx_v_n < 2) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":5797
 * 
 *         if n < 2:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(zerovec(0))
 * 
 */
      __pyx_t_10 = pari_catch_sig_on(); if (unlikely(__pyx_t_10 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":5798
 *         if n < 2:
 *             pari_catch_sig_on()
 *             return P.new_gen(zerovec(0))             # <<<<<<<<<<<<<<
 * 
 *         # 1. Make a table of primes up to n.
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, zerovec(0))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":5801
 * 
 *         # 1. Make a table of primes up to n.
 *         P.init_primes(n+1)             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 */
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_init_primes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = __Pyx_PyInt_From_long((__pyx_v_n + 1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_GOTREF(__pyx_t_2);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7); __Pyx_GIVEREF(__pyx_t_7); __pyx_t_7 = NULL;
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "gen.pyx":5802
 *         # 1. Make a table of primes up to n.
 *         P.init_primes(n+1)
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef GEN g = primes(gtolong(primepi(t0.g)))
 */
    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_t_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":5803
 *         P.init_primes(n+1)
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef GEN g = primes(gtolong(primepi(t0.g)))
 * 
 */
    __pyx_t_10 = pari_catch_sig_on(); if (unlikely(__pyx_t_10 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5803; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5804
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 *         cdef GEN g = primes(gtolong(primepi(t0.g)))             # <<<<<<<<<<<<<<
 * 
 *         # 2. Replace each prime in the table by ellap of it.
 */
    __pyx_v_g = primes(gtolong(primepi(__pyx_v_t0->g)));

    /* "gen.pyx":5808
 *         # 2. Replace each prime in the table by ellap of it.
 *         cdef long i
 *         for i from 0 <= i < glength(g):             # <<<<<<<<<<<<<<
 *             set_gel(g, i + 1, ellap(self.g, gel(g, i + 1)))
 *         return P.new_gen(g)
 */
    __pyx_t_11 = glength(__pyx_v_g);
    for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_11; __pyx_v_i++) {

      /* "gen.pyx":5809
 *         cdef long i
 *         for i from 0 <= i < glength(g):
 *             set_gel(g, i + 1, ellap(self.g, gel(g, i + 1)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(g)
 * 
 */
      set_gel(__pyx_v_g, (__pyx_v_i + 1), ellap(__pyx_v_self->g, gel(__pyx_v_g, (__pyx_v_i + 1))));
    }

    /* "gen.pyx":5810
 *         for i from 0 <= i < glength(g):
 *             set_gel(g, i + 1, ellap(self.g, gel(g, i + 1)))
 *         return P.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 *     def ellbil(self, z0, z1, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5742
 * 
 * 
 *     def ellaplist(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellaplist(n): Returns a PARI list of all the prime-indexed
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_AddTraceback("gen.gen.ellaplist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF(__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5812
 *         return P.new_gen(g)
 * 
 *     def ellbil(self, z0, z1, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellbil(z0, z1): return the value of the canonical bilinear form
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_403ellbil(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_402ellbil[] = "\n        e.ellbil(z0, z1): return the value of the canonical bilinear form\n        on z0 and z1.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve (assumed integral given by a\n           minimal model, as returned by ellminimalmodel)\n\n        -  ``z0, z1`` - rational points on e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellbil([1, 0], [-1, 1])\n            0.418188984498861\n        ";
  static PyObject *__pyx_pw_3gen_3gen_403ellbil(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellbil (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z0,&__pyx_n_s_z1,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellbil", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5812; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellbil") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5812; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5812; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellbil", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5812; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellbil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_402ellbil(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_402ellbil(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellbil", 0);

    /* "gen.pyx":5832
 *             0.418188984498861
 *         """
 *         cdef gen t0 = objtogen(z0)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5833
 *         """
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bilhell(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5834
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bilhell(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5835
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 *         return P.new_gen(bilhell(self.g, t0.g, t1.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellchangecurve(self, ch):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bilhell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5812
 *         return P.new_gen(g)
 * 
 *     def ellbil(self, z0, z1, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellbil(z0, z1): return the value of the canonical bilinear form
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellbil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5837
 *         return P.new_gen(bilhell(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def ellchangecurve(self, ch):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellchangecurve(ch): return the new model (equation) for the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_405ellchangecurve(PyObject *__pyx_v_self, PyObject *__pyx_v_ch); /*proto*/
  static char __pyx_doc_3gen_3gen_404ellchangecurve[] = "\n        e.ellchangecurve(ch): return the new model (equation) for the\n        elliptic curve e given by the change of coordinates ch.\n\n        The change of coordinates is specified by a vector ch=[u,r,s,t]; if\n        `x'` and `y'` are the new coordinates, then\n        `x = u^2 x' + r` and `y = u^3 y' + su^2 x' + t`.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``ch`` - change of coordinates vector with 4\n           entries\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,2,3,4,5]).ellinit()\n            sage: e.ellglobalred()\n            [10351, [1, -1, 0, -1], 1]\n            sage: f = e.ellchangecurve([1,-1,0,-1])\n            sage: f[:5]\n            [1, -1, 0, 4, 3]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_405ellchangecurve(PyObject *__pyx_v_self, PyObject *__pyx_v_ch) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellchangecurve (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_404ellchangecurve(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_ch));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_404ellchangecurve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_ch) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellchangecurve", 0);

    /* "gen.pyx":5864
 *             [1, -1, 0, 4, 3]
 *         """
 *         cdef gen t0 = objtogen(ch)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellchangecurve(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_ch)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5865
 *         """
 *         cdef gen t0 = objtogen(ch)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellchangecurve(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5866
 *         cdef gen t0 = objtogen(ch)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellchangecurve(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def elleta(self, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellchangecurve(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5837
 *         return P.new_gen(bilhell(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def ellchangecurve(self, ch):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellchangecurve(ch): return the new model (equation) for the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellchangecurve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5868
 *         return P.new_gen(ellchangecurve(self.g, t0.g))
 * 
 *     def elleta(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elleta(): return the vector [eta1,eta2] of quasi-periods
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_407elleta(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_406elleta[] = "\n        e.elleta(): return the vector [eta1,eta2] of quasi-periods\n        associated with the period lattice e.omega() of the elliptic curve\n        e.\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,-82,0]).ellinit()\n            sage: e.elleta()\n            [3.60546360143265, 3.60546360143265*I]\n            sage: w1,w2 = e.omega()\n            sage: eta1, eta2 = e.elleta()\n            sage: w1*eta2-w2*eta1\n            6.28318530717959*I\n            sage: w1*eta2-w2*eta1 == pari(2*pi*I)\n            True\n            sage: pari([0,0,0,-82,0]).ellinit(flag=1).elleta()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in elleta\n        ";
  static PyObject *__pyx_pw_3gen_3gen_407elleta(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elleta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elleta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elleta", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5868; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elleta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_406elleta(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_406elleta(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elleta", 0);

    /* "gen.pyx":5890
 *             PariError: incorrect type in elleta
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(elleta(self.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5890; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5891
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(elleta(self.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellheight(self, a, long flag=2, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, elleta(__pyx_v_self->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5868
 *         return P.new_gen(ellchangecurve(self.g, t0.g))
 * 
 *     def elleta(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elleta(): return the vector [eta1,eta2] of quasi-periods
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.elleta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5893
 *         return P.new_gen(elleta(self.g, prec_bits_to_words(precision)))
 * 
 *     def ellheight(self, a, long flag=2, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheight(a, flag=2): return the global Neron-Tate height of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_409ellheight(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_408ellheight[] = "\n        e.ellheight(a, flag=2): return the global Neron-Tate height of the\n        point a on the elliptic curve e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`,\n           assumed to be in a standard minimal integral model (as given by\n           ellminimalmodel)\n\n        -  ``a`` - rational point on e\n\n        -  ``flag (optional)`` - specifies which algorithm to\n           be used for computing the archimedean local height:\n\n           -  ``0`` - uses sigma- and theta-functions and a trick\n               due to J. Silverman\n\n           -  ``1`` - uses Tate's `4^n` algorithm\n\n           -  ``2`` - uses Mestre's AGM algorithm (this is the\n              default, being faster than the other two)\n\n        -  ``precision (optional)`` - the precision of the\n           result, in bits.\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellheight([1,0])\n            0.476711659343740\n            sage: e.ellheight([1,0], flag=0)\n            0.476711659343740\n            sage: e.ellheight([1,0], flag=1)\n            0.476711659343740\n            sage: e.ellheight([1,0], precision=128).sage()\n            0.47671165934373953737948605888465305932\n        ";
  static PyObject *__pyx_pw_3gen_3gen_409ellheight(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellheight (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_a,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellheight") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5893; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5893; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)2);
      }
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5893; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellheight", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5893; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellheight", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_408ellheight(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_408ellheight(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellheight", 0);

    /* "gen.pyx":5933
 *             0.47671165934373953737948605888465305932
 *         """
 *         cdef gen t0 = objtogen(a)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellheight0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5934
 *         """
 *         cdef gen t0 = objtogen(a)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellheight0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5935
 *         cdef gen t0 = objtogen(a)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellheight0(self.g, t0.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellheightmatrix(self, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellheight0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5893
 *         return P.new_gen(elleta(self.g, prec_bits_to_words(precision)))
 * 
 *     def ellheight(self, a, long flag=2, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheight(a, flag=2): return the global Neron-Tate height of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellheight", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5937
 *         return P.new_gen(ellheight0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellheightmatrix(self, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheightmatrix(x): return the height matrix for the vector x of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_411ellheightmatrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_410ellheightmatrix[] = "\n        e.ellheightmatrix(x): return the height matrix for the vector x of\n        points on the elliptic curve e.\n\n        In other words, it returns the Gram matrix of x with respect to the\n        height bilinear form on e (see ellbil).\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`,\n           assumed to be in a standard minimal integral model (as given by\n           ellminimalmodel)\n\n        -  ``x`` - vector of rational points on e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellheightmatrix([[1,0], [-1,1]])\n            [0.476711659343740, 0.418188984498861; 0.418188984498861, 0.686667083305587]\n\n        It is allowed to call :meth:`ellinit` with ``flag=1``::\n\n            sage: E = pari([0,1,1,-2,0]).ellinit(flag=1)\n            sage: E.ellheightmatrix([[1,0], [-1,1]], precision=128).sage()\n            [0.47671165934373953737948605888465305932 0.41818898449886058562988945821587638244]\n            [0.41818898449886058562988945821587638244 0.68666708330558658572355210295409678904]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_411ellheightmatrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellheightmatrix (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellheightmatrix") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5937; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5937; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellheightmatrix", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5937; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellheightmatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_410ellheightmatrix(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_410ellheightmatrix(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellheightmatrix", 0);

    /* "gen.pyx":5968
 *             [0.41818898449886058562988945821587638244 0.68666708330558658572355210295409678904]
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(mathell(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5969
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(mathell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5970
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(mathell(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellisoncurve(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, mathell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5937
 *         return P.new_gen(ellheight0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellheightmatrix(self, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheightmatrix(x): return the height matrix for the vector x of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellheightmatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":5972
 *         return P.new_gen(mathell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellisoncurve(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellisoncurve(x): return True if the point x is on the elliptic
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_413ellisoncurve(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_412ellisoncurve[] = "\n        e.ellisoncurve(x): return True if the point x is on the elliptic\n        curve e, False otherwise.\n\n        If the point or the curve have inexact coefficients, an attempt is\n        made to take this into account.\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.ellisoncurve([1,0])\n            True\n            sage: e.ellisoncurve([1,1])\n            False\n            sage: e.ellisoncurve([1,0.00000000000000001])\n            False\n            sage: e.ellisoncurve([1,0.000000000000000001])\n            True\n            sage: e.ellisoncurve([0])\n            True\n        ";
  static PyObject *__pyx_pw_3gen_3gen_413ellisoncurve(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellisoncurve (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_412ellisoncurve(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_412ellisoncurve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    int __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellisoncurve", 0);

    /* "gen.pyx":5994
 *             True
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         cdef int t = oncurve(self.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":5995
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef int t = oncurve(self.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5995; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":5996
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         cdef int t = oncurve(self.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return t != 0
 */
    __pyx_v_t = oncurve(__pyx_v_self->g, __pyx_v_t0->g);

    /* "gen.pyx":5997
 *         pari_catch_sig_on()
 *         cdef int t = oncurve(self.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return t != 0
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":5998
 *         cdef int t = oncurve(self.g, t0.g)
 *         pari_catch_sig_off()
 *         return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def elllocalred(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":5972
 *         return P.new_gen(mathell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellisoncurve(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellisoncurve(x): return True if the point x is on the elliptic
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellisoncurve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6000
 *         return t != 0
 * 
 *     def elllocalred(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.elllocalred(p): computes the data of local reduction at the prime
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_415elllocalred(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_414elllocalred[] = "\n        e.elllocalred(p): computes the data of local reduction at the prime\n        p on the elliptic curve e\n\n        For more details on local reduction and Kodaira types, see IV.8 and\n        IV.9 in J. Silverman's book \"Advanced topics in the arithmetic of\n        elliptic curves\".\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve with coefficients in `\\ZZ`\n\n        -  ``p`` - prime number\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the exponent of p in the arithmetic\n           conductor of e\n\n        -  ``gen`` - the Kodaira type of e at p, encoded as an\n           integer:\n\n        -  ``1`` - type `I_0`: good reduction,\n           nonsingular curve of genus 1\n\n        -  ``2`` - type `II`: rational curve with a\n           cusp\n\n        -  ``3`` - type `III`: two nonsingular rational\n           curves intersecting tangentially at one point\n\n        -  ``4`` - type `IV`: three nonsingular\n           rational curves intersecting at one point\n\n        -  ``5`` - type `I_1`: rational curve with a\n           node\n\n        -  ``6 or larger`` - think of it as `4+v`, then\n           it is type `I_v`: `v` nonsingular rational curves\n           arranged as a `v`-gon\n\n        -  ``-1`` - type `I_0^*`: nonsingular rational\n           curve of multiplicity two with four nonsingular rational curves of\n           multiplicity one attached\n\n        -  ``-2`` - type `II^*`: nine nonsingular\n           rational curves in a special configuration\n\n        -  ``-3`` - type `III^*`: eight nonsingular\n           rational curves in a special configuration\n\n        -  ``-4`` - type `IV^*`: seven nonsingular\n           rational curves in a special configuration\n\n        -  ``-5 or smaller`` - think of it as `-4-v`,\n           then it is type `I_v^*`: chain of `v+1`\n           nonsingular rational curves of multiplicity two, with two\n           nonsingular rational curves of multiplicity one attached at either\n           en""d\n\n        -  ``gen`` - a vector with 4 components, giving the\n           coordinate changes done during the local reduction; if the first\n           component is 1, then the equation for e was already minimal at p\n\n        -  ``gen`` - the local Tamagawa number `c_p`\n\n\n        EXAMPLES:\n\n        Type `I_0`::\n\n            sage: e = pari([0,0,0,0,1]).ellinit()\n            sage: e.elllocalred(7)\n            [0, 1, [1, 0, 0, 0], 1]\n\n        Type `II`::\n\n            sage: e = pari(EllipticCurve('27a3').a_invariants()).ellinit()\n            sage: e.elllocalred(3)\n            [3, 2, [1, -1, 0, 1], 1]\n\n        Type `III`::\n\n            sage: e = pari(EllipticCurve('24a4').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, 3, [1, 1, 0, 1], 2]\n\n        Type `IV`::\n\n            sage: e = pari(EllipticCurve('20a2').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [2, 4, [1, 1, 0, 1], 3]\n\n        Type `I_1`::\n\n            sage: e = pari(EllipticCurve('11a2').a_invariants()).ellinit()\n            sage: e.elllocalred(11)\n            [1, 5, [1, 0, 0, 0], 1]\n\n        Type `I_2`::\n\n            sage: e = pari(EllipticCurve('14a4').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [1, 6, [1, 0, 0, 0], 2]\n\n        Type `I_6`::\n\n            sage: e = pari(EllipticCurve('14a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [1, 10, [1, 0, 0, 0], 2]\n\n        Type `I_0^*`::\n\n            sage: e = pari(EllipticCurve('32a3').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [5, -1, [1, 1, 1, 0], 1]\n\n        Type `II^*`::\n\n            sage: e = pari(EllipticCurve('24a5').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, -2, [1, 2, 1, 4], 1]\n\n        Type `III^*`::\n\n            sage: e = pari(EllipticCurve('24a2').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n     ""       [3, -3, [1, 2, 1, 4], 2]\n\n        Type `IV^*`::\n\n            sage: e = pari(EllipticCurve('20a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [2, -4, [1, 0, 1, 2], 3]\n\n        Type `I_1^*`::\n\n            sage: e = pari(EllipticCurve('24a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, -5, [1, 0, 1, 2], 4]\n\n        Type `I_6^*`::\n\n            sage: e = pari(EllipticCurve('90c2').a_invariants()).ellinit()\n            sage: e.elllocalred(3)\n            [2, -10, [1, 96, 1, 316], 4]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_415elllocalred(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elllocalred (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_414elllocalred(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_414elllocalred(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elllocalred", 0);

    /* "gen.pyx":6151
 *             [2, -10, [1, 96, 1, 316], 4]
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(elllocalred(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6152
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(elllocalred(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6153
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(elllocalred(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def elllseries(self, s, A=1, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, elllocalred(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6000
 *         return t != 0
 * 
 *     def elllocalred(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.elllocalred(p): computes the data of local reduction at the prime
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.elllocalred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6155
 *         return P.new_gen(elllocalred(self.g, t0.g))
 * 
 *     def elllseries(self, s, A=1, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elllseries(s, A=1): return the value of the `L`-series of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_417elllseries(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_416elllseries[] = "\n        e.elllseries(s, A=1): return the value of the `L`-series of\n        the elliptic curve e at the complex number s.\n\n        This uses an `O(N^{1/2})` algorithm in the conductor N of\n        e, so it is impractical for large conductors (say greater than\n        `10^{12}`).\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve defined over `\\QQ`\n\n        -  ``s`` - complex number\n\n        -  ``A (optional)`` - cutoff point for the integral,\n           which must be chosen close to 1 for best speed.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.elllseries(2.1)\n            0.402838047956645\n            sage: e.elllseries(1, precision=128)\n            2.87490929644255 E-38\n            sage: e.elllseries(1, precision=256)\n            3.00282377034977 E-77\n            sage: e.elllseries(-2)\n            0\n            sage: e.elllseries(2.1, A=1.1)\n            0.402838047956645\n        ";
  static PyObject *__pyx_pw_3gen_3gen_417elllseries(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    PyObject *__pyx_v_A = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elllseries (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_s,&__pyx_n_s_A,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)__pyx_int_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_s)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_A);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elllseries") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_s = values[0];
      __pyx_v_A = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elllseries", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6155; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elllseries", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_416elllseries(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_s, __pyx_v_A, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_416elllseries(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_A, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elllseries", 0);

    /* "gen.pyx":6189
 *             0.402838047956645
 *         """
 *         cdef gen t0 = objtogen(s)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(A)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_s)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6190
 *         """
 *         cdef gen t0 = objtogen(s)
 *         cdef gen t1 = objtogen(A)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(elllseries(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_A)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6191
 *         cdef gen t0 = objtogen(s)
 *         cdef gen t1 = objtogen(A)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(elllseries(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6192
 *         cdef gen t1 = objtogen(A)
 *         pari_catch_sig_on()
 *         return P.new_gen(elllseries(self.g, t0.g, t1.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellminimalmodel(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, elllseries(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6155
 *         return P.new_gen(elllocalred(self.g, t0.g))
 * 
 *     def elllseries(self, s, A=1, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elllseries(s, A=1): return the value of the `L`-series of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.elllseries", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6194
 *         return P.new_gen(elllseries(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def ellminimalmodel(self):             # <<<<<<<<<<<<<<
 *         """
 *         ellminimalmodel(e): return the standard minimal integral model of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_419ellminimalmodel(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_418ellminimalmodel[] = "\n        ellminimalmodel(e): return the standard minimal integral model of\n        the rational elliptic curve e and the corresponding change of\n        variables. INPUT:\n\n\n        -  ``e`` - gen (that defines an elliptic curve)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - minimal model\n\n        -  ``gen`` - change of coordinates\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,2,3,4,5]).ellinit()\n            sage: F, ch = e.ellminimalmodel()\n            sage: F[:5]\n            [1, -1, 0, 4, 3]\n            sage: ch\n            [1, -1, 0, -1]\n            sage: e.ellchangecurve(ch)[:5]\n            [1, -1, 0, 4, 3]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_419ellminimalmodel(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellminimalmodel (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_418ellminimalmodel(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_418ellminimalmodel(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    GEN __pyx_v_x;
    GEN __pyx_v_y;
    struct __pyx_obj_3gen_gen *__pyx_v_model = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_change = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellminimalmodel", 0);

    /* "gen.pyx":6226
 *         cdef gen model, change
 *         cdef pari_sp t
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         x = ellminimalmodel(self.g, &y)
 *         change = P.new_gen_noclear(y)
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6227
 *         cdef pari_sp t
 *         pari_catch_sig_on()
 *         x = ellminimalmodel(self.g, &y)             # <<<<<<<<<<<<<<
 *         change = P.new_gen_noclear(y)
 *         model = P.new_gen(x)
 */
    __pyx_v_x = ellminimalmodel(__pyx_v_self->g, (&__pyx_v_y));

    /* "gen.pyx":6228
 *         pari_catch_sig_on()
 *         x = ellminimalmodel(self.g, &y)
 *         change = P.new_gen_noclear(y)             # <<<<<<<<<<<<<<
 *         model = P.new_gen(x)
 *         return model, change
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, __pyx_v_y)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_change = ((struct __pyx_obj_3gen_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "gen.pyx":6229
 *         x = ellminimalmodel(self.g, &y)
 *         change = P.new_gen_noclear(y)
 *         model = P.new_gen(x)             # <<<<<<<<<<<<<<
 *         return model, change
 * 
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_x)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_model = ((struct __pyx_obj_3gen_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "gen.pyx":6230
 *         change = P.new_gen_noclear(y)
 *         model = P.new_gen(x)
 *         return model, change             # <<<<<<<<<<<<<<
 * 
 *     def ellorder(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(((PyObject *)__pyx_v_model));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_model));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_model));
    __Pyx_INCREF(((PyObject *)__pyx_v_change));
    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_change));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_change));
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6194
 *         return P.new_gen(elllseries(self.g, t0.g, t1.g, prec_bits_to_words(precision)))
 * 
 *     def ellminimalmodel(self):             # <<<<<<<<<<<<<<
 *         """
 *         ellminimalmodel(e): return the standard minimal integral model of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ellminimalmodel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_model);
    __Pyx_XDECREF((PyObject *)__pyx_v_change);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6232
 *         return model, change
 * 
 *     def ellorder(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellorder(x): return the order of the point x on the elliptic
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_421ellorder(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_420ellorder[] = "\n        e.ellorder(x): return the order of the point x on the elliptic\n        curve e (return 0 if x is not a torsion point)\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve defined over `\\QQ`\n\n        -  ``x`` - point on e\n\n\n        EXAMPLES::\n\n            sage: e = pari(EllipticCurve('65a1').a_invariants()).ellinit()\n\n        A point of order two::\n\n            sage: e.ellorder([0,0])\n            2\n\n        And a point of infinite order::\n\n            sage: e.ellorder([1,0])\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_421ellorder(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellorder (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_420ellorder(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_420ellorder(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellorder", 0);

    /* "gen.pyx":6259
 *             0
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(orderell(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6260
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(orderell(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6261
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(orderell(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def ellordinate(self, x, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, orderell(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6232
 *         return model, change
 * 
 *     def ellorder(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellorder(x): return the order of the point x on the elliptic
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellorder", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6263
 *         return P.new_gen(orderell(self.g, t0.g))
 * 
 *     def ellordinate(self, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellordinate(x): return the `y`-coordinates of the points
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_423ellordinate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_422ellordinate[] = "\n        e.ellordinate(x): return the `y`-coordinates of the points\n        on the elliptic curve e having x as `x`-coordinate.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``x`` - x-coordinate (can be a complex or p-adic\n           number, or a more complicated object like a power series)\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.ellordinate(0)\n            [0, -1]\n            sage: e.ellordinate(I)\n            [0.582203589721741 - 1.38606082464177*I, -1.58220358972174 + 1.38606082464177*I]\n            sage: e.ellordinate(I, precision=128)[0].sage()\n            0.58220358972174117723338947874993600727 - 1.3860608246417697185311834209833653345*I\n            sage: e.ellordinate(1+3*5^1+O(5^3))\n            [4*5 + 5^2 + O(5^3), 4 + 3*5^2 + O(5^3)]\n            sage: e.ellordinate('z+2*z^2+O(z^4)')\n            [-2*z - 7*z^2 - 23*z^3 + O(z^4), -1 + 2*z + 7*z^2 + 23*z^3 + O(z^4)]\n\n        The field in which PARI looks for the point depends on the\n        input field::\n\n            sage: e.ellordinate(5)\n            []\n            sage: e.ellordinate(5.0)\n            [11.3427192823270, -12.3427192823270]\n            sage: e.ellordinate(RR(-3))\n            [-1/2 + 3.42782730020052*I, -1/2 - 3.42782730020052*I]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_423ellordinate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellordinate (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellordinate") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6263; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6263; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellordinate", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6263; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellordinate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_422ellordinate(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_422ellordinate(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellordinate", 0);

    /* "gen.pyx":6301
 *             [-1/2 + 3.42782730020052*I, -1/2 - 3.42782730020052*I]
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellordinate(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6302
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellordinate(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6303
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellordinate(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellpointtoz(self, pt, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellordinate(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6263
 *         return P.new_gen(orderell(self.g, t0.g))
 * 
 *     def ellordinate(self, x, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellordinate(x): return the `y`-coordinates of the points
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellordinate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6305
 *         return P.new_gen(ellordinate(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellpointtoz(self, pt, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpointtoz(pt): return the complex number (in the fundamental
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_425ellpointtoz(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_424ellpointtoz[] = "\n        e.ellpointtoz(pt): return the complex number (in the fundamental\n        parallelogram) corresponding to the point ``pt`` on the elliptic curve\n        e, under the complex uniformization of e given by the Weierstrass\n        p-function.\n\n        The complex number z returned by this function lies in the\n        parallelogram formed by the real and complex periods of e, as given\n        by e.omega().\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: e.ellpointtoz([0,0])\n            1.85407467730137\n\n        The point at infinity is sent to the complex number 0::\n\n            sage: e.ellpointtoz([0])\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_425ellpointtoz(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_pt = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellpointtoz (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_pt,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pt)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellpointtoz") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_pt = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellpointtoz", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellpointtoz", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_424ellpointtoz(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_pt, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_424ellpointtoz(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_pt, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellpointtoz", 0);

    /* "gen.pyx":6327
 *             0
 *         """
 *         cdef gen t0 = objtogen(pt)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(zell(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_pt)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6328
 *         """
 *         cdef gen t0 = objtogen(pt)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(zell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6329
 *         cdef gen t0 = objtogen(pt)
 *         pari_catch_sig_on()
 *         return P.new_gen(zell(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellpow(self, z, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, zell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6305
 *         return P.new_gen(ellordinate(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellpointtoz(self, pt, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpointtoz(pt): return the complex number (in the fundamental
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellpointtoz", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6331
 *         return P.new_gen(zell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellpow(self, z, n):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpow(z, n): return `n` times the point `z` on the elliptic
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_427ellpow(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_426ellpow[] = "\n        e.ellpow(z, n): return `n` times the point `z` on the elliptic\n        curve `e`.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - point on `e`\n\n        -  ``n`` - integer, or a complex quadratic integer of complex\n           multiplication for `e`. Complex multiplication currently\n           only works if `e` is defined over `Q`.\n\n\n        EXAMPLES: We consider a curve with CM by `Z[i]`::\n\n            sage: e = pari([0,0,0,3,0]).ellinit()\n            sage: p = [1,2]  # Point of infinite order\n\n        Multiplication by two::\n\n            sage: e.ellpow([0,0], 2)\n            [0]\n            sage: e.ellpow(p, 2)\n            [1/4, -7/8]\n\n        Complex multiplication::\n\n            sage: q = e.ellpow(p, 1+I); q\n            [-2*I, 1 + I]\n            sage: e.ellpow(q, 1-I)\n            [1/4, -7/8]\n\n        TESTS::\n\n            sage: for D in [-7, -8, -11, -12, -16, -19, -27, -28]:  # long time (1s)\n            ....:     hcpol = hilbert_class_polynomial(D)\n            ....:     j = hcpol.roots(multiplicities=False)[0]\n            ....:     t = (1728-j)/(27*j)\n            ....:     E = EllipticCurve([4*t,16*t^2])\n            ....:     P = E.point([0, 4*t])\n            ....:     assert(E.j_invariant() == j)\n            ....:     #\n            ....:     # Compute some CM number and its minimal polynomial\n            ....:     #\n            ....:     cm = pari('cm = (3*quadgen(%s)+2)'%D)\n            ....:     cm_minpoly = pari('minpoly(cm)')\n            ....:     #\n            ....:     # Evaluate cm_minpoly(cm)(P), which should be zero\n            ....:     #\n            ....:     e = pari(E)  # Convert E to PARI\n            ....:     P2 = e.ellpow(P, cm_minpoly[2]*cm + cm_minpoly[1])\n            ....:     P0 = e.elladd(e.ellpow(P, cm_minpoly[0]), e.ellpow(P2, cm))\n            ....:     assert(P0 == E(0))\n        ";
  static PyObject *__pyx_pw_3gen_3gen_427ellpow(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_v_n = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellpow (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellpow", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellpow") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z = values[0];
      __pyx_v_n = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellpow", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellpow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_426ellpow(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_426ellpow(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellpow", 0);

    /* "gen.pyx":6389
 *             ....:     assert(P0 == E(0))
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(n)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6390
 *         """
 *         cdef gen t0 = objtogen(z)
 *         cdef gen t1 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(powell(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6391
 *         cdef gen t0 = objtogen(z)
 *         cdef gen t1 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(powell(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6392
 *         cdef gen t1 = objtogen(n)
 *         pari_catch_sig_on()
 *         return P.new_gen(powell(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def ellrootno(self, p=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, powell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6331
 *         return P.new_gen(zell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellpow(self, z, n):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpow(z, n): return `n` times the point `z` on the elliptic
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellpow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6394
 *         return P.new_gen(powell(self.g, t0.g, t1.g))
 * 
 *     def ellrootno(self, p=1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellrootno(p): return the (local or global) root number of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_429ellrootno(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_428ellrootno[] = "\n        e.ellrootno(p): return the (local or global) root number of the\n        `L`-series of the elliptic curve e\n\n        If p is a prime number, the local root number at p is returned. If\n        p is 1, the global root number is returned. Note that the global\n        root number is the sign of the functional equation of the\n        `L`-series, and therefore conjecturally equal to the parity\n        of the rank of e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`\n\n        -  ``p (default = 1)`` - 1 or a prime number\n\n\n        OUTPUT: 1 or -1\n\n        EXAMPLES: Here is a curve of rank 3::\n\n            sage: e = pari([0,0,0,-82,0]).ellinit()\n            sage: e.ellrootno()\n            -1\n            sage: e.ellrootno(2)\n            1\n            sage: e.ellrootno(1009)\n            1\n        ";
  static PyObject *__pyx_pw_3gen_3gen_429ellrootno(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellrootno (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellrootno") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellrootno", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6394; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellrootno", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_428ellrootno(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_428ellrootno(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    long __pyx_v_rootno;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellrootno", 0);

    /* "gen.pyx":6425
 *             1
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         rootno = ellrootno(self.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6426
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         rootno = ellrootno(self.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6427
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         rootno = ellrootno(self.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return rootno
 */
    __pyx_v_rootno = ellrootno(__pyx_v_self->g, __pyx_v_t0->g);

    /* "gen.pyx":6428
 *         pari_catch_sig_on()
 *         rootno = ellrootno(self.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return rootno
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":6429
 *         rootno = ellrootno(self.g, t0.g)
 *         pari_catch_sig_off()
 *         return rootno             # <<<<<<<<<<<<<<
 * 
 *     def ellsigma(self, z, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_rootno); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6394
 *         return P.new_gen(powell(self.g, t0.g, t1.g))
 * 
 *     def ellrootno(self, p=1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellrootno(p): return the (local or global) root number of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellrootno", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6431
 *         return rootno
 * 
 *     def ellsigma(self, z, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsigma(z, flag=0): return the value at the complex point z of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_431ellsigma(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_430ellsigma[] = "\n        e.ellsigma(z, flag=0): return the value at the complex point z of\n        the Weierstrass `\\sigma` function associated to the\n        elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: C.<i> = ComplexField()\n            sage: e.ellsigma(2+i)\n            1.43490215804166 + 1.80307856719256*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_431ellsigma(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellsigma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellsigma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellsigma", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6431; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellsigma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_430ellsigma(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_430ellsigma(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellsigma", 0);

    /* "gen.pyx":6444
 *             1.43490215804166 + 1.80307856719256*I
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellsigma(self.g, t0.g, flag, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6445
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellsigma(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6446
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellsigma(self.g, t0.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellsub(self, z0, z1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellsigma(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6431
 *         return rootno
 * 
 *     def ellsigma(self, z, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsigma(z, flag=0): return the value at the complex point z of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellsigma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6448
 *         return P.new_gen(ellsigma(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellsub(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsub(z0, z1): return z0-z1 on this elliptic curve.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_433ellsub(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_432ellsub[] = "\n        e.ellsub(z0, z1): return z0-z1 on this elliptic curve.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve E\n\n        -  ``z0`` - point on E\n\n        -  ``z1`` - point on E\n\n\n        OUTPUT: point on E\n\n        EXAMPLES::\n\n            sage: e = pari([0, 1, 1, -2, 0]).ellinit()\n            sage: e.ellsub([1,0], [-1,1])\n            [0, 0]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_433ellsub(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellsub (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z0,&__pyx_n_s_z1,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellsub", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellsub") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellsub", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6448; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellsub", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_432ellsub(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_432ellsub(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellsub", 0);

    /* "gen.pyx":6470
 *             [0, 0]
 *         """
 *         cdef gen t0 = objtogen(z0)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6471
 *         """
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(subell(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6472
 *         cdef gen t0 = objtogen(z0)
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(subell(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6473
 *         cdef gen t1 = objtogen(z1)
 *         pari_catch_sig_on()
 *         return P.new_gen(subell(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def elltaniyama(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, subell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6448
 *         return P.new_gen(ellsigma(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellsub(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsub(z0, z1): return z0-z1 on this elliptic curve.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellsub", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6475
 *         return P.new_gen(subell(self.g, t0.g, t1.g))
 * 
 *     def elltaniyama(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(taniyama(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_435elltaniyama(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_435elltaniyama(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elltaniyama (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_434elltaniyama(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_434elltaniyama(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elltaniyama", 0);

    /* "gen.pyx":6476
 * 
 *     def elltaniyama(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(taniyama(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6477
 *     def elltaniyama(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(taniyama(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def elltors(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, taniyama(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6475
 *         return P.new_gen(subell(self.g, t0.g, t1.g))
 * 
 *     def elltaniyama(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(taniyama(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.elltaniyama", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6479
 *         return P.new_gen(taniyama(self.g))
 * 
 *     def elltors(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elltors(flag = 0): return information about the torsion subgroup
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_437elltors(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_436elltors[] = "\n        e.elltors(flag = 0): return information about the torsion subgroup\n        of the elliptic curve e\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`\n\n        -  ``flag (optional)`` - specify which algorithm to\n           use:\n\n        -  ``0 (default)`` - use Doud's algorithm: bound\n           torsion by computing the cardinality of e(GF(p)) for small primes\n           of good reduction, then look for torsion points using Weierstrass\n           parametrization and Mazur's classification\n\n        -  ``1`` - use algorithm given by the Nagell-Lutz\n           theorem (this is much slower)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the order of the torsion subgroup, a.k.a.\n           the number of points of finite order\n\n        -  ``gen`` - vector giving the structure of the torsion\n           subgroup as a product of cyclic groups, sorted in non-increasing\n           order\n\n        -  ``gen`` - vector giving points on e generating these\n           cyclic groups\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,0,1,-19,26]).ellinit()\n            sage: e.elltors()\n            [12, [6, 2], [[-2, 8], [3, -2]]]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_437elltors(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elltors (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elltors") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elltors", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elltors", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_436elltors(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_436elltors(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elltors", 0);

    /* "gen.pyx":6521
 *             [12, [6, 2], [[-2, 8], [3, -2]]]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(elltors0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6522
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(elltors0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def ellzeta(self, z, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, elltors0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6479
 *         return P.new_gen(taniyama(self.g))
 * 
 *     def elltors(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elltors(flag = 0): return information about the torsion subgroup
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.elltors", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6524
 *         return P.new_gen(elltors0(self.g, flag))
 * 
 *     def ellzeta(self, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellzeta(z): return the value at the complex point z of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_439ellzeta(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_438ellzeta[] = "\n        e.ellzeta(z): return the value at the complex point z of the\n        Weierstrass `\\zeta` function associated with the elliptic\n        curve e.\n\n        .. note::\n\n           This function has infinitely many poles (one of which is at\n           z=0); attempting to evaluate it too close to one of the\n           poles will result in a PariError.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - complex number\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: e.ellzeta(1)\n            1.06479841295883 + 0.E-19*I                # 32-bit\n            1.06479841295883 + 5.42101086242752 E-20*I # 64-bit\n            sage: C.<i> = ComplexField()\n            sage: e.ellzeta(i-1)\n            -0.350122658523049 - 0.350122658523049*I\n        ";
  static PyObject *__pyx_pw_3gen_3gen_439ellzeta(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellzeta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellzeta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellzeta", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6524; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellzeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_438ellzeta(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_438ellzeta(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellzeta", 0);

    /* "gen.pyx":6554
 *             -0.350122658523049 - 0.350122658523049*I
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellzeta(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6555
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellzeta(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6556
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellzeta(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellztopoint(self, z, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellzeta(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6524
 *         return P.new_gen(elltors0(self.g, flag))
 * 
 *     def ellzeta(self, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellzeta(z): return the value at the complex point z of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellzeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6558
 *         return P.new_gen(ellzeta(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellztopoint(self, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellztopoint(z): return the point on the elliptic curve e
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_441ellztopoint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_440ellztopoint[] = "\n        e.ellztopoint(z): return the point on the elliptic curve e\n        corresponding to the complex number z, under the usual complex\n        uniformization of e by the Weierstrass p-function.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - complex number\n\n\n        OUTPUT point on e\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: C.<i> = ComplexField()\n            sage: e.ellztopoint(1+i)\n            [0.E-19                - 1.02152286795670*I, -0.149072813701096 - 0.149072813701096*I]  # 32-bit\n            [7.96075508054992 E-21 - 1.02152286795670*I, -0.149072813701096 - 0.149072813701096*I]  # 64-bit\n\n        Complex numbers belonging to the period lattice of e are of course\n        sent to the point at infinity on e::\n\n            sage: e.ellztopoint(0)\n            [0]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_441ellztopoint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellztopoint (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellztopoint") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellztopoint", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellztopoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_440ellztopoint(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_440ellztopoint(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellztopoint", 0);

    /* "gen.pyx":6588
 *             [0]
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(pointell(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6589
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pointell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6590
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(pointell(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def omega(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, pointell(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6590; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6558
 *         return P.new_gen(ellzeta(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def ellztopoint(self, z, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellztopoint(z): return the point on the elliptic curve e
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellztopoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6592
 *         return P.new_gen(pointell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def omega(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.omega(): return basis for the period lattice of the elliptic
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_443omega(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_442omega[] = "\n        e.omega(): return basis for the period lattice of the elliptic\n        curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.omega()\n            [1.26920930427955, -0.634604652139777 - 1.45881661693850*I]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_443omega(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("omega (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_442omega(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_442omega(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("omega", 0);

    /* "gen.pyx":6603
 *             [1.26920930427955, -0.634604652139777 - 1.45881661693850*I]
 *         """
 *         return self[14:16]             # <<<<<<<<<<<<<<
 * 
 *     def disc(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_v_self), 14, 16, NULL, NULL, &__pyx_slice__21, 1, 1, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6592
 *         return P.new_gen(pointell(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def omega(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.omega(): return basis for the period lattice of the elliptic
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6605
 *         return self[14:16]
 * 
 *     def disc(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.disc(): return the discriminant of the elliptic curve e.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_445disc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_444disc[] = "\n        e.disc(): return the discriminant of the elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.disc()\n            -161051\n            sage: _.factor()\n            [-1, 1; 11, 5]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_445disc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("disc (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_444disc(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_444disc(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("disc", 0);

    /* "gen.pyx":6617
 *             [-1, 1; 11, 5]
 *         """
 *         return self[11]             # <<<<<<<<<<<<<<
 * 
 *     def j(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 11, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6617; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6605
 *         return self[14:16]
 * 
 *     def disc(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.disc(): return the discriminant of the elliptic curve e.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.disc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6619
 *         return self[11]
 * 
 *     def j(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.j(): return the j-invariant of the elliptic curve e.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_447j(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_446j[] = "\n        e.j(): return the j-invariant of the elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.j()\n            -122023936/161051\n            sage: _.factor()\n            [-1, 1; 2, 12; 11, -5; 31, 3]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_447j(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("j (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_446j(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_446j(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("j", 0);

    /* "gen.pyx":6631
 *             [-1, 1; 2, 12; 11, -5; 31, 3]
 *         """
 *         return self[12]             # <<<<<<<<<<<<<<
 * 
 *     def ellj(self, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 12, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6631; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6619
 *         return self[11]
 * 
 *     def j(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.j(): return the j-invariant of the elliptic curve e.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.j", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6633
 *         return self[12]
 * 
 *     def ellj(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Elliptic `j`-invariant of ``self``.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_449ellj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_448ellj[] = "\n        Elliptic `j`-invariant of ``self``.\n\n        EXAMPLES::\n\n            sage: pari(I).ellj()\n            1728.00000000000\n            sage: pari(3*I).ellj()\n            153553679.396729\n            sage: pari('quadgen(-3)').ellj()\n            0.E-54\n            sage: pari('quadgen(-7)').ellj(precision=256).sage()\n            -3375.000000000000000000000000000000000000000000000000000000000000000000000000\n            sage: pari(-I).ellj()\n            Traceback (most recent call last):\n            ...\n            PariError: argument '-I' does not belong to upper half-plane\n        ";
  static PyObject *__pyx_pw_3gen_3gen_449ellj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellj (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellj") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6633; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6633; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellj", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6633; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_448ellj(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_448ellj(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellj", 0);

    /* "gen.pyx":6652
 *             PariError: argument '-I' does not belong to upper half-plane
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jell(self.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6653
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(jell(self.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, jell(__pyx_v_self->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6633
 *         return self[12]
 * 
 *     def ellj(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Elliptic `j`-invariant of ``self``.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ellj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6659
 *     # 6: Functions related to NUMBER FIELDS
 *     ###########################################
 *     def bnfcertify(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``bnf`` being as output by ``bnfinit``, checks whether the result is
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_451bnfcertify(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_450bnfcertify[] = "\n        ``bnf`` being as output by ``bnfinit``, checks whether the result is\n        correct, i.e. whether the calculation of the contents of ``self``\n        are correct without assuming the Generalized Riemann Hypothesis.\n        If it is correct, the answer is 1. If not, the program may output\n        some error message or loop indefinitely.\n\n        For more information about PARI and the Generalized Riemann\n        Hypothesis, see [PariUsers], page 120.\n\n        REFERENCES:\n\n        .. [PariUsers] User's Guide to PARI/GP,\n           http://pari.math.u-bordeaux.fr/pub/pari/manuals/2.5.1/users.pdf\n        ";
  static PyObject *__pyx_pw_3gen_3gen_451bnfcertify(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfcertify (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_450bnfcertify(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_450bnfcertify(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfcertify", 0);

    /* "gen.pyx":6675
 *            http://pari.math.u-bordeaux.fr/pub/pari/manuals/2.5.1/users.pdf
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         n = bnfcertify(self.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6676
 *         """
 *         pari_catch_sig_on()
 *         n = bnfcertify(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = bnfcertify(__pyx_v_self->g);

    /* "gen.pyx":6677
 *         pari_catch_sig_on()
 *         n = bnfcertify(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":6678
 *         n = bnfcertify(self.g)
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def bnfinit(self, long flag=0, tech=None, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6659
 *     # 6: Functions related to NUMBER FIELDS
 *     ###########################################
 *     def bnfcertify(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``bnf`` being as output by ``bnfinit``, checks whether the result is
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.bnfcertify", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6680
 *         return n
 * 
 *     def bnfinit(self, long flag=0, tech=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0
 *         if tech is None:
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_453bnfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_453bnfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_tech = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_tech,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_tech);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6680; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6680; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_tech = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6680; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfinit", 0, 0, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6680; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_452bnfinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_tech, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_452bnfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_tech, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfinit", 0);

    /* "gen.pyx":6682
 *     def bnfinit(self, long flag=0, tech=None, unsigned long precision=0):
 *         cdef gen t0
 *         if tech is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, NULL, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = (__pyx_v_tech == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":6683
 *         cdef gen t0
 *         if tech is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(bnfinit0(self.g, flag, NULL, prec_bits_to_words(precision)))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6684
 *         if tech is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, NULL, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(tech)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfinit0(__pyx_v_self->g, __pyx_v_flag, NULL, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":6686
 *             return P.new_gen(bnfinit0(self.g, flag, NULL, prec_bits_to_words(precision)))
 *         else:
 *             t0 = objtogen(tech)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_tech)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":6687
 *         else:
 *             t0 = objtogen(tech)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(bnfinit0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6688
 *             t0 = objtogen(tech)
 *             pari_catch_sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisintnorm(self, x):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfinit0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":6680
 *         return n
 * 
 *     def bnfinit(self, long flag=0, tech=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0
 *         if tech is None:
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.bnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6690
 *             return P.new_gen(bnfinit0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 *     def bnfisintnorm(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_455bnfisintnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_455bnfisintnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisintnorm (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_454bnfisintnorm(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_454bnfisintnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisintnorm", 0);

    /* "gen.pyx":6691
 * 
 *     def bnfisintnorm(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisintnorm(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6691; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6692
 *     def bnfisintnorm(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfisintnorm(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6692; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6693
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisintnorm(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisnorm(self, x, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfisintnorm(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6690
 *             return P.new_gen(bnfinit0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 *     def bnfisintnorm(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfisintnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6695
 *         return P.new_gen(bnfisintnorm(self.g, t0.g))
 * 
 *     def bnfisnorm(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_457bnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_457bnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisnorm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfisnorm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfisnorm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6695; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_456bnfisnorm(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_456bnfisnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisnorm", 0);

    /* "gen.pyx":6696
 * 
 *     def bnfisnorm(self, x, long flag=0):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisnorm(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6697
 *     def bnfisnorm(self, x, long flag=0):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfisnorm(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6698
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisnorm(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisprincipal(self, x, long flag=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfisnorm(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6695
 *         return P.new_gen(bnfisintnorm(self.g, t0.g))
 * 
 *     def bnfisnorm(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6700
 *         return P.new_gen(bnfisnorm(self.g, t0.g, flag))
 * 
 *     def bnfisprincipal(self, x, long flag=1):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_459bnfisprincipal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_459bnfisprincipal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisprincipal (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfisprincipal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6700; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6700; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfisprincipal", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6700; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bnfisprincipal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_458bnfisprincipal(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_458bnfisprincipal(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisprincipal", 0);

    /* "gen.pyx":6701
 * 
 *     def bnfisprincipal(self, x, long flag=1):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisprincipal0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6702
 *     def bnfisprincipal(self, x, long flag=1):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfisprincipal0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6703
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisprincipal0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def bnfnarrow(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfisprincipal0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6700
 *         return P.new_gen(bnfisnorm(self.g, t0.g, flag))
 * 
 *     def bnfisprincipal(self, x, long flag=1):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfisprincipal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6705
 *         return P.new_gen(bnfisprincipal0(self.g, t0.g, flag))
 * 
 *     def bnfnarrow(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(buchnarrow(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_461bnfnarrow(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_461bnfnarrow(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfnarrow (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_460bnfnarrow(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_460bnfnarrow(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfnarrow", 0);

    /* "gen.pyx":6706
 * 
 *     def bnfnarrow(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(buchnarrow(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6707
 *     def bnfnarrow(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(buchnarrow(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfsunit(self, S, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, buchnarrow(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6705
 *         return P.new_gen(bnfisprincipal0(self.g, t0.g, flag))
 * 
 *     def bnfnarrow(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(buchnarrow(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.bnfnarrow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6709
 *         return P.new_gen(buchnarrow(self.g))
 * 
 *     def bnfsunit(self, S, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(S)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_463bnfsunit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_463bnfsunit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_S = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfsunit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_S,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_S)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfsunit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6709; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_S = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6709; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfsunit", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6709; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bnfsunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_462bnfsunit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_S, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_462bnfsunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_S, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfsunit", 0);

    /* "gen.pyx":6710
 * 
 *     def bnfsunit(self, S, unsigned long precision=0):
 *         cdef gen t0 = objtogen(S)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfsunit(self.g, t0.g, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_S)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6711
 *     def bnfsunit(self, S, unsigned long precision=0):
 *         cdef gen t0 = objtogen(S)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfsunit(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6712
 *         cdef gen t0 = objtogen(S)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfsunit(self.g, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bnfunit(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfsunit(__pyx_v_self->g, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6709
 *         return P.new_gen(buchnarrow(self.g))
 * 
 *     def bnfsunit(self, S, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(S)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfsunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6714
 *         return P.new_gen(bnfsunit(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def bnfunit(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_fu(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_465bnfunit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_465bnfunit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfunit (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_464bnfunit(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_464bnfunit(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfunit", 0);

    /* "gen.pyx":6715
 * 
 *     def bnfunit(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnf_get_fu(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6716
 *     def bnfunit(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_fu(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisunit(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnf_get_fu(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6714
 *         return P.new_gen(bnfsunit(self.g, t0.g, prec_bits_to_words(precision)))
 * 
 *     def bnfunit(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnf_get_fu(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.bnfunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6718
 *         return P.new_gen(bnf_get_fu(self.g))
 * 
 *     def bnfisunit(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_467bnfisunit(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_467bnfisunit(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisunit (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_466bnfisunit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_466bnfisunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisunit", 0);

    /* "gen.pyx":6719
 * 
 *     def bnfisunit(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisunit(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6720
 *     def bnfisunit(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfisunit(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6721
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfisunit(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnrclassno(self, I):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfisunit(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6718
 *         return P.new_gen(bnf_get_fu(self.g))
 * 
 *     def bnfisunit(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfisunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6723
 *         return P.new_gen(bnfisunit(self.g, t0.g))
 * 
 *     def bnrclassno(self, I):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the order of the ray class group of self modulo ``I``.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_469bnrclassno(PyObject *__pyx_v_self, PyObject *__pyx_v_I); /*proto*/
  static char __pyx_doc_3gen_3gen_468bnrclassno[] = "\n        Return the order of the ray class group of self modulo ``I``.\n\n        INPUT:\n\n        - ``self``: a pari \"BNF\" object representing a number field\n        - ``I``: a pari \"BID\" object representing an ideal of self\n\n        OUTPUT: integer\n\n        TESTS::\n\n            sage: K.<z> = QuadraticField(-23)\n            sage: p = K.primes_above(3)[0]\n            sage: K.pari_bnf().bnrclassno(p._pari_bid_())\n            3\n        ";
  static PyObject *__pyx_pw_3gen_3gen_469bnrclassno(PyObject *__pyx_v_self, PyObject *__pyx_v_I) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnrclassno (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_468bnrclassno(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_I));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_468bnrclassno(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnrclassno", 0);

    /* "gen.pyx":6741
 *             3
 *         """
 *         cdef gen t0 = objtogen(I)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnrclassno(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_I)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6742
 *         """
 *         cdef gen t0 = objtogen(I)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnrclassno(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6743
 *         cdef gen t0 = objtogen(I)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnrclassno(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfissunit(self, sunit_data, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnrclassno(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6723
 *         return P.new_gen(bnfisunit(self.g, t0.g))
 * 
 *     def bnrclassno(self, I):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the order of the ray class group of self modulo ``I``.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnrclassno", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6745
 *         return P.new_gen(bnrclassno(self.g, t0.g))
 * 
 *     def bnfissunit(self, sunit_data, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(sunit_data)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_471bnfissunit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_471bnfissunit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_sunit_data = 0;
    PyObject *__pyx_v_x = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfissunit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_sunit_data,&__pyx_n_s_x,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_sunit_data)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("bnfissunit", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfissunit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_sunit_data = values[0];
      __pyx_v_x = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfissunit", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.bnfissunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_470bnfissunit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_sunit_data, __pyx_v_x);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_470bnfissunit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_sunit_data, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfissunit", 0);

    /* "gen.pyx":6746
 * 
 *     def bnfissunit(self, sunit_data, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(sunit_data)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6747
 *     def bnfissunit(self, sunit_data, x):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(sunit_data)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfissunit(self.g, t1.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_sunit_data)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6748
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(sunit_data)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bnfissunit(self.g, t1.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6749
 *         cdef gen t1 = objtogen(sunit_data)
 *         pari_catch_sig_on()
 *         return P.new_gen(bnfissunit(self.g, t1.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def dirzetak(self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, bnfissunit(__pyx_v_self->g, __pyx_v_t1->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6745
 *         return P.new_gen(bnrclassno(self.g, t0.g))
 * 
 *     def bnfissunit(self, sunit_data, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(sunit_data)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.bnfissunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6751
 *         return P.new_gen(bnfissunit(self.g, t1.g, t0.g))
 * 
 *     def dirzetak(self, n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_473dirzetak(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_473dirzetak(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("dirzetak (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_472dirzetak(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_472dirzetak(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("dirzetak", 0);

    /* "gen.pyx":6752
 * 
 *     def dirzetak(self, n):
 *         cdef gen t0 = objtogen(n)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(dirzetak(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6753
 *     def dirzetak(self, n):
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(dirzetak(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6754
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 *         return P.new_gen(dirzetak(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def galoisapply(self, aut, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, dirzetak(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6751
 *         return P.new_gen(bnfissunit(self.g, t1.g, t0.g))
 * 
 *     def dirzetak(self, n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(n)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.dirzetak", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6756
 *         return P.new_gen(dirzetak(self.g, t0.g))
 * 
 *     def galoisapply(self, aut, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(aut)
 *         cdef gen t1 = objtogen(x)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_475galoisapply(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_475galoisapply(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_aut = 0;
    PyObject *__pyx_v_x = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisapply (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_aut,&__pyx_n_s_x,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_aut)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("galoisapply", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6756; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisapply") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6756; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_aut = values[0];
      __pyx_v_x = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisapply", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6756; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.galoisapply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_474galoisapply(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_aut, __pyx_v_x);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_474galoisapply(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_aut, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisapply", 0);

    /* "gen.pyx":6757
 * 
 *     def galoisapply(self, aut, x):
 *         cdef gen t0 = objtogen(aut)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_aut)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6758
 *     def galoisapply(self, aut, x):
 *         cdef gen t0 = objtogen(aut)
 *         cdef gen t1 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(galoisapply(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6758; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6759
 *         cdef gen t0 = objtogen(aut)
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(galoisapply(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6760
 *         cdef gen t1 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(galoisapply(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def galoisinit(self, den=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisapply(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6756
 *         return P.new_gen(dirzetak(self.g, t0.g))
 * 
 *     def galoisapply(self, aut, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(aut)
 *         cdef gen t1 = objtogen(x)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.galoisapply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6762
 *         return P.new_gen(galoisapply(self.g, t0.g, t1.g))
 * 
 *     def galoisinit(self, den=None):             # <<<<<<<<<<<<<<
 *         """
 *         galoisinit(K{,den}): calculate Galois group of number field K; see PARI manual
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_477galoisinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_476galoisinit[] = "\n        galoisinit(K{,den}): calculate Galois group of number field K; see PARI manual\n        for meaning of den\n        ";
  static PyObject *__pyx_pw_3gen_3gen_477galoisinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_den = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_den,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_den);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6762; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_den = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisinit", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6762; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.galoisinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_476galoisinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_den);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_476galoisinit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_den) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisinit", 0);

    /* "gen.pyx":6768
 *         """
 *         cdef gen t0
 *         if den is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisinit(self.g, NULL))
 */
    __pyx_t_1 = (__pyx_v_den == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":6769
 *         cdef gen t0
 *         if den is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(galoisinit(self.g, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6770
 *         if den is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisinit(self.g, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(den)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisinit(__pyx_v_self->g, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":6772
 *             return P.new_gen(galoisinit(self.g, NULL))
 *         else:
 *             t0 = objtogen(den)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisinit(self.g, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_den)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6772; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":6773
 *         else:
 *             t0 = objtogen(den)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(galoisinit(self.g, t0.g))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6773; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6774
 *             t0 = objtogen(den)
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisinit(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def galoispermtopol(self, perm):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisinit(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":6762
 *         return P.new_gen(galoisapply(self.g, t0.g, t1.g))
 * 
 *     def galoisinit(self, den=None):             # <<<<<<<<<<<<<<
 *         """
 *         galoisinit(K{,den}): calculate Galois group of number field K; see PARI manual
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.galoisinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6776
 *             return P.new_gen(galoisinit(self.g, t0.g))
 * 
 *     def galoispermtopol(self, perm):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_479galoispermtopol(PyObject *__pyx_v_self, PyObject *__pyx_v_perm); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_479galoispermtopol(PyObject *__pyx_v_self, PyObject *__pyx_v_perm) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoispermtopol (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_478galoispermtopol(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_perm));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_478galoispermtopol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_perm) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoispermtopol", 0);

    /* "gen.pyx":6777
 * 
 *     def galoispermtopol(self, perm):
 *         cdef gen t0 = objtogen(perm)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(galoispermtopol(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_perm)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6778
 *     def galoispermtopol(self, perm):
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(galoispermtopol(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6779
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 *         return P.new_gen(galoispermtopol(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoispermtopol(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6776
 *             return P.new_gen(galoisinit(self.g, t0.g))
 * 
 *     def galoispermtopol(self, perm):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.galoispermtopol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6781
 *         return P.new_gen(galoispermtopol(self.g, t0.g))
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_481galoisfixedfield(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_481galoisfixedfield(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_perm = 0;
    long __pyx_v_flag;
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisfixedfield (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_perm,&__pyx_n_s_flag,&__pyx_n_s_v,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_perm)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisfixedfield") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6781; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_perm = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6781; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_v = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisfixedfield", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6781; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.galoisfixedfield", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_480galoisfixedfield(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_perm, __pyx_v_flag, __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_480galoisfixedfield(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_perm, long __pyx_v_flag, PyObject *__pyx_v_v) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisfixedfield", 0);

    /* "gen.pyx":6782
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 *         cdef gen t0 = objtogen(perm)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(galoisfixedfield(self.g, t0.g, flag, P.get_var(v)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_perm)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6783
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(galoisfixedfield(self.g, t0.g, flag, P.get_var(v)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6784
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 *         return P.new_gen(galoisfixedfield(self.g, t0.g, flag, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def idealred(self, I, vdir=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisfixedfield(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6784; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6781
 *         return P.new_gen(galoispermtopol(self.g, t0.g))
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(perm)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.galoisfixedfield", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6786
 *         return P.new_gen(galoisfixedfield(self.g, t0.g, flag, P.get_var(v)))
 * 
 *     def idealred(self, I, vdir=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(I)
 *         cdef gen t1 = objtogen(vdir)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_483idealred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_483idealred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_I = 0;
    PyObject *__pyx_v_vdir = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealred (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_I,&__pyx_n_s_vdir,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_I)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_vdir);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealred") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6786; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_I = values[0];
      __pyx_v_vdir = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealred", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6786; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_482idealred(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_I, __pyx_v_vdir);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_482idealred(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I, PyObject *__pyx_v_vdir) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    GEN __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealred", 0);

    /* "gen.pyx":6787
 * 
 *     def idealred(self, I, vdir=0):
 *         cdef gen t0 = objtogen(I)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(vdir)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_I)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6788
 *     def idealred(self, I, vdir=0):
 *         cdef gen t0 = objtogen(I)
 *         cdef gen t1 = objtogen(vdir)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealred0(self.g, t0.g, t1.g if vdir else NULL))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_vdir)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6789
 *         cdef gen t0 = objtogen(I)
 *         cdef gen t1 = objtogen(vdir)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealred0(self.g, t0.g, t1.g if vdir else NULL))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6789; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6790
 *         cdef gen t1 = objtogen(vdir)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealred0(self.g, t0.g, t1.g if vdir else NULL))             # <<<<<<<<<<<<<<
 * 
 *     def idealadd(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_vdir); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_4) {
      __pyx_t_3 = __pyx_v_t1->g;
    } else {
      __pyx_t_3 = NULL;
    }
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealred0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6786
 *         return P.new_gen(galoisfixedfield(self.g, t0.g, flag, P.get_var(v)))
 * 
 *     def idealred(self, I, vdir=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(I)
 *         cdef gen t1 = objtogen(vdir)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6792
 *         return P.new_gen(idealred0(self.g, t0.g, t1.g if vdir else NULL))
 * 
 *     def idealadd(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_485idealadd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_485idealadd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealadd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealadd", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6792; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealadd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6792; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealadd", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6792; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealadd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_484idealadd(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_484idealadd(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealadd", 0);

    /* "gen.pyx":6793
 * 
 *     def idealadd(self, x, y):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6794
 *     def idealadd(self, x, y):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealadd(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6795
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealadd(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6796
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealadd(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealaddtoone(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealadd(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6792
 *         return P.new_gen(idealred0(self.g, t0.g, t1.g if vdir else NULL))
 * 
 *     def idealadd(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealadd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6798
 *         return P.new_gen(idealadd(self.g, t0.g, t1.g))
 * 
 *     def idealaddtoone(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_487idealaddtoone(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_487idealaddtoone(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealaddtoone (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealaddtoone", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6798; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealaddtoone") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6798; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealaddtoone", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6798; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealaddtoone", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_486idealaddtoone(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_486idealaddtoone(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealaddtoone", 0);

    /* "gen.pyx":6799
 * 
 *     def idealaddtoone(self, x, y):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6800
 *     def idealaddtoone(self, x, y):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealaddtoone0(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6801
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealaddtoone0(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6802
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealaddtoone0(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealappr(self, x, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealaddtoone0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6798
 *         return P.new_gen(idealadd(self.g, t0.g, t1.g))
 * 
 *     def idealaddtoone(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealaddtoone", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6804
 *         return P.new_gen(idealaddtoone0(self.g, t0.g, t1.g))
 * 
 *     def idealappr(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_489idealappr(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_489idealappr(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealappr (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealappr") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealappr", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_488idealappr(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_488idealappr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealappr", 0);

    /* "gen.pyx":6805
 * 
 *     def idealappr(self, x, long flag=0):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealappr0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6806
 *     def idealappr(self, x, long flag=0):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealappr0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6807
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealappr0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def idealcoprime(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealappr0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6804
 *         return P.new_gen(idealaddtoone0(self.g, t0.g, t1.g))
 * 
 *     def idealappr(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6809
 *         return P.new_gen(idealappr0(self.g, t0.g, flag))
 * 
 *     def idealcoprime(self, x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Given two integral ideals x and y of a pari number field self,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_491idealcoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_490idealcoprime[] = "\n        Given two integral ideals x and y of a pari number field self,\n        return an element a of the field (expressed in the integral\n        basis of self) such that a*x is an integral ideal coprime to\n        y.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: x = pari('[1, -1, 2]~')\n            sage: y = pari('[1, -1, 3]~')\n            sage: nf.idealcoprime(x, y)\n            [1, 0, 0]~\n\n            sage: y = pari('[2, -2, 4]~')\n            sage: nf.idealcoprime(x, y)\n            [5/43, 9/43, -1/43]~\n        ";
  static PyObject *__pyx_pw_3gen_3gen_491idealcoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealcoprime (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealcoprime", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6809; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealcoprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6809; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealcoprime", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6809; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealcoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_490idealcoprime(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_490idealcoprime(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealcoprime", 0);

    /* "gen.pyx":6829
 *             [5/43, 9/43, -1/43]~
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6830
 *         """
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealcoprime(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6831
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealcoprime(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6832
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealcoprime(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealdiv(self, x, y, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealcoprime(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6809
 *         return P.new_gen(idealappr0(self.g, t0.g, flag))
 * 
 *     def idealcoprime(self, x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Given two integral ideals x and y of a pari number field self,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealcoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6834
 *         return P.new_gen(idealcoprime(self.g, t0.g, t1.g))
 * 
 *     def idealdiv(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_493idealdiv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_493idealdiv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealdiv (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,&__pyx_n_s_flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealdiv", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealdiv") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealdiv", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_492idealdiv(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_492idealdiv(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealdiv", 0);

    /* "gen.pyx":6835
 * 
 *     def idealdiv(self, x, y, long flag=0):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6836
 *     def idealdiv(self, x, y, long flag=0):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealdiv0(self.g, t0.g, t1.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6837
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealdiv0(self.g, t0.g, t1.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6838
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealdiv0(self.g, t0.g, t1.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def idealfactor(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealdiv0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6834
 *         return P.new_gen(idealcoprime(self.g, t0.g, t1.g))
 * 
 *     def idealdiv(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6840
 *         return P.new_gen(idealdiv0(self.g, t0.g, t1.g, flag))
 * 
 *     def idealfactor(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_495idealfactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_495idealfactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealfactor (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_494idealfactor(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_494idealfactor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealfactor", 0);

    /* "gen.pyx":6841
 * 
 *     def idealfactor(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealfactor(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6842
 *     def idealfactor(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealfactor(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6843
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealfactor(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealhnf(self, a, b=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealfactor(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6840
 *         return P.new_gen(idealdiv0(self.g, t0.g, t1.g, flag))
 * 
 *     def idealfactor(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealfactor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6845
 *         return P.new_gen(idealfactor(self.g, t0.g))
 * 
 *     def idealhnf(self, a, b=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_497idealhnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_497idealhnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealhnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_a,&__pyx_n_s_b,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealhnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealhnf", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_496idealhnf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_496idealhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealhnf", 0);

    /* "gen.pyx":6846
 * 
 *     def idealhnf(self, a, b=None):
 *         cdef gen t0 = objtogen(a)             # <<<<<<<<<<<<<<
 *         cdef gen t1
 *         if b is None:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6848
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1
 *         if b is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(idealhnf(self.g, t0.g))
 */
    __pyx_t_2 = (__pyx_v_b == Py_None);
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":6849
 *         cdef gen t1
 *         if b is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(idealhnf(self.g, t0.g))
 *         else:
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6850
 *         if b is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(idealhnf(self.g, t0.g))             # <<<<<<<<<<<<<<
 *         else:
 *             t1 = objtogen(b)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealhnf(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6850; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":6852
 *             return P.new_gen(idealhnf(self.g, t0.g))
 *         else:
 *             t1 = objtogen(b)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(idealhnf0(self.g, t0.g, t1.g))
 */
      __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6852; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":6853
 *         else:
 *             t1 = objtogen(b)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(idealhnf0(self.g, t0.g, t1.g))
 * 
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":6854
 *             t1 = objtogen(b)
 *             pari_catch_sig_on()
 *             return P.new_gen(idealhnf0(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealintersection(self, x, y):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealhnf0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6854; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":6845
 *         return P.new_gen(idealfactor(self.g, t0.g))
 * 
 *     def idealhnf(self, a, b=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6856
 *             return P.new_gen(idealhnf0(self.g, t0.g, t1.g))
 * 
 *     def idealintersection(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_499idealintersection(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_499idealintersection(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealintersection (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealintersection", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealintersection") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealintersection", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6856; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealintersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_498idealintersection(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_498idealintersection(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealintersection", 0);

    /* "gen.pyx":6857
 * 
 *     def idealintersection(self, x, y):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6858
 *     def idealintersection(self, x, y):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealintersect(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6858; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6859
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealintersect(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6860
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealintersect(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def ideallist(self, long bound, long flag = 4):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealintersect(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6856
 *             return P.new_gen(idealhnf0(self.g, t0.g, t1.g))
 * 
 *     def idealintersection(self, x, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealintersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6862
 *         return P.new_gen(idealintersect(self.g, t0.g, t1.g))
 * 
 *     def ideallist(self, long bound, long flag = 4):             # <<<<<<<<<<<<<<
 *         """
 *         Vector of vectors `L` of all idealstar of all ideals of `norm <= bound`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_501ideallist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_500ideallist[] = "\n        Vector of vectors `L` of all idealstar of all ideals of `norm <= bound`.\n\n        The binary digits of flag mean:\n\n         - 1: give generators;\n         - 2: add units;\n         - 4: (default) give only the ideals and not the bid.\n\n        EXAMPLES::\n\n            sage: R.<x> = PolynomialRing(QQ)\n            sage: K.<a> = NumberField(x^2 + 1)\n            sage: L = K.pari_nf().ideallist(100)\n\n        Now we have our list `L`. Entry `L[n-1]` contains all ideals of\n        norm `n`::\n\n            sage: L[0]   # One ideal of norm 1.\n            [[1, 0; 0, 1]]\n            sage: L[64]  # 4 ideals of norm 65.\n            [[65, 8; 0, 1], [65, 47; 0, 1], [65, 18; 0, 1], [65, 57; 0, 1]]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_501ideallist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_bound;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ideallist (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_bound,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bound)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ideallist") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6862; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_bound = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_bound == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6862; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6862; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)4);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ideallist", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6862; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ideallist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_500ideallist(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_bound, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_500ideallist(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_bound, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ideallist", 0);

    /* "gen.pyx":6886
 *             [[65, 8; 0, 1], [65, 47; 0, 1], [65, 18; 0, 1], [65, 57; 0, 1]]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ideallist0(self.g, bound, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6887
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(ideallist0(self.g, bound, flag))             # <<<<<<<<<<<<<<
 * 
 *     def ideallog(self, x, bid):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ideallist0(__pyx_v_self->g, __pyx_v_bound, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6887; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6862
 *         return P.new_gen(idealintersect(self.g, t0.g, t1.g))
 * 
 *     def ideallist(self, long bound, long flag = 4):             # <<<<<<<<<<<<<<
 *         """
 *         Vector of vectors `L` of all idealstar of all ideals of `norm <= bound`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ideallist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6889
 *         return P.new_gen(ideallist0(self.g, bound, flag))
 * 
 *     def ideallog(self, x, bid):             # <<<<<<<<<<<<<<
 *         """
 *         Return the discrete logarithm of the unit x in (ring of integers)/bid.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_503ideallog(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_502ideallog[] = "\n        Return the discrete logarithm of the unit x in (ring of integers)/bid.\n\n        INPUT:\n\n        - ``self`` - a pari number field\n\n        - ``bid``  - a big ideal structure (corresponding to an ideal I\n          of self) output by idealstar\n\n        - ``x``  - an element of self with valuation zero at all\n          primes dividing I\n\n        OUTPUT:\n\n        - the discrete logarithm of x on the generators given in bid[2]\n\n        EXAMPLE::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: I = pari('[1, -1, 2]~')\n            sage: bid = nf.idealstar(I)\n            sage: x = pari('5')\n            sage: nf.ideallog(x, bid)\n            [25]~\n        ";
  static PyObject *__pyx_pw_3gen_3gen_503ideallog(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_bid = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ideallog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_bid,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_bid)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ideallog", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ideallog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_bid = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ideallog", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6889; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ideallog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_502ideallog(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_bid);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_502ideallog(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_bid) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ideallog", 0);

    /* "gen.pyx":6917
 *             [25]~
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(bid)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6918
 *         """
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(bid)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ideallog(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_bid)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6919
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(bid)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ideallog(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6920
 *         cdef gen t1 = objtogen(bid)
 *         pari_catch_sig_on()
 *         return P.new_gen(ideallog(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealmul(self, x, y, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ideallog(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6889
 *         return P.new_gen(ideallist0(self.g, bound, flag))
 * 
 *     def ideallog(self, x, bid):             # <<<<<<<<<<<<<<
 *         """
 *         Return the discrete logarithm of the unit x in (ring of integers)/bid.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ideallog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6922
 *         return P.new_gen(ideallog(self.g, t0.g, t1.g))
 * 
 *     def idealmul(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_505idealmul(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_505idealmul(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealmul (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,&__pyx_n_s_flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealmul", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealmul") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealmul", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6922; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_504idealmul(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_504idealmul(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealmul", 0);

    /* "gen.pyx":6923
 * 
 *     def idealmul(self, x, y, long flag=0):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6924
 *     def idealmul(self, x, y, long flag=0):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         if flag == 0:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6925
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if flag == 0:
 *             return P.new_gen(idealmul(self.g, t0.g, t1.g))
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6925; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6926
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         if flag == 0:             # <<<<<<<<<<<<<<
 *             return P.new_gen(idealmul(self.g, t0.g, t1.g))
 *         else:
 */
    __pyx_t_3 = ((__pyx_v_flag == 0) != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":6927
 *         pari_catch_sig_on()
 *         if flag == 0:
 *             return P.new_gen(idealmul(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(idealmulred(self.g, t0.g, t1.g))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealmul(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":6929
 *             return P.new_gen(idealmul(self.g, t0.g, t1.g))
 *         else:
 *             return P.new_gen(idealmulred(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealnorm(self, x):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealmulred(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6929; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":6922
 *         return P.new_gen(ideallog(self.g, t0.g, t1.g))
 * 
 *     def idealmul(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6931
 *             return P.new_gen(idealmulred(self.g, t0.g, t1.g))
 * 
 *     def idealnorm(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_507idealnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_507idealnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealnorm (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_506idealnorm(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_506idealnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealnorm", 0);

    /* "gen.pyx":6932
 * 
 *     def idealnorm(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealnorm(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6933
 *     def idealnorm(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealnorm(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6934
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealnorm(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealprimedec(nf, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealnorm(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6931
 *             return P.new_gen(idealmulred(self.g, t0.g, t1.g))
 * 
 *     def idealnorm(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6936
 *         return P.new_gen(idealnorm(self.g, t0.g))
 * 
 *     def idealprimedec(nf, p):             # <<<<<<<<<<<<<<
 *         """
 *         Prime ideal decomposition of the prime number `p` in the number
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_509idealprimedec(PyObject *__pyx_v_nf, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_508idealprimedec[] = "\n        Prime ideal decomposition of the prime number `p` in the number\n        field `nf` as a vector of 5 component vectors `[p,a,e,f,b]`\n        representing the prime ideals `p O_K + a O_K`, `e` ,`f` as usual,\n        `a` as vector of components on the integral basis, `b` Lenstra's\n        constant.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: F = pari(K).idealprimedec(5); F\n            [[5, [-2, 1]~, 1, 1, [2, 1]~], [5, [2, 1]~, 1, 1, [-2, 1]~]]\n            sage: F[0].pr_get_p()\n            5\n        ";
  static PyObject *__pyx_pw_3gen_3gen_509idealprimedec(PyObject *__pyx_v_nf, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealprimedec (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_508idealprimedec(((struct __pyx_obj_3gen_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_508idealprimedec(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealprimedec", 0);

    /* "gen.pyx":6952
 *             5
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealprimedec(nf.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6953
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealprimedec(nf.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6954
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealprimedec(nf.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealstar(self, I, long flag=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealprimedec(__pyx_v_nf->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6936
 *         return P.new_gen(idealnorm(self.g, t0.g))
 * 
 *     def idealprimedec(nf, p):             # <<<<<<<<<<<<<<
 *         """
 *         Prime ideal decomposition of the prime number `p` in the number
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealprimedec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6956
 *         return P.new_gen(idealprimedec(nf.g, t0.g))
 * 
 *     def idealstar(self, I, long flag=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the big ideal (bid) structure of modulus I.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_511idealstar(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_510idealstar[] = "\n        Return the big ideal (bid) structure of modulus I.\n\n        INPUT:\n\n        - ``self`` - a pari number field\n\n        - ``I`` -- an ideal of self, or a row vector whose first\n          component is an ideal and whose second component\n          is a row vector of r_1 0 or 1.\n\n        - ``flag`` - determines the amount of computation and the shape\n          of the output:\n\n          - ``1`` (default): return a bid structure without\n            generators\n\n          - ``2``: return a bid structure with generators (slower)\n\n          - ``0`` (deprecated): only outputs units of (ring of integers/I)\n            as an abelian group, i.e as a 3-component\n            vector [h,d,g]: h is the order, d is the vector\n            of SNF cyclic components and g the corresponding\n            generators. This flag is deprecated: it is in\n            fact slightly faster to compute a true bid\n            structure, which contains much more information.\n\n        EXAMPLE::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: I = pari('[1, -1, 2]~')\n            sage: nf.idealstar(I)\n            [[[43, 9, 5; 0, 1, 0; 0, 0, 1], [0]], [42, [42]], Mat([[43, [9, 1, 0]~, 1, 1, [-5, -9, 1]~], 1]), [[[[42], [[3, 0, 0]~], [[3, 0, 0]~], [Vecsmall([])], 1]], [[], [], []]], Mat(1)]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_511idealstar(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_I = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealstar (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_I,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_I)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealstar") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6956; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_I = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6956; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealstar", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6956; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_510idealstar(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_I, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_510idealstar(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_I, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealstar", 0);

    /* "gen.pyx":6992
 *             [[[43, 9, 5; 0, 1, 0; 0, 0, 1], [0]], [42, [42]], Mat([[43, [9, 1, 0]~, 1, 1, [-5, -9, 1]~], 1]), [[[[42], [[3, 0, 0]~], [[3, 0, 0]~], [Vecsmall([])], 1]], [[], [], []]], Mat(1)]
 *         """
 *         cdef gen t0 = objtogen(I)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(idealstar0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_I)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6992; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6993
 *         """
 *         cdef gen t0 = objtogen(I)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(idealstar0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":6994
 *         cdef gen t0 = objtogen(I)
 *         pari_catch_sig_on()
 *         return P.new_gen(idealstar0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def idealtwoelt(self, x, a=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealstar0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":6956
 *         return P.new_gen(idealprimedec(nf.g, t0.g))
 * 
 *     def idealstar(self, I, long flag=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the big ideal (bid) structure of modulus I.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":6996
 *         return P.new_gen(idealstar0(self.g, t0.g, flag))
 * 
 *     def idealtwoelt(self, x, a=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_513idealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_513idealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_a = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealtwoelt (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_a,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealtwoelt") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6996; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_a = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealtwoelt", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6996; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_512idealtwoelt(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_a);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_512idealtwoelt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealtwoelt", 0);

    /* "gen.pyx":6997
 * 
 *     def idealtwoelt(self, x, a=None):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1
 *         if a is None:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":6999
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1
 *         if a is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, NULL))
 */
    __pyx_t_2 = (__pyx_v_a == Py_None);
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":7000
 *         cdef gen t1
 *         if a is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, NULL))
 *         else:
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7000; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7001
 *         if a is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t1 = objtogen(a)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealtwoelt0(__pyx_v_self->g, __pyx_v_t0->g, NULL))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7001; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":7003
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, NULL))
 *         else:
 *             t1 = objtogen(a)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, t1.g))
 */
      __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":7004
 *         else:
 *             t1 = objtogen(a)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, t1.g))
 * 
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7005
 *             t1 = objtogen(a)
 *             pari_catch_sig_on()
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def idealval(self, x, p):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, idealtwoelt0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7005; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":6996
 *         return P.new_gen(idealstar0(self.g, t0.g, flag))
 * 
 *     def idealtwoelt(self, x, a=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7007
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, t1.g))
 * 
 *     def idealval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_515idealval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_515idealval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealval (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealval", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealval") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealval", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7007; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.idealval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_514idealval(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_514idealval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealval", 0);

    /* "gen.pyx":7008
 * 
 *     def idealval(self, x, p):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7008; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7009
 *     def idealval(self, x, p):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         v = idealval(self.g, t0.g, t1.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7009; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7010
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         v = idealval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7010; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7011
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 *         v = idealval(self.g, t0.g, t1.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return v
 */
    __pyx_v_v = idealval(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g);

    /* "gen.pyx":7012
 *         pari_catch_sig_on()
 *         v = idealval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":7013
 *         v = idealval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def elementval(self, x, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7013; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7007
 *             return P.new_gen(idealtwoelt0(self.g, t0.g, t1.g))
 * 
 *     def idealval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.idealval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7015
 *         return v
 * 
 *     def elementval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_517elementval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_517elementval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elementval (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("elementval", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7015; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elementval") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7015; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elementval", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7015; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elementval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_516elementval(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_516elementval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elementval", 0);

    /* "gen.pyx":7016
 * 
 *     def elementval(self, x, p):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7017
 *     def elementval(self, x, p):
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         v = nfval(self.g, t0.g, t1.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7017; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7018
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         v = nfval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7018; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7019
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 *         v = nfval(self.g, t0.g, t1.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return v
 */
    __pyx_v_v = nfval(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g);

    /* "gen.pyx":7020
 *         pari_catch_sig_on()
 *         v = nfval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":7021
 *         v = nfval(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def modreverse(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7015
 *         return v
 * 
 *     def elementval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(p)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.elementval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7023
 *         return v
 * 
 *     def modreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         modreverse(x): reverse polymod of the polymod x, if it exists.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_519modreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_518modreverse[] = "\n        modreverse(x): reverse polymod of the polymod x, if it exists.\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_3gen_3gen_519modreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("modreverse (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_518modreverse(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_518modreverse(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("modreverse", 0);

    /* "gen.pyx":7029
 *         EXAMPLES:
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(modreverse(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7030
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(modreverse(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasis(self, long flag=0, fa=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, modreverse(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7030; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7023
 *         return v
 * 
 *     def modreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         modreverse(x): reverse polymod of the polymod x, if it exists.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.modreverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7032
 *         return P.new_gen(modreverse(self.g))
 * 
 *     def nfbasis(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis(x, flag, fa): integral basis of the field QQ[a], where ``a`` is
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_521nfbasis(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_520nfbasis[] = "\n        nfbasis(x, flag, fa): integral basis of the field QQ[a], where ``a`` is\n        a root of the polynomial x.\n\n        Binary digits of ``flag`` mean:\n\n         - 1: assume that no square of a prime>primelimit divides the\n              discriminant of ``x``.\n         - 2: use round 2 algorithm instead of round 4.\n\n        If present, ``fa`` provides the matrix of a partial factorization of\n        the discriminant of ``x``, useful if one wants only an order maximal at\n        certain primes only.\n\n        EXAMPLES::\n\n            sage: pari('x^3 - 17').nfbasis()\n            [1, x, 1/3*x^2 - 1/3*x + 1/3]\n\n        We test ``flag`` = 1, noting it gives a wrong result when the\n        discriminant (-4 * `p`^2 * `q` in the example below) has a big square\n        factor::\n\n            sage: p = next_prime(10^10); q = next_prime(p)\n            sage: x = polygen(QQ); f = x^2 + p^2*q\n            sage: pari(f).nfbasis(1)   # Wrong result\n            [1, x]\n            sage: pari(f).nfbasis()    # Correct result\n            [1, 1/10000000019*x]\n            sage: pari(f).nfbasis(fa = \"[2,2; %s,2]\"%p)    # Correct result and faster\n            [1, 1/10000000019*x]\n\n        TESTS:\n\n        ``flag`` = 2 should give the same result::\n\n            sage: pari('x^3 - 17').nfbasis(flag = 2)\n            [1, x, 1/3*x^2 - 1/3*x + 1/3]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_521nfbasis(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_fa = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasis (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_fa,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfbasis") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7032; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7032; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfbasis", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7032; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfbasis", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_520nfbasis(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_520nfbasis(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasis", 0);

    /* "gen.pyx":7073
 *         """
 *         cdef gen t0
 *         if not fa:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(nfbasis0(self.g, flag, NULL))
 */
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_fa); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = ((!__pyx_t_1) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":7074
 *         cdef gen t0
 *         if not fa:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(nfbasis0(self.g, flag, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7075
 *         if not fa:
 *             pari_catch_sig_on()
 *             return P.new_gen(nfbasis0(self.g, flag, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(fa)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfbasis0(__pyx_v_self->g, __pyx_v_flag, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":7077
 *             return P.new_gen(nfbasis0(self.g, flag, NULL))
 *         else:
 *             t0 = objtogen(fa)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(nfbasis0(self.g, flag, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_fa)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":7078
 *         else:
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(nfbasis0(self.g, flag, t0.g))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7079
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()
 *             return P.new_gen(nfbasis0(self.g, flag, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasis_d(self, long flag=0, fa=None):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfbasis0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":7032
 *         return P.new_gen(modreverse(self.g))
 * 
 *     def nfbasis(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis(x, flag, fa): integral basis of the field QQ[a], where ``a`` is
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.nfbasis", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7081
 *             return P.new_gen(nfbasis0(self.g, flag, t0.g))
 * 
 *     def nfbasis_d(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis_d(x): Return a basis of the number field defined over QQ
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_523nfbasis_d(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_522nfbasis_d[] = "\n        nfbasis_d(x): Return a basis of the number field defined over QQ\n        by x and its discriminant.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: F._pari_()[0].nfbasis_d()\n            ([1, y, y^2], -108)\n\n        ::\n\n            sage: G = NumberField(x^5-11,'beta')\n            sage: G._pari_()[0].nfbasis_d()\n            ([1, y, y^2, y^3, y^4], 45753125)\n\n        ::\n\n            sage: pari([-2,0,0,1]).Polrev().nfbasis_d()\n            ([1, x, x^2], -108)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_523nfbasis_d(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    CYTHON_UNUSED long __pyx_v_flag;
    PyObject *__pyx_v_fa = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasis_d (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_fa,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfbasis_d") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7081; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7081; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfbasis_d", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7081; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfbasis_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_522nfbasis_d(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_522nfbasis_d(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, PyObject *__pyx_v_fa) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    GEN __pyx_v_disc;
    struct __pyx_obj_3gen_gen *__pyx_v_B = NULL;
    struct __pyx_obj_3gen_gen *__pyx_v_D = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasis_d", 0);

    /* "gen.pyx":7105
 *         cdef gen t0
 *         cdef GEN disc
 *         if not fa:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, NULL))
 */
    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_fa); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = ((!__pyx_t_1) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":7106
 *         cdef GEN disc
 *         if not fa:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7107
 *         if not fa:
 *             pari_catch_sig_on()
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(fa)
 */
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, nfbasis(__pyx_v_self->g, (&__pyx_v_disc), NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_B = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "gen.pyx":7109
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, NULL))
 *         else:
 *             t0 = objtogen(fa)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_fa)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":7110
 *         else:
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, t0.g))
 *         D = P.new_gen(disc)
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7111
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, t0.g))             # <<<<<<<<<<<<<<
 *         D = P.new_gen(disc)
 *         return B, D
 */
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, nfbasis(__pyx_v_self->g, (&__pyx_v_disc), __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_B = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;
    }
    __pyx_L3:;

    /* "gen.pyx":7112
 *             pari_catch_sig_on()
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, t0.g))
 *         D = P.new_gen(disc)             # <<<<<<<<<<<<<<
 *         return B, D
 * 
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_disc)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_D = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":7113
 *             B = P.new_gen_noclear(nfbasis(self.g, &disc, t0.g))
 *         D = P.new_gen(disc)
 *         return B, D             # <<<<<<<<<<<<<<
 * 
 *     def nfbasistoalg(nf, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(((PyObject *)__pyx_v_B));
    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_B));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_B));
    __Pyx_INCREF(((PyObject *)__pyx_v_D));
    PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_D));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_D));
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7081
 *             return P.new_gen(nfbasis0(self.g, flag, t0.g))
 * 
 *     def nfbasis_d(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis_d(x): Return a basis of the number field defined over QQ
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.nfbasis_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_B);
    __Pyx_XDECREF((PyObject *)__pyx_v_D);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7115
 *         return B, D
 * 
 *     def nfbasistoalg(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into an
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_525nfbasistoalg(PyObject *__pyx_v_nf, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_524nfbasistoalg[] = "\n        Transforms the column vector ``x`` on the integral basis into an\n        algebraic number.\n\n        INPUT:\n\n         - ``nf`` -- a number field\n         - ``x`` -- a column of rational numbers of length equal to the\n           degree of ``nf`` or a single rational number\n\n        OUTPUT:\n\n         - A POLMOD representing the element of ``nf`` whose coordinates\n           are ``x`` in the Z-basis of ``nf``.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^3 - 17)\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.getattr('zk')\n            [1, 1/3*y^2 - 1/3*y + 1/3, y]\n            sage: Kpari.nfbasistoalg(42)\n            Mod(42, y^3 - 17)\n            sage: Kpari.nfbasistoalg(\"[3/2, -5, 0]~\")\n            Mod(-5/3*y^2 + 5/3*y - 1/6, y^3 - 17)\n            sage: Kpari.getattr('zk') * pari(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n        ";
  static PyObject *__pyx_pw_3gen_3gen_525nfbasistoalg(PyObject *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasistoalg (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_524nfbasistoalg(((struct __pyx_obj_3gen_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_524nfbasistoalg(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasistoalg", 0);

    /* "gen.pyx":7145
 *             -5/3*y^2 + 5/3*y - 1/6
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(basistoalg(nf.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7146
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(basistoalg(nf.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7147
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(basistoalg(nf.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasistoalg_lift(nf, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, basistoalg(__pyx_v_nf->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7115
 *         return B, D
 * 
 *     def nfbasistoalg(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into an
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfbasistoalg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7149
 *         return P.new_gen(basistoalg(nf.g, t0.g))
 * 
 *     def nfbasistoalg_lift(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into a
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_527nfbasistoalg_lift(PyObject *__pyx_v_nf, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_526nfbasistoalg_lift[] = "\n        Transforms the column vector ``x`` on the integral basis into a\n        polynomial representing the algebraic number.\n\n        INPUT:\n\n         - ``nf`` -- a number field\n         - ``x`` -- a column of rational numbers of length equal to the\n           degree of ``nf`` or a single rational number\n\n        OUTPUT:\n\n         - ``nf.nfbasistoalg(x).lift()``\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^3 - 17)\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.getattr('zk')\n            [1, 1/3*y^2 - 1/3*y + 1/3, y]\n            sage: Kpari.nfbasistoalg_lift(42)\n            42\n            sage: Kpari.nfbasistoalg_lift(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n            sage: Kpari.getattr('zk') * pari(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n        ";
  static PyObject *__pyx_pw_3gen_3gen_527nfbasistoalg_lift(PyObject *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasistoalg_lift (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_526nfbasistoalg_lift(((struct __pyx_obj_3gen_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_526nfbasistoalg_lift(struct __pyx_obj_3gen_gen *__pyx_v_nf, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasistoalg_lift", 0);

    /* "gen.pyx":7178
 *             -5/3*y^2 + 5/3*y - 1/6
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gel(basistoalg(nf.g, t0.g), 2))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7179
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gel(basistoalg(nf.g, t0.g), 2))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7180
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(gel(basistoalg(nf.g, t0.g), 2))             # <<<<<<<<<<<<<<
 * 
 *     def nfdisc(self, long flag=0, p=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gel(basistoalg(__pyx_v_nf->g, __pyx_v_t0->g), 2))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7149
 *         return P.new_gen(basistoalg(nf.g, t0.g))
 * 
 *     def nfbasistoalg_lift(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into a
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfbasistoalg_lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7182
 *         return P.new_gen(gel(basistoalg(nf.g, t0.g), 2))
 * 
 *     def nfdisc(self, long flag=0, p=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfdisc(x): Return the discriminant of the number field defined over
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_529nfdisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_528nfdisc[] = "\n        nfdisc(x): Return the discriminant of the number field defined over\n        QQ by x.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: F._pari_()[0].nfdisc()\n            -108\n\n        ::\n\n            sage: G = NumberField(x^5-11,'beta')\n            sage: G._pari_()[0].nfdisc()\n            45753125\n\n        ::\n\n            sage: f = x^3-2\n            sage: f._pari_()\n            x^3 - 2\n            sage: f._pari_().nfdisc()\n            -108\n        ";
  static PyObject *__pyx_pw_3gen_3gen_529nfdisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfdisc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_p,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfdisc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfdisc", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_528nfdisc(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_528nfdisc(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v__p = 0;
    GEN __pyx_v_g;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    GEN __pyx_t_6;
    int __pyx_t_7;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfdisc", 0);

    /* "gen.pyx":7209
 *         cdef gen _p
 *         cdef GEN g
 *         if p != 0:             # <<<<<<<<<<<<<<
 *             _p = self.pari(p)
 *             g = _p.g
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_p, __pyx_int_0, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_2) {

      /* "gen.pyx":7210
 *         cdef GEN g
 *         if p != 0:
 *             _p = self.pari(p)             # <<<<<<<<<<<<<<
 *             g = _p.g
 *         else:
 */
      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_pari); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_4);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_3, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
      } else {
        __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __Pyx_GIVEREF(__pyx_t_4); __pyx_t_4 = NULL;
        __Pyx_INCREF(__pyx_v_p);
        PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_p);
        __Pyx_GIVEREF(__pyx_v_p);
        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_3gen_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v__p = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":7211
 *         if p != 0:
 *             _p = self.pari(p)
 *             g = _p.g             # <<<<<<<<<<<<<<
 *         else:
 *             g = <GEN>NULL
 */
      __pyx_t_6 = __pyx_v__p->g;
      __pyx_v_g = __pyx_t_6;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "gen.pyx":7213
 *             g = _p.g
 *         else:
 *             g = <GEN>NULL             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nfdisc0(self.g, flag, g))
 */
      __pyx_v_g = ((GEN)NULL);
    }
    __pyx_L3:;

    /* "gen.pyx":7214
 *         else:
 *             g = <GEN>NULL
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfdisc0(self.g, flag, g))
 * 
 */
    __pyx_t_7 = pari_catch_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7215
 *             g = <GEN>NULL
 *         pari_catch_sig_on()
 *         return P.new_gen(nfdisc0(self.g, flag, g))             # <<<<<<<<<<<<<<
 * 
 *     def nfeltdiveuc(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfdisc0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7182
 *         return P.new_gen(gel(basistoalg(nf.g, t0.g), 2))
 * 
 *     def nfdisc(self, long flag=0, p=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfdisc(x): Return the discriminant of the number field defined over
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen.gen.nfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v__p);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7217
 *         return P.new_gen(nfdisc0(self.g, flag, g))
 * 
 *     def nfeltdiveuc(self, x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Given `x` and `y` in the number field ``self``, return `q` such
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_531nfeltdiveuc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_530nfeltdiveuc[] = "\n        Given `x` and `y` in the number field ``self``, return `q` such\n        that `x - q y` is \"small\".\n\n        EXAMPLES::\n\n            sage: k.<a> = NumberField(x^2 + 5)\n            sage: x = 10\n            sage: y = a + 1\n            sage: pari(k).nfeltdiveuc(pari(x), pari(y))\n            [2, -2]~\n        ";
  static PyObject *__pyx_pw_3gen_3gen_531nfeltdiveuc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfeltdiveuc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("nfeltdiveuc", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfeltdiveuc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfeltdiveuc", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfeltdiveuc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_530nfeltdiveuc(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_530nfeltdiveuc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfeltdiveuc", 0);

    /* "gen.pyx":7230
 *             [2, -2]~
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7231
 *         """
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nfdiveuc(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7232
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfdiveuc(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7233
 *         cdef gen t1 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(nfdiveuc(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfeltreduce(self, x, I):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfdiveuc(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7217
 *         return P.new_gen(nfdisc0(self.g, flag, g))
 * 
 *     def nfeltdiveuc(self, x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Given `x` and `y` in the number field ``self``, return `q` such
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfeltdiveuc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7235
 *         return P.new_gen(nfdiveuc(self.g, t0.g, t1.g))
 * 
 *     def nfeltreduce(self, x, I):             # <<<<<<<<<<<<<<
 *         """
 *         Given an ideal I in Hermite normal form and an element x of the pari
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_533nfeltreduce(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_532nfeltreduce[] = "\n        Given an ideal I in Hermite normal form and an element x of the pari\n        number field self, finds an element r in self such that x-r belongs\n        to the ideal and r is small.\n\n        EXAMPLES::\n\n            sage: k.<a> = NumberField(x^2 + 5)\n            sage: I = k.ideal(a)\n            sage: kp = pari(k)\n            sage: kp.nfeltreduce(12, I.pari_hnf())\n            [2, 0]~\n            sage: 12 - k(kp.nfeltreduce(12, I.pari_hnf())) in I\n            True\n        ";
  static PyObject *__pyx_pw_3gen_3gen_533nfeltreduce(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_I = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfeltreduce (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_x,&__pyx_n_s_I,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_I)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("nfeltreduce", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfeltreduce") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_I = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfeltreduce", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfeltreduce", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_532nfeltreduce(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_I);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_532nfeltreduce(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_I) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfeltreduce", 0);

    /* "gen.pyx":7251
 *             True
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(I)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7252
 *         """
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(I)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nfreduce(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_I)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7253
 *         cdef gen t0 = objtogen(x)
 *         cdef gen t1 = objtogen(I)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfreduce(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7254
 *         cdef gen t1 = objtogen(I)
 *         pari_catch_sig_on()
 *         return P.new_gen(nfreduce(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def nffactor(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfreduce(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7235
 *         return P.new_gen(nfdiveuc(self.g, t0.g, t1.g))
 * 
 *     def nfeltreduce(self, x, I):             # <<<<<<<<<<<<<<
 *         """
 *         Given an ideal I in Hermite normal form and an element x of the pari
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfeltreduce", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7256
 *         return P.new_gen(nfreduce(self.g, t0.g, t1.g))
 * 
 *     def nffactor(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_535nffactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_535nffactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nffactor (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_534nffactor(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_534nffactor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nffactor", 0);

    /* "gen.pyx":7257
 * 
 *     def nffactor(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nffactor(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7258
 *     def nffactor(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nffactor(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7259
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(nffactor(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfgenerator(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nffactor(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7256
 *         return P.new_gen(nfreduce(self.g, t0.g, t1.g))
 * 
 *     def nffactor(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nffactor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7261
 *         return P.new_gen(nffactor(self.g, t0.g))
 * 
 *     def nfgenerator(self):             # <<<<<<<<<<<<<<
 *         f = self[0]
 *         x = f.variable()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_537nfgenerator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_537nfgenerator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfgenerator (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_536nfgenerator(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_536nfgenerator(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_v_f = NULL;
    PyObject *__pyx_v_x = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfgenerator", 0);

    /* "gen.pyx":7262
 * 
 *     def nfgenerator(self):
 *         f = self[0]             # <<<<<<<<<<<<<<
 *         x = f.variable()
 *         return x.Mod(f)
 */
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7262; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_f = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "gen.pyx":7263
 *     def nfgenerator(self):
 *         f = self[0]
 *         x = f.variable()             # <<<<<<<<<<<<<<
 *         return x.Mod(f)
 * 
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_variable); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_x = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "gen.pyx":7264
 *         f = self[0]
 *         x = f.variable()
 *         return x.Mod(f)             # <<<<<<<<<<<<<<
 * 
 *     def nfhilbert(self, a, b, p=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_x, __pyx_n_s_Mod); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_f); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __Pyx_GIVEREF(__pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_f);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_f);
      __Pyx_GIVEREF(__pyx_v_f);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7261
 *         return P.new_gen(nffactor(self.g, t0.g))
 * 
 *     def nfgenerator(self):             # <<<<<<<<<<<<<<
 *         f = self[0]
 *         x = f.variable()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.nfgenerator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_f);
    __Pyx_XDECREF(__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7266
 *         return x.Mod(f)
 * 
 *     def nfhilbert(self, a, b, p=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfhilbert(nf,a,b,{p}): if p is omitted, global Hilbert symbol (a,b)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_539nfhilbert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_538nfhilbert[] = "\n        nfhilbert(nf,a,b,{p}): if p is omitted, global Hilbert symbol (a,b)\n        in nf, that is 1 if X^2-aY^2-bZ^2 has a non-trivial solution (X,Y,Z)\n        in nf, -1 otherwise. Otherwise compute the local symbol modulo the\n        prime ideal p.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<t> = NumberField(x^3 - x + 1)\n            sage: pari(K).nfhilbert(t, t + 2)\n            -1\n            sage: P = K.ideal(t^2 + t - 2)   # Prime ideal above 5\n            sage: pari(K).nfhilbert(t, t + 2, P.pari_prime())\n            -1\n            sage: P = K.ideal(t^2 + 3*t - 1) # Prime ideal above 23, ramified\n            sage: pari(K).nfhilbert(t, t + 2, P.pari_prime())\n            1\n        ";
  static PyObject *__pyx_pw_3gen_3gen_539nfhilbert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfhilbert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_a,&__pyx_n_s_b,&__pyx_n_s_p,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("nfhilbert", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfhilbert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
      __pyx_v_p = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfhilbert", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7266; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_538nfhilbert(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b, __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_538nfhilbert(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t2 = 0;
    long __pyx_v_r;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfhilbert", 0);

    /* "gen.pyx":7286
 *             1
 *         """
 *         cdef gen t0 = objtogen(a)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(b)
 *         cdef gen t2
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7287
 *         """
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1 = objtogen(b)             # <<<<<<<<<<<<<<
 *         cdef gen t2
 *         if p:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7289
 *         cdef gen t1 = objtogen(b)
 *         cdef gen t2
 *         if p:             # <<<<<<<<<<<<<<
 *             t2 = objtogen(p)
 *             pari_catch_sig_on()
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_p); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "gen.pyx":7290
 *         cdef gen t2
 *         if p:
 *             t2 = objtogen(p)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             r = nfhilbert0(self.g, t0.g, t1.g, t2.g)
 */
      __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_t2 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":7291
 *         if p:
 *             t2 = objtogen(p)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             r = nfhilbert0(self.g, t0.g, t1.g, t2.g)
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7292
 *             t2 = objtogen(p)
 *             pari_catch_sig_on()
 *             r = nfhilbert0(self.g, t0.g, t1.g, t2.g)             # <<<<<<<<<<<<<<
 *         else:
 *             pari_catch_sig_on()
 */
      __pyx_v_r = nfhilbert0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_v_t2->g);
      goto __pyx_L3;
    }
    /*else*/ {

      /* "gen.pyx":7294
 *             r = nfhilbert0(self.g, t0.g, t1.g, t2.g)
 *         else:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             r = nfhilbert(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7295
 *         else:
 *             pari_catch_sig_on()
 *             r = nfhilbert(self.g, t0.g, t1.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return r
 */
      __pyx_v_r = nfhilbert(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g);
    }
    __pyx_L3:;

    /* "gen.pyx":7296
 *             pari_catch_sig_on()
 *             r = nfhilbert(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":7297
 *             r = nfhilbert(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 *         return r             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_r); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7266
 *         return x.Mod(f)
 * 
 *     def nfhilbert(self, a, b, p=None):             # <<<<<<<<<<<<<<
 *         """
 *         nfhilbert(nf,a,b,{p}): if p is omitted, global Hilbert symbol (a,b)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XDECREF((PyObject *)__pyx_v_t2);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7300
 * 
 * 
 *     def nfhnf(self,x):             # <<<<<<<<<<<<<<
 *         """
 *         nfhnf(nf,x) : given a pseudo-matrix (A, I) or an integral pseudo-matrix (A,I,J), finds a
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_541nfhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_540nfhnf[] = "\n        nfhnf(nf,x) : given a pseudo-matrix (A, I) or an integral pseudo-matrix (A,I,J), finds a\n        pseudo-basis in Hermite normal form of the module it generates.\n\n        A pseudo-matrix is a 2-component row vector (A, I) where A is a relative m x n matrix and\n        I an ideal list of length n. An integral pseudo-matrix is a 3-component row vector (A, I, J).\n\n        .. NOTE::\n\n            The definition of a pseudo-basis ([Cohen]_):\n            Let M be a finitely generated, torsion-free R-module, and set V = KM.  If `\\mathfrak{a}_i` are\n            fractional ideals of R and `w_i` are elements of V, we say that\n            `(w_i, \\mathfrak{a}_k)_{1 \\leq i \\leq k}`\n            is a pseudo-basis of M if\n            `M = \\mathfrak{a}_1 w_1 \\oplus \\cdots \\oplus \\mathfrak{a}_k w_k.`\n\n        REFERENCES:\n\n        .. [Cohen] Cohen, \"Advanced Topics in Computational Number Theory\"\n\n        EXAMPLES::\n\n            sage: F.<a> = NumberField(x^2-x-1)\n            sage: Fp = pari(F)\n            sage: A = matrix(F,[[1,2,a,3],[3,0,a+2,0],[0,0,a,2],[3+a,a,0,1]])\n            sage: I = [F.ideal(-2*a+1),F.ideal(7), F.ideal(3),F.ideal(1)]\n            sage: Fp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [-969/5, -1/15]~, [15, -2]~, [-1938, -3]~; 0, 1, 0, 0; 0, 0, 1, 0;\n            0, 0, 0, 1], [[3997, 1911; 0, 7], [15, 6; 0, 3], [1, 0; 0, 1], [1, 0; 0,\n            1]]]\n            sage: K.<b> = NumberField(x^3-2)\n            sage: Kp = pari(K)\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b^2,b,57],[0,2,1,b^2-3],[2,0,0,b]])\n            sage: I = [K.ideal(2),K.ideal(3+b^2),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, -225, 72, -31; 0, 1, [0, -1, 0]~, [0, 0, -1/2]~; 0, 0, 1, [0, 0,\n            -1/2]~; 0, 0, 0, 1], [[1116, 756, 612; 0, 18, 0; 0, 0, 18], [2, 0, 0; 0,\n            2, 0; 0, 0, 2], [1, 0, 0; 0, 1, 0; 0, 0, 1], [2, 0, 0; 0, 1, 0; 0, 0,\n            1]]]""\n\n        An example where the ring of integers of the number field is not a PID::\n\n            sage: K.<b> = NumberField(x^2+5)\n            sage: Kp = pari(K)\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b^2,b,57],[0,2,1,b^2-3],[2,0,0,b]])\n            sage: I = [K.ideal(2),K.ideal(3+b^2),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [15, 6]~, [0, -54]~, [113, 72]~; 0, 1, [-4, -1]~, [0, -1]~; 0, 0,\n            1, 0; 0, 0, 0, 1], [[360, 180; 0, 180], [6, 4; 0, 2], [1, 0; 0, 1], [1,\n            0; 0, 1]]]\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b,b,57],[0,2,1,b-3],[2,0,b,b]])\n            sage: I = [K.ideal(2).factor()[0][0],K.ideal(3+b),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [7605, 4]~, [5610, 5]~, [7913, -6]~; 0, 1, 0, -1; 0, 0, 1, 0; 0, 0,\n            0, 1], [[19320, 13720; 0, 56], [2, 1; 0, 1], [1, 0; 0, 1], [1, 0; 0,\n            1]]]\n\n        AUTHORS:\n\n        - Aly Deines (2012-09-19)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_541nfhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfhnf (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_540nfhnf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_540nfhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfhnf", 0);

    /* "gen.pyx":7362
 *         - Aly Deines (2012-09-19)
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nfhnf(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7363
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfhnf(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7364
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(nfhnf(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfhnf(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7300
 * 
 * 
 *     def nfhnf(self,x):             # <<<<<<<<<<<<<<
 *         """
 *         nfhnf(nf,x) : given a pseudo-matrix (A, I) or an integral pseudo-matrix (A,I,J), finds a
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7367
 * 
 * 
 *     def nfinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfinit(pol, {flag=0}): ``pol`` being a nonconstant irreducible
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_543nfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_542nfinit[] = "\n        nfinit(pol, {flag=0}): ``pol`` being a nonconstant irreducible\n        polynomial, gives a vector containing all the data necessary for PARI\n        to compute in this number field.\n\n        ``flag`` is optional and can be set to:\n         - 0: default\n         - 1: do not compute different\n         - 2: first use polred to find a simpler polynomial\n         - 3: outputs a two-element vector [nf,Mod(a,P)], where nf is as in 2\n              and Mod(a,P) is a polmod equal to Mod(x,pol) and P=nf.pol\n\n        EXAMPLES::\n\n            sage: pari('x^3 - 17').nfinit()\n            [x^3 - 17, [1, 1], -867, 3, [[1, 1.68006..., 2.57128...; 1, -0.340034... + 2.65083...*I, -1.28564... - 2.22679...*I], [1, 1.68006..., 2.57128...; 1, 2.31080..., -3.51243...; 1, -2.99087..., 0.941154...], [1, 2, 3; 1, 2, -4; 1, -3, 1], [3, 1, 0; 1, -11, 17; 0, 17, 0], [51, 0, 16; 0, 17, 3; 0, 0, 1], [17, 0, -1; 0, 0, 3; -1, 3, 2], [51, [-17, 6, -1; 0, -18, 3; 1, 0, -16]]], [2.57128..., -1.28564... - 2.22679...*I], [1, 1/3*x^2 - 1/3*x + 1/3, x], [1, 0, -1; 0, 0, 3; 0, 1, 1], [1, 0, 0, 0, -4, 6, 0, 6, -1; 0, 1, 0, 1, 1, -1, 0, -1, 3; 0, 0, 1, 0, 2, 0, 1, 0, 1]]\n\n        TESTS:\n\n        This example only works after increasing precision::\n\n            sage: pari('x^2 + 10^100 + 1').nfinit(precision=64)\n            Traceback (most recent call last):\n            ...\n            PariError: precision too low in floorr (precision loss in truncation)\n            sage: pari('x^2 + 10^100 + 1').nfinit()\n            [...]\n\n        Throw a PARI error which is not of type ``precer``::\n\n            sage: pari('1.0').nfinit()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type in checknf\n        ";
  static PyObject *__pyx_pw_3gen_3gen_543nfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7367; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7367; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7367; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7367; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_542nfinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_542nfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_v_err = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    PyObject *__pyx_t_8 = NULL;
    PyObject *__pyx_t_9 = NULL;
    PyObject *__pyx_t_10 = NULL;
    Py_ssize_t __pyx_t_11;
    PyObject *__pyx_t_12 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfinit", 0);

    /* "gen.pyx":7404
 *         """
 *         # If explicit precision is given, use only that
 *         if precision:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(nfinit0(self.g, flag, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = (__pyx_v_precision != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":7405
 *         # If explicit precision is given, use only that
 *         if precision:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(nfinit0(self.g, flag, prec_bits_to_words(precision)))
 * 
 */
      __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7406
 *         if precision:
 *             pari_catch_sig_on()
 *             return P.new_gen(nfinit0(self.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfinit0(__pyx_v_self->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":7409
 * 
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 *         precision = 64             # <<<<<<<<<<<<<<
 *         while True:
 *             try:
 */
    __pyx_v_precision = 64;

    /* "gen.pyx":7410
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 *         precision = 64
 *         while True:             # <<<<<<<<<<<<<<
 *             try:
 *                 return self.nfinit(flag, precision)
 */
    while (1) {

      /* "gen.pyx":7411
 *         precision = 64
 *         while True:
 *             try:             # <<<<<<<<<<<<<<
 *                 return self.nfinit(flag, precision)
 *             except PariError as err:
 */
      {
        __Pyx_ExceptionSave(&__pyx_t_4, &__pyx_t_5, &__pyx_t_6);
        __Pyx_XGOTREF(__pyx_t_4);
        __Pyx_XGOTREF(__pyx_t_5);
        __Pyx_XGOTREF(__pyx_t_6);
        /*try:*/ {

          /* "gen.pyx":7412
 *         while True:
 *             try:
 *                 return self.nfinit(flag, precision)             # <<<<<<<<<<<<<<
 *             except PariError as err:
 *                 if err.errnum() == e_PREC:
 */
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nfinit); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7412; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_8 = __Pyx_PyInt_From_long(__pyx_v_flag); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7412; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_9 = __Pyx_PyInt_From_unsigned_long(__pyx_v_precision); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7412; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_9);
          __pyx_t_10 = NULL;
          __pyx_t_11 = 0;
          if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_7))) {
            __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_7);
            if (likely(__pyx_t_10)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
              __Pyx_INCREF(__pyx_t_10);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_7, function);
              __pyx_t_11 = 1;
            }
          }
          __pyx_t_12 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7412; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_12);
          if (__pyx_t_10) {
            PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __Pyx_GIVEREF(__pyx_t_10); __pyx_t_10 = NULL;
          }
          PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_t_8);
          __Pyx_GIVEREF(__pyx_t_8);
          PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_9);
          __Pyx_GIVEREF(__pyx_t_9);
          __pyx_t_8 = 0;
          __pyx_t_9 = 0;
          __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7412; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_r = __pyx_t_3;
          __pyx_t_3 = 0;
          goto __pyx_L10_try_return;
        }
        __pyx_L6_error:;
        __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
        __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;

        /* "gen.pyx":7413
 *             try:
 *                 return self.nfinit(flag, precision)
 *             except PariError as err:             # <<<<<<<<<<<<<<
 *                 if err.errnum() == e_PREC:
 * 
 */
        __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_PariError); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7413; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = PyErr_ExceptionMatches(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        if (__pyx_t_2) {
          __Pyx_AddTraceback("gen.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_7, &__pyx_t_12) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7413; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_GOTREF(__pyx_t_7);
          __Pyx_GOTREF(__pyx_t_12);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_XDECREF_SET(__pyx_v_err, __pyx_t_7);

          /* "gen.pyx":7414
 *                 return self.nfinit(flag, precision)
 *             except PariError as err:
 *                 if err.errnum() == e_PREC:             # <<<<<<<<<<<<<<
 * 
 *                     precision *= 2
 */
          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_err, __pyx_n_s_errnum); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_10 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_8))) {
            __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
            if (likely(__pyx_t_10)) {
              PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
              __Pyx_INCREF(__pyx_t_10);
              __Pyx_INCREF(function);
              __Pyx_DECREF_SET(__pyx_t_8, function);
            }
          }
          if (__pyx_t_10) {
            __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_10); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
            __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          } else {
            __pyx_t_9 = __Pyx_PyObject_CallNoArg(__pyx_t_8); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          }
          __Pyx_GOTREF(__pyx_t_9);
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = __Pyx_PyInt_From_int(e_PREC); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_10 = PyObject_RichCompare(__pyx_t_9, __pyx_t_8, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7414; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          if (__pyx_t_1) {

            /* "gen.pyx":7416
 *                 if err.errnum() == e_PREC:
 * 
 *                     precision *= 2             # <<<<<<<<<<<<<<
 *                 else:
 *                     raise
 */
            __pyx_v_precision = (__pyx_v_precision * 2);
            goto __pyx_L16;
          }
          /*else*/ {

            /* "gen.pyx":7418
 *                     precision *= 2
 *                 else:
 *                     raise             # <<<<<<<<<<<<<<
 * 
 *     def nfisisom(self, gen other):
 */
            __Pyx_GIVEREF(__pyx_t_3);
            __Pyx_GIVEREF(__pyx_t_7);
            __Pyx_XGIVEREF(__pyx_t_12);
            __Pyx_ErrRestore(__pyx_t_3, __pyx_t_7, __pyx_t_12);
            __pyx_t_3 = 0; __pyx_t_7 = 0; __pyx_t_12 = 0; 
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7418; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          }
          __pyx_L16:;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
          goto __pyx_L7_exception_handled;
        }
        goto __pyx_L8_except_error;
        __pyx_L8_except_error:;
        __Pyx_XGIVEREF(__pyx_t_4);
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_ExceptionReset(__pyx_t_4, __pyx_t_5, __pyx_t_6);
        goto __pyx_L1_error;
        __pyx_L10_try_return:;
        __Pyx_XGIVEREF(__pyx_t_4);
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_ExceptionReset(__pyx_t_4, __pyx_t_5, __pyx_t_6);
        goto __pyx_L0;
        __pyx_L7_exception_handled:;
        __Pyx_XGIVEREF(__pyx_t_4);
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_ExceptionReset(__pyx_t_4, __pyx_t_5, __pyx_t_6);
      }
    }

    /* "gen.pyx":7367
 * 
 * 
 *     def nfinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfinit(pol, {flag=0}): ``pol`` being a nonconstant irreducible
 */

    /* function exit code */
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_XDECREF(__pyx_t_9);
    __Pyx_XDECREF(__pyx_t_10);
    __Pyx_XDECREF(__pyx_t_12);
    __Pyx_AddTraceback("gen.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_err);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7420
 *                     raise
 * 
 *     def nfisisom(self, gen other):             # <<<<<<<<<<<<<<
 *         """
 *         nfisisom(x, y): Determine if the number fields defined by x and y
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_545nfisisom(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
  static char __pyx_doc_3gen_3gen_544nfisisom[] = "\n        nfisisom(x, y): Determine if the number fields defined by x and y\n        are isomorphic. According to the PARI documentation, this is much\n        faster if at least one of x or y is a number field. If they are\n        isomorphic, it returns an embedding for the generators. If not,\n        returns 0.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: G = NumberField(x^3-2,'beta')\n            sage: F._pari_().nfisisom(G._pari_())\n            [y]\n\n        ::\n\n            sage: GG = NumberField(x^3-4,'gamma')\n            sage: F._pari_().nfisisom(GG._pari_())\n            [1/2*y^2]\n\n        ::\n\n            sage: F._pari_().nfisisom(GG.pari_nf())\n            [1/2*y^2]\n\n        ::\n\n            sage: F.pari_nf().nfisisom(GG._pari_()[0])\n            [y^2]\n\n        ::\n\n            sage: H = NumberField(x^2-2,'alpha')\n            sage: F._pari_().nfisisom(H._pari_())\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_545nfisisom(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
    CYTHON_UNUSED int __pyx_lineno = 0;
    CYTHON_UNUSED const char *__pyx_filename = NULL;
    CYTHON_UNUSED int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfisisom (wrapper)", 0);
    if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_3gen_gen, 1, "other", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_r = __pyx_pf_3gen_3gen_544nfisisom(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((struct __pyx_obj_3gen_gen *)__pyx_v_other));

    /* function exit code */
    goto __pyx_L0;
    __pyx_L1_error:;
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_544nfisisom(struct __pyx_obj_3gen_gen *__pyx_v_self, struct __pyx_obj_3gen_gen *__pyx_v_other) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfisisom", 0);

    /* "gen.pyx":7457
 *             0
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfisisom(self.g, other.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7458
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(nfisisom(self.g, other.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfrootsof1(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfisisom(__pyx_v_self->g, __pyx_v_other->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7420
 *                     raise
 * 
 *     def nfisisom(self, gen other):             # <<<<<<<<<<<<<<
 *         """
 *         nfisisom(x, y): Determine if the number fields defined by x and y
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.nfisisom", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7460
 *         return P.new_gen(nfisisom(self.g, other.g))
 * 
 *     def nfrootsof1(self):             # <<<<<<<<<<<<<<
 *         """
 *         nf.nfrootsof1()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_547nfrootsof1(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_546nfrootsof1[] = "\n        nf.nfrootsof1()\n\n        number of roots of unity and primitive root of unity in the number\n        field nf.\n\n        EXAMPLES::\n\n            sage: nf = pari('x^2 + 1').nfinit()\n            sage: nf.nfrootsof1()\n            [4, -x]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_547nfrootsof1(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfrootsof1 (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_546nfrootsof1(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_546nfrootsof1(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfrootsof1", 0);

    /* "gen.pyx":7473
 *             [4, -x]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rootsof1(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7474
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(rootsof1(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfsubfields(self, long d=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rootsof1(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7460
 *         return P.new_gen(nfisisom(self.g, other.g))
 * 
 *     def nfrootsof1(self):             # <<<<<<<<<<<<<<
 *         """
 *         nf.nfrootsof1()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.nfrootsof1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7476
 *         return P.new_gen(rootsof1(self.g))
 * 
 *     def nfsubfields(self, long d=0):             # <<<<<<<<<<<<<<
 *         """
 *         Find all subfields of degree d of number field nf (all subfields if
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_549nfsubfields(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_548nfsubfields[] = "\n        Find all subfields of degree d of number field nf (all subfields if\n        d is null or omitted). Result is a vector of subfields, each being\n        given by [g,h], where g is an absolute equation and h expresses one\n        of the roots of g in terms of the root x of the polynomial defining\n        nf.\n\n        INPUT:\n\n\n        -  ``self`` - nf number field\n\n        -  ``d`` - C long integer\n        ";
  static PyObject *__pyx_pw_3gen_3gen_549nfsubfields(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_d;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfsubfields (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_d,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_d);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfsubfields") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7476; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_d = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_d == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7476; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_d = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfsubfields", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7476; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfsubfields", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_548nfsubfields(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_d);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_548nfsubfields(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_d) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfsubfields", 0);

    /* "gen.pyx":7491
 *         -  ``d`` - C long integer
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfsubfields(self.g, d))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7492
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(nfsubfields(self.g, d))             # <<<<<<<<<<<<<<
 * 
 *     def rnfcharpoly(self, T, a, v='x'):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfsubfields(__pyx_v_self->g, __pyx_v_d))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7476
 *         return P.new_gen(rootsof1(self.g))
 * 
 *     def nfsubfields(self, long d=0):             # <<<<<<<<<<<<<<
 *         """
 *         Find all subfields of degree d of number field nf (all subfields if
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.nfsubfields", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7494
 *         return P.new_gen(nfsubfields(self.g, d))
 * 
 *     def rnfcharpoly(self, T, a, v='x'):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(T)
 *         cdef gen t1 = objtogen(a)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_551rnfcharpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_551rnfcharpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_T = 0;
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfcharpoly (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_T,&__pyx_n_s_a,&__pyx_n_s_v,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_n_s_x);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("rnfcharpoly", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfcharpoly") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_T = values[0];
      __pyx_v_a = values[1];
      __pyx_v_v = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfcharpoly", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7494; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.rnfcharpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_550rnfcharpoly(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_T, __pyx_v_a, __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_550rnfcharpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_T, PyObject *__pyx_v_a, PyObject *__pyx_v_v) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t2 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfcharpoly", 0);

    /* "gen.pyx":7495
 * 
 *     def rnfcharpoly(self, T, a, v='x'):
 *         cdef gen t0 = objtogen(T)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(a)
 *         cdef gen t2 = objtogen(v)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_T)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7496
 *     def rnfcharpoly(self, T, a, v='x'):
 *         cdef gen t0 = objtogen(T)
 *         cdef gen t1 = objtogen(a)             # <<<<<<<<<<<<<<
 *         cdef gen t2 = objtogen(v)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7497
 *         cdef gen t0 = objtogen(T)
 *         cdef gen t1 = objtogen(a)
 *         cdef gen t2 = objtogen(v)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfcharpoly(self.g, t0.g, t1.g, gvar(t2.g)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_v)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t2 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7498
 *         cdef gen t1 = objtogen(a)
 *         cdef gen t2 = objtogen(v)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfcharpoly(self.g, t0.g, t1.g, gvar(t2.g)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7499
 *         cdef gen t2 = objtogen(v)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfcharpoly(self.g, t0.g, t1.g, gvar(t2.g)))             # <<<<<<<<<<<<<<
 * 
 *     def rnfdisc(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfcharpoly(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, gvar(__pyx_v_t2->g)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7494
 *         return P.new_gen(nfsubfields(self.g, d))
 * 
 *     def rnfcharpoly(self, T, a, v='x'):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(T)
 *         cdef gen t1 = objtogen(a)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfcharpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XDECREF((PyObject *)__pyx_v_t2);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7501
 *         return P.new_gen(rnfcharpoly(self.g, t0.g, t1.g, gvar(t2.g)))
 * 
 *     def rnfdisc(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_553rnfdisc(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_553rnfdisc(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfdisc (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_552rnfdisc(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_552rnfdisc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfdisc", 0);

    /* "gen.pyx":7502
 * 
 *     def rnfdisc(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfdiscf(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7503
 *     def rnfdisc(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfdiscf(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7504
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfdiscf(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfeltabstorel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfdiscf(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7501
 *         return P.new_gen(rnfcharpoly(self.g, t0.g, t1.g, gvar(t2.g)))
 * 
 *     def rnfdisc(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7506
 *         return P.new_gen(rnfdiscf(self.g, t0.g))
 * 
 *     def rnfeltabstorel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_555rnfeltabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_555rnfeltabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfeltabstorel (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_554rnfeltabstorel(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_554rnfeltabstorel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfeltabstorel", 0);

    /* "gen.pyx":7507
 * 
 *     def rnfeltabstorel(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfelementabstorel(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7508
 *     def rnfeltabstorel(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfelementabstorel(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7509
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfelementabstorel(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfeltreltoabs(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfelementabstorel(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7506
 *         return P.new_gen(rnfdiscf(self.g, t0.g))
 * 
 *     def rnfeltabstorel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfeltabstorel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7511
 *         return P.new_gen(rnfelementabstorel(self.g, t0.g))
 * 
 *     def rnfeltreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_557rnfeltreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_557rnfeltreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfeltreltoabs (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_556rnfeltreltoabs(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_556rnfeltreltoabs(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfeltreltoabs", 0);

    /* "gen.pyx":7512
 * 
 *     def rnfeltreltoabs(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfelementreltoabs(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7513
 *     def rnfeltreltoabs(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfelementreltoabs(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7514
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfelementreltoabs(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfequation(self, poly, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfelementreltoabs(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7511
 *         return P.new_gen(rnfelementabstorel(self.g, t0.g))
 * 
 *     def rnfeltreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfeltreltoabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7516
 *         return P.new_gen(rnfelementreltoabs(self.g, t0.g))
 * 
 *     def rnfequation(self, poly, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_559rnfequation(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_559rnfequation(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_poly = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfequation (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_poly,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_poly)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfequation") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7516; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_poly = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7516; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfequation", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7516; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.rnfequation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_558rnfequation(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_poly, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_558rnfequation(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfequation", 0);

    /* "gen.pyx":7517
 * 
 *     def rnfequation(self, poly, long flag=0):
 *         cdef gen t0 = objtogen(poly)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfequation0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_poly)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7518
 *     def rnfequation(self, poly, long flag=0):
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfequation0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7519
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfequation0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealabstorel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfequation0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7516
 *         return P.new_gen(rnfelementreltoabs(self.g, t0.g))
 * 
 *     def rnfequation(self, poly, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfequation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7521
 *         return P.new_gen(rnfequation0(self.g, t0.g, flag))
 * 
 *     def rnfidealabstorel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_561rnfidealabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_561rnfidealabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealabstorel (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_560rnfidealabstorel(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_560rnfidealabstorel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealabstorel", 0);

    /* "gen.pyx":7522
 * 
 *     def rnfidealabstorel(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealabstorel(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7523
 *     def rnfidealabstorel(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealabstorel(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7524
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealabstorel(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealdown(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealabstorel(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7521
 *         return P.new_gen(rnfequation0(self.g, t0.g, flag))
 * 
 *     def rnfidealabstorel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealabstorel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7526
 *         return P.new_gen(rnfidealabstorel(self.g, t0.g))
 * 
 *     def rnfidealdown(self, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         rnfidealdown(rnf,x): finds the intersection of the ideal x with the base field.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_563rnfidealdown(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_3gen_3gen_562rnfidealdown[] = "\n        rnfidealdown(rnf,x): finds the intersection of the ideal x with the base field.\n\n        EXAMPLES:\n            sage: x = ZZ['xx1'].0; pari(x)\n            xx1\n            sage: y = ZZ['yy1'].0; pari(y)\n            yy1\n            sage: nf = pari(y^2 - 6*y + 24).nfinit()\n            sage: rnf = nf.rnfinit(x^2 - pari(y))\n\n        This is the relative HNF of the inert ideal (2) in rnf::\n\n            sage: P = pari('[[[1, 0]~, [0, 0]~; [0, 0]~, [1, 0]~], [[2, 0; 0, 2], [2, 0; 0, 1/2]]]')\n\n        And this is the HNF of the inert ideal (2) in nf:\n\n            sage: rnf.rnfidealdown(P)\n            [2, 0; 0, 2]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_563rnfidealdown(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealdown (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_562rnfidealdown(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_562rnfidealdown(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealdown", 0);

    /* "gen.pyx":7547
 *             [2, 0; 0, 2]
 *         """
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealdown(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7548
 *         """
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealdown(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7549
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealdown(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealhnf(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealdown(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7526
 *         return P.new_gen(rnfidealabstorel(self.g, t0.g))
 * 
 *     def rnfidealdown(self, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         rnfidealdown(rnf,x): finds the intersection of the ideal x with the base field.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealdown", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7551
 *         return P.new_gen(rnfidealdown(self.g, t0.g))
 * 
 *     def rnfidealhnf(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_565rnfidealhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_565rnfidealhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealhnf (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_564rnfidealhnf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_564rnfidealhnf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealhnf", 0);

    /* "gen.pyx":7552
 * 
 *     def rnfidealhnf(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealhermite(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7553
 *     def rnfidealhnf(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealhermite(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7554
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealhermite(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealnormrel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealhermite(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7551
 *         return P.new_gen(rnfidealdown(self.g, t0.g))
 * 
 *     def rnfidealhnf(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7556
 *         return P.new_gen(rnfidealhermite(self.g, t0.g))
 * 
 *     def rnfidealnormrel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_567rnfidealnormrel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_567rnfidealnormrel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealnormrel (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_566rnfidealnormrel(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_566rnfidealnormrel(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealnormrel", 0);

    /* "gen.pyx":7557
 * 
 *     def rnfidealnormrel(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealnormrel(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7558
 *     def rnfidealnormrel(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealnormrel(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7558; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7559
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealnormrel(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealreltoabs(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealnormrel(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7556
 *         return P.new_gen(rnfidealhermite(self.g, t0.g))
 * 
 *     def rnfidealnormrel(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealnormrel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7561
 *         return P.new_gen(rnfidealnormrel(self.g, t0.g))
 * 
 *     def rnfidealreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_569rnfidealreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_569rnfidealreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealreltoabs (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_568rnfidealreltoabs(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_568rnfidealreltoabs(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealreltoabs", 0);

    /* "gen.pyx":7562
 * 
 *     def rnfidealreltoabs(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealreltoabs(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7563
 *     def rnfidealreltoabs(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealreltoabs(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7564
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealreltoabs(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealtwoelt(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealreltoabs(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7561
 *         return P.new_gen(rnfidealnormrel(self.g, t0.g))
 * 
 *     def rnfidealreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealreltoabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7566
 *         return P.new_gen(rnfidealreltoabs(self.g, t0.g))
 * 
 *     def rnfidealtwoelt(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_571rnfidealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_571rnfidealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealtwoelt (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_570rnfidealtwoelt(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_570rnfidealtwoelt(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealtwoelt", 0);

    /* "gen.pyx":7567
 * 
 *     def rnfidealtwoelt(self, x):
 *         cdef gen t0 = objtogen(x)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealtwoelement(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7567; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7568
 *     def rnfidealtwoelt(self, x):
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfidealtwoelement(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7569
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfidealtwoelement(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfinit(self, poly):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfidealtwoelement(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7569; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7566
 *         return P.new_gen(rnfidealreltoabs(self.g, t0.g))
 * 
 *     def rnfidealtwoelt(self, x):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(x)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfidealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7571
 *         return P.new_gen(rnfidealtwoelement(self.g, t0.g))
 * 
 *     def rnfinit(self, poly):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES: We construct a relative number field.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_573rnfinit(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static char __pyx_doc_3gen_3gen_572rnfinit[] = "\n        EXAMPLES: We construct a relative number field.\n\n        ::\n\n            sage: f = pari('y^3+y+1')\n            sage: K = f.nfinit()\n            sage: x = pari('x'); y = pari('y')\n            sage: g = x^5 - x^2 + y\n            sage: L = K.rnfinit(g)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_573rnfinit(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfinit (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_572rnfinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_572rnfinit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfinit", 0);

    /* "gen.pyx":7583
 *             sage: L = K.rnfinit(g)
 *         """
 *         cdef gen t0 = objtogen(poly)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfinit(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_poly)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7584
 *         """
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfinit(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7585
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfinit(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def rnfisfree(self, poly):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfinit(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7571
 *         return P.new_gen(rnfidealtwoelement(self.g, t0.g))
 * 
 *     def rnfinit(self, poly):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES: We construct a relative number field.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7587
 *         return P.new_gen(rnfinit(self.g, t0.g))
 * 
 *     def rnfisfree(self, poly):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_575rnfisfree(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_575rnfisfree(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisfree (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_574rnfisfree(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_574rnfisfree(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    long __pyx_v_r;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisfree", 0);

    /* "gen.pyx":7588
 * 
 *     def rnfisfree(self, poly):
 *         cdef gen t0 = objtogen(poly)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         r = rnfisfree(self.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_poly)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7589
 *     def rnfisfree(self, poly):
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         r = rnfisfree(self.g, t0.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7589; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7590
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 *         r = rnfisfree(self.g, t0.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return r
 */
    __pyx_v_r = rnfisfree(__pyx_v_self->g, __pyx_v_t0->g);

    /* "gen.pyx":7591
 *         pari_catch_sig_on()
 *         r = rnfisfree(self.g, t0.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":7592
 *         r = rnfisfree(self.g, t0.g)
 *         pari_catch_sig_off()
 *         return r             # <<<<<<<<<<<<<<
 * 
 *     def quadhilbert(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_r); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7592; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7587
 *         return P.new_gen(rnfinit(self.g, t0.g))
 * 
 *     def rnfisfree(self, poly):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfisfree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7594
 *         return r
 * 
 *     def quadhilbert(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a polynomial over `\QQ` whose roots generate the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_577quadhilbert(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_576quadhilbert[] = "\n        Returns a polynomial over `\\QQ` whose roots generate the\n        Hilbert class field of the quadratic field of discriminant\n        ``self`` (which must be fundamental).\n\n        EXAMPLES::\n\n            sage: pari(-23).quadhilbert()\n            x^3 - x^2 + 1\n            sage: pari(145).quadhilbert()\n            x^4 - x^3 - 3*x^2 + x + 1\n            sage: pari(-12).quadhilbert()   # Not fundamental\n            Traceback (most recent call last):\n            ...\n            PariError: quadray needs a fundamental discriminant\n        ";
  static PyObject *__pyx_pw_3gen_3gen_577quadhilbert(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("quadhilbert (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_576quadhilbert(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_576quadhilbert(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("quadhilbert", 0);

    /* "gen.pyx":7611
 *             PariError: quadray needs a fundamental discriminant
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # Precision argument is only used for real quadratic extensions
 *         # and will be automatically increased by PARI if needed.
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7614
 *         # Precision argument is only used for real quadratic extensions
 *         # and will be automatically increased by PARI if needed.
 *         return P.new_gen(quadhilbert(self.g, DEFAULTPREC))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, quadhilbert(__pyx_v_self->g, DEFAULTPREC))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7594
 *         return r
 * 
 *     def quadhilbert(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a polynomial over `\QQ` whose roots generate the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.quadhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7620
 *     # 7: POLYNOMIALS and power series
 *     ##################################################
 *     def reverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the polynomial obtained by reversing the coefficients of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_579reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_578reverse[] = "\n        Return the polynomial obtained by reversing the coefficients of\n        this polynomial.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_579reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("reverse (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_578reverse(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_578reverse(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("reverse", 0);

    /* "gen.pyx":7625
 *         this polynomial.
 *         """
 *         return self.Vec().Polrev()             # <<<<<<<<<<<<<<
 * 
 *     def content(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_Vec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Polrev); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_2);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_2) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7620
 *     # 7: POLYNOMIALS and power series
 *     ##################################################
 *     def reverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the polynomial obtained by reversing the coefficients of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.reverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7627
 *         return self.Vec().Polrev()
 * 
 *     def content(self):             # <<<<<<<<<<<<<<
 *         """
 *         Greatest common divisor of all the components of ``self``.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_581content(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_580content[] = "\n        Greatest common divisor of all the components of ``self``.\n\n        EXAMPLES::\n\n            sage: R.<x> = PolynomialRing(ZZ)\n            sage: pari(2*x^2 + 2).content()\n            2\n            sage: pari(\"4*x^3 - 2*x/3 + 2/5\").content()\n            2/15\n        ";
  static PyObject *__pyx_pw_3gen_3gen_581content(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("content (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_580content(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_580content(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("content", 0);

    /* "gen.pyx":7639
 *             2/15
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(content(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7640
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(content(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def deriv(self, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, content(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7627
 *         return self.Vec().Polrev()
 * 
 *     def content(self):             # <<<<<<<<<<<<<<
 *         """
 *         Greatest common divisor of all the components of ``self``.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.content", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7642
 *         return P.new_gen(content(self.g))
 * 
 *     def deriv(self, v=-1):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(deriv(self.g, P.get_var(v)))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_583deriv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_583deriv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("deriv (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "deriv") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("deriv", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7642; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.deriv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_582deriv(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_582deriv(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("deriv", 0);

    /* "gen.pyx":7643
 * 
 *     def deriv(self, v=-1):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(deriv(self.g, P.get_var(v)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7644
 *     def deriv(self, v=-1):
 *         pari_catch_sig_on()
 *         return P.new_gen(deriv(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def eval(self, *args, **kwds):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, deriv(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7644; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7642
 *         return P.new_gen(content(self.g))
 * 
 *     def deriv(self, v=-1):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(deriv(self.g, P.get_var(v)))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.deriv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7646
 *         return P.new_gen(deriv(self.g, P.get_var(v)))
 * 
 *     def eval(self, *args, **kwds):             # <<<<<<<<<<<<<<
 *         """
 *         Evaluate ``self`` with the given arguments.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_585eval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_584eval[] = "\n        Evaluate ``self`` with the given arguments.\n\n        This is currently implemented in 3 cases:\n        \n        - univariate polynomials, rational functions, power series and\n          Laurent series (using a single unnamed argument or keyword\n          arguments),\n        - any PARI object supporting the PARI function ``substvec``\n          (in particular, multivariate polynomials) using keyword\n          arguments,\n        - objects of type ``t_CLOSURE`` (functions in GP bytecode form)\n          using unnamed arguments.\n\n        In no case is mixing unnamed and keyword arguments allowed.\n\n        EXAMPLES::\n\n            sage: f = pari('x^2 + 1')\n            sage: f.type()\n            't_POL'\n            sage: f.eval(I)\n            0\n            sage: f.eval(x=2)\n            5\n            sage: (1/f).eval(x=1)\n            1/2\n\n        The notation ``f(x)`` is an alternative for ``f.eval(x)``::\n\n            sage: f(3) == f.eval(3)\n            True\n\n        Evaluating power series::\n\n            sage: f = pari('1 + x + x^3 + O(x^7)')\n            sage: f(2*pari('y')^2)\n            1 + 2*y^2 + 8*y^6 + O(y^14)\n\n        Substituting zero is sometimes possible, and trying to do so\n        in illegal cases can raise various errors::\n\n            sage: pari('1 + O(x^3)').eval(0)\n            1\n            sage: pari('1/x').eval(0)\n            Traceback (most recent call last):\n            ...\n            PariError: division by zero\n            sage: pari('1/x + O(x^2)').eval(0)\n            Traceback (most recent call last):\n            ...\n            ZeroDivisionError: substituting 0 in Laurent series with negative valuation\n            sage: pari('1/x + O(x^2)').eval(pari('O(x^3)'))\n            Traceback (most recent call last):\n            ...\n            PariError: division by zero\n            sage: pari('O(x^0)').eval(0)\n            Traceback (most recent call last):\n            ...\n            PariErro""r: non existent component in truecoeff\n\n        Evaluating multivariate polynomials::\n        \n            sage: f = pari('y^2 + x^3')\n            sage: f(1)    # Dangerous, depends on PARI variable ordering\n            y^2 + 1\n            sage: f(x=1)  # Safe\n            y^2 + 1\n            sage: f(y=1)\n            x^3 + 1\n            sage: f(1, 2)\n            Traceback (most recent call last):\n            ...\n            TypeError: evaluating PARI t_POL takes exactly 1 argument (2 given)\n            sage: f(y='x', x='2*y')\n            x^2 + 8*y^3\n            sage: f()\n            x^3 + y^2\n\n        It's not an error to substitute variables which do not appear::\n\n            sage: f.eval(z=37)\n            x^3 + y^2\n            sage: pari(42).eval(t=0)\n            42\n\n        We can define and evaluate closures as follows::\n\n            sage: T = pari('n -> n + 2')\n            sage: T.type()\n            't_CLOSURE'\n            sage: T.eval(3)\n            5\n\n            sage: T = pari('() -> 42')\n            sage: T()\n            42\n\n            sage: pr = pari('s -> print(s)')\n            sage: pr.eval('\"hello world\"')\n            hello world\n\n            sage: f = pari('myfunc(x,y) = x*y')\n            sage: f.eval(5, 6)\n            30\n\n        Default arguments work, missing arguments are treated as zero\n        (like in GP)::\n\n            sage: f = pari(\"(x, y, z=1.0) -> [x, y, z]\")\n            sage: f(1, 2, 3)\n            [1, 2, 3]\n            sage: f(1, 2)\n            [1, 2, 1.00000000000000]\n            sage: f(1)\n            [1, 0, 1.00000000000000]\n            sage: f()\n            [0, 0, 1.00000000000000]\n\n        Using keyword arguments, we can substitute in more complicated\n        objects, for example a number field::\n\n            sage: K.<a> = NumberField(x^2 + 1)\n            sage: nf = K._pari_()\n            sage: nf\n            [y^2 + 1, [0, 1], -4, 1, [Mat([1, 0.E-19 - 1.00000000000""000*I]), [1, -1.00000000000000; 1, 1.00000000000000], [1, -1; 1, 1], [2, 0; 0, -2], [2, 0; 0, 2], [1, 0; 0, -1], [1, [0, -1; 1, 0]]], [0.E-19 - 1.00000000000000*I], [1, y], [1, 0; 0, 1], [1, 0, 0, -1; 0, 1, 1, 0]]\n            sage: nf(y='x')\n            [x^2 + 1, [0, 1], -4, 1, [Mat([1, 0.E-19 - 1.00000000000000*I]), [1, -1.00000000000000; 1, 1.00000000000000], [1, -1; 1, 1], [2, 0; 0, -2], [2, 0; 0, 2], [1, 0; 0, -1], [1, [0, -1; 1, 0]]], [0.E-19 - 1.00000000000000*I], [1, x], [1, 0; 0, 1], [1, 0, 0, -1; 0, 1, 1, 0]]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_585eval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_args = 0;
    PyObject *__pyx_v_kwds = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eval (wrapper)", 0);
    if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "eval", 1))) return NULL;
    __pyx_v_kwds = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
    if (unlikely(!__pyx_v_kwds)) return NULL;
    __Pyx_GOTREF(__pyx_v_kwds);
    __Pyx_INCREF(__pyx_args);
    __pyx_v_args = __pyx_args;
    __pyx_r = __pyx_pf_3gen_3gen_584eval(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_args, __pyx_v_kwds);

    /* function exit code */
    __Pyx_XDECREF(__pyx_v_args);
    __Pyx_XDECREF(__pyx_v_kwds);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_584eval(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwds) {
    long __pyx_v_t;
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    GEN __pyx_v_result;
    long __pyx_v_arity;
    long __pyx_v_nargs;
    long __pyx_v_nkwds;
    PyObject *__pyx_v_vstr = NULL;
    GEN __pyx_v_v;
    long __pyx_v_i;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    Py_ssize_t __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    int __pyx_t_7;
    int __pyx_t_8;
    long __pyx_t_9;
    long __pyx_t_10;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eval", 0);

    /* "gen.pyx":7776
 *             [x^2 + 1, [0, 1], -4, 1, [Mat([1, 0.E-19 - 1.00000000000000*I]), [1, -1.00000000000000; 1, 1.00000000000000], [1, -1; 1, 1], [2, 0; 0, -2], [2, 0; 0, 2], [1, 0; 0, -1], [1, [0, -1; 1, 0]]], [0.E-19 - 1.00000000000000*I], [1, x], [1, 0; 0, 1], [1, 0, 0, -1; 0, 1, 1, 0]]
 *         """
 *         cdef long t = typ(self.g)             # <<<<<<<<<<<<<<
 *         cdef gen t0
 *         cdef GEN result
 */
    __pyx_v_t = typ(__pyx_v_self->g);

    /* "gen.pyx":7780
 *         cdef GEN result
 *         cdef long arity
 *         cdef long nargs = len(args)             # <<<<<<<<<<<<<<
 *         cdef long nkwds = len(kwds)
 * 
 */
    __pyx_t_1 = PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_nargs = __pyx_t_1;

    /* "gen.pyx":7781
 *         cdef long arity
 *         cdef long nargs = len(args)
 *         cdef long nkwds = len(kwds)             # <<<<<<<<<<<<<<
 * 
 *         # Closure must be evaluated using *args
 */
    __pyx_t_1 = PyDict_Size(__pyx_v_kwds); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_nkwds = __pyx_t_1;

    /* "gen.pyx":7784
 * 
 *         # Closure must be evaluated using *args
 *         if t == t_CLOSURE:             # <<<<<<<<<<<<<<
 *             if nkwds > 0:
 *                 raise TypeError("cannot evaluate a PARI closure using keyword arguments")
 */
    __pyx_t_2 = ((__pyx_v_t == t_CLOSURE) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":7785
 *         # Closure must be evaluated using *args
 *         if t == t_CLOSURE:
 *             if nkwds > 0:             # <<<<<<<<<<<<<<
 *                 raise TypeError("cannot evaluate a PARI closure using keyword arguments")
 *             # XXX: use undocumented internals to get arity of closure
 */
      __pyx_t_2 = ((__pyx_v_nkwds > 0) != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":7786
 *         if t == t_CLOSURE:
 *             if nkwds > 0:
 *                 raise TypeError("cannot evaluate a PARI closure using keyword arguments")             # <<<<<<<<<<<<<<
 *             # XXX: use undocumented internals to get arity of closure
 *             # (In PARI 2.6, there is closure_arity() which does this)
 */
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_Raise(__pyx_t_3, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }

      /* "gen.pyx":7789
 *             # XXX: use undocumented internals to get arity of closure
 *             # (In PARI 2.6, there is closure_arity() which does this)
 *             arity = self.g[1]             # <<<<<<<<<<<<<<
 *             if nargs > arity:
 *                 raise TypeError("PARI closure takes at most %d argument%s (%d given)"%(
 */
      __pyx_v_arity = (__pyx_v_self->g[1]);

      /* "gen.pyx":7790
 *             # (In PARI 2.6, there is closure_arity() which does this)
 *             arity = self.g[1]
 *             if nargs > arity:             # <<<<<<<<<<<<<<
 *                 raise TypeError("PARI closure takes at most %d argument%s (%d given)"%(
 *                     arity, "s" if (arity!=1) else "", nargs))
 */
      __pyx_t_2 = ((__pyx_v_nargs > __pyx_v_arity) != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":7792
 *             if nargs > arity:
 *                 raise TypeError("PARI closure takes at most %d argument%s (%d given)"%(
 *                     arity, "s" if (arity!=1) else "", nargs))             # <<<<<<<<<<<<<<
 *             t0 = objtogen(args)
 *             pari_catch_sig_on()
 */
        __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_arity); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        if (((__pyx_v_arity != 1) != 0)) {
          __Pyx_INCREF(__pyx_n_s_s);
          __pyx_t_4 = __pyx_n_s_s;
        } else {
          __Pyx_INCREF(__pyx_kp_s__12);
          __pyx_t_4 = __pyx_kp_s__12;
        }
        __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_nargs); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_3 = 0;
        __pyx_t_4 = 0;
        __pyx_t_5 = 0;

        /* "gen.pyx":7791
 *             arity = self.g[1]
 *             if nargs > arity:
 *                 raise TypeError("PARI closure takes at most %d argument%s (%d given)"%(             # <<<<<<<<<<<<<<
 *                     arity, "s" if (arity!=1) else "", nargs))
 *             t0 = objtogen(args)
 */
        __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_PARI_closure_takes_at_most_d_arg, __pyx_t_6); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_Raise(__pyx_t_5, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }

      /* "gen.pyx":7793
 *                 raise TypeError("PARI closure takes at most %d argument%s (%d given)"%(
 *                     arity, "s" if (arity!=1) else "", nargs))
 *             t0 = objtogen(args)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             result = closure_callgenvec(self.g, t0.g)
 */
      __pyx_t_5 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_args)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_5);
      __pyx_t_5 = 0;

      /* "gen.pyx":7794
 *                     arity, "s" if (arity!=1) else "", nargs))
 *             t0 = objtogen(args)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             result = closure_callgenvec(self.g, t0.g)
 *             if result == gnil:
 */
      __pyx_t_7 = pari_catch_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7795
 *             t0 = objtogen(args)
 *             pari_catch_sig_on()
 *             result = closure_callgenvec(self.g, t0.g)             # <<<<<<<<<<<<<<
 *             if result == gnil:
 *                 P.clear_stack()
 */
      __pyx_v_result = closure_callgenvec(__pyx_v_self->g, __pyx_v_t0->g);

      /* "gen.pyx":7796
 *             pari_catch_sig_on()
 *             result = closure_callgenvec(self.g, t0.g)
 *             if result == gnil:             # <<<<<<<<<<<<<<
 *                 P.clear_stack()
 *                 return None
 */
      __pyx_t_2 = ((__pyx_v_result == gnil) != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":7797
 *             result = closure_callgenvec(self.g, t0.g)
 *             if result == gnil:
 *                 P.clear_stack()             # <<<<<<<<<<<<<<
 *                 return None
 *             return P.new_gen(result)
 */
        ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->clear_stack(__pyx_v_3gen_P);

        /* "gen.pyx":7798
 *             if result == gnil:
 *                 P.clear_stack()
 *                 return None             # <<<<<<<<<<<<<<
 *             return P.new_gen(result)
 * 
 */
        __Pyx_XDECREF(__pyx_r);
        __Pyx_INCREF(Py_None);
        __pyx_r = Py_None;
        goto __pyx_L0;
      }

      /* "gen.pyx":7799
 *                 P.clear_stack()
 *                 return None
 *             return P.new_gen(result)             # <<<<<<<<<<<<<<
 * 
 *         # Evaluate univariate polynomials, rational functions and
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_result)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":7803
 *         # Evaluate univariate polynomials, rational functions and
 *         # series using *args
 *         if nargs > 0:             # <<<<<<<<<<<<<<
 *             if nkwds > 0:
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")
 */
    __pyx_t_2 = ((__pyx_v_nargs > 0) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":7804
 *         # series using *args
 *         if nargs > 0:
 *             if nkwds > 0:             # <<<<<<<<<<<<<<
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):
 */
      __pyx_t_2 = ((__pyx_v_nkwds > 0) != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":7805
 *         if nargs > 0:
 *             if nkwds > 0:
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")             # <<<<<<<<<<<<<<
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())
 */
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_Raise(__pyx_t_5, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }

      /* "gen.pyx":7806
 *             if nkwds > 0:
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):             # <<<<<<<<<<<<<<
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())
 *             if nargs != 1:
 */
      __pyx_t_8 = ((__pyx_v_t == t_POL) != 0);
      if (!__pyx_t_8) {
      } else {
        __pyx_t_2 = __pyx_t_8;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_8 = ((__pyx_v_t == t_RFRAC) != 0);
      if (!__pyx_t_8) {
      } else {
        __pyx_t_2 = __pyx_t_8;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_8 = ((__pyx_v_t == t_SER) != 0);
      __pyx_t_2 = __pyx_t_8;
      __pyx_L10_bool_binop_done:;
      __pyx_t_8 = ((!__pyx_t_2) != 0);
      if (__pyx_t_8) {

        /* "gen.pyx":7807
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())             # <<<<<<<<<<<<<<
 *             if nargs != 1:
 *                 raise TypeError("evaluating PARI %s takes exactly 1 argument (%d given)"
 */
        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_type); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_6, function);
          }
        }
        if (__pyx_t_4) {
          __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        } else {
          __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyString_Format(__pyx_kp_s_cannot_evaluate_PARI_s_using_unn, __pyx_t_5); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_Raise(__pyx_t_6, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }

      /* "gen.pyx":7808
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())
 *             if nargs != 1:             # <<<<<<<<<<<<<<
 *                 raise TypeError("evaluating PARI %s takes exactly 1 argument (%d given)"
 *                                 % (self.type(), nargs))
 */
      __pyx_t_8 = ((__pyx_v_nargs != 1) != 0);
      if (__pyx_t_8) {

        /* "gen.pyx":7810
 *             if nargs != 1:
 *                 raise TypeError("evaluating PARI %s takes exactly 1 argument (%d given)"
 *                                 % (self.type(), nargs))             # <<<<<<<<<<<<<<
 * 
 *             t0 = objtogen(args[0])
 */
        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_type); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_4 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
          __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
          if (likely(__pyx_t_4)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
            __Pyx_INCREF(__pyx_t_4);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_5, function);
          }
        }
        if (__pyx_t_4) {
          __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        } else {
          __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_nargs); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_6 = 0;
        __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyString_Format(__pyx_kp_s_evaluating_PARI_s_takes_exactly, __pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

        /* "gen.pyx":7809
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())
 *             if nargs != 1:
 *                 raise TypeError("evaluating PARI %s takes exactly 1 argument (%d given)"             # <<<<<<<<<<<<<<
 *                                 % (self.type(), nargs))
 * 
 */
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_Raise(__pyx_t_5, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }

      /* "gen.pyx":7812
 *                                 % (self.type(), nargs))
 * 
 *             t0 = objtogen(args[0])             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             if t == t_POL or t == t_RFRAC:
 */
      __pyx_t_5 = __Pyx_GetItemInt_Tuple(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7812; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_t_5)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":7813
 * 
 *             t0 = objtogen(args[0])
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             if t == t_POL or t == t_RFRAC:
 *                 return P.new_gen(poleval(self.g, t0.g))
 */
      __pyx_t_7 = pari_catch_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":7814
 *             t0 = objtogen(args[0])
 *             pari_catch_sig_on()
 *             if t == t_POL or t == t_RFRAC:             # <<<<<<<<<<<<<<
 *                 return P.new_gen(poleval(self.g, t0.g))
 *             else:  # t == t_SER
 */
      __pyx_t_2 = ((__pyx_v_t == t_POL) != 0);
      if (!__pyx_t_2) {
      } else {
        __pyx_t_8 = __pyx_t_2;
        goto __pyx_L15_bool_binop_done;
      }
      __pyx_t_2 = ((__pyx_v_t == t_RFRAC) != 0);
      __pyx_t_8 = __pyx_t_2;
      __pyx_L15_bool_binop_done:;
      if (__pyx_t_8) {

        /* "gen.pyx":7815
 *             pari_catch_sig_on()
 *             if t == t_POL or t == t_RFRAC:
 *                 return P.new_gen(poleval(self.g, t0.g))             # <<<<<<<<<<<<<<
 *             else:  # t == t_SER
 *                 if isexactzero(t0.g):
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, poleval(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }
      /*else*/ {

        /* "gen.pyx":7817
 *                 return P.new_gen(poleval(self.g, t0.g))
 *             else:  # t == t_SER
 *                 if isexactzero(t0.g):             # <<<<<<<<<<<<<<
 *                     # Work around the fact that PARI currently doesn't
 *                     # support substituting exact 0 in a power series.
 */
        __pyx_t_8 = (isexactzero(__pyx_v_t0->g) != 0);
        if (__pyx_t_8) {

          /* "gen.pyx":7823
 *                     # arguments, and hope this will be fixed in a
 *                     # future PARI version.
 *                     if valp(self.g) < 0:             # <<<<<<<<<<<<<<
 *                         pari_catch_sig_off()
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')
 */
          __pyx_t_8 = ((valp(__pyx_v_self->g) < 0) != 0);
          if (__pyx_t_8) {

            /* "gen.pyx":7824
 *                     # future PARI version.
 *                     if valp(self.g) < 0:
 *                         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')
 *                     elif valp(self.g) == 0:
 */
            pari_catch_sig_off();

            /* "gen.pyx":7825
 *                     if valp(self.g) < 0:
 *                         pari_catch_sig_off()
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')             # <<<<<<<<<<<<<<
 *                     elif valp(self.g) == 0:
 *                         return P.new_gen(polcoeff0(self.g, 0, -1))
 */
            __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_ZeroDivisionError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_4);
            __Pyx_Raise(__pyx_t_4, 0, 0, 0);
            __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }

          /* "gen.pyx":7826
 *                         pari_catch_sig_off()
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')
 *                     elif valp(self.g) == 0:             # <<<<<<<<<<<<<<
 *                         return P.new_gen(polcoeff0(self.g, 0, -1))
 *                     else:
 */
          __pyx_t_8 = ((valp(__pyx_v_self->g) == 0) != 0);
          if (__pyx_t_8) {

            /* "gen.pyx":7827
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')
 *                     elif valp(self.g) == 0:
 *                         return P.new_gen(polcoeff0(self.g, 0, -1))             # <<<<<<<<<<<<<<
 *                     else:
 *                         pari_catch_sig_off()
 */
            __Pyx_XDECREF(__pyx_r);
            __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polcoeff0(__pyx_v_self->g, 0, -1))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            __Pyx_GOTREF(__pyx_t_4);
            __pyx_r = __pyx_t_4;
            __pyx_t_4 = 0;
            goto __pyx_L0;
          }
          /*else*/ {

            /* "gen.pyx":7829
 *                         return P.new_gen(polcoeff0(self.g, 0, -1))
 *                     else:
 *                         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *                         return P.PARI_ZERO
 *                 return P.new_gen(gsubst(self.g, varn(self.g), t0.g))
 */
            pari_catch_sig_off();

            /* "gen.pyx":7830
 *                     else:
 *                         pari_catch_sig_off()
 *                         return P.PARI_ZERO             # <<<<<<<<<<<<<<
 *                 return P.new_gen(gsubst(self.g, varn(self.g), t0.g))
 * 
 */
            __Pyx_XDECREF(__pyx_r);
            __Pyx_INCREF(((PyObject *)__pyx_v_3gen_P->PARI_ZERO));
            __pyx_r = ((PyObject *)__pyx_v_3gen_P->PARI_ZERO);
            goto __pyx_L0;
          }
        }

        /* "gen.pyx":7831
 *                         pari_catch_sig_off()
 *                         return P.PARI_ZERO
 *                 return P.new_gen(gsubst(self.g, varn(self.g), t0.g))             # <<<<<<<<<<<<<<
 * 
 *         # Call substvec() using **kwds
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsubst(__pyx_v_self->g, varn(__pyx_v_self->g), __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }
    }

    /* "gen.pyx":7834
 * 
 *         # Call substvec() using **kwds
 *         vstr = kwds.keys()            # Variables as Python strings             # <<<<<<<<<<<<<<
 *         t0 = objtogen(kwds.values())  # Replacements
 * 
 */
    __pyx_t_4 = __Pyx_PyDict_Keys(__pyx_v_kwds); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_vstr = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "gen.pyx":7835
 *         # Call substvec() using **kwds
 *         vstr = kwds.keys()            # Variables as Python strings
 *         t0 = objtogen(kwds.values())  # Replacements             # <<<<<<<<<<<<<<
 * 
 *         pari_catch_sig_on()
 */
    __pyx_t_4 = __Pyx_PyDict_Values(__pyx_v_kwds); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_t_4)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_5);
    __pyx_t_5 = 0;

    /* "gen.pyx":7837
 *         t0 = objtogen(kwds.values())  # Replacements
 * 
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef GEN v = cgetg(nkwds+1, t_VEC)  # Variables as PARI polynomials
 *         cdef long i
 */
    __pyx_t_7 = pari_catch_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7838
 * 
 *         pari_catch_sig_on()
 *         cdef GEN v = cgetg(nkwds+1, t_VEC)  # Variables as PARI polynomials             # <<<<<<<<<<<<<<
 *         cdef long i
 *         for i in range(nkwds):
 */
    __pyx_v_v = cgetg((__pyx_v_nkwds + 1), t_VEC);

    /* "gen.pyx":7840
 *         cdef GEN v = cgetg(nkwds+1, t_VEC)  # Variables as PARI polynomials
 *         cdef long i
 *         for i in range(nkwds):             # <<<<<<<<<<<<<<
 *             set_gel(v, i+1, pol_x(P.get_var(vstr[i])))
 *         return P.new_gen(gsubstvec(self.g, v, t0.g))
 */
    __pyx_t_9 = __pyx_v_nkwds;
    for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;

      /* "gen.pyx":7841
 *         cdef long i
 *         for i in range(nkwds):
 *             set_gel(v, i+1, pol_x(P.get_var(vstr[i])))             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubstvec(self.g, v, t0.g))
 * 
 */
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_vstr, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7841; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_5);
      set_gel(__pyx_v_v, (__pyx_v_i + 1), pol_x(((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_t_5)));
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }

    /* "gen.pyx":7842
 *         for i in range(nkwds):
 *             set_gel(v, i+1, pol_x(P.get_var(vstr[i])))
 *         return P.new_gen(gsubstvec(self.g, v, t0.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsubstvec(__pyx_v_self->g, __pyx_v_v, __pyx_v_t0->g))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7646
 *         return P.new_gen(deriv(self.g, P.get_var(v)))
 * 
 *     def eval(self, *args, **kwds):             # <<<<<<<<<<<<<<
 *         """
 *         Evaluate ``self`` with the given arguments.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_AddTraceback("gen.gen.eval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF(__pyx_v_vstr);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7845
 * 
 * 
 *     def __call__(self, *args, **kwds):             # <<<<<<<<<<<<<<
 *         """
 *         Evaluate ``self`` with the given arguments.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_587__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_586__call__[] = "\n        Evaluate ``self`` with the given arguments.\n\n        This has the same effect as :meth:`eval`.\n\n        EXAMPLES::\n\n            sage: R.<x> = GF(3)[]\n            sage: f = (x^2 + x + 1)._pari_()\n            sage: f.type()\n            't_POL'\n            sage: f(2)\n            Mod(1, 3)\n\n        TESTS::\n\n            sage: T = pari('n -> 1/n')\n            sage: T.type()\n            't_CLOSURE'\n            sage: T(0)\n            Traceback (most recent call last):\n            ...\n            PariError: _/_: division by zero\n            sage: pari('() -> 42')(1,2,3)\n            Traceback (most recent call last):\n            ...\n            TypeError: PARI closure takes at most 0 arguments (3 given)\n            sage: pari('n -> n')(n=2)\n            Traceback (most recent call last):\n            ...\n            TypeError: cannot evaluate a PARI closure using keyword arguments\n            sage: pari('x + y')(4, y=1)\n            Traceback (most recent call last):\n            ...\n            TypeError: mixing unnamed and keyword arguments not allowed when evaluating a PARI object\n            sage: pari(\"12345\")(4)\n            Traceback (most recent call last):\n            ...\n            TypeError: cannot evaluate PARI t_INT using unnamed arguments\n        ";
  #if CYTHON_COMPILING_IN_CPYTHON
  struct wrapperbase __pyx_wrapperbase_3gen_3gen_586__call__;
  #endif
  static PyObject *__pyx_pw_3gen_3gen_587__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_args = 0;
    PyObject *__pyx_v_kwds = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__call__ (wrapper)", 0);
    if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__call__", 1))) return NULL;
    __pyx_v_kwds = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
    if (unlikely(!__pyx_v_kwds)) return NULL;
    __Pyx_GOTREF(__pyx_v_kwds);
    __Pyx_INCREF(__pyx_args);
    __pyx_v_args = __pyx_args;
    __pyx_r = __pyx_pf_3gen_3gen_586__call__(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_args, __pyx_v_kwds);

    /* function exit code */
    __Pyx_XDECREF(__pyx_v_args);
    __Pyx_XDECREF(__pyx_v_kwds);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_586__call__(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwds) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__call__", 0);

    /* "gen.pyx":7886
 *             TypeError: cannot evaluate PARI t_INT using unnamed arguments
 *         """
 *         return self.eval(*args, **kwds)             # <<<<<<<<<<<<<<
 * 
 *     def factornf(self, t):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_eval); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __pyx_v_kwds;
    __Pyx_INCREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7845
 * 
 * 
 *     def __call__(self, *args, **kwds):             # <<<<<<<<<<<<<<
 *         """
 *         Evaluate ``self`` with the given arguments.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7888
 *         return self.eval(*args, **kwds)
 * 
 *     def factornf(self, t):             # <<<<<<<<<<<<<<
 *         """
 *         Factorization of the polynomial ``self`` over the number field
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_589factornf(PyObject *__pyx_v_self, PyObject *__pyx_v_t); /*proto*/
  static char __pyx_doc_3gen_3gen_588factornf[] = "\n        Factorization of the polynomial ``self`` over the number field\n        defined by the polynomial ``t``.  This does not require that `t`\n        is integral, nor that the discriminant of the number field can be\n        factored.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^2 - 1/8)\n            sage: pari(x^2 - 2).factornf(K.pari_polynomial(\"a\"))\n            [x + Mod(-4*a, 8*a^2 - 1), 1; x + Mod(4*a, 8*a^2 - 1), 1]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_589factornf(PyObject *__pyx_v_self, PyObject *__pyx_v_t) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factornf (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_588factornf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_t));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_588factornf(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_t) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factornf", 0);

    /* "gen.pyx":7902
 *             [x + Mod(-4*a, 8*a^2 - 1), 1; x + Mod(4*a, 8*a^2 - 1), 1]
 *         """
 *         cdef gen t0 = objtogen(t)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polfnf(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_t)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7902; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7903
 *         """
 *         cdef gen t0 = objtogen(t)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polfnf(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7904
 *         cdef gen t0 = objtogen(t)
 *         pari_catch_sig_on()
 *         return P.new_gen(polfnf(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def factorpadic(self, p, long r=20, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polfnf(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7904; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7888
 *         return self.eval(*args, **kwds)
 * 
 *     def factornf(self, t):             # <<<<<<<<<<<<<<
 *         """
 *         Factorization of the polynomial ``self`` over the number field
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.factornf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7906
 *         return P.new_gen(polfnf(self.g, t0.g))
 * 
 *     def factorpadic(self, p, long r=20, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         self.factorpadic(p,r=20,flag=0): p-adic factorization of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_591factorpadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_590factorpadic[] = "\n        self.factorpadic(p,r=20,flag=0): p-adic factorization of the\n        polynomial x to precision r. flag is optional and may be set to 0\n        (use round 4) or 1 (use Buchmann-Lenstra)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_591factorpadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    long __pyx_v_r;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factorpadic (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,&__pyx_n_s_r,&__pyx_n_s_flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_r);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factorpadic") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      if (values[1]) {
        __pyx_v_r = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_r == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_r = ((long)20);
      }
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factorpadic", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.factorpadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_590factorpadic(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_590factorpadic(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_r, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factorpadic", 0);

    /* "gen.pyx":7912
 *         (use round 4) or 1 (use Buchmann-Lenstra)
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(factorpadic0(self.g, t0.g, r, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7912; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7913
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(factorpadic0(self.g, t0.g, r, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7913; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7914
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(factorpadic0(self.g, t0.g, r, flag))             # <<<<<<<<<<<<<<
 * 
 *     def factormod(self, p, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, factorpadic0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_r, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7906
 *         return P.new_gen(polfnf(self.g, t0.g))
 * 
 *     def factorpadic(self, p, long r=20, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         self.factorpadic(p,r=20,flag=0): p-adic factorization of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.factorpadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7916
 *         return P.new_gen(factorpadic0(self.g, t0.g, r, flag))
 * 
 *     def factormod(self, p, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.factormod(p,flag=0): factorization mod p of the polynomial x
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_593factormod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_592factormod[] = "\n        x.factormod(p,flag=0): factorization mod p of the polynomial x\n        using Berlekamp. flag is optional, and can be 0: default or 1:\n        simple factormod, same except that only the degrees of the\n        irreducible factors are given.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_593factormod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factormod (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factormod") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7916; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7916; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factormod", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7916; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.factormod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_592factormod(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_592factormod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factormod", 0);

    /* "gen.pyx":7923
 *         irreducible factors are given.
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(factormod0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7924
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(factormod0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7925
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(factormod0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def intformal(self, y=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, factormod0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7925; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7916
 *         return P.new_gen(factorpadic0(self.g, t0.g, r, flag))
 * 
 *     def factormod(self, p, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.factormod(p,flag=0): factorization mod p of the polynomial x
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.factormod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7927
 *         return P.new_gen(factormod0(self.g, t0.g, flag))
 * 
 *     def intformal(self, y=-1):             # <<<<<<<<<<<<<<
 *         """
 *         x.intformal(y): formal integration of x with respect to the main
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_595intformal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_594intformal[] = "\n        x.intformal(y): formal integration of x with respect to the main\n        variable of y, or to the main variable of x if y is omitted\n        ";
  static PyObject *__pyx_pw_3gen_3gen_595intformal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("intformal (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intformal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7927; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("intformal", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7927; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.intformal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_594intformal(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_y);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_594intformal(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("intformal", 0);

    /* "gen.pyx":7932
 *         variable of y, or to the main variable of x if y is omitted
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(integ(self.g, P.get_var(y)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7933
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(integ(self.g, P.get_var(y)))             # <<<<<<<<<<<<<<
 * 
 *     def padicappr(self, a):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, integ(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_y)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7927
 *         return P.new_gen(factormod0(self.g, t0.g, flag))
 * 
 *     def intformal(self, y=-1):             # <<<<<<<<<<<<<<
 *         """
 *         x.intformal(y): formal integration of x with respect to the main
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.intformal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7935
 *         return P.new_gen(integ(self.g, P.get_var(y)))
 * 
 *     def padicappr(self, a):             # <<<<<<<<<<<<<<
 *         """
 *         x.padicappr(a): p-adic roots of the polynomial x congruent to a mod
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_597padicappr(PyObject *__pyx_v_self, PyObject *__pyx_v_a); /*proto*/
  static char __pyx_doc_3gen_3gen_596padicappr[] = "\n        x.padicappr(a): p-adic roots of the polynomial x congruent to a mod\n        p\n        ";
  static PyObject *__pyx_pw_3gen_3gen_597padicappr(PyObject *__pyx_v_self, PyObject *__pyx_v_a) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicappr (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_596padicappr(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_a));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_596padicappr(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicappr", 0);

    /* "gen.pyx":7940
 *         p
 *         """
 *         cdef gen t0 = objtogen(a)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(padicappr(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7941
 *         """
 *         cdef gen t0 = objtogen(a)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(padicappr(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7941; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7942
 *         cdef gen t0 = objtogen(a)
 *         pari_catch_sig_on()
 *         return P.new_gen(padicappr(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def newtonpoly(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, padicappr(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7942; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7935
 *         return P.new_gen(integ(self.g, P.get_var(y)))
 * 
 *     def padicappr(self, a):             # <<<<<<<<<<<<<<
 *         """
 *         x.padicappr(a): p-adic roots of the polynomial x congruent to a mod
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.padicappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7944
 *         return P.new_gen(padicappr(self.g, t0.g))
 * 
 *     def newtonpoly(self, p):             # <<<<<<<<<<<<<<
 *         """
 *         x.newtonpoly(p): Newton polygon of polynomial x with respect to the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_599newtonpoly(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_3gen_3gen_598newtonpoly[] = "\n        x.newtonpoly(p): Newton polygon of polynomial x with respect to the\n        prime p.\n\n        EXAMPLES::\n\n            sage: x = pari('y^8+6*y^6-27*y^5+1/9*y^2-y+1')\n            sage: x.newtonpoly(3)\n            [1, 1, -1/3, -1/3, -1/3, -1/3, -1/3, -1/3]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_599newtonpoly(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("newtonpoly (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_598newtonpoly(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_598newtonpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("newtonpoly", 0);

    /* "gen.pyx":7955
 *             [1, 1, -1/3, -1/3, -1/3, -1/3, -1/3, -1/3]
 *         """
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(newtonpoly(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7956
 *         """
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(newtonpoly(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7957
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(newtonpoly(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def polcoeff(self, long n, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, newtonpoly(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7944
 *         return P.new_gen(padicappr(self.g, t0.g))
 * 
 *     def newtonpoly(self, p):             # <<<<<<<<<<<<<<
 *         """
 *         x.newtonpoly(p): Newton polygon of polynomial x with respect to the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.newtonpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7959
 *         return P.new_gen(newtonpoly(self.g, t0.g))
 * 
 *     def polcoeff(self, long n, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_601polcoeff(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_600polcoeff[] = "\n        EXAMPLES::\n\n            sage: f = pari(\"x^2 + y^3 + x*y\")\n            sage: f\n            x^2 + y*x + y^3\n            sage: f.polcoeff(1)\n            y\n            sage: f.polcoeff(3)\n            0\n            sage: f.polcoeff(3, \"y\")\n            1\n            sage: f.polcoeff(1, \"y\")\n            x\n        ";
  static PyObject *__pyx_pw_3gen_3gen_601polcoeff(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_var = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcoeff (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_n,&__pyx_n_s_var,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcoeff") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7959; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7959; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_var = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcoeff", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7959; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polcoeff", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_600polcoeff(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_var);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_600polcoeff(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcoeff", 0);

    /* "gen.pyx":7975
 *             x
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polcoeff0(self.g, n, P.get_var(var)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7976
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(polcoeff0(self.g, n, P.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def polcompositum(self, pol2, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polcoeff0(__pyx_v_self->g, __pyx_v_n, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7959
 *         return P.new_gen(newtonpoly(self.g, t0.g))
 * 
 *     def polcoeff(self, long n, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polcoeff", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7978
 *         return P.new_gen(polcoeff0(self.g, n, P.get_var(var)))
 * 
 *     def polcompositum(self, pol2, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(pol2)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_603polcompositum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_603polcompositum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_pol2 = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcompositum (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_pol2,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_pol2)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcompositum") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7978; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_pol2 = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7978; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcompositum", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7978; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polcompositum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_602polcompositum(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_pol2, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_602polcompositum(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_pol2, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcompositum", 0);

    /* "gen.pyx":7979
 * 
 *     def polcompositum(self, pol2, long flag=0):
 *         cdef gen t0 = objtogen(pol2)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polcompositum0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_pol2)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7979; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":7980
 *     def polcompositum(self, pol2, long flag=0):
 *         cdef gen t0 = objtogen(pol2)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polcompositum0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7980; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7981
 *         cdef gen t0 = objtogen(pol2)
 *         pari_catch_sig_on()
 *         return P.new_gen(polcompositum0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def poldegree(self, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polcompositum0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7981; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7978
 *         return P.new_gen(polcoeff0(self.g, n, P.get_var(var)))
 * 
 *     def polcompositum(self, pol2, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(pol2)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polcompositum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7983
 *         return P.new_gen(polcompositum0(self.g, t0.g, flag))
 * 
 *     def poldegree(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         f.poldegree(var=x): Return the degree of this polynomial.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_605poldegree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_604poldegree[] = "\n        f.poldegree(var=x): Return the degree of this polynomial.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_605poldegree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldegree (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_var,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "poldegree") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7983; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("poldegree", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7983; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.poldegree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_604poldegree(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_var);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_604poldegree(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldegree", 0);

    /* "gen.pyx":7987
 *         f.poldegree(var=x): Return the degree of this polynomial.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         n = poldegree(self.g, P.get_var(var))
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":7988
 *         """
 *         pari_catch_sig_on()
 *         n = poldegree(self.g, P.get_var(var))             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = poldegree(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var));

    /* "gen.pyx":7989
 *         pari_catch_sig_on()
 *         n = poldegree(self.g, P.get_var(var))
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":7990
 *         n = poldegree(self.g, P.get_var(var))
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def poldisc(self, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7983
 *         return P.new_gen(polcompositum0(self.g, t0.g, flag))
 * 
 *     def poldegree(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         f.poldegree(var=x): Return the degree of this polynomial.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.poldegree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":7992
 *         return n
 * 
 *     def poldisc(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the discriminant of this polynomial.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_607poldisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_606poldisc[] = "\n        Return the discriminant of this polynomial.\n\n        EXAMPLES::\n\n            sage: pari(\"x^2 + 1\").poldisc()\n            -4\n\n        Before :trac:`15654`, this used to take a very long time.\n        Now it takes much less than a second::\n\n            sage: pari.allocatemem(200000)\n            PARI stack size set to 200000 bytes\n            sage: x = polygen(ZpFM(3,10))\n            sage: pol = ((x-1)^50 + x)\n            sage: pari(pol).poldisc()\n            2*3 + 3^4 + 2*3^6 + 3^7 + 2*3^8 + 2*3^9 + O(3^10)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_607poldisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldisc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_var,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "poldisc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7992; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("poldisc", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7992; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.poldisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_606poldisc(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_var);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_606poldisc(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldisc", 0);

    /* "gen.pyx":8011
 *             2*3 + 3^4 + 2*3^6 + 3^7 + 2*3^8 + 2*3^9 + O(3^10)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(poldisc0(self.g, P.get_var(var)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8011; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8012
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(poldisc0(self.g, P.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def poldiscreduced(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, poldisc0(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":7992
 *         return n
 * 
 *     def poldisc(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the discriminant of this polynomial.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.poldisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8014
 *         return P.new_gen(poldisc0(self.g, P.get_var(var)))
 * 
 *     def poldiscreduced(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(reduceddiscsmith(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_609poldiscreduced(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_609poldiscreduced(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldiscreduced (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_608poldiscreduced(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_608poldiscreduced(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldiscreduced", 0);

    /* "gen.pyx":8015
 * 
 *     def poldiscreduced(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(reduceddiscsmith(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8016
 *     def poldiscreduced(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(reduceddiscsmith(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def polgalois(self, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, reduceddiscsmith(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8014
 *         return P.new_gen(poldisc0(self.g, P.get_var(var)))
 * 
 *     def poldiscreduced(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(reduceddiscsmith(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.poldiscreduced", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8018
 *         return P.new_gen(reduceddiscsmith(self.g))
 * 
 *     def polgalois(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         f.polgalois(): Galois group of the polynomial f
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_611polgalois(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_610polgalois[] = "\n        f.polgalois(): Galois group of the polynomial f\n        ";
  static PyObject *__pyx_pw_3gen_3gen_611polgalois(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polgalois (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polgalois") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[0]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polgalois", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polgalois", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_610polgalois(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_610polgalois(struct __pyx_obj_3gen_gen *__pyx_v_self, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polgalois", 0);

    /* "gen.pyx":8022
 *         f.polgalois(): Galois group of the polynomial f
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polgalois(self.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8023
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(polgalois(self.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def nfgaloisconj(self, long flag=0, denom=None, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polgalois(__pyx_v_self->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8023; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8018
 *         return P.new_gen(reduceddiscsmith(self.g))
 * 
 *     def polgalois(self, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         f.polgalois(): Galois group of the polynomial f
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polgalois", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8025
 *         return P.new_gen(polgalois(self.g, prec_bits_to_words(precision)))
 * 
 *     def nfgaloisconj(self, long flag=0, denom=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Edited from the pari documentation:
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_613nfgaloisconj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_612nfgaloisconj[] = "\n        Edited from the pari documentation:\n\n        nfgaloisconj(nf): list of conjugates of a root of the\n        polynomial x=nf.pol in the same number field.\n\n        Uses a combination of Allombert's algorithm and nfroots.\n\n        EXAMPLES::\n\n            sage: x = QQ['x'].0; nf = pari(x^2 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [-x, x]~\n            sage: nf = pari(x^3 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [x]~\n            sage: nf = pari(x^4 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [-x, x]~\n        ";
  static PyObject *__pyx_pw_3gen_3gen_613nfgaloisconj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_denom = 0;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfgaloisconj (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_denom,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_denom);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfgaloisconj") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8025; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8025; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_denom = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8025; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfgaloisconj", 0, 0, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8025; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nfgaloisconj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_612nfgaloisconj(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_denom, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_612nfgaloisconj(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_denom, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfgaloisconj", 0);

    /* "gen.pyx":8047
 *         """
 *         cdef gen t0
 *         if denom is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisconj0(self.g, flag, NULL, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = (__pyx_v_denom == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":8048
 *         cdef gen t0
 *         if denom is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(galoisconj0(self.g, flag, NULL, prec_bits_to_words(precision)))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8048; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8049
 *         if denom is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisconj0(self.g, flag, NULL, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(denom)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisconj0(__pyx_v_self->g, __pyx_v_flag, NULL, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":8051
 *             return P.new_gen(galoisconj0(self.g, flag, NULL, prec_bits_to_words(precision)))
 *         else:
 *             t0 = objtogen(denom)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisconj0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_denom)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":8052
 *         else:
 *             t0 = objtogen(denom)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(galoisconj0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8052; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8053
 *             t0 = objtogen(denom)
 *             pari_catch_sig_on()
 *             return P.new_gen(galoisconj0(self.g, flag, t0.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def nfroots(self, poly):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, galoisconj0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_t0->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8053; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":8025
 *         return P.new_gen(polgalois(self.g, prec_bits_to_words(precision)))
 * 
 *     def nfgaloisconj(self, long flag=0, denom=None, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Edited from the pari documentation:
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.nfgaloisconj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8055
 *             return P.new_gen(galoisconj0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 *     def nfroots(self, poly):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the roots of `poly` in the number field self without
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_615nfroots(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static char __pyx_doc_3gen_3gen_614nfroots[] = "\n        Return the roots of `poly` in the number field self without\n        multiplicity.\n\n        EXAMPLES::\n\n            sage: y = QQ['yy'].0; _ = pari(y) # pari has variable ordering rules\n            sage: x = QQ['zz'].0; nf = pari(x^2 + 2).nfinit()\n            sage: nf.nfroots(y^2 + 2)\n            [Mod(-zz, zz^2 + 2), Mod(zz, zz^2 + 2)]\n            sage: nf = pari(x^3 + 2).nfinit()\n            sage: nf.nfroots(y^3 + 2)\n            [Mod(zz, zz^3 + 2)]\n            sage: nf = pari(x^4 + 2).nfinit()\n            sage: nf.nfroots(y^4 + 2)\n            [Mod(-zz, zz^4 + 2), Mod(zz, zz^4 + 2)]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_615nfroots(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfroots (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_614nfroots(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_614nfroots(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfroots", 0);

    /* "gen.pyx":8073
 *             [Mod(-zz, zz^4 + 2), Mod(zz, zz^4 + 2)]
 *         """
 *         cdef gen t0 = objtogen(poly)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(nfroots(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_poly)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8074
 *         """
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfroots(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8075
 *         cdef gen t0 = objtogen(poly)
 *         pari_catch_sig_on()
 *         return P.new_gen(nfroots(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def polhensellift(self, y, p, long e):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nfroots(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8055
 *             return P.new_gen(galoisconj0(self.g, flag, t0.g, prec_bits_to_words(precision)))
 * 
 *     def nfroots(self, poly):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the roots of `poly` in the number field self without
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nfroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8077
 *         return P.new_gen(nfroots(self.g, t0.g))
 * 
 *     def polhensellift(self, y, p, long e):             # <<<<<<<<<<<<<<
 *         """
 *         self.polhensellift(y, p, e): lift the factorization y of self
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_617polhensellift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_616polhensellift[] = "\n        self.polhensellift(y, p, e): lift the factorization y of self\n        modulo p to a factorization modulo `p^e` using Hensel lift.\n        The factors in y must be pairwise relatively prime modulo p.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_617polhensellift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_p = 0;
    long __pyx_v_e;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polhensellift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_p,&__pyx_n_s_e,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_e)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polhensellift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      }
      __pyx_v_y = values[0];
      __pyx_v_p = values[1];
      __pyx_v_e = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_e == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polhensellift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_616polhensellift(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_p, __pyx_v_e);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_616polhensellift(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_p, long __pyx_v_e) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polhensellift", 0);

    /* "gen.pyx":8083
 *         The factors in y must be pairwise relatively prime modulo p.
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8084
 *         """
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polhensellift(self.g, t0.g, t1.g, e))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8085
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polhensellift(self.g, t0.g, t1.g, e))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8086
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(polhensellift(self.g, t0.g, t1.g, e))             # <<<<<<<<<<<<<<
 * 
 *     def polisirreducible(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polhensellift(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_v_e))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8077
 *         return P.new_gen(nfroots(self.g, t0.g))
 * 
 *     def polhensellift(self, y, p, long e):             # <<<<<<<<<<<<<<
 *         """
 *         self.polhensellift(y, p, e): lift the factorization y of self
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polhensellift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8088
 *         return P.new_gen(polhensellift(self.g, t0.g, t1.g, e))
 * 
 *     def polisirreducible(self):             # <<<<<<<<<<<<<<
 *         """
 *         f.polisirreducible(): Returns True if f is an irreducible
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_619polisirreducible(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_618polisirreducible[] = "\n        f.polisirreducible(): Returns True if f is an irreducible\n        non-constant polynomial, or False if f is reducible or constant.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_619polisirreducible(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polisirreducible (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_618polisirreducible(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_618polisirreducible(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polisirreducible", 0);

    /* "gen.pyx":8093
 *         non-constant polynomial, or False if f is reducible or constant.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long t = isirreducible(self.g)
 *         P.clear_stack()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8094
 *         """
 *         pari_catch_sig_on()
 *         cdef long t = isirreducible(self.g)             # <<<<<<<<<<<<<<
 *         P.clear_stack()
 *         return t != 0
 */
    __pyx_v_t = isirreducible(__pyx_v_self->g);

    /* "gen.pyx":8095
 *         pari_catch_sig_on()
 *         cdef long t = isirreducible(self.g)
 *         P.clear_stack()             # <<<<<<<<<<<<<<
 *         return t != 0
 * 
 */
    ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->clear_stack(__pyx_v_3gen_P);

    /* "gen.pyx":8096
 *         cdef long t = isirreducible(self.g)
 *         P.clear_stack()
 *         return t != 0             # <<<<<<<<<<<<<<
 * 
 *     def pollead(self, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_t != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8088
 *         return P.new_gen(polhensellift(self.g, t0.g, t1.g, e))
 * 
 *     def polisirreducible(self):             # <<<<<<<<<<<<<<
 *         """
 *         f.polisirreducible(): Returns True if f is an irreducible
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polisirreducible", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8098
 *         return t != 0
 * 
 *     def pollead(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         self.pollead(v): leading coefficient of polynomial or series self,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_621pollead(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_620pollead[] = "\n        self.pollead(v): leading coefficient of polynomial or series self,\n        or self itself if self is a scalar. Error otherwise. With respect\n        to the main variable of self if v is omitted, with respect to the\n        variable v otherwise\n        ";
  static PyObject *__pyx_pw_3gen_3gen_621pollead(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("pollead (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pollead") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("pollead", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.pollead", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_620pollead(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_620pollead(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pollead", 0);

    /* "gen.pyx":8105
 *         variable v otherwise
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pollead(self.g, P.get_var(v)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8106
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(pollead(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def polrecip(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, pollead(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8098
 *         return t != 0
 * 
 *     def pollead(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         self.pollead(v): leading coefficient of polynomial or series self,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.pollead", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8108
 *         return P.new_gen(pollead(self.g, P.get_var(v)))
 * 
 *     def polrecip(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polrecip(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_623polrecip(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_623polrecip(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrecip (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_622polrecip(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_622polrecip(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrecip", 0);

    /* "gen.pyx":8109
 * 
 *     def polrecip(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polrecip(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8110
 *     def polrecip(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(polrecip(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def polred(self, long flag=0, fa=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polrecip(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8108
 *         return P.new_gen(pollead(self.g, P.get_var(v)))
 * 
 *     def polrecip(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polrecip(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polrecip", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8112
 *         return P.new_gen(polrecip(self.g))
 * 
 *     def polred(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0
 *         if fa is None:
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_625polred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_625polred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_fa = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polred (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_fa,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polred") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polred", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_624polred(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_624polred(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polred", 0);

    /* "gen.pyx":8114
 *     def polred(self, long flag=0, fa=None):
 *         cdef gen t0
 *         if fa is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(polred0(self.g, flag, NULL))
 */
    __pyx_t_1 = (__pyx_v_fa == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":8115
 *         cdef gen t0
 *         if fa is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(polred0(self.g, flag, NULL))
 *         else:
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8116
 *         if fa is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(polred0(self.g, flag, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(fa)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polred0(__pyx_v_self->g, __pyx_v_flag, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":8118
 *             return P.new_gen(polred0(self.g, flag, NULL))
 *         else:
 *             t0 = objtogen(fa)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(polred0(self.g, flag, t0.g))
 */
      __pyx_t_4 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_fa)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "gen.pyx":8119
 *         else:
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(polred0(self.g, flag, t0.g))
 * 
 */
      __pyx_t_3 = pari_catch_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8120
 *             t0 = objtogen(fa)
 *             pari_catch_sig_on()
 *             return P.new_gen(polred0(self.g, flag, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def polredabs(self, long flag=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polred0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_t0->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":8112
 *         return P.new_gen(polrecip(self.g))
 * 
 *     def polred(self, long flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         cdef gen t0
 *         if fa is None:
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.polred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8122
 *             return P.new_gen(polred0(self.g, flag, t0.g))
 * 
 *     def polredabs(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polredabs0(self.g, flag))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_627polredabs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_627polredabs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polredabs (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polredabs") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polredabs", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8122; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polredabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_626polredabs(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_626polredabs(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polredabs", 0);

    /* "gen.pyx":8123
 * 
 *     def polredabs(self, long flag=0):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polredabs0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8124
 *     def polredabs(self, long flag=0):
 *         pari_catch_sig_on()
 *         return P.new_gen(polredabs0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def polredbest(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polredabs0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8122
 *             return P.new_gen(polred0(self.g, flag, t0.g))
 * 
 *     def polredabs(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polredabs0(self.g, flag))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polredabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8126
 *         return P.new_gen(polredabs0(self.g, flag))
 * 
 *     def polredbest(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polredbest(self.g, flag))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_629polredbest(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_629polredbest(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polredbest (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polredbest") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polredbest", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8126; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polredbest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_628polredbest(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_628polredbest(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polredbest", 0);

    /* "gen.pyx":8127
 * 
 *     def polredbest(self, long flag=0):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polredbest(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8128
 *     def polredbest(self, long flag=0):
 *         pari_catch_sig_on()
 *         return P.new_gen(polredbest(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def polresultant(self, y, var=-1, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polredbest(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8126
 *         return P.new_gen(polredabs0(self.g, flag))
 * 
 *     def polredbest(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polredbest(self.g, flag))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polredbest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8130
 *         return P.new_gen(polredbest(self.g, flag))
 * 
 *     def polresultant(self, y, var=-1, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_631polresultant(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_631polresultant(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_var = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polresultant (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_var,&__pyx_n_s_flag,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polresultant") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      __pyx_v_var = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polresultant", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polresultant", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_630polresultant(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_var, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_630polresultant(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_var, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polresultant", 0);

    /* "gen.pyx":8131
 * 
 *     def polresultant(self, y, var=-1, long flag=0):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polresultant0(self.g, t0.g, P.get_var(var), flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8132
 *     def polresultant(self, y, var=-1, long flag=0):
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polresultant0(self.g, t0.g, P.get_var(var), flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8133
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(polresultant0(self.g, t0.g, P.get_var(var), flag))             # <<<<<<<<<<<<<<
 * 
 *     def polroots(self, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polresultant0(__pyx_v_self->g, __pyx_v_t0->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var), __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8130
 *         return P.new_gen(polredbest(self.g, flag))
 * 
 *     def polresultant(self, y, var=-1, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polresultant", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8135
 *         return P.new_gen(polresultant0(self.g, t0.g, P.get_var(var), flag))
 * 
 *     def polroots(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         polroots(x,flag=0): complex roots of the polynomial x. flag is
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_633polroots(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_632polroots[] = "\n        polroots(x,flag=0): complex roots of the polynomial x. flag is\n        optional, and can be 0: default, uses Schonhage's method modified\n        by Gourdon, or 1: uses a modified Newton method.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_633polroots(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    CYTHON_UNUSED long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polroots (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polroots") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8135; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8135; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8135; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polroots", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8135; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_632polroots(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_632polroots(struct __pyx_obj_3gen_gen *__pyx_v_self, CYTHON_UNUSED long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polroots", 0);

    /* "gen.pyx":8141
 *         by Gourdon, or 1: uses a modified Newton method.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(roots(self.g, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8142
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(roots(self.g, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def polrootsmod(self, p, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, roots(__pyx_v_self->g, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8135
 *         return P.new_gen(polresultant0(self.g, t0.g, P.get_var(var), flag))
 * 
 *     def polroots(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         polroots(x,flag=0): complex roots of the polynomial x. flag is
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8144
 *         return P.new_gen(roots(self.g, prec_bits_to_words(precision)))
 * 
 *     def polrootsmod(self, p, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_635polrootsmod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_635polrootsmod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootsmod (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootsmod") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootsmod", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8144; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polrootsmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_634polrootsmod(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_634polrootsmod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootsmod", 0);

    /* "gen.pyx":8145
 * 
 *     def polrootsmod(self, p, long flag=0):
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rootmod0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8146
 *     def polrootsmod(self, p, long flag=0):
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rootmod0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8147
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(rootmod0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def polrootspadic(self, p, r=20):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rootmod0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8144
 *         return P.new_gen(roots(self.g, prec_bits_to_words(precision)))
 * 
 *     def polrootsmod(self, p, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polrootsmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8149
 *         return P.new_gen(rootmod0(self.g, t0.g, flag))
 * 
 *     def polrootspadic(self, p, r=20):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_637polrootspadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_637polrootspadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_v_r = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootspadic (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,&__pyx_n_s_r,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_20);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_r);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootspadic") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8149; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      __pyx_v_r = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootspadic", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8149; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polrootspadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_636polrootspadic(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_636polrootspadic(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootspadic", 0);

    /* "gen.pyx":8150
 * 
 *     def polrootspadic(self, p, r=20):
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rootpadic(self.g, t0.g, r))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8151
 *     def polrootspadic(self, p, r=20):
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rootpadic(self.g, t0.g, r))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8152
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(rootpadic(self.g, t0.g, r))             # <<<<<<<<<<<<<<
 * 
 *     def polrootspadicfast(self, p, r=20):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_v_r); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rootpadic(__pyx_v_self->g, __pyx_v_t0->g, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8149
 *         return P.new_gen(rootmod0(self.g, t0.g, flag))
 * 
 *     def polrootspadic(self, p, r=20):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polrootspadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8154
 *         return P.new_gen(rootpadic(self.g, t0.g, r))
 * 
 *     def polrootspadicfast(self, p, r=20):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_639polrootspadicfast(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_639polrootspadicfast(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_v_r = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootspadicfast (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_p,&__pyx_n_s_r,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_20);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_r);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootspadicfast") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8154; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      __pyx_v_r = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootspadicfast", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8154; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polrootspadicfast", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_638polrootspadicfast(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_638polrootspadicfast(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootspadicfast", 0);

    /* "gen.pyx":8155
 * 
 *     def polrootspadicfast(self, p, r=20):
 *         cdef gen t0 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rootpadicfast(self.g, t0.g, r))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8156
 *     def polrootspadicfast(self, p, r=20):
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rootpadicfast(self.g, t0.g, r))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8157
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 *         return P.new_gen(rootpadicfast(self.g, t0.g, r))             # <<<<<<<<<<<<<<
 * 
 *     def polsturm(self, a, b):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_v_r); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rootpadicfast(__pyx_v_self->g, __pyx_v_t0->g, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8154
 *         return P.new_gen(rootpadic(self.g, t0.g, r))
 * 
 *     def polrootspadicfast(self, p, r=20):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(p)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polrootspadicfast", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8159
 *         return P.new_gen(rootpadicfast(self.g, t0.g, r))
 * 
 *     def polsturm(self, a, b):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1 = objtogen(b)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_641polsturm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_641polsturm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsturm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_a,&__pyx_n_s_b,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polsturm", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polsturm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polsturm", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8159; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polsturm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_640polsturm(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_640polsturm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsturm", 0);

    /* "gen.pyx":8160
 * 
 *     def polsturm(self, a, b):
 *         cdef gen t0 = objtogen(a)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(b)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_a)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8161
 *     def polsturm(self, a, b):
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1 = objtogen(b)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, t0.g, t1.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8162
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1 = objtogen(b)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         n = sturmpart(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8163
 *         cdef gen t1 = objtogen(b)
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, t0.g, t1.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = sturmpart(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g);

    /* "gen.pyx":8164
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":8165
 *         n = sturmpart(self.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def polsturm_full(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8159
 *         return P.new_gen(rootpadicfast(self.g, t0.g, r))
 * 
 *     def polsturm(self, a, b):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(a)
 *         cdef gen t1 = objtogen(b)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polsturm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8167
 *         return n
 * 
 *     def polsturm_full(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, NULL, NULL)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_643polsturm_full(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_643polsturm_full(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsturm_full (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_642polsturm_full(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_642polsturm_full(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsturm_full", 0);

    /* "gen.pyx":8168
 * 
 *     def polsturm_full(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         n = sturmpart(self.g, NULL, NULL)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8169
 *     def polsturm_full(self):
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, NULL, NULL)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = sturmpart(__pyx_v_self->g, NULL, NULL);

    /* "gen.pyx":8170
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, NULL, NULL)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":8171
 *         n = sturmpart(self.g, NULL, NULL)
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def polsylvestermatrix(self, g):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8167
 *         return n
 * 
 *     def polsturm_full(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         n = sturmpart(self.g, NULL, NULL)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polsturm_full", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8173
 *         return n
 * 
 *     def polsylvestermatrix(self, g):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_645polsylvestermatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_g); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_645polsylvestermatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsylvestermatrix (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_644polsylvestermatrix(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_g));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_644polsylvestermatrix(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_g) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsylvestermatrix", 0);

    /* "gen.pyx":8174
 * 
 *     def polsylvestermatrix(self, g):
 *         cdef gen t0 = objtogen(g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(sylvestermatrix(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8175
 *     def polsylvestermatrix(self, g):
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sylvestermatrix(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8176
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 *         return P.new_gen(sylvestermatrix(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def polsym(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, sylvestermatrix(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8173
 *         return n
 * 
 *     def polsylvestermatrix(self, g):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.polsylvestermatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8178
 *         return P.new_gen(sylvestermatrix(self.g, t0.g))
 * 
 *     def polsym(self, long n):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polsym(self.g, n))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_647polsym(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_647polsym(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsym (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8178; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polsym", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_646polsym(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((long)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_646polsym(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsym", 0);

    /* "gen.pyx":8179
 * 
 *     def polsym(self, long n):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polsym(self.g, n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8180
 *     def polsym(self, long n):
 *         pari_catch_sig_on()
 *         return P.new_gen(polsym(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def serconvol(self, g):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, polsym(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8178
 *         return P.new_gen(sylvestermatrix(self.g, t0.g))
 * 
 *     def polsym(self, long n):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(polsym(self.g, n))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.polsym", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8182
 *         return P.new_gen(polsym(self.g, n))
 * 
 *     def serconvol(self, g):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_649serconvol(PyObject *__pyx_v_self, PyObject *__pyx_v_g); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_649serconvol(PyObject *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serconvol (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_648serconvol(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_g));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_648serconvol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_g) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serconvol", 0);

    /* "gen.pyx":8183
 * 
 *     def serconvol(self, g):
 *         cdef gen t0 = objtogen(g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(convol(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8184
 *     def serconvol(self, g):
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(convol(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8185
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 *         return P.new_gen(convol(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def serlaplace(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, convol(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8182
 *         return P.new_gen(polsym(self.g, n))
 * 
 *     def serconvol(self, g):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(g)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.serconvol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8187
 *         return P.new_gen(convol(self.g, t0.g))
 * 
 *     def serlaplace(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(laplace(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_651serlaplace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_651serlaplace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serlaplace (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_650serlaplace(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_650serlaplace(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serlaplace", 0);

    /* "gen.pyx":8188
 * 
 *     def serlaplace(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(laplace(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8189
 *     def serlaplace(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(laplace(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def serreverse(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, laplace(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8187
 *         return P.new_gen(convol(self.g, t0.g))
 * 
 *     def serlaplace(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(laplace(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.serlaplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8191
 *         return P.new_gen(laplace(self.g))
 * 
 *     def serreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         serreverse(f): reversion of the power series f.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_653serreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_652serreverse[] = "\n        serreverse(f): reversion of the power series f.\n\n        If f(t) is a series in t with valuation 1, find the series g(t)\n        such that g(f(t)) = t.\n\n        EXAMPLES::\n\n            sage: f = pari('x+x^2+x^3+O(x^4)'); f\n            x + x^2 + x^3 + O(x^4)\n            sage: g = f.serreverse(); g\n            x - x^2 + x^3 + O(x^4)\n            sage: f.subst('x',g)\n            x + O(x^4)\n            sage: g.subst('x',f)\n            x + O(x^4)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_653serreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serreverse (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_652serreverse(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_652serreverse(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serreverse", 0);

    /* "gen.pyx":8209
 *             x + O(x^4)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(recip(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8210
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(recip(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def thueinit(self, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, recip(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8191
 *         return P.new_gen(laplace(self.g))
 * 
 *     def serreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         serreverse(f): reversion of the power series f.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.serreverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8212
 *         return P.new_gen(recip(self.g))
 * 
 *     def thueinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(thueinit(self.g, flag, prec_bits_to_words(precision)))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_655thueinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_655thueinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thueinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thueinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[1]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thueinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.thueinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_654thueinit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_654thueinit(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thueinit", 0);

    /* "gen.pyx":8213
 * 
 *     def thueinit(self, long flag=0, unsigned long precision=0):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(thueinit(self.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8214
 *     def thueinit(self, long flag=0, unsigned long precision=0):
 *         pari_catch_sig_on()
 *         return P.new_gen(thueinit(self.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, thueinit(__pyx_v_self->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8212
 *         return P.new_gen(recip(self.g))
 * 
 *     def thueinit(self, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(thueinit(self.g, flag, prec_bits_to_words(precision)))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.thueinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8217
 * 
 * 
 *     def rnfisnorminit(self, polrel, long flag=2):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(polrel)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_657rnfisnorminit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_657rnfisnorminit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_polrel = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisnorminit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_polrel,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_polrel)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfisnorminit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_polrel = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)2);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfisnorminit", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8217; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.rnfisnorminit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_656rnfisnorminit(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_polrel, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_656rnfisnorminit(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_polrel, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisnorminit", 0);

    /* "gen.pyx":8218
 * 
 *     def rnfisnorminit(self, polrel, long flag=2):
 *         cdef gen t0 = objtogen(polrel)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfisnorminit(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_polrel)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8219
 *     def rnfisnorminit(self, polrel, long flag=2):
 *         cdef gen t0 = objtogen(polrel)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfisnorminit(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8220
 *         cdef gen t0 = objtogen(polrel)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfisnorminit(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def rnfisnorm(self, T, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfisnorminit(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8217
 * 
 * 
 *     def rnfisnorminit(self, polrel, long flag=2):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(polrel)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfisnorminit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8222
 *         return P.new_gen(rnfisnorminit(self.g, t0.g, flag))
 * 
 *     def rnfisnorm(self, T, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(T)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_659rnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_659rnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_T = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisnorm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_T,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfisnorm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_T = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfisnorm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8222; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.rnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_658rnfisnorm(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_T, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_658rnfisnorm(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_T, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisnorm", 0);

    /* "gen.pyx":8223
 * 
 *     def rnfisnorm(self, T, long flag=0):
 *         cdef gen t0 = objtogen(T)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfisnorm(t0.g, self.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_T)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8224
 *     def rnfisnorm(self, T, long flag=0):
 *         cdef gen t0 = objtogen(T)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfisnorm(t0.g, self.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8225
 *         cdef gen t0 = objtogen(T)
 *         pari_catch_sig_on()
 *         return P.new_gen(rnfisnorm(t0.g, self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, rnfisnorm(__pyx_v_t0->g, __pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8222
 *         return P.new_gen(rnfisnorminit(self.g, t0.g, flag))
 * 
 *     def rnfisnorm(self, T, long flag=0):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(T)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.rnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8231
 *     ###########################################
 * 
 *     def vecextract(self, y, z=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         self.vecextract(y,z): extraction of the components of the matrix or
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_661vecextract(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_660vecextract[] = "\n        self.vecextract(y,z): extraction of the components of the matrix or\n        vector x according to y and z. If z is omitted, y designates\n        columns, otherwise y corresponds to rows and z to columns. y and z\n        can be vectors (of indices), strings (indicating ranges as\n        in\"1..10\") or masks (integers whose binary representation indicates\n        the indices to extract, from left to right 1, 2, 4, 8, etc.)\n\n        .. note::\n\n           This function uses the PARI row and column indexing, so the\n           first row or column is indexed by 1 instead of 0.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_661vecextract(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_z = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("vecextract (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_z,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vecextract") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("vecextract", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8231; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.vecextract", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_660vecextract(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_z);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_660vecextract(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("vecextract", 0);

    /* "gen.pyx":8245
 *            first row or column is indexed by 1 instead of 0.
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         cdef gen t1
 *         if z is None:
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8247
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1
 *         if z is None:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(shallowextract(self.g, t0.g))
 */
    __pyx_t_2 = (__pyx_v_z == Py_None);
    __pyx_t_3 = (__pyx_t_2 != 0);
    if (__pyx_t_3) {

      /* "gen.pyx":8248
 *         cdef gen t1
 *         if z is None:
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(shallowextract(self.g, t0.g))
 *         else:
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8249
 *         if z is None:
 *             pari_catch_sig_on()
 *             return P.new_gen(shallowextract(self.g, t0.g))             # <<<<<<<<<<<<<<
 *         else:
 *             t1 = objtogen(z)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, shallowextract(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":8251
 *             return P.new_gen(shallowextract(self.g, t0.g))
 *         else:
 *             t1 = objtogen(z)             # <<<<<<<<<<<<<<
 *             pari_catch_sig_on()
 *             return P.new_gen(extract0(self.g, t0.g, t1.g))
 */
      __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":8252
 *         else:
 *             t1 = objtogen(z)
 *             pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(extract0(self.g, t0.g, t1.g))
 * 
 */
      __pyx_t_4 = pari_catch_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":8253
 *             t1 = objtogen(z)
 *             pari_catch_sig_on()
 *             return P.new_gen(extract0(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def ncols(self):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, extract0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":8231
 *     ###########################################
 * 
 *     def vecextract(self, y, z=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         self.vecextract(y,z): extraction of the components of the matrix or
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.vecextract", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8255
 *             return P.new_gen(extract0(self.g, t0.g, t1.g))
 * 
 *     def ncols(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of columns of self.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_663ncols(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_662ncols[] = "\n        Return the number of columns of self.\n\n        EXAMPLES::\n\n            sage: pari('matrix(19,8)').ncols()\n            8\n        ";
  static PyObject *__pyx_pw_3gen_3gen_663ncols(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ncols (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_662ncols(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_662ncols(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ncols", 0);

    /* "gen.pyx":8265
 *         """
 *         cdef long n
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         n = glength(self.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8266
 *         cdef long n
 *         pari_catch_sig_on()
 *         n = glength(self.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = glength(__pyx_v_self->g);

    /* "gen.pyx":8267
 *         pari_catch_sig_on()
 *         n = glength(self.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":8268
 *         n = glength(self.g)
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def nrows(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8255
 *             return P.new_gen(extract0(self.g, t0.g, t1.g))
 * 
 *     def ncols(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of columns of self.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.ncols", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8270
 *         return n
 * 
 *     def nrows(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of rows of self.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_665nrows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_664nrows[] = "\n        Return the number of rows of self.\n\n        EXAMPLES::\n\n            sage: pari('matrix(19,8)').nrows()\n            19\n        ";
  static PyObject *__pyx_pw_3gen_3gen_665nrows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nrows (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_664nrows(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_664nrows(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nrows", 0);

    /* "gen.pyx":8280
 *         """
 *         cdef long n
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # if this matrix has no columns
 *         # then it has no rows.
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8283
 *         # if this matrix has no columns
 *         # then it has no rows.
 *         if self.ncols() == 0:             # <<<<<<<<<<<<<<
 *             pari_catch_sig_off()
 *             return 0
 */
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_ncols); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_int_0, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_5) {

      /* "gen.pyx":8284
 *         # then it has no rows.
 *         if self.ncols() == 0:
 *             pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *             return 0
 *         n = glength(<GEN>(self.g[1]))
 */
      pari_catch_sig_off();

      /* "gen.pyx":8285
 *         if self.ncols() == 0:
 *             pari_catch_sig_off()
 *             return 0             # <<<<<<<<<<<<<<
 *         n = glength(<GEN>(self.g[1]))
 *         pari_catch_sig_off()
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_int_0);
      __pyx_r = __pyx_int_0;
      goto __pyx_L0;
    }

    /* "gen.pyx":8286
 *             pari_catch_sig_off()
 *             return 0
 *         n = glength(<GEN>(self.g[1]))             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return n
 */
    __pyx_v_n = glength(((GEN)(__pyx_v_self->g[1])));

    /* "gen.pyx":8287
 *             return 0
 *         n = glength(<GEN>(self.g[1]))
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":8288
 *         n = glength(<GEN>(self.g[1]))
 *         pari_catch_sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def mattranspose(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_n); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8270
 *         return n
 * 
 *     def nrows(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of rows of self.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.nrows", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8290
 *         return n
 * 
 *     def mattranspose(self):             # <<<<<<<<<<<<<<
 *         """
 *         Transpose of the matrix self.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_667mattranspose(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_666mattranspose[] = "\n        Transpose of the matrix self.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6; 7,8,9]').mattranspose()\n            [1, 4, 7; 2, 5, 8; 3, 6, 9]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_667mattranspose(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mattranspose (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_666mattranspose(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_666mattranspose(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mattranspose", 0);

    /* "gen.pyx":8299
 *             [1, 4, 7; 2, 5, 8; 3, 6, 9]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtrans(self.g)).Mat()
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8300
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtrans(self.g)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def matadjoint(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtrans(__pyx_v_self->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Mat_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8290
 *         return n
 * 
 *     def mattranspose(self):             # <<<<<<<<<<<<<<
 *         """
 *         Transpose of the matrix self.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.mattranspose", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8302
 *         return P.new_gen(gtrans(self.g)).Mat()
 * 
 *     def matadjoint(self):             # <<<<<<<<<<<<<<
 *         """
 *         matadjoint(x): adjoint matrix of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_669matadjoint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_668matadjoint[] = "\n        matadjoint(x): adjoint matrix of x.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').matadjoint()\n            [-3, 6, -3; 6, -12, 6; -3, 6, -3]\n            sage: pari('[a,b,c; d,e,f; g,h,i]').matadjoint()\n            [(i*e - h*f), (-i*b + h*c), (f*b - e*c); (-i*d + g*f), i*a - g*c, -f*a + d*c; (h*d - g*e), -h*a + g*b, e*a - d*b]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_669matadjoint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matadjoint (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_668matadjoint(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_668matadjoint(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matadjoint", 0);

    /* "gen.pyx":8313
 *             [(i*e - h*f), (-i*b + h*c), (f*b - e*c); (-i*d + g*f), i*a - g*c, -f*a + d*c; (h*d - g*e), -h*a + g*b, e*a - d*b]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(adj(self.g)).Mat()
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8314
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(adj(self.g)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def qflll(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, adj(__pyx_v_self->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Mat_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8302
 *         return P.new_gen(gtrans(self.g)).Mat()
 * 
 *     def matadjoint(self):             # <<<<<<<<<<<<<<
 *         """
 *         matadjoint(x): adjoint matrix of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.matadjoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8316
 *         return P.new_gen(adj(self.g)).Mat()
 * 
 *     def qflll(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflll(x,flag=0): LLL reduction of the vectors forming the matrix x
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_671qflll(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_670qflll[] = "\n        qflll(x,flag=0): LLL reduction of the vectors forming the matrix x\n        (gives the unimodular transformation matrix). The columns of x must\n        be linearly independent, unless specified otherwise below. flag is\n        optional, and can be 0: default, 1: assumes x is integral, columns\n        may be dependent, 2: assumes x is integral, returns a partially\n        reduced basis, 4: assumes x is integral, returns [K,I] where K is\n        the integer kernel of x and I the LLL reduced image, 5: same as 4\n        but x may have polynomial coefficients, 8: same as 0 but x may have\n        polynomial coefficients.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_671qflll(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qflll (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qflll") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8316; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8316; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qflll", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8316; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.qflll", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_670qflll(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_670qflll(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qflll", 0);

    /* "gen.pyx":8328
 *         polynomial coefficients.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(qflll0(self.g,flag)).Mat()
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8329
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(qflll0(self.g,flag)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def qflllgram(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, qflll0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Mat_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8316
 *         return P.new_gen(adj(self.g)).Mat()
 * 
 *     def qflll(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflll(x,flag=0): LLL reduction of the vectors forming the matrix x
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.qflll", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8331
 *         return P.new_gen(qflll0(self.g,flag)).Mat()
 * 
 *     def qflllgram(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflllgram(x,flag=0): LLL reduction of the lattice whose gram matrix
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_673qflllgram(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_672qflllgram[] = "\n        qflllgram(x,flag=0): LLL reduction of the lattice whose gram matrix\n        is x (gives the unimodular transformation matrix). flag is optional\n        and can be 0: default,1: lllgramint algorithm for integer matrices,\n        4: lllgramkerim giving the kernel and the LLL reduced image, 5:\n        lllgramkerimgen same when the matrix has polynomial coefficients,\n        8: lllgramgen, same as qflllgram when the coefficients are\n        polynomials.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_673qflllgram(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qflllgram (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qflllgram") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qflllgram", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8331; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.qflllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_672qflllgram(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_672qflllgram(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qflllgram", 0);

    /* "gen.pyx":8341
 *         polynomials.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(qflllgram0(self.g,flag)).Mat()
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8342
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(qflllgram0(self.g,flag)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def lllgram(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, qflllgram0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Mat_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_4, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_2 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8331
 *         return P.new_gen(qflll0(self.g,flag)).Mat()
 * 
 *     def qflllgram(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflllgram(x,flag=0): LLL reduction of the lattice whose gram matrix
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.qflllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8344
 *         return P.new_gen(qflllgram0(self.g,flag)).Mat()
 * 
 *     def lllgram(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(0)
 * 
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_675lllgram(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_675lllgram(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lllgram (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_674lllgram(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_674lllgram(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lllgram", 0);

    /* "gen.pyx":8345
 * 
 *     def lllgram(self):
 *         return self.qflllgram(0)             # <<<<<<<<<<<<<<
 * 
 *     def lllgramint(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_qflllgram); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8344
 *         return P.new_gen(qflllgram0(self.g,flag)).Mat()
 * 
 *     def lllgram(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(0)
 * 
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.lllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8347
 *         return self.qflllgram(0)
 * 
 *     def lllgramint(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(1)
 * 
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_677lllgramint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_677lllgramint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lllgramint (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_676lllgramint(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_676lllgramint(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lllgramint", 0);

    /* "gen.pyx":8348
 * 
 *     def lllgramint(self):
 *         return self.qflllgram(1)             # <<<<<<<<<<<<<<
 * 
 *     def qfminim(self, b=None, m=None, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_qflllgram); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8347
 *         return self.qflllgram(0)
 * 
 *     def lllgramint(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(1)
 * 
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.lllgramint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8350
 *         return self.qflllgram(1)
 * 
 *     def qfminim(self, b=None, m=None, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return vectors with bounded norm for this quadratic form.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_679qfminim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_678qfminim[] = "\n        Return vectors with bounded norm for this quadratic form.\n\n        INPUT:\n\n        - ``self`` -- a quadratic form\n        - ``b`` -- a bound on vector norm (finds minimal non-zero\n          vectors if b=0)\n        - ``m`` -- maximum number of vectors to return.  If ``None``\n          (default), return all vectors of norm at most B\n        - flag (optional) --\n\n           - 0: default;\n           - 1: return only the first minimal vector found (ignore ``max``);\n           - 2: as 0 but uses a more robust, slower implementation,\n             valid for non integral quadratic forms.\n\n        OUTPUT:\n\n        A triple consisting of\n\n        - the number of vectors of norm <= b,\n        - the actual maximum norm of vectors listed\n        - a matrix whose columns are vectors with norm less than or\n          equal to b for the definite quadratic form. Only one of `v`\n          and `-v` is returned and the zero vector is never returned.\n\n        .. note::\n\n           If max is specified then only max vectors will be output,\n           but all vectors withing the given norm bound will be computed.\n\n        EXAMPLES::\n\n            sage: A = Matrix(3,3,[1,2,3,2,5,5,3,5,11])\n            sage: A.is_positive_definite()\n            True\n\n        The first 5 vectors of norm at most 10::\n\n             sage: pari(A).qfminim(10, 5).python()\n             [\n                      [-17 -14 -15 -16 -13]\n                      [  4   3   3   3   2]\n             146, 10, [  3   3   3   3   3]\n             ]\n\n\n        All vectors of minimal norm::\n\n             sage: pari(A).qfminim(0).python()\n             [\n                   [-5 -2  1]\n                   [ 1  1  0]\n             6, 1, [ 1  0  0]\n             ]\n\n        Use flag=2 for non-integral input::\n\n             sage: pari(A.change_ring(RR)).qfminim(5, m=5, flag=2).python()\n             [\n                                      [ -5 -10  -2  -7   3]\n                   ""                   [  1   2   1   2   0]\n             10, 5.00000000023283..., [  1   2   0   1  -1]\n             ]\n\n        ";
  static PyObject *__pyx_pw_3gen_3gen_679qfminim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_v_m = 0;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qfminim (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_b,&__pyx_n_s_m,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[4] = {0,0,0,0};
      values[0] = ((PyObject *)Py_None);
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_b);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_m);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
          case  3:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[3] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qfminim") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      __pyx_v_m = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[3]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[3]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qfminim", 0, 0, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.qfminim", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_678qfminim(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_b, __pyx_v_m, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_678qfminim(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_b, PyObject *__pyx_v_m, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    GEN __pyx_v_g0;
    GEN __pyx_v_g1;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    GEN __pyx_t_4;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qfminim", 0);

    /* "gen.pyx":8420
 *         cdef gen t0, t1
 *         cdef GEN g0, g1
 *         if b is None:             # <<<<<<<<<<<<<<
 *             g0 = NULL
 *         else:
 */
    __pyx_t_1 = (__pyx_v_b == Py_None);
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":8421
 *         cdef GEN g0, g1
 *         if b is None:
 *             g0 = NULL             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = objtogen(b)
 */
      __pyx_v_g0 = NULL;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "gen.pyx":8423
 *             g0 = NULL
 *         else:
 *             t0 = objtogen(b)             # <<<<<<<<<<<<<<
 *             g0 = t0.g
 *         if m is None:
 */
      __pyx_t_3 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_b)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "gen.pyx":8424
 *         else:
 *             t0 = objtogen(b)
 *             g0 = t0.g             # <<<<<<<<<<<<<<
 *         if m is None:
 *             g1 = NULL
 */
      __pyx_t_4 = __pyx_v_t0->g;
      __pyx_v_g0 = __pyx_t_4;
    }
    __pyx_L3:;

    /* "gen.pyx":8425
 *             t0 = objtogen(b)
 *             g0 = t0.g
 *         if m is None:             # <<<<<<<<<<<<<<
 *             g1 = NULL
 *         else:
 */
    __pyx_t_2 = (__pyx_v_m == Py_None);
    __pyx_t_1 = (__pyx_t_2 != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":8426
 *             g0 = t0.g
 *         if m is None:
 *             g1 = NULL             # <<<<<<<<<<<<<<
 *         else:
 *             t1 = objtogen(m)
 */
      __pyx_v_g1 = NULL;
      goto __pyx_L4;
    }
    /*else*/ {

      /* "gen.pyx":8428
 *             g1 = NULL
 *         else:
 *             t1 = objtogen(m)             # <<<<<<<<<<<<<<
 *             g1 = t1.g
 *         pari_catch_sig_on()
 */
      __pyx_t_3 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_m)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "gen.pyx":8429
 *         else:
 *             t1 = objtogen(m)
 *             g1 = t1.g             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         # precision is only used when flag == 2
 */
      __pyx_t_4 = __pyx_v_t1->g;
      __pyx_v_g1 = __pyx_t_4;
    }
    __pyx_L4:;

    /* "gen.pyx":8430
 *             t1 = objtogen(m)
 *             g1 = t1.g
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         # precision is only used when flag == 2
 *         return P.new_gen(qfminim0(self.g, g0, g1, flag, prec_bits_to_words(precision)))
 */
    __pyx_t_5 = pari_catch_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8432
 *         pari_catch_sig_on()
 *         # precision is only used when flag == 2
 *         return P.new_gen(qfminim0(self.g, g0, g1, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def qfrep(self, B, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, qfminim0(__pyx_v_self->g, __pyx_v_g0, __pyx_v_g1, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8350
 *         return self.qflllgram(1)
 * 
 *     def qfminim(self, b=None, m=None, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return vectors with bounded norm for this quadratic form.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.qfminim", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8434
 *         return P.new_gen(qfminim0(self.g, g0, g1, flag, prec_bits_to_words(precision)))
 * 
 *     def qfrep(self, B, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qfrep(x,B,flag=0): vector of (half) the number of vectors of norms
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_681qfrep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_680qfrep[] = "\n        qfrep(x,B,flag=0): vector of (half) the number of vectors of norms\n        from 1 to B for the integral and definite quadratic form x. Binary\n        digits of flag mean 1: count vectors of even norm from 1 to 2B, 2:\n        return a t_VECSMALL instead of a t_VEC.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_681qfrep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_B = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qfrep (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_B,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qfrep") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8434; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_B = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8434; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qfrep", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8434; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.qfrep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_680qfrep(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_B, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_680qfrep(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_B, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qfrep", 0);

    /* "gen.pyx":8441
 *         return a t_VECSMALL instead of a t_VEC.
 *         """
 *         cdef gen t0 = objtogen(B)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(qfrep0(self.g, t0.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_B)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8442
 *         """
 *         cdef gen t0 = objtogen(B)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(qfrep0(self.g, t0.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8443
 *         cdef gen t0 = objtogen(B)
 *         pari_catch_sig_on()
 *         return P.new_gen(qfrep0(self.g, t0.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matsolve(self, B):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, qfrep0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8434
 *         return P.new_gen(qfminim0(self.g, g0, g1, flag, prec_bits_to_words(precision)))
 * 
 *     def qfrep(self, B, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qfrep(x,B,flag=0): vector of (half) the number of vectors of norms
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.qfrep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8445
 *         return P.new_gen(qfrep0(self.g, t0.g, flag))
 * 
 *     def matsolve(self, B):             # <<<<<<<<<<<<<<
 *         """
 *         matsolve(B): Solve the linear system Mx=B for an invertible matrix
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_683matsolve(PyObject *__pyx_v_self, PyObject *__pyx_v_B); /*proto*/
  static char __pyx_doc_3gen_3gen_682matsolve[] = "\n        matsolve(B): Solve the linear system Mx=B for an invertible matrix\n        M\n\n        matsolve(B) uses Gaussian elimination to solve Mx=B, where M is\n        invertible and B is a column vector.\n\n        The corresponding pari library routine is gauss. The gp-interface\n        name matsolve has been given preference here.\n\n        INPUT:\n\n\n        -  ``B`` - a column vector of the same dimension as the\n           square matrix self\n\n\n        EXAMPLES::\n\n            sage: pari('[1,1;1,-1]').matsolve(pari('[1;0]'))\n            [1/2; 1/2]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_683matsolve(PyObject *__pyx_v_self, PyObject *__pyx_v_B) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matsolve (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_682matsolve(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_B));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_682matsolve(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_B) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matsolve", 0);

    /* "gen.pyx":8468
 *             [1/2; 1/2]
 *         """
 *         cdef gen t0 = objtogen(B)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gauss(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_B)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8469
 *         """
 *         cdef gen t0 = objtogen(B)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gauss(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8470
 *         cdef gen t0 = objtogen(B)
 *         pari_catch_sig_on()
 *         return P.new_gen(gauss(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def matsolvemod(self, D, B, long flag = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gauss(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8445
 *         return P.new_gen(qfrep0(self.g, t0.g, flag))
 * 
 *     def matsolve(self, B):             # <<<<<<<<<<<<<<
 *         """
 *         matsolve(B): Solve the linear system Mx=B for an invertible matrix
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.matsolve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8472
 *         return P.new_gen(gauss(self.g, t0.g))
 * 
 *     def matsolvemod(self, D, B, long flag = 0):             # <<<<<<<<<<<<<<
 *         r"""
 *         For column vectors `D=(d_i)` and `B=(b_i)`, find a small integer
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_685matsolvemod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_684matsolvemod[] = "\n        For column vectors `D=(d_i)` and `B=(b_i)`, find a small integer\n        solution to the system of linear congruences\n\n        .. math::\n\n            R_ix=b_i\\text{ (mod }d_i),\n\n        where `R_i` is the ith row of ``self``. If `d_i=0`, the equation is\n        considered over the integers. The entries of ``self``, ``D``, and\n        ``B`` should all be integers (those of ``D`` should also be\n        non-negative).\n\n        If ``flag`` is 1, the output is a two-component row vector whose first\n        component is a solution and whose second component is a matrix whose\n        columns form a basis of the solution set of the homogeneous system.\n\n        For either value of ``flag``, the output is 0 if there is no solution.\n\n        Note that if ``D`` or ``B`` is an integer, then it will be considered\n        as a vector all of whose entries are that integer.\n\n        EXAMPLES::\n\n            sage: D = pari('[3,4]~')\n            sage: B = pari('[1,2]~')\n            sage: M = pari('[1,2;3,4]')\n            sage: M.matsolvemod(D, B)\n            [-2, 0]~\n            sage: M.matsolvemod(3, 1)\n            [-1, 1]~\n            sage: M.matsolvemod(pari('[3,0]~'), pari('[1,2]~'))\n            [6, -4]~\n            sage: M2 = pari('[1,10;9,18]')\n            sage: M2.matsolvemod(3, pari('[2,3]~'), 1)\n            [[0, -1]~, [-1, -2; 1, -1]]\n            sage: M2.matsolvemod(9, pari('[2,3]~'))\n            0\n            sage: M2.matsolvemod(9, pari('[2,45]~'), 1)\n            [[1, 1]~, [-1, -4; 1, -5]]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_685matsolvemod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_D = 0;
    PyObject *__pyx_v_B = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matsolvemod (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_D,&__pyx_n_s_B,&__pyx_n_s_flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_D)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("matsolvemod", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matsolvemod") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_D = values[0];
      __pyx_v_B = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matsolvemod", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matsolvemod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_684matsolvemod(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_D, __pyx_v_B, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_684matsolvemod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_D, PyObject *__pyx_v_B, long __pyx_v_flag) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matsolvemod", 0);

    /* "gen.pyx":8514
 *             [[1, 1]~, [-1, -4; 1, -5]]
 *         """
 *         cdef gen t0 = objtogen(D)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(B)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_D)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8515
 *         """
 *         cdef gen t0 = objtogen(D)
 *         cdef gen t1 = objtogen(B)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(matsolvemod0(self.g, t0.g, t1.g, flag))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_B)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8516
 *         cdef gen t0 = objtogen(D)
 *         cdef gen t1 = objtogen(B)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(matsolvemod0(self.g, t0.g, t1.g, flag))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8517
 *         cdef gen t1 = objtogen(B)
 *         pari_catch_sig_on()
 *         return P.new_gen(matsolvemod0(self.g, t0.g, t1.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matker(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, matsolvemod0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8472
 *         return P.new_gen(gauss(self.g, t0.g))
 * 
 *     def matsolvemod(self, D, B, long flag = 0):             # <<<<<<<<<<<<<<
 *         r"""
 *         For column vectors `D=(d_i)` and `B=(b_i)`, find a small integer
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.matsolvemod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8519
 *         return P.new_gen(matsolvemod0(self.g, t0.g, t1.g, flag))
 * 
 *     def matker(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return a basis of the kernel of this matrix.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_687matker(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_686matker[] = "\n        Return a basis of the kernel of this matrix.\n\n        INPUT:\n\n\n        -  ``flag`` - optional; may be set to 0: default;\n           non-zero: x is known to have integral entries.\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3;4,5,6;7,8,9]').matker()\n            [1; -2; 1]\n\n        With algorithm 1, even if the matrix has integer entries the kernel\n        need not be saturated (which is weird)::\n\n            sage: pari('[1,2,3;4,5,6;7,8,9]').matker(1)\n            [3; -6; 3]\n            sage: pari('matrix(3,3,i,j,i)').matker()\n            [-1, -1; 1, 0; 0, 1]\n            sage: pari('[1,2,3;4,5,6;7,8,9]*Mod(1,2)').matker()\n            [Mod(1, 2); Mod(0, 2); Mod(1, 2)]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_687matker(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matker (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matker") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8519; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8519; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matker", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8519; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_686matker(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_686matker(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matker", 0);

    /* "gen.pyx":8545
 *             [Mod(1, 2); Mod(0, 2); Mod(1, 2)]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(matker0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8546
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(matker0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matkerint(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, matker0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8519
 *         return P.new_gen(matsolvemod0(self.g, t0.g, t1.g, flag))
 * 
 *     def matker(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return a basis of the kernel of this matrix.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.matker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8548
 *         return P.new_gen(matker0(self.g, flag))
 * 
 *     def matkerint(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the integer kernel of a matrix.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_689matkerint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_688matkerint[] = "\n        Return the integer kernel of a matrix.\n\n        This is the LLL-reduced Z-basis of the kernel of the matrix x with\n        integral entries.\n\n        INPUT:\n\n\n        -  ``flag`` - optional, and may be set to 0: default,\n           uses a modified LLL, 1: uses matrixqz.\n\n\n        EXAMPLES::\n\n            sage: pari('[2,1;2,1]').matker()\n            [-1/2; 1]\n            sage: pari('[2,1;2,1]').matkerint()\n            [1; -2]\n            sage: pari('[2,1;2,1]').matkerint(1)\n            [1; -2]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_689matkerint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matkerint (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matkerint") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8548; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8548; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matkerint", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8548; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matkerint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_688matkerint(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_688matkerint(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matkerint", 0);

    /* "gen.pyx":8571
 *             [1; -2]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(matkerint0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8572
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(matkerint0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matdet(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, matkerint0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8548
 *         return P.new_gen(matker0(self.g, flag))
 * 
 *     def matkerint(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the integer kernel of a matrix.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.matkerint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8574
 *         return P.new_gen(matkerint0(self.g, flag))
 * 
 *     def matdet(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the determinant of this matrix.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_691matdet(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_690matdet[] = "\n        Return the determinant of this matrix.\n\n        INPUT:\n\n\n        -  ``flag`` - (optional) flag 0: using Gauss-Bareiss.\n           1: use classical Gaussian elimination (slightly better for integer\n           entries)\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2; 3,4]').matdet(0)\n            -2\n            sage: pari('[1,2; 3,4]').matdet(1)\n            -2\n        ";
  static PyObject *__pyx_pw_3gen_3gen_691matdet(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matdet (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matdet") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8574; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8574; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matdet", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8574; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matdet", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_690matdet(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_690matdet(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matdet", 0);

    /* "gen.pyx":8593
 *             -2
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(det0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8593; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8594
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(det0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def trace(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, det0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8594; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8574
 *         return P.new_gen(matkerint0(self.g, flag))
 * 
 *     def matdet(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the determinant of this matrix.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.matdet", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8596
 *         return P.new_gen(det0(self.g, flag))
 * 
 *     def trace(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the trace of this PARI object.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_693trace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_692trace[] = "\n        Return the trace of this PARI object.\n\n        EXAMPLES::\n\n            sage: pari('[1,2; 3,4]').trace()\n            5\n        ";
  static PyObject *__pyx_pw_3gen_3gen_693trace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("trace (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_692trace(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_692trace(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("trace", 0);

    /* "gen.pyx":8605
 *             5
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtrace(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8606
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(gtrace(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def mathnf(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gtrace(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8596
 *         return P.new_gen(det0(self.g, flag))
 * 
 *     def trace(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the trace of this PARI object.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.trace", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8608
 *         return P.new_gen(gtrace(self.g))
 * 
 *     def mathnf(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         A.mathnf(flag=0): (upper triangular) Hermite normal form of A,
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_695mathnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_694mathnf[] = "\n        A.mathnf(flag=0): (upper triangular) Hermite normal form of A,\n        basis for the lattice formed by the columns of A.\n\n        INPUT:\n\n\n        -  ``flag`` - optional, value range from 0 to 4 (0 if\n           omitted), meaning : 0: naive algorithm\n\n        -  ``1: Use Batut's algorithm`` - output 2-component\n           vector [H,U] such that H is the HNF of A, and U is a unimodular\n           matrix such that xU=H. 3: Use Batut's algorithm. Output [H,U,P]\n           where P is a permutation matrix such that P A U = H. 4: As 1, using\n           a heuristic variant of LLL reduction along the way.\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').mathnf()\n            [6, 1; 3, 1; 0, 1]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_695mathnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "mathnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("mathnf", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8608; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.mathnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_694mathnf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_694mathnf(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnf", 0);

    /* "gen.pyx":8631
 *             [6, 1; 3, 1; 0, 1]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(mathnf0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8632
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(mathnf0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def mathnfmod(self, d):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, mathnf0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8608
 *         return P.new_gen(gtrace(self.g))
 * 
 *     def mathnf(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         A.mathnf(flag=0): (upper triangular) Hermite normal form of A,
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.mathnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8634
 *         return P.new_gen(mathnf0(self.g, flag))
 * 
 *     def mathnfmod(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite normal form if d is a multiple of the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_697mathnfmod(PyObject *__pyx_v_self, PyObject *__pyx_v_d); /*proto*/
  static char __pyx_doc_3gen_3gen_696mathnfmod[] = "\n        Returns the Hermite normal form if d is a multiple of the\n        determinant\n\n        Beware that PARI's concept of a Hermite normal form is an upper\n        triangular matrix with the same column space as the input matrix.\n\n        INPUT:\n\n\n        -  ``d`` - multiple of the determinant of self\n\n\n        EXAMPLES::\n\n                   sage: M=matrix([[1,2,3],[4,5,6],[7,8,11]])\n            sage: d=M.det()\n            sage: pari(M).mathnfmod(d)\n                   [6, 4, 3; 0, 1, 0; 0, 0, 1]\n\n        Note that d really needs to be a multiple of the discriminant, not\n        just of the exponent of the cokernel::\n\n                   sage: M=matrix([[1,0,0],[0,2,0],[0,0,6]])\n            sage: pari(M).mathnfmod(6)\n            [1, 0, 0; 0, 1, 0; 0, 0, 6]\n            sage: pari(M).mathnfmod(12)\n            [1, 0, 0; 0, 2, 0; 0, 0, 6]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_697mathnfmod(PyObject *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnfmod (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_696mathnfmod(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_d));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_696mathnfmod(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_d) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnfmod", 0);

    /* "gen.pyx":8664
 *             [1, 0, 0; 0, 2, 0; 0, 0, 6]
 *         """
 *         cdef gen t0 = objtogen(d)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(hnfmod(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8665
 *         """
 *         cdef gen t0 = objtogen(d)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hnfmod(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8666
 *         cdef gen t0 = objtogen(d)
 *         pari_catch_sig_on()
 *         return P.new_gen(hnfmod(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def mathnfmodid(self, d):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hnfmod(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8634
 *         return P.new_gen(mathnf0(self.g, flag))
 * 
 *     def mathnfmod(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite normal form if d is a multiple of the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.mathnfmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8668
 *         return P.new_gen(hnfmod(self.g, t0.g))
 * 
 *     def mathnfmodid(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite Normal Form of M concatenated with d\*Identity
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_699mathnfmodid(PyObject *__pyx_v_self, PyObject *__pyx_v_d); /*proto*/
  static char __pyx_doc_3gen_3gen_698mathnfmodid[] = "\n        Returns the Hermite Normal Form of M concatenated with d\\*Identity\n\n        Beware that PARI's concept of a Hermite normal form is a maximal\n        rank upper triangular matrix with the same column space as the\n        input matrix.\n\n        INPUT:\n\n\n        -  ``d`` - Determines\n\n\n        EXAMPLES::\n\n                   sage: M=matrix([[1,0,0],[0,2,0],[0,0,6]])\n            sage: pari(M).mathnfmodid(6)\n                   [1, 0, 0; 0, 2, 0; 0, 0, 6]\n\n        This routine is not completely equivalent to mathnfmod::\n\n            sage: pari(M).mathnfmod(6)\n            [1, 0, 0; 0, 1, 0; 0, 0, 6]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_699mathnfmodid(PyObject *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnfmodid (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_698mathnfmodid(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_d));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_698mathnfmodid(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_d) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnfmodid", 0);

    /* "gen.pyx":8693
 *             [1, 0, 0; 0, 1, 0; 0, 0, 6]
 *         """
 *         cdef gen t0 = objtogen(d)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(hnfmodid(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_d)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8694
 *         """
 *         cdef gen t0 = objtogen(d)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hnfmodid(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8695
 *         cdef gen t0 = objtogen(d)
 *         pari_catch_sig_on()
 *         return P.new_gen(hnfmodid(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def matsnf(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, hnfmodid(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8668
 *         return P.new_gen(hnfmod(self.g, t0.g))
 * 
 *     def mathnfmodid(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite Normal Form of M concatenated with d\*Identity
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.mathnfmodid", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8697
 *         return P.new_gen(hnfmodid(self.g, t0.g))
 * 
 *     def matsnf(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.matsnf(flag=0): Smith normal form (i.e. elementary divisors) of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_701matsnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_700matsnf[] = "\n        x.matsnf(flag=0): Smith normal form (i.e. elementary divisors) of\n        the matrix x, expressed as a vector d. Binary digits of flag mean\n        1: returns [u,v,d] where d=u\\*x\\*v, otherwise only the diagonal d\n        is returned, 2: allow polynomial entries, otherwise assume x is\n        integral, 4: removes all information corresponding to entries equal\n        to 1 in d.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').matsnf()\n            [0, 3, 1]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_701matsnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matsnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matsnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8697; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8697; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matsnf", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8697; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matsnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_700matsnf(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_700matsnf(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matsnf", 0);

    /* "gen.pyx":8711
 *             [0, 3, 1]
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(matsnf0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8712
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(matsnf0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matfrobenius(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, matsnf0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8697
 *         return P.new_gen(hnfmodid(self.g, t0.g))
 * 
 *     def matsnf(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.matsnf(flag=0): Smith normal form (i.e. elementary divisors) of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.matsnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8714
 *         return P.new_gen(matsnf0(self.g, flag))
 * 
 *     def matfrobenius(self, long flag=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         M.matfrobenius(flag=0): Return the Frobenius form of the square
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_703matfrobenius(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_702matfrobenius[] = "\n        M.matfrobenius(flag=0): Return the Frobenius form of the square\n        matrix M. If flag is 1, return only the elementary divisors (a list\n        of polynomials). If flag is 2, return a two-components vector [F,B]\n        where F is the Frobenius form and B is the basis change so that\n        `M=B^{-1} F B`.\n\n        EXAMPLES::\n\n            sage: a = pari('[1,2;3,4]')\n            sage: a.matfrobenius()\n            [0, 2; 1, 5]\n            sage: a.matfrobenius(flag=1)\n            [x^2 - 5*x - 2]\n            sage: a.matfrobenius(2)\n            [[0, 2; 1, 5], [1, -1/3; 0, 1/3]]\n            sage: v = a.matfrobenius(2)\n            sage: v[0]\n            [0, 2; 1, 5]\n            sage: v[1]^(-1)*v[0]*v[1]\n            [1, 2; 3, 4]\n\n        We let t be the matrix of `T_2` acting on modular symbols\n        of level 43, which was computed using\n        ``ModularSymbols(43,sign=1).T(2).matrix()``::\n\n            sage: t = pari('[3, -2, 0, 0; 0, -2, 0, 1; 0, -1, -2, 2; 0, -2, 0, 2]')\n            sage: t.matfrobenius()\n            [0, 0, 0, -12; 1, 0, 0, -2; 0, 1, 0, 8; 0, 0, 1, 1]\n            sage: t.charpoly('x')\n            x^4 - x^3 - 8*x^2 + 2*x + 12\n            sage: t.matfrobenius(1)\n            [x^4 - x^3 - 8*x^2 + 2*x + 12]\n\n        AUTHORS:\n\n        - Martin Albrect (2006-04-02)\n        ";
  static PyObject *__pyx_pw_3gen_3gen_703matfrobenius(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matfrobenius (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matfrobenius") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matfrobenius", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.matfrobenius", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_702matfrobenius(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_702matfrobenius(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matfrobenius", 0);

    /* "gen.pyx":8753
 *         - Martin Albrect (2006-04-02)
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(matfrobenius(self.g, flag, 0))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8754
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(matfrobenius(self.g, flag, 0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, matfrobenius(__pyx_v_self->g, __pyx_v_flag, 0))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8714
 *         return P.new_gen(matsnf0(self.g, flag))
 * 
 *     def matfrobenius(self, long flag=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         M.matfrobenius(flag=0): Return the Frobenius form of the square
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.matfrobenius", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8760
 *     # polarit2.c
 *     ###########################################
 *     def factor(gen self, limit=-1, bint proof=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the factorization of x.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_705factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_704factor[] = "\n        Return the factorization of x.\n\n        INPUT:\n\n        -  ``limit`` -- (default: -1) is optional and can be set\n           whenever x is of (possibly recursive) rational type. If limit is\n           set return partial factorization, using primes up to limit (up to\n           primelimit if limit=0).\n\n        - ``proof`` -- (default: True) optional. If False (not the default),\n          returned factors larger than `2^{64}` may only be pseudoprimes.\n\n        .. note::\n\n           In the standard PARI/GP interpreter and C-library the\n           factor command *always* has proof=False, so beware!\n\n        EXAMPLES::\n\n            sage: pari('x^10-1').factor()\n            [x - 1, 1; x + 1, 1; x^4 - x^3 + x^2 - x + 1, 1; x^4 + x^3 + x^2 + x + 1, 1]\n            sage: pari(2^100-1).factor()\n            [3, 1; 5, 3; 11, 1; 31, 1; 41, 1; 101, 1; 251, 1; 601, 1; 1801, 1; 4051, 1; 8101, 1; 268501, 1]\n            sage: pari(2^100-1).factor(proof=False)\n            [3, 1; 5, 3; 11, 1; 31, 1; 41, 1; 101, 1; 251, 1; 601, 1; 1801, 1; 4051, 1; 8101, 1; 268501, 1]\n\n        We illustrate setting a limit::\n\n            sage: pari(next_prime(10^50)*next_prime(10^60)*next_prime(10^4)).factor(10^5)\n            [10007, 1; 100000000000000000000000000000000000000000000000151000000000700000000000000000000000000000000000000000000001057, 1]\n\n        PARI doesn't have an algorithm for factoring multivariate\n        polynomials::\n\n            sage: pari('x^3 - y^3').factor()\n            Traceback (most recent call last):\n            ...\n            PariError: sorry, factor for general polynomials is not yet implemented\n        ";
  static PyObject *__pyx_pw_3gen_3gen_705factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_limit = 0;
    CYTHON_UNUSED int __pyx_v_proof;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factor (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_limit,&__pyx_n_s_proof,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_limit);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_proof);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factor") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_limit = values[0];
      if (values[1]) {
        __pyx_v_proof = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_proof == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_proof = ((int)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factor", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8760; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_704factor(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_limit, __pyx_v_proof);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_704factor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_limit, CYTHON_UNUSED int __pyx_v_proof) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factor", 0);

    /* "gen.pyx":8815
 *             else:
 *                 return _factor_int_when_pari_factor_failed(self, z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(factor0(self.g, limit))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8816
 *                 return _factor_int_when_pari_factor_failed(self, z)
 *         pari_catch_sig_on()
 *         return P.new_gen(factor0(self.g, limit))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_As_long(__pyx_v_limit); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, factor0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8760
 *     # polarit2.c
 *     ###########################################
 *     def factor(gen self, limit=-1, bint proof=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the factorization of x.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8823
 *     ###########################################
 * 
 *     def hilbert(x, y, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_707hilbert(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_707hilbert(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_p = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("hilbert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("hilbert", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8823; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hilbert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8823; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_y = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("hilbert", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8823; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.hilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_706hilbert(((struct __pyx_obj_3gen_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_p);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_706hilbert(struct __pyx_obj_3gen_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_p) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    long __pyx_v_ret;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("hilbert", 0);

    /* "gen.pyx":8824
 * 
 *     def hilbert(x, y, p):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8825
 *     def hilbert(x, y, p):
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         ret = hilbert0(x.g, t0.g, t1.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8826
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         ret = hilbert0(x.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8827
 *         cdef gen t1 = objtogen(p)
 *         pari_catch_sig_on()
 *         ret = hilbert0(x.g, t0.g, t1.g)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return ret
 */
    __pyx_v_ret = hilbert(__pyx_v_x->g, __pyx_v_t0->g, __pyx_v_t1->g);

    /* "gen.pyx":8828
 *         pari_catch_sig_on()
 *         ret = hilbert0(x.g, t0.g, t1.g)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return ret
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":8829
 *         ret = hilbert0(x.g, t0.g, t1.g)
 *         pari_catch_sig_off()
 *         return ret             # <<<<<<<<<<<<<<
 * 
 *     def chinese(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_ret); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8823
 *     ###########################################
 * 
 *     def hilbert(x, y, p):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(p)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.hilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8831
 *         return ret
 * 
 *     def chinese(self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_709chinese(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_709chinese(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("chinese (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_708chinese(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_708chinese(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("chinese", 0);

    /* "gen.pyx":8832
 * 
 *     def chinese(self, y):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(chinese(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8833
 *     def chinese(self, y):
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(chinese(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8834
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(chinese(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def order(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, chinese(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8834; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8831
 *         return ret
 * 
 *     def chinese(self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.chinese", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8836
 *         return P.new_gen(chinese(self.g, t0.g))
 * 
 *     def order(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(order(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_711order(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_711order(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("order (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_710order(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_710order(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("order", 0);

    /* "gen.pyx":8837
 * 
 *     def order(self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(order(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8838
 *     def order(self):
 *         pari_catch_sig_on()
 *         return P.new_gen(order(self.g))             # <<<<<<<<<<<<<<
 * 
 *     # def znprimroot(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, order(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8836
 *         return P.new_gen(chinese(self.g, t0.g))
 * 
 *     def order(self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(order(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.order", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8870
 *     #     return P.new_gen(znprimroot0(self.g))
 * 
 *     def __abs__(self):             # <<<<<<<<<<<<<<
 *         return self.abs()
 * 
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_713__abs__(PyObject *__pyx_v_self); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_713__abs__(PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__abs__ (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_712__abs__(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_712__abs__(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__abs__", 0);

    /* "gen.pyx":8871
 * 
 *     def __abs__(self):
 *         return self.abs()             # <<<<<<<<<<<<<<
 * 
 *     def norm(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8870
 *     #     return P.new_gen(znprimroot0(self.g))
 * 
 *     def __abs__(self):             # <<<<<<<<<<<<<<
 *         return self.abs()
 * 
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.__abs__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8873
 *         return self.abs()
 * 
 *     def norm(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gnorm(self.g))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_715norm(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_715norm(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("norm (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_714norm(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_714norm(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("norm", 0);

    /* "gen.pyx":8874
 * 
 *     def norm(gen self):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gnorm(self.g))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8875
 *     def norm(gen self):
 *         pari_catch_sig_on()
 *         return P.new_gen(gnorm(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nextprime(gen self, bint add_one=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gnorm(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8873
 *         return self.abs()
 * 
 *     def norm(gen self):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gnorm(self.g))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8877
 *         return P.new_gen(gnorm(self.g))
 * 
 *     def nextprime(gen self, bint add_one=0):             # <<<<<<<<<<<<<<
 *         """
 *         nextprime(x): smallest pseudoprime greater than or equal to `x`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_717nextprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_716nextprime[] = "\n        nextprime(x): smallest pseudoprime greater than or equal to `x`.\n        If ``add_one`` is non-zero, return the smallest pseudoprime\n        strictly greater than `x`.\n\n        EXAMPLES::\n\n            sage: pari(1).nextprime()\n            2\n            sage: pari(2).nextprime()\n            2\n            sage: pari(2).nextprime(add_one = 1)\n            3\n            sage: pari(2^100).nextprime()\n            1267650600228229401496703205653\n        ";
  static PyObject *__pyx_pw_3gen_3gen_717nextprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    int __pyx_v_add_one;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nextprime (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_add_one,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_add_one);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nextprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8877; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_add_one = __Pyx_PyObject_IsTrue(values[0]); if (unlikely((__pyx_v_add_one == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8877; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_add_one = ((int)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nextprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8877; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.nextprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_716nextprime(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_add_one);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_716nextprime(struct __pyx_obj_3gen_gen *__pyx_v_self, int __pyx_v_add_one) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nextprime", 0);

    /* "gen.pyx":8894
 *             1267650600228229401496703205653
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         if add_one:
 *             return P.new_gen(nextprime(gaddsg(1,self.g)))
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8895
 *         """
 *         pari_catch_sig_on()
 *         if add_one:             # <<<<<<<<<<<<<<
 *             return P.new_gen(nextprime(gaddsg(1,self.g)))
 *         return P.new_gen(nextprime(self.g))
 */
    __pyx_t_2 = (__pyx_v_add_one != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":8896
 *         pari_catch_sig_on()
 *         if add_one:
 *             return P.new_gen(nextprime(gaddsg(1,self.g)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(nextprime(self.g))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nextprime(gaddsg(1, __pyx_v_self->g)))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8896; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":8897
 *         if add_one:
 *             return P.new_gen(nextprime(gaddsg(1,self.g)))
 *         return P.new_gen(nextprime(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def change_variable_name(self, var):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, nextprime(__pyx_v_self->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8877
 *         return P.new_gen(gnorm(self.g))
 * 
 *     def nextprime(gen self, bint add_one=0):             # <<<<<<<<<<<<<<
 *         """
 *         nextprime(x): smallest pseudoprime greater than or equal to `x`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.nextprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8899
 *         return P.new_gen(nextprime(self.g))
 * 
 *     def change_variable_name(self, var):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, which must be a ``t_POL`` or ``t_SER``, set the
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_719change_variable_name(PyObject *__pyx_v_self, PyObject *__pyx_v_var); /*proto*/
  static char __pyx_doc_3gen_3gen_718change_variable_name[] = "\n        In ``self``, which must be a ``t_POL`` or ``t_SER``, set the\n        variable to ``var``.  If the variable of ``self`` is already\n        ``var``, then return ``self``.\n\n        .. WARNING::\n\n            You should be careful with variable priorities when\n            applying this on a polynomial or series of which the\n            coefficients have polynomial components.  To be safe, only\n            use this function on polynomials with integer or rational\n            coefficients.  For a safer alternative, use :meth:`subst`.\n\n        EXAMPLES::\n\n            sage: f = pari('x^3 + 17*x + 3')\n            sage: f.change_variable_name(\"y\")\n            y^3 + 17*y + 3\n            sage: f = pari('1 + 2*y + O(y^10)')\n            sage: f.change_variable_name(\"q\")\n            1 + 2*q + O(q^10)\n            sage: f.change_variable_name(\"y\") is f\n            True\n\n        In PARI, ``I`` refers to the square root of -1, so it cannot be\n        used as variable name.  Note the difference with :meth:`subst`::\n\n            sage: f = pari('x^2 + 1')\n            sage: f.change_variable_name(\"I\")\n            Traceback (most recent call last):\n            ...\n            PariError: I already exists with incompatible valence\n            sage: f.subst(\"x\", \"I\")\n            0\n        ";
  static PyObject *__pyx_pw_3gen_3gen_719change_variable_name(PyObject *__pyx_v_self, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("change_variable_name (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_718change_variable_name(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_var));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_718change_variable_name(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    long __pyx_v_n;
    struct __pyx_obj_3gen_gen *__pyx_v_newg = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("change_variable_name", 0);

    /* "gen.pyx":8935
 *             0
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         cdef long n = P.get_var(var)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8936
 *         """
 *         pari_catch_sig_on()
 *         cdef long n = P.get_var(var)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         if varn(self.g) == n:
 */
    __pyx_v_n = ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var);

    /* "gen.pyx":8937
 *         pari_catch_sig_on()
 *         cdef long n = P.get_var(var)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         if varn(self.g) == n:
 *             return self
 */
    pari_catch_sig_off();

    /* "gen.pyx":8938
 *         cdef long n = P.get_var(var)
 *         pari_catch_sig_off()
 *         if varn(self.g) == n:             # <<<<<<<<<<<<<<
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 */
    __pyx_t_2 = ((varn(__pyx_v_self->g) == __pyx_v_n) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":8939
 *         pari_catch_sig_off()
 *         if varn(self.g) == n:
 *             return self             # <<<<<<<<<<<<<<
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_self));
      __pyx_r = ((PyObject *)__pyx_v_self);
      goto __pyx_L0;
    }

    /* "gen.pyx":8940
 *         if varn(self.g) == n:
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:             # <<<<<<<<<<<<<<
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 *         # Copy self and then change the variable in place
 */
    __pyx_t_3 = ((typ(__pyx_v_self->g) != t_POL) != 0);
    if (__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_3 = ((typ(__pyx_v_self->g) != t_SER) != 0);
    __pyx_t_2 = __pyx_t_3;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_2) {

      /* "gen.pyx":8941
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 *             raise TypeError, "set_variable() only works for polynomials or power series"             # <<<<<<<<<<<<<<
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)
 */
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_kp_s_set_variable_only_works_for_poly, 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8941; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":8943
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)             # <<<<<<<<<<<<<<
 *         setvarn(newg.g, n)
 *         return newg
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, __pyx_v_self->g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8943; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_newg = ((struct __pyx_obj_3gen_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "gen.pyx":8944
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)
 *         setvarn(newg.g, n)             # <<<<<<<<<<<<<<
 *         return newg
 * 
 */
    setvarn(__pyx_v_newg->g, __pyx_v_n);

    /* "gen.pyx":8945
 *         cdef gen newg = P.new_gen_noclear(self.g)
 *         setvarn(newg.g, n)
 *         return newg             # <<<<<<<<<<<<<<
 * 
 *     def subst(self, var, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_newg));
    __pyx_r = ((PyObject *)__pyx_v_newg);
    goto __pyx_L0;

    /* "gen.pyx":8899
 *         return P.new_gen(nextprime(self.g))
 * 
 *     def change_variable_name(self, var):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, which must be a ``t_POL`` or ``t_SER``, set the
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.gen.change_variable_name", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_newg);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8947
 *         return newg
 * 
 *     def subst(self, var, z):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, replace the variable ``var`` by the expression `z`.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_721subst(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_720subst[] = "\n        In ``self``, replace the variable ``var`` by the expression `z`.\n\n        EXAMPLES::\n\n            sage: x = pari(\"x\"); y = pari(\"y\")\n            sage: f = pari('x^3 + 17*x + 3')\n            sage: f.subst(x, y)\n            y^3 + 17*y + 3\n            sage: f.subst(x, \"z\")\n            z^3 + 17*z + 3\n            sage: f.subst(x, \"z\")^2\n            z^6 + 34*z^4 + 6*z^3 + 289*z^2 + 102*z + 9\n            sage: f.subst(x, \"x+1\")\n            x^3 + 3*x^2 + 20*x + 21\n            sage: f.subst(x, \"xyz\")\n            xyz^3 + 17*xyz + 3\n            sage: f.subst(x, \"xyz\")^2\n            xyz^6 + 34*xyz^4 + 6*xyz^3 + 289*xyz^2 + 102*xyz + 9\n        ";
  static PyObject *__pyx_pw_3gen_3gen_721subst(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_v_z = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("subst (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_var,&__pyx_n_s_z,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("subst", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8947; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "subst") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8947; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_var = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("subst", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8947; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_720subst(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_var, __pyx_v_z);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_720subst(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_z) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("subst", 0);

    /* "gen.pyx":8968
 *             xyz^6 + 34*xyz^4 + 6*xyz^3 + 289*xyz^2 + 102*xyz + 9
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubst(self.g, P.get_var(var), t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8969
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubst(self.g, P.get_var(var), t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8970
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubst(self.g, P.get_var(var), t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def substpol(self, y, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsubst(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var), __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8947
 *         return newg
 * 
 *     def subst(self, var, z):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, replace the variable ``var`` by the expression `z`.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8972
 *         return P.new_gen(gsubst(self.g, P.get_var(var), t0.g))
 * 
 *     def substpol(self, y, z):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(z)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_723substpol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_723substpol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_z = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("substpol (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_y,&__pyx_n_s_z,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("substpol", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8972; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "substpol") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8972; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_y = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("substpol", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8972; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.substpol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_722substpol(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_z);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_722substpol(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("substpol", 0);

    /* "gen.pyx":8973
 * 
 *     def substpol(self, y, z):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(z)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8974
 *     def substpol(self, y, z):
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubstpol(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":8975
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubstpol(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":8976
 *         cdef gen t1 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubstpol(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def nf_subst(self, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsubstpol(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8972
 *         return P.new_gen(gsubst(self.g, P.get_var(var), t0.g))
 * 
 *     def substpol(self, y, z):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         cdef gen t1 = objtogen(z)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.substpol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":8978
 *         return P.new_gen(gsubstpol(self.g, t0.g, t1.g))
 * 
 *     def nf_subst(self, z):             # <<<<<<<<<<<<<<
 *         """
 *         Given a PARI number field ``self``, return the same PARI
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_725nf_subst(PyObject *__pyx_v_self, PyObject *__pyx_v_z); /*proto*/
  static char __pyx_doc_3gen_3gen_724nf_subst[] = "\n        Given a PARI number field ``self``, return the same PARI\n        number field but in the variable ``z``.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K = NumberField(x^2 + 5, 'a')\n\n        We can substitute in a PARI ``nf`` structure::\n\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.nf_get_pol()\n            y^2 + 5\n            sage: Lpari = Kpari.nf_subst('a')\n            sage: Lpari.nf_get_pol()\n            a^2 + 5\n\n        We can also substitute in a PARI ``bnf`` structure::\n\n            sage: Kpari = K.pari_bnf()\n            sage: Kpari.nf_get_pol()\n            y^2 + 5\n            sage: Kpari.bnf_get_cyc()  # Structure of class group\n            [2]\n            sage: Lpari = Kpari.nf_subst('a')\n            sage: Lpari.nf_get_pol()\n            a^2 + 5\n            sage: Lpari.bnf_get_cyc()  # We still have a bnf after substituting\n            [2]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_725nf_subst(PyObject *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nf_subst (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_724nf_subst(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_z));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_724nf_subst(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nf_subst", 0);

    /* "gen.pyx":9015
 *             [2]
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubst(self.g, gvar(self.g), t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9016
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubst(self.g, gvar(self.g), t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9017
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(gsubst(self.g, gvar(self.g), t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def taylor(self, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, gsubst(__pyx_v_self->g, gvar(__pyx_v_self->g), __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9017; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":8978
 *         return P.new_gen(gsubstpol(self.g, t0.g, t1.g))
 * 
 *     def nf_subst(self, z):             # <<<<<<<<<<<<<<
 *         """
 *         Given a PARI number field ``self``, return the same PARI
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.nf_subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9019
 *         return P.new_gen(gsubst(self.g, gvar(self.g), t0.g))
 * 
 *     def taylor(self, v=-1):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_727taylor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_727taylor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("taylor (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "taylor") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9019; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("taylor", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9019; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.taylor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_726taylor(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_v);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_726taylor(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("taylor", 0);

    /* "gen.pyx":9020
 * 
 *     def taylor(self, v=-1):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9021
 *     def taylor(self, v=-1):
 *         pari_catch_sig_on()
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))             # <<<<<<<<<<<<<<
 * 
 *     def thue(self, rhs, ne):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, tayl(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_v), precdl))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9019
 *         return P.new_gen(gsubst(self.g, gvar(self.g), t0.g))
 * 
 *     def taylor(self, v=-1):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.taylor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9023
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))
 * 
 *     def thue(self, rhs, ne):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(rhs)
 *         cdef gen t1 = objtogen(ne)
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_729thue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_729thue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_rhs = 0;
    PyObject *__pyx_v_ne = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thue (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rhs,&__pyx_n_s_ne,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_rhs)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ne)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("thue", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9023; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thue") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9023; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_rhs = values[0];
      __pyx_v_ne = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thue", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9023; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.thue", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_728thue(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_rhs, __pyx_v_ne);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_728thue(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_rhs, PyObject *__pyx_v_ne) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thue", 0);

    /* "gen.pyx":9024
 * 
 *     def thue(self, rhs, ne):
 *         cdef gen t0 = objtogen(rhs)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(ne)
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_rhs)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9024; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9025
 *     def thue(self, rhs, ne):
 *         cdef gen t0 = objtogen(rhs)
 *         cdef gen t1 = objtogen(ne)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(thue(self.g, t0.g, t1.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_ne)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9026
 *         cdef gen t0 = objtogen(rhs)
 *         cdef gen t1 = objtogen(ne)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(thue(self.g, t0.g, t1.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9026; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9027
 *         cdef gen t1 = objtogen(ne)
 *         pari_catch_sig_on()
 *         return P.new_gen(thue(self.g, t0.g, t1.g))             # <<<<<<<<<<<<<<
 * 
 *     def charpoly(self, var=-1, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, thue(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9023
 *         return P.new_gen(tayl(self.g, P.get_var(v), precdl))
 * 
 *     def thue(self, rhs, ne):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(rhs)
 *         cdef gen t1 = objtogen(ne)
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.thue", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9029
 *         return P.new_gen(thue(self.g, t0.g, t1.g))
 * 
 *     def charpoly(self, var=-1, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         charpoly(A,v=x,flag=0): det(v\*Id-A) = characteristic polynomial of
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_731charpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_730charpoly[] = "\n        charpoly(A,v=x,flag=0): det(v\\*Id-A) = characteristic polynomial of\n        A using the comatrix. flag is optional and may be set to 1 (use\n        Lagrange interpolation) or 2 (use Hessenberg form), 0 being the\n        default.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_731charpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("charpoly (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_var,&__pyx_n_s_flag,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_var);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "charpoly") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9029; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9029; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("charpoly", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9029; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.charpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_730charpoly(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_var, __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_730charpoly(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_var, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("charpoly", 0);

    /* "gen.pyx":9036
 *         default.
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(charpoly0(self.g, P.get_var(var), flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9037
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(charpoly0(self.g, P.get_var(var), flag))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, charpoly0(__pyx_v_self->g, ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->get_var(__pyx_v_3gen_P, __pyx_v_var), __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9037; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9029
 *         return P.new_gen(thue(self.g, t0.g, t1.g))
 * 
 *     def charpoly(self, var=-1, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         charpoly(A,v=x,flag=0): det(v\*Id-A) = characteristic polynomial of
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.charpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9040
 * 
 * 
 *     def kronecker(gen self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_733kronecker(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_733kronecker(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("kronecker (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_732kronecker(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_732kronecker(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("kronecker", 0);

    /* "gen.pyx":9041
 * 
 *     def kronecker(gen self, y):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return kronecker(self.g, t0.g)
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9041; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9042
 *     def kronecker(gen self, y):
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return kronecker(self.g, t0.g)
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9043
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return kronecker(self.g, t0.g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyInt_From_long(kronecker(__pyx_v_self->g, __pyx_v_t0->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9043; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9040
 * 
 * 
 *     def kronecker(gen self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.kronecker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9046
 * 
 * 
 *     def type(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI type of self as a string.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_735type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_3gen_3gen_734type[] = "\n        Return the PARI type of self as a string.\n\n        .. note::\n\n           In Cython, it is much faster to simply use typ(self.g) for\n           checking PARI types.\n\n        EXAMPLES::\n\n            sage: pari(7).type()\n            't_INT'\n            sage: pari('x').type()\n            't_POL'\n        ";
  static PyObject *__pyx_pw_3gen_3gen_735type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("type (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_734type(((struct __pyx_obj_3gen_gen *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_734type(struct __pyx_obj_3gen_gen *__pyx_v_self) {
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("type", 0);

    /* "gen.pyx":9077
 *         # need to be updated accordingly.
 *         #
 *         cdef long t = typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *         if   t == t_INT:      return 't_INT'
 */
    __pyx_v_t = typ(__pyx_v_self->g);

    /* "gen.pyx":9079
 *         cdef long t = typ(self.g)
 * 
 *         if   t == t_INT:      return 't_INT'             # <<<<<<<<<<<<<<
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'
 */
    __pyx_t_1 = ((__pyx_v_t == t_INT) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_INT);
      __pyx_r = __pyx_n_s_t_INT;
      goto __pyx_L0;
    }

    /* "gen.pyx":9080
 * 
 *         if   t == t_INT:      return 't_INT'
 *         elif t == t_REAL:     return 't_REAL'             # <<<<<<<<<<<<<<
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'
 */
    __pyx_t_1 = ((__pyx_v_t == t_REAL) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_REAL);
      __pyx_r = __pyx_n_s_t_REAL;
      goto __pyx_L0;
    }

    /* "gen.pyx":9081
 *         if   t == t_INT:      return 't_INT'
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'             # <<<<<<<<<<<<<<
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'
 */
    __pyx_t_1 = ((__pyx_v_t == t_INTMOD) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_INTMOD);
      __pyx_r = __pyx_n_s_t_INTMOD;
      goto __pyx_L0;
    }

    /* "gen.pyx":9082
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'             # <<<<<<<<<<<<<<
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 */
    __pyx_t_1 = ((__pyx_v_t == t_FRAC) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_FRAC);
      __pyx_r = __pyx_n_s_t_FRAC;
      goto __pyx_L0;
    }

    /* "gen.pyx":9083
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'             # <<<<<<<<<<<<<<
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'
 */
    __pyx_t_1 = ((__pyx_v_t == t_FFELT) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_FFELT);
      __pyx_r = __pyx_n_s_t_FFELT;
      goto __pyx_L0;
    }

    /* "gen.pyx":9084
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'             # <<<<<<<<<<<<<<
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'
 */
    __pyx_t_1 = ((__pyx_v_t == t_COMPLEX) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_COMPLEX);
      __pyx_r = __pyx_n_s_t_COMPLEX;
      goto __pyx_L0;
    }

    /* "gen.pyx":9085
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'             # <<<<<<<<<<<<<<
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'
 */
    __pyx_t_1 = ((__pyx_v_t == t_PADIC) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_PADIC);
      __pyx_r = __pyx_n_s_t_PADIC;
      goto __pyx_L0;
    }

    /* "gen.pyx":9086
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'             # <<<<<<<<<<<<<<
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'
 */
    __pyx_t_1 = ((__pyx_v_t == t_QUAD) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_QUAD);
      __pyx_r = __pyx_n_s_t_QUAD;
      goto __pyx_L0;
    }

    /* "gen.pyx":9087
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'             # <<<<<<<<<<<<<<
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'
 */
    __pyx_t_1 = ((__pyx_v_t == t_POLMOD) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_POLMOD);
      __pyx_r = __pyx_n_s_t_POLMOD;
      goto __pyx_L0;
    }

    /* "gen.pyx":9088
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'             # <<<<<<<<<<<<<<
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'
 */
    __pyx_t_1 = ((__pyx_v_t == t_POL) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_POL);
      __pyx_r = __pyx_n_s_t_POL;
      goto __pyx_L0;
    }

    /* "gen.pyx":9089
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'             # <<<<<<<<<<<<<<
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'
 */
    __pyx_t_1 = ((__pyx_v_t == t_SER) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_SER);
      __pyx_r = __pyx_n_s_t_SER;
      goto __pyx_L0;
    }

    /* "gen.pyx":9090
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'             # <<<<<<<<<<<<<<
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'
 */
    __pyx_t_1 = ((__pyx_v_t == t_RFRAC) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_RFRAC);
      __pyx_r = __pyx_n_s_t_RFRAC;
      goto __pyx_L0;
    }

    /* "gen.pyx":9091
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'             # <<<<<<<<<<<<<<
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'
 */
    __pyx_t_1 = ((__pyx_v_t == t_QFR) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_QFR);
      __pyx_r = __pyx_n_s_t_QFR;
      goto __pyx_L0;
    }

    /* "gen.pyx":9092
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'             # <<<<<<<<<<<<<<
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'
 */
    __pyx_t_1 = ((__pyx_v_t == t_QFI) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_QFI);
      __pyx_r = __pyx_n_s_t_QFI;
      goto __pyx_L0;
    }

    /* "gen.pyx":9093
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'             # <<<<<<<<<<<<<<
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'
 */
    __pyx_t_1 = ((__pyx_v_t == t_VEC) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_VEC);
      __pyx_r = __pyx_n_s_t_VEC;
      goto __pyx_L0;
    }

    /* "gen.pyx":9094
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'             # <<<<<<<<<<<<<<
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'
 */
    __pyx_t_1 = ((__pyx_v_t == t_COL) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_COL);
      __pyx_r = __pyx_n_s_t_COL;
      goto __pyx_L0;
    }

    /* "gen.pyx":9095
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'             # <<<<<<<<<<<<<<
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'
 */
    __pyx_t_1 = ((__pyx_v_t == t_MAT) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_MAT);
      __pyx_r = __pyx_n_s_t_MAT;
      goto __pyx_L0;
    }

    /* "gen.pyx":9096
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'             # <<<<<<<<<<<<<<
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 */
    __pyx_t_1 = ((__pyx_v_t == t_LIST) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_LIST);
      __pyx_r = __pyx_n_s_t_LIST;
      goto __pyx_L0;
    }

    /* "gen.pyx":9097
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'             # <<<<<<<<<<<<<<
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 */
    __pyx_t_1 = ((__pyx_v_t == t_STR) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_STR);
      __pyx_r = __pyx_n_s_t_STR;
      goto __pyx_L0;
    }

    /* "gen.pyx":9098
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'             # <<<<<<<<<<<<<<
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 *         else:
 */
    __pyx_t_1 = ((__pyx_v_t == t_VECSMALL) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_VECSMALL);
      __pyx_r = __pyx_n_s_t_VECSMALL;
      goto __pyx_L0;
    }

    /* "gen.pyx":9099
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 *         elif t == t_CLOSURE:  return 't_CLOSURE'             # <<<<<<<<<<<<<<
 *         else:
 *             raise TypeError, "Unknown PARI type: %s"%t
 */
    __pyx_t_1 = ((__pyx_v_t == t_CLOSURE) != 0);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_n_s_t_CLOSURE);
      __pyx_r = __pyx_n_s_t_CLOSURE;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":9101
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 *         else:
 *             raise TypeError, "Unknown PARI type: %s"%t             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_t); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = __Pyx_PyString_Format(__pyx_kp_s_Unknown_PARI_type_s, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, __pyx_t_3, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }

    /* "gen.pyx":9046
 * 
 * 
 *     def type(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the PARI type of self as a string.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.type", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9104
 * 
 * 
 *     def polinterpolate(self, ya, x):             # <<<<<<<<<<<<<<
 *         """
 *         self.polinterpolate(ya,x,e): polynomial interpolation at x
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_737polinterpolate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_736polinterpolate[] = "\n        self.polinterpolate(ya,x,e): polynomial interpolation at x\n        according to data vectors self, ya (i.e. return P such that\n        P(self[i]) = ya[i] for all i). Also return an error estimate on the\n        returned value.\n        ";
  static PyObject *__pyx_pw_3gen_3gen_737polinterpolate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_ya = 0;
    PyObject *__pyx_v_x = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polinterpolate (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_ya,&__pyx_n_s_x,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_ya)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polinterpolate", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9104; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polinterpolate") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9104; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_ya = values[0];
      __pyx_v_x = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polinterpolate", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9104; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.polinterpolate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_736polinterpolate(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_ya, __pyx_v_x);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_736polinterpolate(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_ya, PyObject *__pyx_v_x) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    struct __pyx_obj_3gen_gen *__pyx_v_t1 = 0;
    GEN __pyx_v_dy;
    GEN __pyx_v_g;
    struct __pyx_obj_3gen_gen *__pyx_v_dif = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polinterpolate", 0);

    /* "gen.pyx":9111
 *         returned value.
 *         """
 *         cdef gen t0 = objtogen(ya)             # <<<<<<<<<<<<<<
 *         cdef gen t1 = objtogen(x)
 *         cdef GEN dy, g
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_ya)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9112
 *         """
 *         cdef gen t0 = objtogen(ya)
 *         cdef gen t1 = objtogen(x)             # <<<<<<<<<<<<<<
 *         cdef GEN dy, g
 *         pari_catch_sig_on()
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t1 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9114
 *         cdef gen t1 = objtogen(x)
 *         cdef GEN dy, g
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         g = polint(self.g, t0.g, t1.g, &dy)
 *         dif = P.new_gen_noclear(dy)
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9115
 *         cdef GEN dy, g
 *         pari_catch_sig_on()
 *         g = polint(self.g, t0.g, t1.g, &dy)             # <<<<<<<<<<<<<<
 *         dif = P.new_gen_noclear(dy)
 *         return P.new_gen(g), dif
 */
    __pyx_v_g = polint(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_t1->g, (&__pyx_v_dy));

    /* "gen.pyx":9116
 *         pari_catch_sig_on()
 *         g = polint(self.g, t0.g, t1.g, &dy)
 *         dif = P.new_gen_noclear(dy)             # <<<<<<<<<<<<<<
 *         return P.new_gen(g), dif
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen_noclear(__pyx_v_3gen_P, __pyx_v_dy)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_dif = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9117
 *         g = polint(self.g, t0.g, t1.g, &dy)
 *         dif = P.new_gen_noclear(dy)
 *         return P.new_gen(g), dif             # <<<<<<<<<<<<<<
 * 
 *     def algdep(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_v_dif));
    PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_dif));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_dif));
    __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9104
 * 
 * 
 *     def polinterpolate(self, ya, x):             # <<<<<<<<<<<<<<
 *         """
 *         self.polinterpolate(ya,x,e): polynomial interpolation at x
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.gen.polinterpolate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XDECREF((PyObject *)__pyx_v_t1);
    __Pyx_XDECREF((PyObject *)__pyx_v_dif);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9119
 *         return P.new_gen(g), dif
 * 
 *     def algdep(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_739algdep(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_3gen_3gen_738algdep[] = "\n        EXAMPLES::\n\n            sage: n = pari.set_real_precision(210)\n            sage: w1 = pari('z1=2-sqrt(26); (z1+I)/(z1-I)')\n            sage: f = w1.algdep(12); f\n            545*x^11 - 297*x^10 - 281*x^9 + 48*x^8 - 168*x^7 + 690*x^6 - 168*x^5 + 48*x^4 - 281*x^3 - 297*x^2 + 545*x\n            sage: f(w1).abs() < 1.0e-200\n            True\n            sage: f.factor()\n            [x, 1; x + 1, 2; x^2 + 1, 1; x^2 + x + 1, 1; 545*x^4 - 1932*x^3 + 2790*x^2 - 1932*x + 545, 1]\n            sage: pari.set_real_precision(n)\n            210\n        ";
  static PyObject *__pyx_pw_3gen_3gen_739algdep(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("algdep (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_As_long(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9119; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.algdep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_738algdep(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((long)__pyx_v_n));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_738algdep(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("algdep", 0);

    /* "gen.pyx":9134
 *             210
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(algdep(self.g, n))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9135
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(algdep(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def concat(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, algdep(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9119
 *         return P.new_gen(g), dif
 * 
 *     def algdep(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.algdep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9137
 *         return P.new_gen(algdep(self.g, n))
 * 
 *     def concat(self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_741concat(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_741concat(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("concat (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_740concat(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_740concat(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("concat", 0);

    /* "gen.pyx":9138
 * 
 *     def concat(self, y):
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(concat(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9139
 *     def concat(self, y):
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(concat(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9140
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(concat(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def lindep(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, concat(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9137
 *         return P.new_gen(algdep(self.g, n))
 * 
 *     def concat(self, y):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.concat", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9142
 *         return P.new_gen(concat(self.g, t0.g))
 * 
 *     def lindep(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(lindep0(self.g, flag))
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_743lindep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_743lindep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lindep (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lindep") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9142; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9142; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lindep", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9142; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.lindep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_742lindep(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_flag);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_742lindep(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lindep", 0);

    /* "gen.pyx":9143
 * 
 *     def lindep(self, long flag=0):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(lindep0(self.g, flag))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9144
 *     def lindep(self, long flag=0):
 *         pari_catch_sig_on()
 *         return P.new_gen(lindep0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def listinsert(self, obj, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, lindep0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9142
 *         return P.new_gen(concat(self.g, t0.g))
 * 
 *     def lindep(self, long flag=0):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(lindep0(self.g, flag))
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.lindep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9146
 *         return P.new_gen(lindep0(self.g, flag))
 * 
 *     def listinsert(self, obj, long n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_745listinsert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_745listinsert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_obj = 0;
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("listinsert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_obj,&__pyx_n_s_n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_obj)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("listinsert", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "listinsert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_obj = values[0];
      __pyx_v_n = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("listinsert", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.listinsert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_744listinsert(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_obj, __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_744listinsert(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("listinsert", 0);

    /* "gen.pyx":9147
 * 
 *     def listinsert(self, obj, long n):
 *         cdef gen t0 = objtogen(obj)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(listinsert(self.g, t0.g, n))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_obj)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9148
 *     def listinsert(self, obj, long n):
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(listinsert(self.g, t0.g, n))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9149
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 *         return P.new_gen(listinsert(self.g, t0.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def listput(self, obj, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, listinsert(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_n))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9146
 *         return P.new_gen(lindep0(self.g, flag))
 * 
 *     def listinsert(self, obj, long n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.listinsert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9151
 *         return P.new_gen(listinsert(self.g, t0.g, n))
 * 
 *     def listput(self, obj, long n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_747listput(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_3gen_3gen_747listput(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_obj = 0;
    long __pyx_v_n;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("listput (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_obj,&__pyx_n_s_n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_obj)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("listput", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "listput") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_obj = values[0];
      __pyx_v_n = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("listput", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.listput", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_746listput(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_obj, __pyx_v_n);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_746listput(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("listput", 0);

    /* "gen.pyx":9152
 * 
 *     def listput(self, obj, long n):
 *         cdef gen t0 = objtogen(obj)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(listput(self.g, t0.g, n))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_obj)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9153
 *     def listput(self, obj, long n):
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(listput(self.g, t0.g, n))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9154
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 *         return P.new_gen(listput(self.g, t0.g, n))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, listput(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_n))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9151
 *         return P.new_gen(listinsert(self.g, t0.g, n))
 * 
 *     def listput(self, obj, long n):             # <<<<<<<<<<<<<<
 *         cdef gen t0 = objtogen(obj)
 *         pari_catch_sig_on()
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.listput", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9158
 * 
 * 
 *     def elleisnum(self, long k, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         om.elleisnum(k, flag=0): om=[om1,om2] being a 2-component vector
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_749elleisnum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_748elleisnum[] = "\n        om.elleisnum(k, flag=0): om=[om1,om2] being a 2-component vector\n        giving a basis of a lattice L and k an even positive integer,\n        computes the numerical value of the Eisenstein series of weight k.\n        When flag is non-zero and k=4 or 6, this gives g2 or g3 with the\n        correct normalization.\n\n        INPUT:\n\n\n        -  ``om`` - gen, 2-component vector giving a basis of a\n           lattice L\n\n        -  ``k`` - int (even positive)\n\n        -  ``flag`` - int (default 0)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - numerical value of E_k\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: om = e.omega()\n            sage: om\n            [2.49021256085506, -1.97173770155165*I]\n            sage: om.elleisnum(2) # was:  -5.28864933965426\n            10.0672605281120\n            sage: om.elleisnum(4)\n            112.000000000000\n            sage: om.elleisnum(100)\n            2.15314248576078 E50\n        ";
  static PyObject *__pyx_pw_3gen_3gen_749elleisnum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_k;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elleisnum (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_k,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elleisnum") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_k = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[2]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elleisnum", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.elleisnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_748elleisnum(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_k, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_748elleisnum(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_k, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elleisnum", 0);

    /* "gen.pyx":9196
 *             2.15314248576078 E50
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(elleisnum(self.g, k, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9197
 *         """
 *         pari_catch_sig_on()
 *         return P.new_gen(elleisnum(self.g, k, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellwp(gen self, z='z', long n=20, long flag=0, unsigned long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, elleisnum(__pyx_v_self->g, __pyx_v_k, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9158
 * 
 * 
 *     def elleisnum(self, long k, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         om.elleisnum(k, flag=0): om=[om1,om2] being a 2-component vector
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.gen.elleisnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9199
 *         return P.new_gen(elleisnum(self.g, k, flag, prec_bits_to_words(precision)))
 * 
 *     def ellwp(gen self, z='z', long n=20, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the value or the series expansion of the Weierstrass
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_751ellwp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_750ellwp[] = "\n        Return the value or the series expansion of the Weierstrass\n        `P`-function at `z` on the lattice `self` (or the lattice\n        defined by the elliptic curve `self`).\n\n        INPUT:\n\n        -  ``self`` -- an elliptic curve created using ``ellinit`` or a\n           list ``[om1, om2]`` representing generators for a lattice.\n\n        -  ``z`` -- (default: 'z') a complex number or a variable name\n           (as string or PARI variable).\n\n        -  ``n`` -- (default: 20) if 'z' is a variable, compute the\n           series expansion up to at least `O(z^n)`.\n\n        -  ``flag`` -- (default = 0): If ``flag`` is 0, compute only\n           `P(z)`.  If ``flag`` is 1, compute `[P(z), P'(z)]`.\n\n        OUTPUT:\n\n        - `P(z)` (if ``flag`` is 0) or `[P(z), P'(z)]` (if ``flag`` is 1).\n           numbers\n\n        EXAMPLES:\n\n        We first define the elliptic curve X_0(11)::\n\n            sage: E = pari([0,-1,1,-10,-20]).ellinit()\n\n        Compute P(1)::\n\n            sage: E.ellwp(1)\n            13.9658695257485 + 0.E-18*I\n\n        Compute P(1+i), where i = sqrt(-1)::\n\n            sage: C.<i> = ComplexField()\n            sage: E.ellwp(pari(1+i))\n            -1.11510682565555 + 2.33419052307470*I\n            sage: E.ellwp(1+i)\n            -1.11510682565555 + 2.33419052307470*I\n\n        The series expansion, to the default `O(z^20)` precision::\n\n            sage: E.ellwp()\n            z^-2 + 31/15*z^2 + 2501/756*z^4 + 961/675*z^6 + 77531/41580*z^8 + 1202285717/928746000*z^10 + 2403461/2806650*z^12 + 30211462703/43418875500*z^14 + 3539374016033/7723451736000*z^16 + 413306031683977/1289540602350000*z^18 + O(z^20)\n\n        Compute the series for wp to lower precision::\n\n            sage: E.ellwp(n=4)\n            z^-2 + 31/15*z^2 + O(z^4)\n\n        Next we use the version where the input is generators for a\n        lattice::\n\n            sage: pari([1.2692, 0.63 + 1.45*i]).ellwp(1)\n            13.9656146936689 +"" 0.000644829272810...*I\n\n        With flag=1, compute the pair P(z) and P'(z)::\n\n            sage: E.ellwp(1, flag=1)\n            [13.9658695257485 + 0.E-18*I, 50.5619300880073 ... E-18*I]\n        ";
  static PyObject *__pyx_pw_3gen_3gen_751ellwp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    CYTHON_UNUSED long __pyx_v_n;
    long __pyx_v_flag;
    unsigned long __pyx_v_precision;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellwp (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_z,&__pyx_n_s_n,&__pyx_n_s_flag,&__pyx_n_s_precision,0};
      PyObject* values[4] = {0,0,0,0};
      values[0] = ((PyObject *)__pyx_n_s_z);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_z);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_n);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_flag);
            if (value) { values[2] = value; kw_args--; }
          }
          case  3:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_precision);
            if (value) { values[3] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellwp") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9199; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_n = __Pyx_PyInt_As_long(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9199; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)20);
      }
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9199; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[3]) {
        __pyx_v_precision = __Pyx_PyInt_As_unsigned_long(values[3]); if (unlikely((__pyx_v_precision == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9199; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((unsigned long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellwp", 0, 0, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9199; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.ellwp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_750ellwp(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_n, __pyx_v_flag, __pyx_v_precision);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_750ellwp(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_z, CYTHON_UNUSED long __pyx_v_n, long __pyx_v_flag, unsigned long __pyx_v_precision) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellwp", 0);

    /* "gen.pyx":9264
 *             [13.9658695257485 + 0.E-18*I, 50.5619300880073 ... E-18*I]
 *         """
 *         cdef gen t0 = objtogen(z)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellwp0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_z)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9265
 *         """
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellwp0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9266
 *         cdef gen t0 = objtogen(z)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellwp0(self.g, t0.g, flag, prec_bits_to_words(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellchangepoint(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellwp0(__pyx_v_self->g, __pyx_v_t0->g, __pyx_v_flag, __pyx_f_13pari_instance_prec_bits_to_words(__pyx_v_precision, 0)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9199
 *         return P.new_gen(elleisnum(self.g, k, flag, prec_bits_to_words(precision)))
 * 
 *     def ellwp(gen self, z='z', long n=20, long flag=0, unsigned long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the value or the series expansion of the Weierstrass
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellwp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9268
 *         return P.new_gen(ellwp0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellchangepoint(self, y):             # <<<<<<<<<<<<<<
 *         """
 *         self.ellchangepoint(y): change data on point or vector of points
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_753ellchangepoint(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_3gen_3gen_752ellchangepoint[] = "\n        self.ellchangepoint(y): change data on point or vector of points\n        self on an elliptic curve according to y=[u,r,s,t]\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: x = pari([1,0])\n            sage: e.ellisoncurve([1,4])\n            False\n            sage: e.ellisoncurve(x)\n            True\n            sage: f = e.ellchangecurve([1,2,3,-1])\n            sage: f[:5]   # show only first five entries\n            [6, -2, -1, 17, 8]\n            sage: x.ellchangepoint([1,2,3,-1])\n            [-1, 4]\n            sage: f.ellisoncurve([-1,4])\n            True\n        ";
  static PyObject *__pyx_pw_3gen_3gen_753ellchangepoint(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellchangepoint (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_3gen_752ellchangepoint(((struct __pyx_obj_3gen_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_752ellchangepoint(struct __pyx_obj_3gen_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    struct __pyx_obj_3gen_gen *__pyx_v_t0 = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellchangepoint", 0);

    /* "gen.pyx":9289
 *             True
 *         """
 *         cdef gen t0 = objtogen(y)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(ellchangepoint(self.g, t0.g))
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_y)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_t0 = ((struct __pyx_obj_3gen_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9290
 *         """
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellchangepoint(self.g, t0.g))
 * 
 */
    __pyx_t_2 = pari_catch_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9291
 *         cdef gen t0 = objtogen(y)
 *         pari_catch_sig_on()
 *         return P.new_gen(ellchangepoint(self.g, t0.g))             # <<<<<<<<<<<<<<
 * 
 *     def debug(gen self, long depth = -1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, ellchangepoint(__pyx_v_self->g, __pyx_v_t0->g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9268
 *         return P.new_gen(ellwp0(self.g, t0.g, flag, prec_bits_to_words(precision)))
 * 
 *     def ellchangepoint(self, y):             # <<<<<<<<<<<<<<
 *         """
 *         self.ellchangepoint(y): change data on point or vector of points
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("gen.gen.ellchangepoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t0);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9293
 *         return P.new_gen(ellchangepoint(self.g, t0.g))
 * 
 *     def debug(gen self, long depth = -1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Show the internal structure of self (like the ``\x`` command in gp).
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_3gen_755debug(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_3gen_754debug[] = "\n        Show the internal structure of self (like the ``\\x`` command in gp).\n\n        EXAMPLE::\n\n            sage: pari('[1/2, 1.0*I]').debug()  # random addresses\n            [&=0000000004c5f010] VEC(lg=3):2200000000000003 0000000004c5eff8 0000000004c5efb0\n              1st component = [&=0000000004c5eff8] FRAC(lg=3):0800000000000003 0000000004c5efe0 0000000004c5efc8\n                num = [&=0000000004c5efe0] INT(lg=3):0200000000000003 (+,lgefint=3):4000000000000003 0000000000000001\n                den = [&=0000000004c5efc8] INT(lg=3):0200000000000003 (+,lgefint=3):4000000000000003 0000000000000002\n              2nd component = [&=0000000004c5efb0] COMPLEX(lg=3):0c00000000000003 00007fae8a2eb840 0000000004c5ef90\n                real = gen_0\n                imag = [&=0000000004c5ef90] REAL(lg=4):0400000000000004 (+,expo=0):6000000000000000 8000000000000000 0000000000000000\n        ";
  static PyObject *__pyx_pw_3gen_3gen_755debug(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_depth;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("debug (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_depth,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_depth);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "debug") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_depth = __Pyx_PyInt_As_long(values[0]); if (unlikely((__pyx_v_depth == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_depth = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("debug", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9293; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.gen.debug", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_3gen_754debug(((struct __pyx_obj_3gen_gen *)__pyx_v_self), __pyx_v_depth);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_3gen_754debug(struct __pyx_obj_3gen_gen *__pyx_v_self, long __pyx_v_depth) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("debug", 0);

    /* "gen.pyx":9308
 *                 imag = [&=0000000004c5ef90] REAL(lg=4):0400000000000004 (+,expo=0):6000000000000000 8000000000000000 0000000000000000
 *         """
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         dbgGEN(self.g, depth)
 *         pari_catch_sig_off()
 */
    __pyx_t_1 = pari_catch_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "gen.pyx":9309
 *         """
 *         pari_catch_sig_on()
 *         dbgGEN(self.g, depth)             # <<<<<<<<<<<<<<
 *         pari_catch_sig_off()
 *         return
 */
    dbgGEN(__pyx_v_self->g, __pyx_v_depth);

    /* "gen.pyx":9310
 *         pari_catch_sig_on()
 *         dbgGEN(self.g, depth)
 *         pari_catch_sig_off()             # <<<<<<<<<<<<<<
 *         return
 * 
 */
    pari_catch_sig_off();

    /* "gen.pyx":9311
 *         dbgGEN(self.g, depth)
 *         pari_catch_sig_off()
 *         return             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    /* "gen.pyx":9293
 *         return P.new_gen(ellchangepoint(self.g, t0.g))
 * 
 *     def debug(gen self, long depth = -1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Show the internal structure of self (like the ``\x`` command in gp).
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_AddTraceback("gen.gen.debug", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9314
 * 
 * 
 * def init_pari_stack(s=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Deprecated, use ``pari.allocatemem()`` instead.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_1init_pari_stack(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_3gen_init_pari_stack[] = "\n    Deprecated, use ``pari.allocatemem()`` instead.\n\n    EXAMPLES::\n\n        sage: from gen import init_pari_stack\n        sage: init_pari_stack()\n        doctest:...: DeprecationWarning: init_pari_stack() is deprecated; use pari.allocatemem() instead.\n        See http://trac.sagemath.org/10018 for details.\n        sage: pari.stacksize()\n        8000000\n    ";
  static PyMethodDef __pyx_mdef_3gen_1init_pari_stack = {"init_pari_stack", (PyCFunction)__pyx_pw_3gen_1init_pari_stack, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_init_pari_stack};
  static PyObject *__pyx_pw_3gen_1init_pari_stack(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("init_pari_stack (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_s,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_8000000);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s_s);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "init_pari_stack") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_s = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("init_pari_stack", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("gen.init_pari_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_3gen_init_pari_stack(__pyx_self, __pyx_v_s);

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_init_pari_stack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_s) {
    PyObject *__pyx_v_deprecation = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("init_pari_stack", 0);

    /* "gen.pyx":9327
 *         8000000
 *     """
 *     from sage.misc.superseded import deprecation             # <<<<<<<<<<<<<<
 *     deprecation(10018, 'init_pari_stack() is deprecated; use pari.allocatemem() instead.')
 *     P.allocatemem(s, silent=True)
 */
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_n_s_deprecation);
    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_deprecation);
    __Pyx_GIVEREF(__pyx_n_s_deprecation);
    __pyx_t_2 = __Pyx_Import(__pyx_n_s_sage_misc_superseded, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_deprecation); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_t_1);
    __pyx_v_deprecation = __pyx_t_1;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "gen.pyx":9328
 *     """
 *     from sage.misc.superseded import deprecation
 *     deprecation(10018, 'init_pari_stack() is deprecated; use pari.allocatemem() instead.')             # <<<<<<<<<<<<<<
 *     P.allocatemem(s, silent=True)
 * 
 */
    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_v_deprecation, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "gen.pyx":9329
 *     from sage.misc.superseded import deprecation
 *     deprecation(10018, 'init_pari_stack() is deprecated; use pari.allocatemem() instead.')
 *     P.allocatemem(s, silent=True)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_3gen_P), __pyx_n_s_allocatemem); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_silent, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "gen.pyx":9314
 * 
 * 
 * def init_pari_stack(s=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Deprecated, use ``pari.allocatemem()`` instead.
 */

    /* function exit code */
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("gen.init_pari_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_deprecation);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9332
 * 
 * 
 * cdef gen objtogen(s):             # <<<<<<<<<<<<<<
 *     """Convert any Sage/Python object to a PARI gen"""
 *     cdef GEN g
 */

  static struct __pyx_obj_3gen_gen *__pyx_f_3gen_objtogen(PyObject *__pyx_v_s) {
    GEN __pyx_v_g;
    Py_ssize_t __pyx_v_length;
    Py_ssize_t __pyx_v_i;
    mpz_t __pyx_v_mpz_int;
    struct __pyx_obj_3gen_gen *__pyx_v_v = 0;
    char *__pyx_v_c_string;
    PyObject *__pyx_v_ustring = 0;
    struct __pyx_obj_3gen_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    PyObject *__pyx_t_8 = NULL;
    int __pyx_t_9;
    char *__pyx_t_10;
    double __pyx_t_11;
    PyObject *__pyx_t_12 = NULL;
    PyObject *__pyx_t_13 = NULL;
    int __pyx_t_14;
    Py_ssize_t __pyx_t_15;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("objtogen", 0);

    /* "gen.pyx":9341
 *     cdef bytes ustring
 * 
 *     if isinstance(s, gen):             # <<<<<<<<<<<<<<
 *         return s
 *     try:
 */
    __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_s, ((PyObject*)__pyx_ptype_3gen_gen)); 
    __pyx_t_2 = (__pyx_t_1 != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9342
 * 
 *     if isinstance(s, gen):
 *         return s             # <<<<<<<<<<<<<<
 *     try:
 *         return s._pari_()
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      if (!(likely(((__pyx_v_s) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_s, __pyx_ptype_3gen_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_INCREF(__pyx_v_s);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_v_s);
      goto __pyx_L0;
    }

    /* "gen.pyx":9343
 *     if isinstance(s, gen):
 *         return s
 *     try:             # <<<<<<<<<<<<<<
 *         return s._pari_()
 *     except AttributeError:
 */
    {
      __Pyx_ExceptionSave(&__pyx_t_3, &__pyx_t_4, &__pyx_t_5);
      __Pyx_XGOTREF(__pyx_t_3);
      __Pyx_XGOTREF(__pyx_t_4);
      __Pyx_XGOTREF(__pyx_t_5);
      /*try:*/ {

        /* "gen.pyx":9344
 *         return s
 *     try:
 *         return s._pari_()             # <<<<<<<<<<<<<<
 *     except AttributeError:
 *         pass
 */
        __Pyx_XDECREF(((PyObject *)__pyx_r));
        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_pari_2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9344; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_7))) {
          __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
          if (likely(__pyx_t_8)) {
            PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
            __Pyx_INCREF(__pyx_t_8);
            __Pyx_INCREF(function);
            __Pyx_DECREF_SET(__pyx_t_7, function);
          }
        }
        if (__pyx_t_8) {
          __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9344; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
          __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        } else {
          __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_7); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9344; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        }
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_3gen_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9344; __pyx_clineno = __LINE__; goto __pyx_L4_error;}
        __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_6);
        __pyx_t_6 = 0;
        goto __pyx_L8_try_return;
      }
      __pyx_L4_error:;
      __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "gen.pyx":9345
 *     try:
 *         return s._pari_()
 *     except AttributeError:             # <<<<<<<<<<<<<<
 *         pass
 * 
 */
      __pyx_t_9 = PyErr_ExceptionMatches(__pyx_builtin_AttributeError);
      if (__pyx_t_9) {
        PyErr_Restore(0,0,0);
        goto __pyx_L5_exception_handled;
      }
      goto __pyx_L6_except_error;
      __pyx_L6_except_error:;
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_XGIVEREF(__pyx_t_4);
      __Pyx_XGIVEREF(__pyx_t_5);
      __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      goto __pyx_L1_error;
      __pyx_L8_try_return:;
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_XGIVEREF(__pyx_t_4);
      __Pyx_XGIVEREF(__pyx_t_5);
      __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_4, __pyx_t_5);
      goto __pyx_L0;
      __pyx_L5_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_XGIVEREF(__pyx_t_4);
      __Pyx_XGIVEREF(__pyx_t_5);
      __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_4, __pyx_t_5);
    }

    /* "gen.pyx":9350
 *     # Check basic Python types. Start with strings, which are a very
 *     # common case.
 *     if PyString_Check(s):             # <<<<<<<<<<<<<<
 * 
 *         pari_catch_sig_on()
 */
    __pyx_t_2 = (PyString_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9352
 *     if PyString_Check(s):
 * 
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         ustring = (s).encode("utf-8")
 *         c_string = ustring
 */
      __pyx_t_9 = pari_catch_sig_on(); if (unlikely(__pyx_t_9 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9353
 * 
 *         pari_catch_sig_on()
 *         ustring = (s).encode("utf-8")             # <<<<<<<<<<<<<<
 *         c_string = ustring
 *         g = gp_read_str(c_string)
 */
      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_encode); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (!(likely(PyBytes_CheckExact(__pyx_t_7))||((__pyx_t_7) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_7)->tp_name), 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v_ustring = ((PyObject*)__pyx_t_7);
      __pyx_t_7 = 0;

      /* "gen.pyx":9354
 *         pari_catch_sig_on()
 *         ustring = (s).encode("utf-8")
 *         c_string = ustring             # <<<<<<<<<<<<<<
 *         g = gp_read_str(c_string)
 *         if g == gnil:
 */
      __pyx_t_10 = __Pyx_PyObject_AsString(__pyx_v_ustring); if (unlikely((!__pyx_t_10) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v_c_string = __pyx_t_10;

      /* "gen.pyx":9355
 *         ustring = (s).encode("utf-8")
 *         c_string = ustring
 *         g = gp_read_str(c_string)             # <<<<<<<<<<<<<<
 *         if g == gnil:
 *             P.clear_stack()
 */
      __pyx_v_g = gp_read_str(__pyx_v_c_string);

      /* "gen.pyx":9356
 *         c_string = ustring
 *         g = gp_read_str(c_string)
 *         if g == gnil:             # <<<<<<<<<<<<<<
 *             P.clear_stack()
 *             return None
 */
      __pyx_t_2 = ((__pyx_v_g == gnil) != 0);
      if (__pyx_t_2) {

        /* "gen.pyx":9357
 *         g = gp_read_str(c_string)
 *         if g == gnil:
 *             P.clear_stack()             # <<<<<<<<<<<<<<
 *             return None
 *         return P.new_gen(g)
 */
        ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->clear_stack(__pyx_v_3gen_P);

        /* "gen.pyx":9358
 *         if g == gnil:
 *             P.clear_stack()
 *             return None             # <<<<<<<<<<<<<<
 *         return P.new_gen(g)
 *     if PyInt_Check(s):
 */
        __Pyx_XDECREF(((PyObject *)__pyx_r));
        __Pyx_INCREF(Py_None);
        __pyx_r = ((struct __pyx_obj_3gen_gen *)Py_None);
        goto __pyx_L0;
      }

      /* "gen.pyx":9359
 *             P.clear_stack()
 *             return None
 *         return P.new_gen(g)             # <<<<<<<<<<<<<<
 *     if PyInt_Check(s):
 *         pari_catch_sig_on()
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_g)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9360
 *             return None
 *         return P.new_gen(g)
 *     if PyInt_Check(s):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(stoi(PyInt_AS_LONG(s)))
 */
    __pyx_t_2 = (PyInt_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9361
 *         return P.new_gen(g)
 *     if PyInt_Check(s):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(stoi(PyInt_AS_LONG(s)))
 *     if PyBool_Check(s):
 */
      __pyx_t_9 = pari_catch_sig_on(); if (unlikely(__pyx_t_9 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9362
 *     if PyInt_Check(s):
 *         pari_catch_sig_on()
 *         return P.new_gen(stoi(PyInt_AS_LONG(s)))             # <<<<<<<<<<<<<<
 *     if PyBool_Check(s):
 *         return P.PARI_ONE if s else P.PARI_ZERO
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, stoi(PyInt_AS_LONG(__pyx_v_s)))); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9363
 *         pari_catch_sig_on()
 *         return P.new_gen(stoi(PyInt_AS_LONG(s)))
 *     if PyBool_Check(s):             # <<<<<<<<<<<<<<
 *         return P.PARI_ONE if s else P.PARI_ZERO
 *     if PyLong_Check(s):
 */
    __pyx_t_2 = (PyBool_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9364
 *         return P.new_gen(stoi(PyInt_AS_LONG(s)))
 *     if PyBool_Check(s):
 *         return P.PARI_ONE if s else P.PARI_ZERO             # <<<<<<<<<<<<<<
 *     if PyLong_Check(s):
 *         pari_catch_sig_on()
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_s); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__pyx_t_2) {
        __Pyx_INCREF(((PyObject *)__pyx_v_3gen_P->PARI_ONE));
        __pyx_t_7 = ((PyObject *)__pyx_v_3gen_P->PARI_ONE);
      } else {
        __Pyx_INCREF(((PyObject *)__pyx_v_3gen_P->PARI_ZERO));
        __pyx_t_7 = ((PyObject *)__pyx_v_3gen_P->PARI_ZERO);
      }
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9365
 *     if PyBool_Check(s):
 *         return P.PARI_ONE if s else P.PARI_ZERO
 *     if PyLong_Check(s):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         mpz_init(mpz_int)
 */
    __pyx_t_2 = (PyLong_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9366
 *         return P.PARI_ONE if s else P.PARI_ZERO
 *     if PyLong_Check(s):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         mpz_init(mpz_int)
 *         mpz_set_pylong(mpz_int, s)
 */
      __pyx_t_9 = pari_catch_sig_on(); if (unlikely(__pyx_t_9 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9367
 *     if PyLong_Check(s):
 *         pari_catch_sig_on()
 *         mpz_init(mpz_int)             # <<<<<<<<<<<<<<
 *         mpz_set_pylong(mpz_int, s)
 *         g = P._new_GEN_from_mpz_t(mpz_int)
 */
      mpz_init(__pyx_v_mpz_int);

      /* "gen.pyx":9368
 *         pari_catch_sig_on()
 *         mpz_init(mpz_int)
 *         mpz_set_pylong(mpz_int, s)             # <<<<<<<<<<<<<<
 *         g = P._new_GEN_from_mpz_t(mpz_int)
 *         mpz_clear(mpz_int)
 */
      __pyx_t_9 = mpz_set_pylong(__pyx_v_mpz_int, __pyx_v_s); if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9369
 *         mpz_init(mpz_int)
 *         mpz_set_pylong(mpz_int, s)
 *         g = P._new_GEN_from_mpz_t(mpz_int)             # <<<<<<<<<<<<<<
 *         mpz_clear(mpz_int)
 *         return P.new_gen(g)
 */
      __pyx_v_g = ((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->_new_GEN_from_mpz_t(__pyx_v_3gen_P, __pyx_v_mpz_int);

      /* "gen.pyx":9370
 *         mpz_set_pylong(mpz_int, s)
 *         g = P._new_GEN_from_mpz_t(mpz_int)
 *         mpz_clear(mpz_int)             # <<<<<<<<<<<<<<
 *         return P.new_gen(g)
 *     if PyFloat_Check(s):
 */
      mpz_clear(__pyx_v_mpz_int);

      /* "gen.pyx":9371
 *         g = P._new_GEN_from_mpz_t(mpz_int)
 *         mpz_clear(mpz_int)
 *         return P.new_gen(g)             # <<<<<<<<<<<<<<
 *     if PyFloat_Check(s):
 *         pari_catch_sig_on()
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_g)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9372
 *         mpz_clear(mpz_int)
 *         return P.new_gen(g)
 *     if PyFloat_Check(s):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         return P.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 */
    __pyx_t_2 = (PyFloat_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9373
 *         return P.new_gen(g)
 *     if PyFloat_Check(s):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *     if PyComplex_Check(s):
 */
      __pyx_t_9 = pari_catch_sig_on(); if (unlikely(__pyx_t_9 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9374
 *     if PyFloat_Check(s):
 *         pari_catch_sig_on()
 *         return P.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))             # <<<<<<<<<<<<<<
 *     if PyComplex_Check(s):
 *         pari_catch_sig_on()
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, dbltor(PyFloat_AS_DOUBLE(__pyx_v_s)))); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9374; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9375
 *         pari_catch_sig_on()
 *         return P.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *     if PyComplex_Check(s):             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         g = cgetg(3, t_COMPLEX)
 */
    __pyx_t_2 = (PyComplex_Check(__pyx_v_s) != 0);
    if (__pyx_t_2) {

      /* "gen.pyx":9376
 *         return P.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *     if PyComplex_Check(s):
 *         pari_catch_sig_on()             # <<<<<<<<<<<<<<
 *         g = cgetg(3, t_COMPLEX)
 *         set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 */
      __pyx_t_9 = pari_catch_sig_on(); if (unlikely(__pyx_t_9 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "gen.pyx":9377
 *     if PyComplex_Check(s):
 *         pari_catch_sig_on()
 *         g = cgetg(3, t_COMPLEX)             # <<<<<<<<<<<<<<
 *         set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *         set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 */
      __pyx_v_g = cgetg(3, t_COMPLEX);

      /* "gen.pyx":9378
 *         pari_catch_sig_on()
 *         g = cgetg(3, t_COMPLEX)
 *         set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))             # <<<<<<<<<<<<<<
 *         set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 *         return P.new_gen(g)
 */
      __pyx_t_11 = PyComplex_RealAsDouble(__pyx_v_s); if (unlikely(__pyx_t_11 == -1.0 && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      set_gel(__pyx_v_g, 1, dbltor(__pyx_t_11));

      /* "gen.pyx":9379
 *         g = cgetg(3, t_COMPLEX)
 *         set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *         set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(g)
 * 
 */
      __pyx_t_11 = PyComplex_ImagAsDouble(__pyx_v_s); if (unlikely(__pyx_t_11 == -1.0 && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      set_gel(__pyx_v_g, 2, dbltor(__pyx_t_11));

      /* "gen.pyx":9380
 *         set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *         set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 *         return P.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->new_gen(__pyx_v_3gen_P, __pyx_v_g)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L0;
    }

    /* "gen.pyx":9382
 *         return P.new_gen(g)
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,             # <<<<<<<<<<<<<<
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)
 */
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_types); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_ListType); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_types); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_XRangeType); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "gen.pyx":9383
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,
 *                         types.TupleType, types.GeneratorType)):             # <<<<<<<<<<<<<<
 *         length = len(s)
 *         v = P._empty_vector(length)
 */
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_types); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_TupleType); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_12);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_types); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_GeneratorType); if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_13);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

    /* "gen.pyx":9382
 *         return P.new_gen(g)
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,             # <<<<<<<<<<<<<<
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)
 */
    __pyx_t_1 = PyObject_IsInstance(__pyx_v_s, __pyx_t_6); 
    __pyx_t_14 = (__pyx_t_1 != 0);
    if (!__pyx_t_14) {
    } else {
      __pyx_t_2 = __pyx_t_14;
      goto __pyx_L20_bool_binop_done;
    }
    __pyx_t_14 = PyObject_IsInstance(__pyx_v_s, __pyx_t_8); 
    __pyx_t_1 = (__pyx_t_14 != 0);
    if (!__pyx_t_1) {
    } else {
      __pyx_t_2 = __pyx_t_1;
      goto __pyx_L20_bool_binop_done;
    }

    /* "gen.pyx":9383
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,
 *                         types.TupleType, types.GeneratorType)):             # <<<<<<<<<<<<<<
 *         length = len(s)
 *         v = P._empty_vector(length)
 */
    __pyx_t_1 = PyObject_IsInstance(__pyx_v_s, __pyx_t_12); 
    __pyx_t_14 = (__pyx_t_1 != 0);
    if (!__pyx_t_14) {
    } else {
      __pyx_t_2 = __pyx_t_14;
      goto __pyx_L20_bool_binop_done;
    }

    /* "gen.pyx":9382
 *         return P.new_gen(g)
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,             # <<<<<<<<<<<<<<
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)
 */
    __pyx_t_14 = PyObject_IsInstance(__pyx_v_s, __pyx_t_13); 

    /* "gen.pyx":9383
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,
 *                         types.TupleType, types.GeneratorType)):             # <<<<<<<<<<<<<<
 *         length = len(s)
 *         v = P._empty_vector(length)
 */
    __pyx_t_1 = (__pyx_t_14 != 0);
    __pyx_t_2 = __pyx_t_1;
    __pyx_L20_bool_binop_done:;
    __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

    /* "gen.pyx":9382
 *         return P.new_gen(g)
 * 
 *     if isinstance(s, (types.ListType, types.XRangeType,             # <<<<<<<<<<<<<<
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)
 */
    __pyx_t_1 = (__pyx_t_2 != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":9384
 *     if isinstance(s, (types.ListType, types.XRangeType,
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)             # <<<<<<<<<<<<<<
 *         v = P._empty_vector(length)
 *         for i from 0 <= i < length:
 */
      __pyx_t_15 = PyObject_Length(__pyx_v_s); if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v_length = __pyx_t_15;

      /* "gen.pyx":9385
 *                         types.TupleType, types.GeneratorType)):
 *         length = len(s)
 *         v = P._empty_vector(length)             # <<<<<<<<<<<<<<
 *         for i from 0 <= i < length:
 *             v[i] = objtogen(s[i])
 */
      __pyx_t_6 = ((PyObject *)((struct __pyx_vtabstruct_13pari_instance_PariInstance *)__pyx_v_3gen_P->__pyx_vtab)->_empty_vector(__pyx_v_3gen_P, __pyx_v_length)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_v_v = ((struct __pyx_obj_3gen_gen *)__pyx_t_6);
      __pyx_t_6 = 0;

      /* "gen.pyx":9386
 *         length = len(s)
 *         v = P._empty_vector(length)
 *         for i from 0 <= i < length:             # <<<<<<<<<<<<<<
 *             v[i] = objtogen(s[i])
 *         return v
 */
      __pyx_t_15 = __pyx_v_length;
      for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_15; __pyx_v_i++) {

        /* "gen.pyx":9387
 *         v = P._empty_vector(length)
 *         for i from 0 <= i < length:
 *             v[i] = objtogen(s[i])             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
        __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_s, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9387; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_8 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_t_6)); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(__Pyx_SetItemInt(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_t_8, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      }

      /* "gen.pyx":9388
 *         for i from 0 <= i < length:
 *             v[i] = objtogen(s[i])
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     # Simply use the string representation
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __Pyx_INCREF(((PyObject *)__pyx_v_v));
      __pyx_r = __pyx_v_v;
      goto __pyx_L0;
    }

    /* "gen.pyx":9391
 * 
 *     # Simply use the string representation
 *     return objtogen(str(s))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_t_6)); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9391; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = ((struct __pyx_obj_3gen_gen *)__pyx_t_8);
    __pyx_t_8 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9332
 * 
 * 
 * cdef gen objtogen(s):             # <<<<<<<<<<<<<<
 *     """Convert any Sage/Python object to a PARI gen"""
 *     cdef GEN g
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_XDECREF(__pyx_t_12);
    __Pyx_XDECREF(__pyx_t_13);
    __Pyx_AddTraceback("gen.objtogen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XDECREF(__pyx_v_ustring);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9394
 * 
 * 
 * cdef GEN _Vec_append(GEN v, GEN a, long n):             # <<<<<<<<<<<<<<
 *     """
 *     This implements appending zeros (or another constant GEN ``a``) to
 */

  static GEN __pyx_f_3gen__Vec_append(GEN __pyx_v_v, GEN __pyx_v_a, long __pyx_v_n) {
    long __pyx_v_lenv;
    GEN __pyx_v_w;
    long __pyx_v_i;
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    __Pyx_RefNannySetupContext("_Vec_append", 0);

    /* "gen.pyx":9416
 *     A GEN of the same type as ``v``.
 *     """
 *     cdef long lenv = lg(v)-1             # <<<<<<<<<<<<<<
 *     cdef GEN w
 *     cdef long i
 */
    __pyx_v_lenv = (lg(__pyx_v_v) - 1);

    /* "gen.pyx":9420
 *     cdef long i
 *     # Do we need to extend the vector with zeros?
 *     if n > lenv:             # <<<<<<<<<<<<<<
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 */
    __pyx_t_1 = ((__pyx_v_n > __pyx_v_lenv) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":9421
 *     # Do we need to extend the vector with zeros?
 *     if n > lenv:
 *         w = cgetg(n+1, typ(v))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))
 */
      __pyx_v_w = cgetg((__pyx_v_n + 1), typ(__pyx_v_v));

      /* "gen.pyx":9422
 *     if n > lenv:
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 */
      __pyx_t_2 = __pyx_v_lenv;
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "gen.pyx":9423
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)
 */
        set_gel(__pyx_v_w, __pyx_v_i, gel(__pyx_v_v, __pyx_v_i));
      }

      /* "gen.pyx":9424
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i+lenv, a)
 *         return w
 */
      __pyx_t_2 = (__pyx_v_n - __pyx_v_lenv);
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "gen.pyx":9425
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)             # <<<<<<<<<<<<<<
 *         return w
 *     elif n < -lenv:
 */
        set_gel(__pyx_v_w, (__pyx_v_i + __pyx_v_lenv), __pyx_v_a);
      }

      /* "gen.pyx":9426
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)
 *         return w             # <<<<<<<<<<<<<<
 *     elif n < -lenv:
 *         n = -n  # Make n positive
 */
      __pyx_r = __pyx_v_w;
      goto __pyx_L0;
    }

    /* "gen.pyx":9427
 *             set_gel(w, i+lenv, a)
 *         return w
 *     elif n < -lenv:             # <<<<<<<<<<<<<<
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))
 */
    __pyx_t_1 = ((__pyx_v_n < (-__pyx_v_lenv)) != 0);
    if (__pyx_t_1) {

      /* "gen.pyx":9428
 *         return w
 *     elif n < -lenv:
 *         n = -n  # Make n positive             # <<<<<<<<<<<<<<
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 */
      __pyx_v_n = (-__pyx_v_n);

      /* "gen.pyx":9429
 *     elif n < -lenv:
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))
 */
      __pyx_v_w = cgetg((__pyx_v_n + 1), typ(__pyx_v_v));

      /* "gen.pyx":9430
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 */
      __pyx_t_2 = __pyx_v_lenv;
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "gen.pyx":9431
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)
 */
        set_gel(__pyx_v_w, (__pyx_v_i + (__pyx_v_n - __pyx_v_lenv)), gel(__pyx_v_v, __pyx_v_i));
      }

      /* "gen.pyx":9432
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i, a)
 *         return w
 */
      __pyx_t_2 = (__pyx_v_n - __pyx_v_lenv);
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "gen.pyx":9433
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)             # <<<<<<<<<<<<<<
 *         return w
 *     else:
 */
        set_gel(__pyx_v_w, __pyx_v_i, __pyx_v_a);
      }

      /* "gen.pyx":9434
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)
 *         return w             # <<<<<<<<<<<<<<
 *     else:
 *         return v
 */
      __pyx_r = __pyx_v_w;
      goto __pyx_L0;
    }
    /*else*/ {

      /* "gen.pyx":9436
 *         return w
 *     else:
 *         return v             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_r = __pyx_v_v;
      goto __pyx_L0;
    }

    /* "gen.pyx":9394
 * 
 * 
 * cdef GEN _Vec_append(GEN v, GEN a, long n):             # <<<<<<<<<<<<<<
 *     """
 *     This implements appending zeros (or another constant GEN ``a``) to
 */

    /* function exit code */
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9445
 *     Error raised by PARI
 *     """
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_9PariError_1errnum(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_3gen_9PariError_errnum[] = "\n        Return the PARI error number corresponding to this exception.\n\n        EXAMPLES::\n\n            sage: try:\n            ....:     pari('1/0')\n            ....: except PariError as err:\n            ....:     print err.errnum()\n            27\n        ";
  static PyMethodDef __pyx_mdef_3gen_9PariError_1errnum = {"errnum", (PyCFunction)__pyx_pw_3gen_9PariError_1errnum, METH_O, __pyx_doc_3gen_9PariError_errnum};
  static PyObject *__pyx_pw_3gen_9PariError_1errnum(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("errnum (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_9PariError_errnum(__pyx_self, ((PyObject *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_9PariError_errnum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("errnum", 0);

    /* "gen.pyx":9457
 *             27
 *         """
 *         return self.args[0]             # <<<<<<<<<<<<<<
 * 
 *     def errtext(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9457; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9445
 *     Error raised by PARI
 *     """
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.PariError.errnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9459
 *         return self.args[0]
 * 
 *     def errtext(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the message output by PARI when this error occurred.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_9PariError_3errtext(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_3gen_9PariError_2errtext[] = "\n        Return the message output by PARI when this error occurred.\n\n        EXAMPLE::\n\n            sage: try:\n            ....:     pari('pi()')\n            ....: except PariError as e:\n            ....:     print e.errtext()\n            ....:\n              ***   at top-level: pi()\n              ***                 ^----\n              ***   not a function in function call\n\n        ";
  static PyMethodDef __pyx_mdef_3gen_9PariError_3errtext = {"errtext", (PyCFunction)__pyx_pw_3gen_9PariError_3errtext, METH_O, __pyx_doc_3gen_9PariError_2errtext};
  static PyObject *__pyx_pw_3gen_9PariError_3errtext(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("errtext (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_9PariError_2errtext(__pyx_self, ((PyObject *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_9PariError_2errtext(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("errtext", 0);

    /* "gen.pyx":9475
 * 
 *         """
 *         return self.args[1]             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9475; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9459
 *         return self.args[0]
 * 
 *     def errtext(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the message output by PARI when this error occurred.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("gen.PariError.errtext", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9477
 *         return self.args[1]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_9PariError_5__repr__(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_3gen_9PariError_4__repr__[] = "\n        TESTS::\n\n            sage: PariError(11)\n            PariError(11)\n        ";
  static PyMethodDef __pyx_mdef_3gen_9PariError_5__repr__ = {"__repr__", (PyCFunction)__pyx_pw_3gen_9PariError_5__repr__, METH_O, __pyx_doc_3gen_9PariError_4__repr__};
  static PyObject *__pyx_pw_3gen_9PariError_5__repr__(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_9PariError_4__repr__(__pyx_self, ((PyObject *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_9PariError_4__repr__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__repr__", 0);

    /* "gen.pyx":9484
 *             PariError(11)
 *         """
 *         return "PariError(%d)"%self.errnum()             # <<<<<<<<<<<<<<
 * 
 *     def __str__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_errnum); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyString_Format(__pyx_kp_s_PariError_d, __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9477
 *         return self.args[1]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.PariError.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9486
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a suitable message for displaying this exception.
 */

  /* Python wrapper */
  static PyObject *__pyx_pw_3gen_9PariError_7__str__(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_3gen_9PariError_6__str__[] = "\n        Return a suitable message for displaying this exception.\n\n        This is the last line of ``self.errtext()``, with the leading\n        ``\"  ***   \"`` and trailing periods and colons (if any) removed.\n        An exception is syntax errors, where the \"syntax error\" line is\n        shown.\n\n        EXAMPLES::\n\n            sage: try:\n            ....:     pari('1/0')\n            ....: except PariError as err:\n            ....:     print err\n            _/_: division by zero\n\n        A syntax error::\n\n            sage: pari('!@#$%^&*()')\n            Traceback (most recent call last):\n            ...\n            PariError: syntax error, unexpected $undefined: !@#$%^&*()\n        ";
  static PyMethodDef __pyx_mdef_3gen_9PariError_7__str__ = {"__str__", (PyCFunction)__pyx_pw_3gen_9PariError_7__str__, METH_O, __pyx_doc_3gen_9PariError_6__str__};
  static PyObject *__pyx_pw_3gen_9PariError_7__str__(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
    __pyx_r = __pyx_pf_3gen_9PariError_6__str__(__pyx_self, ((PyObject *)__pyx_v_self));

    /* function exit code */
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_3gen_9PariError_6__str__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_v_lines = NULL;
    PyObject *__pyx_v_line = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    Py_ssize_t __pyx_t_5;
    PyObject *(*__pyx_t_6)(PyObject *);
    int __pyx_t_7;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__str__", 0);

    /* "gen.pyx":9510
 *             PariError: syntax error, unexpected $undefined: !@#$%^&*()
 *         """
 *         lines = self.errtext().split('\n')             # <<<<<<<<<<<<<<
 *         if self.errnum() == e_SYNTAX:
 *             for line in lines:
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_errtext); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_lines = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "gen.pyx":9511
 *         """
 *         lines = self.errtext().split('\n')
 *         if self.errnum() == e_SYNTAX:             # <<<<<<<<<<<<<<
 *             for line in lines:
 *                 if "syntax error" in line:
 */
    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_errnum); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyInt_From_int(e_SYNTAX); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_4) {

      /* "gen.pyx":9512
 *         lines = self.errtext().split('\n')
 *         if self.errnum() == e_SYNTAX:
 *             for line in lines:             # <<<<<<<<<<<<<<
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")
 */
      if (likely(PyList_CheckExact(__pyx_v_lines)) || PyTuple_CheckExact(__pyx_v_lines)) {
        __pyx_t_3 = __pyx_v_lines; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
        __pyx_t_6 = NULL;
      } else {
        __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_v_lines); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      for (;;) {
        if (likely(!__pyx_t_6)) {
          if (likely(PyList_CheckExact(__pyx_t_3))) {
            if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          } else {
            if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_2); __pyx_t_5++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #else
            __pyx_t_2 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_6(__pyx_t_3);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = PyErr_Occurred();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_2);
        }
        __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_2);
        __pyx_t_2 = 0;

        /* "gen.pyx":9513
 *         if self.errnum() == e_SYNTAX:
 *             for line in lines:
 *                 if "syntax error" in line:             # <<<<<<<<<<<<<<
 *                     return line.lstrip(" *").rstrip(" .:")
 *         return lines[-1].lstrip(" *").rstrip(" .:")
 */
        __pyx_t_4 = (__Pyx_PySequence_Contains(__pyx_kp_s_syntax_error, __pyx_v_line, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_t_7 = (__pyx_t_4 != 0);
        if (__pyx_t_7) {

          /* "gen.pyx":9514
 *             for line in lines:
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")             # <<<<<<<<<<<<<<
 *         return lines[-1].lstrip(" *").rstrip(" .:")
 * 
 */
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_lstrip); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_2);
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_r = __pyx_t_1;
          __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          goto __pyx_L0;
        }

        /* "gen.pyx":9512
 *         lines = self.errtext().split('\n')
 *         if self.errnum() == e_SYNTAX:
 *             for line in lines:             # <<<<<<<<<<<<<<
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")
 */
      }
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "gen.pyx":9515
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")
 *         return lines[-1].lstrip(" *").rstrip(" .:")             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_lines, -1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_lstrip); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    /* "gen.pyx":9486
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a suitable message for displaying this exception.
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("gen.PariError.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_lines);
    __Pyx_XDECREF(__pyx_v_line);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9518
 * 
 * 
 * cdef _factor_int_when_pari_factor_failed(x, failed_factorization):             # <<<<<<<<<<<<<<
 *     """
 *     This is called by factor when PARI's factor tried to factor, got
 */

  static PyObject *__pyx_f_3gen__factor_int_when_pari_factor_failed(CYTHON_UNUSED PyObject *__pyx_v_x, PyObject *__pyx_v_failed_factorization) {
    PyObject *__pyx_v_P = NULL;
    PyObject *__pyx_v_E = NULL;
    PyObject *__pyx_v_w = NULL;
    Py_ssize_t __pyx_v_i;
    PyObject *__pyx_v_p = NULL;
    PyObject *__pyx_v_e = NULL;
    PyObject *__pyx_v_F = NULL;
    Py_ssize_t __pyx_v_j;
    PyObject *__pyx_v_m = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    Py_ssize_t __pyx_t_3;
    int __pyx_t_4;
    PyObject *__pyx_t_5 = NULL;
    Py_ssize_t __pyx_t_6;
    PyObject *__pyx_t_7 = NULL;
    Py_ssize_t __pyx_t_8;
    Py_ssize_t __pyx_t_9;
    int __pyx_t_10;
    PyObject *__pyx_t_11 = NULL;
    PyObject *__pyx_t_12 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_factor_int_when_pari_factor_failed", 0);

    /* "gen.pyx":9528
 *     forcing a fake failure in the code in misc.h.)
 *     """
 *     P = failed_factorization[0]  # 'primes'             # <<<<<<<<<<<<<<
 *     E = failed_factorization[1]  # exponents
 *     if len(P) == 1 and E[0] == 1:
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_failed_factorization, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9528; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_P = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "gen.pyx":9529
 *     """
 *     P = failed_factorization[0]  # 'primes'
 *     E = failed_factorization[1]  # exponents             # <<<<<<<<<<<<<<
 *     if len(P) == 1 and E[0] == 1:
 *         # Major problem -- factor can't split the integer at all, but it's composite.  We're stuffed.
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_failed_factorization, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9529; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_E = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "gen.pyx":9530
 *     P = failed_factorization[0]  # 'primes'
 *     E = failed_factorization[1]  # exponents
 *     if len(P) == 1 and E[0] == 1:             # <<<<<<<<<<<<<<
 *         # Major problem -- factor can't split the integer at all, but it's composite.  We're stuffed.
 *         print "BIG WARNING: The number %s wasn't split at all by PARI, but it's definitely composite."%(P[0])
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_P); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = ((__pyx_t_3 == 1) != 0);
    if (__pyx_t_4) {
    } else {
      __pyx_t_2 = __pyx_t_4;
      goto __pyx_L4_bool_binop_done;
    }
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_E, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9530; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = __pyx_t_4;
    __pyx_L4_bool_binop_done:;
    if (__pyx_t_2) {

      /* "gen.pyx":9532
 *     if len(P) == 1 and E[0] == 1:
 *         # Major problem -- factor can't split the integer at all, but it's composite.  We're stuffed.
 *         print "BIG WARNING: The number %s wasn't split at all by PARI, but it's definitely composite."%(P[0])             # <<<<<<<<<<<<<<
 *         print "This is probably an infinite loop..."
 *     w = []
 */
      __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_P, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9532; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_BIG_WARNING_The_number_s_wasn_t, __pyx_t_5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (__Pyx_PrintOne(0, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "gen.pyx":9533
 *         # Major problem -- factor can't split the integer at all, but it's composite.  We're stuffed.
 *         print "BIG WARNING: The number %s wasn't split at all by PARI, but it's definitely composite."%(P[0])
 *         print "This is probably an infinite loop..."             # <<<<<<<<<<<<<<
 *     w = []
 *     for i in range(len(P)):
 */
      if (__Pyx_PrintOne(0, __pyx_kp_s_This_is_probably_an_infinite_loo) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "gen.pyx":9534
 *         print "BIG WARNING: The number %s wasn't split at all by PARI, but it's definitely composite."%(P[0])
 *         print "This is probably an infinite loop..."
 *     w = []             # <<<<<<<<<<<<<<
 *     for i in range(len(P)):
 *         p = P[i]
 */
    __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_w = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "gen.pyx":9535
 *         print "This is probably an infinite loop..."
 *     w = []
 *     for i in range(len(P)):             # <<<<<<<<<<<<<<
 *         p = P[i]
 *         e = E[i]
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_P); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_3; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;

      /* "gen.pyx":9536
 *     w = []
 *     for i in range(len(P)):
 *         p = P[i]             # <<<<<<<<<<<<<<
 *         e = E[i]
 *         if not p.isprime():
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_P, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9536; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_p, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":9537
 *     for i in range(len(P)):
 *         p = P[i]
 *         e = E[i]             # <<<<<<<<<<<<<<
 *         if not p.isprime():
 *             # Try to factor further -- assume this works.
 */
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_E, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9537; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_XDECREF_SET(__pyx_v_e, __pyx_t_1);
      __pyx_t_1 = 0;

      /* "gen.pyx":9538
 *         p = P[i]
 *         e = E[i]
 *         if not p.isprime():             # <<<<<<<<<<<<<<
 *             # Try to factor further -- assume this works.
 *             F = p.factor(proof=True)
 */
      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_p, __pyx_n_s_isprime); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
        __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
        if (likely(__pyx_t_7)) {
          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
          __Pyx_INCREF(__pyx_t_7);
          __Pyx_INCREF(function);
          __Pyx_DECREF_SET(__pyx_t_5, function);
        }
      }
      if (__pyx_t_7) {
        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      } else {
        __pyx_t_1 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = ((!__pyx_t_2) != 0);
      if (__pyx_t_4) {

        /* "gen.pyx":9540
 *         if not p.isprime():
 *             # Try to factor further -- assume this works.
 *             F = p.factor(proof=True)             # <<<<<<<<<<<<<<
 *             for j in range(len(F[0])):
 *                 w.append((F[0][j], F[1][j]))
 */
        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_p, __pyx_n_s_factor); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_proof, Py_True) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_empty_tuple, __pyx_t_5); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_XDECREF_SET(__pyx_v_F, __pyx_t_7);
        __pyx_t_7 = 0;

        /* "gen.pyx":9541
 *             # Try to factor further -- assume this works.
 *             F = p.factor(proof=True)
 *             for j in range(len(F[0])):             # <<<<<<<<<<<<<<
 *                 w.append((F[0][j], F[1][j]))
 *         else:
 */
        __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_F, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9541; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = PyObject_Length(__pyx_t_7); if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9541; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
          __pyx_v_j = __pyx_t_9;

          /* "gen.pyx":9542
 *             F = p.factor(proof=True)
 *             for j in range(len(F[0])):
 *                 w.append((F[0][j], F[1][j]))             # <<<<<<<<<<<<<<
 *         else:
 *             w.append((p, e))
 */
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_F, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_7, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
          __Pyx_GOTREF(__pyx_t_5);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = __Pyx_GetItemInt(__pyx_v_F, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_7);
          PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
          __Pyx_GIVEREF(__pyx_t_5);
          PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_1);
          __Pyx_GIVEREF(__pyx_t_1);
          __pyx_t_5 = 0;
          __pyx_t_1 = 0;
          __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_w, __pyx_t_7); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
        }
        goto __pyx_L8;
      }
      /*else*/ {

        /* "gen.pyx":9544
 *                 w.append((F[0][j], F[1][j]))
 *         else:
 *             w.append((p, e))             # <<<<<<<<<<<<<<
 *     m = P.matrix(len(w), 2)
 *     for i in range(len(w)):
 */
        __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __Pyx_INCREF(__pyx_v_p);
        PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_p);
        __Pyx_GIVEREF(__pyx_v_p);
        __Pyx_INCREF(__pyx_v_e);
        PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_e);
        __Pyx_GIVEREF(__pyx_v_e);
        __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_w, __pyx_t_7); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_L8:;
    }

    /* "gen.pyx":9545
 *         else:
 *             w.append((p, e))
 *     m = P.matrix(len(w), 2)             # <<<<<<<<<<<<<<
 *     for i in range(len(w)):
 *         m[i,0] = w[i][0]
 */
    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_P, __pyx_n_s_matrix); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyList_GET_SIZE(__pyx_v_w); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_11 = NULL;
    __pyx_t_3 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
      __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_1);
      if (likely(__pyx_t_11)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
        __Pyx_INCREF(__pyx_t_11);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_1, function);
        __pyx_t_3 = 1;
      }
    }
    __pyx_t_12 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_12);
    if (__pyx_t_11) {
      PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __Pyx_GIVEREF(__pyx_t_11); __pyx_t_11 = NULL;
    }
    PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_3, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_int_2);
    PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_3, __pyx_int_2);
    __Pyx_GIVEREF(__pyx_int_2);
    __pyx_t_5 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_m = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "gen.pyx":9546
 *             w.append((p, e))
 *     m = P.matrix(len(w), 2)
 *     for i in range(len(w)):             # <<<<<<<<<<<<<<
 *         m[i,0] = w[i][0]
 *         m[i,1] = w[i][1]
 */
    __pyx_t_3 = PyList_GET_SIZE(__pyx_v_w); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_3; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;

      /* "gen.pyx":9547
 *     m = P.matrix(len(w), 2)
 *     for i in range(len(w)):
 *         m[i,0] = w[i][0]             # <<<<<<<<<<<<<<
 *         m[i,1] = w[i][1]
 *     return m
 */
      __pyx_t_7 = __Pyx_GetItemInt_List(__pyx_v_w, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9547; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9547; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_12);
      PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_7);
      __Pyx_GIVEREF(__pyx_t_7);
      __Pyx_INCREF(__pyx_int_0);
      PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
      __pyx_t_7 = 0;
      if (unlikely(PyObject_SetItem(__pyx_v_m, __pyx_t_12, __pyx_t_1) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "gen.pyx":9548
 *     for i in range(len(w)):
 *         m[i,0] = w[i][0]
 *         m[i,1] = w[i][1]             # <<<<<<<<<<<<<<
 *     return m
 * 
 */
      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_w, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9548; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_12 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9548; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_7);
      PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      __pyx_t_1 = 0;
      if (unlikely(PyObject_SetItem(__pyx_v_m, __pyx_t_7, __pyx_t_12) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
    }

    /* "gen.pyx":9549
 *         m[i,0] = w[i][0]
 *         m[i,1] = w[i][1]
 *     return m             # <<<<<<<<<<<<<<
 * 
 * cdef _richcmp_(left, right, int op):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_m);
    __pyx_r = __pyx_v_m;
    goto __pyx_L0;

    /* "gen.pyx":9518
 * 
 * 
 * cdef _factor_int_when_pari_factor_failed(x, failed_factorization):             # <<<<<<<<<<<<<<
 *     """
 *     This is called by factor when PARI's factor tried to factor, got
 */

    /* function exit code */
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_XDECREF(__pyx_t_11);
    __Pyx_XDECREF(__pyx_t_12);
    __Pyx_AddTraceback("gen._factor_int_when_pari_factor_failed", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_P);
    __Pyx_XDECREF(__pyx_v_E);
    __Pyx_XDECREF(__pyx_v_w);
    __Pyx_XDECREF(__pyx_v_p);
    __Pyx_XDECREF(__pyx_v_e);
    __Pyx_XDECREF(__pyx_v_F);
    __Pyx_XDECREF(__pyx_v_m);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "gen.pyx":9551
 *     return m
 * 
 * cdef _richcmp_(left, right, int op):             # <<<<<<<<<<<<<<
 *     """
 *     Compare left and right.
 */

  static PyObject *__pyx_f_3gen__richcmp_(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op) {
    int __pyx_v_r;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_richcmp_", 0);

    /* "gen.pyx":9574
 *     #         r = left.__cmp__(right)
 *     #     else:
 *     r = (objtogen(left))._cmp_c_impl(objtogen(right))             # <<<<<<<<<<<<<<
 * 
 *     if op == 0:  #<
 */
    __pyx_t_2 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_left)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_cmp_c_impl); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)__pyx_f_3gen_objtogen(__pyx_v_right)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __Pyx_GIVEREF(__pyx_t_4); __pyx_t_4 = NULL;
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_r = __pyx_t_6;

    /* "gen.pyx":9586
 *     elif op == 3: #!=
 *         return PyBool_FromLong(r != 0)
 *     elif op == 5: #>=             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r >= 0)
 */
    switch (__pyx_v_op) {

      /* "gen.pyx":9576
 *     r = (objtogen(left))._cmp_c_impl(objtogen(right))
 * 
 *     if op == 0:  #<             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r  < 0)
 *     elif op == 2: #==
 */
      case 0:

      /* "gen.pyx":9577
 * 
 *     if op == 0:  #<
 *         return PyBool_FromLong(r  < 0)             # <<<<<<<<<<<<<<
 *     elif op == 2: #==
 *         return PyBool_FromLong(r == 0)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r < 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9577; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;

      /* "gen.pyx":9578
 *     if op == 0:  #<
 *         return PyBool_FromLong(r  < 0)
 *     elif op == 2: #==             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r == 0)
 *     elif op == 4: #>
 */
      case 2:

      /* "gen.pyx":9579
 *         return PyBool_FromLong(r  < 0)
 *     elif op == 2: #==
 *         return PyBool_FromLong(r == 0)             # <<<<<<<<<<<<<<
 *     elif op == 4: #>
 *         return PyBool_FromLong(r  > 0)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r == 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;

      /* "gen.pyx":9580
 *     elif op == 2: #==
 *         return PyBool_FromLong(r == 0)
 *     elif op == 4: #>             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r  > 0)
 *     elif op == 1: #<=
 */
      case 4:

      /* "gen.pyx":9581
 *         return PyBool_FromLong(r == 0)
 *     elif op == 4: #>
 *         return PyBool_FromLong(r  > 0)             # <<<<<<<<<<<<<<
 *     elif op == 1: #<=
 *         return PyBool_FromLong(r <= 0)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r > 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;

      /* "gen.pyx":9582
 *     elif op == 4: #>
 *         return PyBool_FromLong(r  > 0)
 *     elif op == 1: #<=             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r <= 0)
 *     elif op == 3: #!=
 */
      case 1:

      /* "gen.pyx":9583
 *         return PyBool_FromLong(r  > 0)
 *     elif op == 1: #<=
 *         return PyBool_FromLong(r <= 0)             # <<<<<<<<<<<<<<
 *     elif op == 3: #!=
 *         return PyBool_FromLong(r != 0)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r <= 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;

      /* "gen.pyx":9584
 *     elif op == 1: #<=
 *         return PyBool_FromLong(r <= 0)
 *     elif op == 3: #!=             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r != 0)
 *     elif op == 5: #>=
 */
      case 3:

      /* "gen.pyx":9585
 *         return PyBool_FromLong(r <= 0)
 *     elif op == 3: #!=
 *         return PyBool_FromLong(r != 0)             # <<<<<<<<<<<<<<
 *     elif op == 5: #>=
 *         return PyBool_FromLong(r >= 0)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r != 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;

      /* "gen.pyx":9586
 *     elif op == 3: #!=
 *         return PyBool_FromLong(r != 0)
 *     elif op == 5: #>=             # <<<<<<<<<<<<<<
 *         return PyBool_FromLong(r >= 0)
 */
      case 5:

      /* "gen.pyx":9587
 *         return PyBool_FromLong(r != 0)
 *     elif op == 5: #>=
 *         return PyBool_FromLong(r >= 0)             # <<<<<<<<<<<<<<
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyBool_FromLong((__pyx_v_r >= 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      break;
      default: break;
    }

    /* "gen.pyx":9551
 *     return m
 * 
 * cdef _richcmp_(left, right, int op):             # <<<<<<<<<<<<<<
 *     """
 *     Compare left and right.
 */

    /* function exit code */
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("gen._richcmp_", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_tp_new_3gen_gen(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
    struct __pyx_obj_3gen_gen *p;
    PyObject *o;
    o = (*t->tp_alloc)(t, 0);
    if (unlikely(!o)) return 0;
    p = ((struct __pyx_obj_3gen_gen *)o);
    p->refers_to = ((PyObject*)Py_None); Py_INCREF(Py_None);
    return o;
  }

  static void __pyx_tp_dealloc_3gen_gen(PyObject *o) {
    struct __pyx_obj_3gen_gen *p = (struct __pyx_obj_3gen_gen *)o;
    PyObject_GC_UnTrack(o);
    {
      PyObject *etype, *eval, *etb;
      PyErr_Fetch(&etype, &eval, &etb);
      ++Py_REFCNT(o);
      __pyx_pw_3gen_3gen_3__dealloc__(o);
      --Py_REFCNT(o);
      PyErr_Restore(etype, eval, etb);
    }
    Py_CLEAR(p->refers_to);
    (*Py_TYPE(o)->tp_free)(o);
  }

  static int __pyx_tp_traverse_3gen_gen(PyObject *o, visitproc v, void *a) {
    int e;
    struct __pyx_obj_3gen_gen *p = (struct __pyx_obj_3gen_gen *)o;
    if (p->refers_to) {
      e = (*v)(p->refers_to, a); if (e) return e;
    }
    return 0;
  }

  static int __pyx_tp_clear_3gen_gen(PyObject *o) {
    PyObject* tmp;
    struct __pyx_obj_3gen_gen *p = (struct __pyx_obj_3gen_gen *)o;
    tmp = ((PyObject*)p->refers_to);
    p->refers_to = ((PyObject*)Py_None); Py_INCREF(Py_None);
    Py_XDECREF(tmp);
    return 0;
  }
  static PyObject *__pyx_sq_item_3gen_gen(PyObject *o, Py_ssize_t i) {
    PyObject *r;
    PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
    r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
    Py_DECREF(x);
    return r;
  }

  static int __pyx_mp_ass_subscript_3gen_gen(PyObject *o, PyObject *i, PyObject *v) {
    if (v) {
      return __pyx_pw_3gen_3gen_83__setitem__(o, i, v);
    }
    else {
      PyErr_Format(PyExc_NotImplementedError,
        "Subscript deletion not supported by %.200s", Py_TYPE(o)->tp_name);
      return -1;
    }
  }

  static PyMethodDef __pyx_methods_3gen_gen[] = {
    {"TestBesselk", (PyCFunction)__pyx_pw_3gen_3gen_5TestBesselk, METH_VARARGS|METH_KEYWORDS, 0},
    {"_testclass", (PyCFunction)__pyx_pw_3gen_3gen_11_testclass, METH_NOARGS, 0},
    {"list", (PyCFunction)__pyx_pw_3gen_3gen_13list, METH_NOARGS, __pyx_doc_3gen_3gen_12list},
    {"__reduce__", (PyCFunction)__pyx_pw_3gen_3gen_15__reduce__, METH_NOARGS, __pyx_doc_3gen_3gen_14__reduce__},
    {"_add_", (PyCFunction)__pyx_pw_3gen_3gen_17_add_, METH_O, 0},
    {"_sub_", (PyCFunction)__pyx_pw_3gen_3gen_19_sub_, METH_O, 0},
    {"_mul_", (PyCFunction)__pyx_pw_3gen_3gen_21_mul_, METH_O, 0},
    {"_div_", (PyCFunction)__pyx_pw_3gen_3gen_23_div_, METH_O, 0},
    {"_add_one", (PyCFunction)__pyx_pw_3gen_3gen_25_add_one, METH_NOARGS, __pyx_doc_3gen_3gen_24_add_one},
    {"getattr", (PyCFunction)__pyx_pw_3gen_3gen_49getattr, METH_O, __pyx_doc_3gen_3gen_48getattr},
    {"mod", (PyCFunction)__pyx_pw_3gen_3gen_51mod, METH_NOARGS, __pyx_doc_3gen_3gen_50mod},
    {"nf_get_pol", (PyCFunction)__pyx_pw_3gen_3gen_53nf_get_pol, METH_NOARGS, __pyx_doc_3gen_3gen_52nf_get_pol},
    {"nf_get_diff", (PyCFunction)__pyx_pw_3gen_3gen_55nf_get_diff, METH_NOARGS, __pyx_doc_3gen_3gen_54nf_get_diff},
    {"nf_get_sign", (PyCFunction)__pyx_pw_3gen_3gen_57nf_get_sign, METH_NOARGS, __pyx_doc_3gen_3gen_56nf_get_sign},
    {"nf_get_zk", (PyCFunction)__pyx_pw_3gen_3gen_59nf_get_zk, METH_NOARGS, __pyx_doc_3gen_3gen_58nf_get_zk},
    {"bnf_get_no", (PyCFunction)__pyx_pw_3gen_3gen_61bnf_get_no, METH_NOARGS, __pyx_doc_3gen_3gen_60bnf_get_no},
    {"bnf_get_cyc", (PyCFunction)__pyx_pw_3gen_3gen_63bnf_get_cyc, METH_NOARGS, __pyx_doc_3gen_3gen_62bnf_get_cyc},
    {"bnf_get_gen", (PyCFunction)__pyx_pw_3gen_3gen_65bnf_get_gen, METH_NOARGS, __pyx_doc_3gen_3gen_64bnf_get_gen},
    {"bnf_get_reg", (PyCFunction)__pyx_pw_3gen_3gen_67bnf_get_reg, METH_NOARGS, __pyx_doc_3gen_3gen_66bnf_get_reg},
    {"pr_get_p", (PyCFunction)__pyx_pw_3gen_3gen_69pr_get_p, METH_NOARGS, __pyx_doc_3gen_3gen_68pr_get_p},
    {"pr_get_e", (PyCFunction)__pyx_pw_3gen_3gen_71pr_get_e, METH_NOARGS, __pyx_doc_3gen_3gen_70pr_get_e},
    {"pr_get_f", (PyCFunction)__pyx_pw_3gen_3gen_73pr_get_f, METH_NOARGS, __pyx_doc_3gen_3gen_72pr_get_f},
    {"pr_get_gen", (PyCFunction)__pyx_pw_3gen_3gen_75pr_get_gen, METH_NOARGS, __pyx_doc_3gen_3gen_74pr_get_gen},
    {"bid_get_cyc", (PyCFunction)__pyx_pw_3gen_3gen_77bid_get_cyc, METH_NOARGS, __pyx_doc_3gen_3gen_76bid_get_cyc},
    {"bid_get_gen", (PyCFunction)__pyx_pw_3gen_3gen_79bid_get_gen, METH_NOARGS, __pyx_doc_3gen_3gen_78bid_get_gen},
    {"_cmp_c_impl", (PyCFunction)__pyx_pw_3gen_3gen_89_cmp_c_impl, METH_O, __pyx_doc_3gen_3gen_88_cmp_c_impl},
    {"__copy__", (PyCFunction)__pyx_pw_3gen_3gen_91__copy__, METH_NOARGS, 0},
    {"list_str", (PyCFunction)__pyx_pw_3gen_3gen_93list_str, METH_NOARGS, __pyx_doc_3gen_3gen_92list_str},
    {"python_list_small", (PyCFunction)__pyx_pw_3gen_3gen_99python_list_small, METH_NOARGS, __pyx_doc_3gen_3gen_98python_list_small},
    {"python_list", (PyCFunction)__pyx_pw_3gen_3gen_101python_list, METH_NOARGS, __pyx_doc_3gen_3gen_100python_list},
    {"python", (PyCFunction)__pyx_pw_3gen_3gen_103python, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_102python},
    {"__complex__", (PyCFunction)__pyx_pw_3gen_3gen_109__complex__, METH_NOARGS, __pyx_doc_3gen_3gen_108__complex__},
    {"gequal", (PyCFunction)__pyx_pw_3gen_3gen_113gequal, METH_O, __pyx_doc_3gen_3gen_112gequal},
    {"gequal0", (PyCFunction)__pyx_pw_3gen_3gen_115gequal0, METH_NOARGS, __pyx_doc_3gen_3gen_114gequal0},
    {"gequal_long", (PyCFunction)__pyx_pw_3gen_3gen_117gequal_long, METH_O, __pyx_doc_3gen_3gen_116gequal_long},
    {"isprime", (PyCFunction)__pyx_pw_3gen_3gen_119isprime, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_118isprime},
    {"qfbhclassno", (PyCFunction)__pyx_pw_3gen_3gen_121qfbhclassno, METH_NOARGS, __pyx_doc_3gen_3gen_120qfbhclassno},
    {"ispseudoprime", (PyCFunction)__pyx_pw_3gen_3gen_123ispseudoprime, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_122ispseudoprime},
    {"ispower", (PyCFunction)__pyx_pw_3gen_3gen_125ispower, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_124ispower},
    {"divrem", (PyCFunction)__pyx_pw_3gen_3gen_127divrem, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_126divrem},
    {"lex", (PyCFunction)__pyx_pw_3gen_3gen_129lex, METH_O, __pyx_doc_3gen_3gen_128lex},
    {"max", (PyCFunction)__pyx_pw_3gen_3gen_131max, METH_O, __pyx_doc_3gen_3gen_130max},
    {"min", (PyCFunction)__pyx_pw_3gen_3gen_133min, METH_O, __pyx_doc_3gen_3gen_132min},
    {"shift", (PyCFunction)__pyx_pw_3gen_3gen_135shift, METH_O, __pyx_doc_3gen_3gen_134shift},
    {"shiftmul", (PyCFunction)__pyx_pw_3gen_3gen_137shiftmul, METH_O, __pyx_doc_3gen_3gen_136shiftmul},
    {"sign", (PyCFunction)__pyx_pw_3gen_3gen_139sign, METH_NOARGS, __pyx_doc_3gen_3gen_138sign},
    {"vecmax", (PyCFunction)__pyx_pw_3gen_3gen_141vecmax, METH_NOARGS, __pyx_doc_3gen_3gen_140vecmax},
    {"vecmin", (PyCFunction)__pyx_pw_3gen_3gen_143vecmin, METH_NOARGS, __pyx_doc_3gen_3gen_142vecmin},
    {"Col", (PyCFunction)__pyx_pw_3gen_3gen_145Col, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_144Col},
    {"Colrev", (PyCFunction)__pyx_pw_3gen_3gen_147Colrev, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_146Colrev},
    {"List", (PyCFunction)__pyx_pw_3gen_3gen_149List, METH_NOARGS, __pyx_doc_3gen_3gen_148List},
    {"Mat", (PyCFunction)__pyx_pw_3gen_3gen_151Mat, METH_NOARGS, __pyx_doc_3gen_3gen_150Mat},
    {"Mod", (PyCFunction)__pyx_pw_3gen_3gen_153Mod, METH_O, __pyx_doc_3gen_3gen_152Mod},
    {"Pol", (PyCFunction)__pyx_pw_3gen_3gen_155Pol, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_154Pol},
    {"Polrev", (PyCFunction)__pyx_pw_3gen_3gen_157Polrev, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_156Polrev},
    {"Qfb", (PyCFunction)__pyx_pw_3gen_3gen_159Qfb, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_158Qfb},
    {"Ser", (PyCFunction)__pyx_pw_3gen_3gen_161Ser, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_160Ser},
    {"Set", (PyCFunction)__pyx_pw_3gen_3gen_163Set, METH_NOARGS, __pyx_doc_3gen_3gen_162Set},
    {"Str", (PyCFunction)__pyx_pw_3gen_3gen_165Str, METH_NOARGS, __pyx_doc_3gen_3gen_164Str},
    {"Strchr", (PyCFunction)__pyx_pw_3gen_3gen_167Strchr, METH_NOARGS, __pyx_doc_3gen_3gen_166Strchr},
    {"Strexpand", (PyCFunction)__pyx_pw_3gen_3gen_169Strexpand, METH_NOARGS, __pyx_doc_3gen_3gen_168Strexpand},
    {"Strtex", (PyCFunction)__pyx_pw_3gen_3gen_171Strtex, METH_NOARGS, __pyx_doc_3gen_3gen_170Strtex},
    {"printtex", (PyCFunction)__pyx_pw_3gen_3gen_173printtex, METH_NOARGS, 0},
    {"Vec", (PyCFunction)__pyx_pw_3gen_3gen_175Vec, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_174Vec},
    {"Vecrev", (PyCFunction)__pyx_pw_3gen_3gen_177Vecrev, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_176Vecrev},
    {"Vecsmall", (PyCFunction)__pyx_pw_3gen_3gen_179Vecsmall, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_178Vecsmall},
    {"binary", (PyCFunction)__pyx_pw_3gen_3gen_181binary, METH_NOARGS, __pyx_doc_3gen_3gen_180binary},
    {"bitand", (PyCFunction)__pyx_pw_3gen_3gen_183bitand, METH_O, __pyx_doc_3gen_3gen_182bitand},
    {"bitneg", (PyCFunction)__pyx_pw_3gen_3gen_185bitneg, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_184bitneg},
    {"bitnegimply", (PyCFunction)__pyx_pw_3gen_3gen_187bitnegimply, METH_O, __pyx_doc_3gen_3gen_186bitnegimply},
    {"bitor", (PyCFunction)__pyx_pw_3gen_3gen_189bitor, METH_O, __pyx_doc_3gen_3gen_188bitor},
    {"bittest", (PyCFunction)__pyx_pw_3gen_3gen_191bittest, METH_O, __pyx_doc_3gen_3gen_190bittest},
    {"bitxor", (PyCFunction)__pyx_pw_3gen_3gen_193bitxor, METH_O, __pyx_doc_3gen_3gen_192bitxor},
    {"ceil", (PyCFunction)__pyx_pw_3gen_3gen_195ceil, METH_NOARGS, __pyx_doc_3gen_3gen_194ceil},
    {"centerlift", (PyCFunction)__pyx_pw_3gen_3gen_197centerlift, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_196centerlift},
    {"component", (PyCFunction)__pyx_pw_3gen_3gen_199component, METH_O, __pyx_doc_3gen_3gen_198component},
    {"conj", (PyCFunction)__pyx_pw_3gen_3gen_201conj, METH_NOARGS, __pyx_doc_3gen_3gen_200conj},
    {"conjvec", (PyCFunction)__pyx_pw_3gen_3gen_203conjvec, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_202conjvec},
    {"denominator", (PyCFunction)__pyx_pw_3gen_3gen_205denominator, METH_NOARGS, __pyx_doc_3gen_3gen_204denominator},
    {"floor", (PyCFunction)__pyx_pw_3gen_3gen_207floor, METH_NOARGS, __pyx_doc_3gen_3gen_206floor},
    {"frac", (PyCFunction)__pyx_pw_3gen_3gen_209frac, METH_NOARGS, __pyx_doc_3gen_3gen_208frac},
    {"imag", (PyCFunction)__pyx_pw_3gen_3gen_211imag, METH_NOARGS, __pyx_doc_3gen_3gen_210imag},
    {"length", (PyCFunction)__pyx_pw_3gen_3gen_213length, METH_NOARGS, __pyx_doc_3gen_3gen_212length},
    {"lift", (PyCFunction)__pyx_pw_3gen_3gen_215lift, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_214lift},
    {"numbpart", (PyCFunction)__pyx_pw_3gen_3gen_217numbpart, METH_NOARGS, __pyx_doc_3gen_3gen_216numbpart},
    {"numerator", (PyCFunction)__pyx_pw_3gen_3gen_219numerator, METH_NOARGS, __pyx_doc_3gen_3gen_218numerator},
    {"numtoperm", (PyCFunction)__pyx_pw_3gen_3gen_221numtoperm, METH_O, __pyx_doc_3gen_3gen_220numtoperm},
    {"padicprec", (PyCFunction)__pyx_pw_3gen_3gen_223padicprec, METH_O, __pyx_doc_3gen_3gen_222padicprec},
    {"padicprime", (PyCFunction)__pyx_pw_3gen_3gen_225padicprime, METH_NOARGS, __pyx_doc_3gen_3gen_224padicprime},
    {"permtonum", (PyCFunction)__pyx_pw_3gen_3gen_227permtonum, METH_NOARGS, __pyx_doc_3gen_3gen_226permtonum},
    {"precision", (PyCFunction)__pyx_pw_3gen_3gen_229precision, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_228precision},
    {"random", (PyCFunction)__pyx_pw_3gen_3gen_231random, METH_NOARGS, __pyx_doc_3gen_3gen_230random},
    {"real", (PyCFunction)__pyx_pw_3gen_3gen_233real, METH_NOARGS, __pyx_doc_3gen_3gen_232real},
    {"round", (PyCFunction)__pyx_pw_3gen_3gen_235round, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_234round},
    {"simplify", (PyCFunction)__pyx_pw_3gen_3gen_237simplify, METH_NOARGS, __pyx_doc_3gen_3gen_236simplify},
    {"sizeword", (PyCFunction)__pyx_pw_3gen_3gen_239sizeword, METH_NOARGS, __pyx_doc_3gen_3gen_238sizeword},
    {"sizebyte", (PyCFunction)__pyx_pw_3gen_3gen_241sizebyte, METH_NOARGS, __pyx_doc_3gen_3gen_240sizebyte},
    {"sizedigit", (PyCFunction)__pyx_pw_3gen_3gen_243sizedigit, METH_NOARGS, __pyx_doc_3gen_3gen_242sizedigit},
    {"truncate", (PyCFunction)__pyx_pw_3gen_3gen_245truncate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_244truncate},
    {"valuation", (PyCFunction)__pyx_pw_3gen_3gen_247valuation, METH_O, __pyx_doc_3gen_3gen_246valuation},
    {"_valp", (PyCFunction)__pyx_pw_3gen_3gen_249_valp, METH_NOARGS, __pyx_doc_3gen_3gen_248_valp},
    {"variable", (PyCFunction)__pyx_pw_3gen_3gen_251variable, METH_NOARGS, __pyx_doc_3gen_3gen_250variable},
    {"abs", (PyCFunction)__pyx_pw_3gen_3gen_253abs, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_252abs},
    {"acos", (PyCFunction)__pyx_pw_3gen_3gen_255acos, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_254acos},
    {"acosh", (PyCFunction)__pyx_pw_3gen_3gen_257acosh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_256acosh},
    {"agm", (PyCFunction)__pyx_pw_3gen_3gen_259agm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_258agm},
    {"arg", (PyCFunction)__pyx_pw_3gen_3gen_261arg, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_260arg},
    {"asin", (PyCFunction)__pyx_pw_3gen_3gen_263asin, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_262asin},
    {"asinh", (PyCFunction)__pyx_pw_3gen_3gen_265asinh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_264asinh},
    {"atan", (PyCFunction)__pyx_pw_3gen_3gen_267atan, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_266atan},
    {"atanh", (PyCFunction)__pyx_pw_3gen_3gen_269atanh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_268atanh},
    {"bernfrac", (PyCFunction)__pyx_pw_3gen_3gen_271bernfrac, METH_NOARGS, __pyx_doc_3gen_3gen_270bernfrac},
    {"bernreal", (PyCFunction)__pyx_pw_3gen_3gen_273bernreal, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_272bernreal},
    {"bernvec", (PyCFunction)__pyx_pw_3gen_3gen_275bernvec, METH_NOARGS, __pyx_doc_3gen_3gen_274bernvec},
    {"besselh1", (PyCFunction)__pyx_pw_3gen_3gen_277besselh1, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_276besselh1},
    {"besselh2", (PyCFunction)__pyx_pw_3gen_3gen_279besselh2, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_278besselh2},
    {"besselj", (PyCFunction)__pyx_pw_3gen_3gen_281besselj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_280besselj},
    {"besseljh", (PyCFunction)__pyx_pw_3gen_3gen_283besseljh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_282besseljh},
    {"besseli", (PyCFunction)__pyx_pw_3gen_3gen_285besseli, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_284besseli},
    {"besselk", (PyCFunction)__pyx_pw_3gen_3gen_287besselk, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_286besselk},
    {"besseln", (PyCFunction)__pyx_pw_3gen_3gen_289besseln, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_288besseln},
    {"cos", (PyCFunction)__pyx_pw_3gen_3gen_291cos, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_290cos},
    {"cosh", (PyCFunction)__pyx_pw_3gen_3gen_293cosh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_292cosh},
    {"cotan", (PyCFunction)__pyx_pw_3gen_3gen_295cotan, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_294cotan},
    {"dilog", (PyCFunction)__pyx_pw_3gen_3gen_297dilog, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_296dilog},
    {"eint1", (PyCFunction)__pyx_pw_3gen_3gen_299eint1, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_298eint1},
    {"erfc", (PyCFunction)__pyx_pw_3gen_3gen_301erfc, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_300erfc},
    {"eta", (PyCFunction)__pyx_pw_3gen_3gen_303eta, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_302eta},
    {"exp", (PyCFunction)__pyx_pw_3gen_3gen_305exp, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_304exp},
    {"gamma", (PyCFunction)__pyx_pw_3gen_3gen_307gamma, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_306gamma},
    {"gammah", (PyCFunction)__pyx_pw_3gen_3gen_309gammah, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_308gammah},
    {"hyperu", (PyCFunction)__pyx_pw_3gen_3gen_311hyperu, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_310hyperu},
    {"incgam", (PyCFunction)__pyx_pw_3gen_3gen_313incgam, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_312incgam},
    {"incgamc", (PyCFunction)__pyx_pw_3gen_3gen_315incgamc, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_314incgamc},
    {"log", (PyCFunction)__pyx_pw_3gen_3gen_317log, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_316log},
    {"lngamma", (PyCFunction)__pyx_pw_3gen_3gen_319lngamma, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_318lngamma},
    {"log_gamma", (PyCFunction)__pyx_pw_3gen_3gen_321log_gamma, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_320log_gamma},
    {"polylog", (PyCFunction)__pyx_pw_3gen_3gen_323polylog, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_322polylog},
    {"psi", (PyCFunction)__pyx_pw_3gen_3gen_325psi, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_324psi},
    {"sin", (PyCFunction)__pyx_pw_3gen_3gen_327sin, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_326sin},
    {"sinh", (PyCFunction)__pyx_pw_3gen_3gen_329sinh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_328sinh},
    {"sqr", (PyCFunction)__pyx_pw_3gen_3gen_331sqr, METH_NOARGS, __pyx_doc_3gen_3gen_330sqr},
    {"sqrt", (PyCFunction)__pyx_pw_3gen_3gen_333sqrt, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_332sqrt},
    {"sqrtint", (PyCFunction)__pyx_pw_3gen_3gen_335sqrtint, METH_NOARGS, __pyx_doc_3gen_3gen_334sqrtint},
    {"sqrtn", (PyCFunction)__pyx_pw_3gen_3gen_337sqrtn, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_336sqrtn},
    {"tan", (PyCFunction)__pyx_pw_3gen_3gen_339tan, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_338tan},
    {"tanh", (PyCFunction)__pyx_pw_3gen_3gen_341tanh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_340tanh},
    {"teichmuller", (PyCFunction)__pyx_pw_3gen_3gen_343teichmuller, METH_NOARGS, __pyx_doc_3gen_3gen_342teichmuller},
    {"theta", (PyCFunction)__pyx_pw_3gen_3gen_345theta, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_344theta},
    {"thetanullk", (PyCFunction)__pyx_pw_3gen_3gen_347thetanullk, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_346thetanullk},
    {"weber", (PyCFunction)__pyx_pw_3gen_3gen_349weber, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_348weber},
    {"zeta", (PyCFunction)__pyx_pw_3gen_3gen_351zeta, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_350zeta},
    {"bezout", (PyCFunction)__pyx_pw_3gen_3gen_353bezout, METH_O, 0},
    {"binomial", (PyCFunction)__pyx_pw_3gen_3gen_355binomial, METH_O, __pyx_doc_3gen_3gen_354binomial},
    {"contfrac", (PyCFunction)__pyx_pw_3gen_3gen_357contfrac, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_356contfrac},
    {"contfracpnqn", (PyCFunction)__pyx_pw_3gen_3gen_359contfracpnqn, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_358contfracpnqn},
    {"ffgen", (PyCFunction)__pyx_pw_3gen_3gen_361ffgen, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_360ffgen},
    {"ffinit", (PyCFunction)__pyx_pw_3gen_3gen_363ffinit, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_362ffinit},
    {"fibonacci", (PyCFunction)__pyx_pw_3gen_3gen_365fibonacci, METH_NOARGS, __pyx_doc_3gen_3gen_364fibonacci},
    {"gcd", (PyCFunction)__pyx_pw_3gen_3gen_367gcd, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_366gcd},
    {"issquare", (PyCFunction)__pyx_pw_3gen_3gen_369issquare, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_368issquare},
    {"issquarefree", (PyCFunction)__pyx_pw_3gen_3gen_371issquarefree, METH_NOARGS, __pyx_doc_3gen_3gen_370issquarefree},
    {"lcm", (PyCFunction)__pyx_pw_3gen_3gen_373lcm, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_372lcm},
    {"primepi", (PyCFunction)__pyx_pw_3gen_3gen_375primepi, METH_NOARGS, __pyx_doc_3gen_3gen_374primepi},
    {"sumdiv", (PyCFunction)__pyx_pw_3gen_3gen_377sumdiv, METH_NOARGS, __pyx_doc_3gen_3gen_376sumdiv},
    {"sumdivk", (PyCFunction)__pyx_pw_3gen_3gen_379sumdivk, METH_O, __pyx_doc_3gen_3gen_378sumdivk},
    {"xgcd", (PyCFunction)__pyx_pw_3gen_3gen_381xgcd, METH_O, __pyx_doc_3gen_3gen_380xgcd},
    {"Zn_issquare", (PyCFunction)__pyx_pw_3gen_3gen_383Zn_issquare, METH_O, __pyx_doc_3gen_3gen_382Zn_issquare},
    {"Zn_sqrt", (PyCFunction)__pyx_pw_3gen_3gen_385Zn_sqrt, METH_O, __pyx_doc_3gen_3gen_384Zn_sqrt},
    {"ellinit", (PyCFunction)__pyx_pw_3gen_3gen_387ellinit, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_386ellinit},
    {"ellglobalred", (PyCFunction)__pyx_pw_3gen_3gen_389ellglobalred, METH_NOARGS, __pyx_doc_3gen_3gen_388ellglobalred},
    {"elladd", (PyCFunction)__pyx_pw_3gen_3gen_391elladd, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_390elladd},
    {"ellak", (PyCFunction)__pyx_pw_3gen_3gen_393ellak, METH_O, __pyx_doc_3gen_3gen_392ellak},
    {"ellan", (PyCFunction)__pyx_pw_3gen_3gen_395ellan, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_394ellan},
    {"ellanalyticrank", (PyCFunction)__pyx_pw_3gen_3gen_397ellanalyticrank, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_396ellanalyticrank},
    {"ellap", (PyCFunction)__pyx_pw_3gen_3gen_399ellap, METH_O, __pyx_doc_3gen_3gen_398ellap},
    {"ellaplist", (PyCFunction)__pyx_pw_3gen_3gen_401ellaplist, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_400ellaplist},
    {"ellbil", (PyCFunction)__pyx_pw_3gen_3gen_403ellbil, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_402ellbil},
    {"ellchangecurve", (PyCFunction)__pyx_pw_3gen_3gen_405ellchangecurve, METH_O, __pyx_doc_3gen_3gen_404ellchangecurve},
    {"elleta", (PyCFunction)__pyx_pw_3gen_3gen_407elleta, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_406elleta},
    {"ellheight", (PyCFunction)__pyx_pw_3gen_3gen_409ellheight, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_408ellheight},
    {"ellheightmatrix", (PyCFunction)__pyx_pw_3gen_3gen_411ellheightmatrix, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_410ellheightmatrix},
    {"ellisoncurve", (PyCFunction)__pyx_pw_3gen_3gen_413ellisoncurve, METH_O, __pyx_doc_3gen_3gen_412ellisoncurve},
    {"elllocalred", (PyCFunction)__pyx_pw_3gen_3gen_415elllocalred, METH_O, __pyx_doc_3gen_3gen_414elllocalred},
    {"elllseries", (PyCFunction)__pyx_pw_3gen_3gen_417elllseries, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_416elllseries},
    {"ellminimalmodel", (PyCFunction)__pyx_pw_3gen_3gen_419ellminimalmodel, METH_NOARGS, __pyx_doc_3gen_3gen_418ellminimalmodel},
    {"ellorder", (PyCFunction)__pyx_pw_3gen_3gen_421ellorder, METH_O, __pyx_doc_3gen_3gen_420ellorder},
    {"ellordinate", (PyCFunction)__pyx_pw_3gen_3gen_423ellordinate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_422ellordinate},
    {"ellpointtoz", (PyCFunction)__pyx_pw_3gen_3gen_425ellpointtoz, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_424ellpointtoz},
    {"ellpow", (PyCFunction)__pyx_pw_3gen_3gen_427ellpow, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_426ellpow},
    {"ellrootno", (PyCFunction)__pyx_pw_3gen_3gen_429ellrootno, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_428ellrootno},
    {"ellsigma", (PyCFunction)__pyx_pw_3gen_3gen_431ellsigma, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_430ellsigma},
    {"ellsub", (PyCFunction)__pyx_pw_3gen_3gen_433ellsub, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_432ellsub},
    {"elltaniyama", (PyCFunction)__pyx_pw_3gen_3gen_435elltaniyama, METH_NOARGS, 0},
    {"elltors", (PyCFunction)__pyx_pw_3gen_3gen_437elltors, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_436elltors},
    {"ellzeta", (PyCFunction)__pyx_pw_3gen_3gen_439ellzeta, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_438ellzeta},
    {"ellztopoint", (PyCFunction)__pyx_pw_3gen_3gen_441ellztopoint, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_440ellztopoint},
    {"omega", (PyCFunction)__pyx_pw_3gen_3gen_443omega, METH_NOARGS, __pyx_doc_3gen_3gen_442omega},
    {"disc", (PyCFunction)__pyx_pw_3gen_3gen_445disc, METH_NOARGS, __pyx_doc_3gen_3gen_444disc},
    {"j", (PyCFunction)__pyx_pw_3gen_3gen_447j, METH_NOARGS, __pyx_doc_3gen_3gen_446j},
    {"ellj", (PyCFunction)__pyx_pw_3gen_3gen_449ellj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_448ellj},
    {"bnfcertify", (PyCFunction)__pyx_pw_3gen_3gen_451bnfcertify, METH_NOARGS, __pyx_doc_3gen_3gen_450bnfcertify},
    {"bnfinit", (PyCFunction)__pyx_pw_3gen_3gen_453bnfinit, METH_VARARGS|METH_KEYWORDS, 0},
    {"bnfisintnorm", (PyCFunction)__pyx_pw_3gen_3gen_455bnfisintnorm, METH_O, 0},
    {"bnfisnorm", (PyCFunction)__pyx_pw_3gen_3gen_457bnfisnorm, METH_VARARGS|METH_KEYWORDS, 0},
    {"bnfisprincipal", (PyCFunction)__pyx_pw_3gen_3gen_459bnfisprincipal, METH_VARARGS|METH_KEYWORDS, 0},
    {"bnfnarrow", (PyCFunction)__pyx_pw_3gen_3gen_461bnfnarrow, METH_NOARGS, 0},
    {"bnfsunit", (PyCFunction)__pyx_pw_3gen_3gen_463bnfsunit, METH_VARARGS|METH_KEYWORDS, 0},
    {"bnfunit", (PyCFunction)__pyx_pw_3gen_3gen_465bnfunit, METH_NOARGS, 0},
    {"bnfisunit", (PyCFunction)__pyx_pw_3gen_3gen_467bnfisunit, METH_O, 0},
    {"bnrclassno", (PyCFunction)__pyx_pw_3gen_3gen_469bnrclassno, METH_O, __pyx_doc_3gen_3gen_468bnrclassno},
    {"bnfissunit", (PyCFunction)__pyx_pw_3gen_3gen_471bnfissunit, METH_VARARGS|METH_KEYWORDS, 0},
    {"dirzetak", (PyCFunction)__pyx_pw_3gen_3gen_473dirzetak, METH_O, 0},
    {"galoisapply", (PyCFunction)__pyx_pw_3gen_3gen_475galoisapply, METH_VARARGS|METH_KEYWORDS, 0},
    {"galoisinit", (PyCFunction)__pyx_pw_3gen_3gen_477galoisinit, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_476galoisinit},
    {"galoispermtopol", (PyCFunction)__pyx_pw_3gen_3gen_479galoispermtopol, METH_O, 0},
    {"galoisfixedfield", (PyCFunction)__pyx_pw_3gen_3gen_481galoisfixedfield, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealred", (PyCFunction)__pyx_pw_3gen_3gen_483idealred, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealadd", (PyCFunction)__pyx_pw_3gen_3gen_485idealadd, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealaddtoone", (PyCFunction)__pyx_pw_3gen_3gen_487idealaddtoone, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealappr", (PyCFunction)__pyx_pw_3gen_3gen_489idealappr, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealcoprime", (PyCFunction)__pyx_pw_3gen_3gen_491idealcoprime, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_490idealcoprime},
    {"idealdiv", (PyCFunction)__pyx_pw_3gen_3gen_493idealdiv, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealfactor", (PyCFunction)__pyx_pw_3gen_3gen_495idealfactor, METH_O, 0},
    {"idealhnf", (PyCFunction)__pyx_pw_3gen_3gen_497idealhnf, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealintersection", (PyCFunction)__pyx_pw_3gen_3gen_499idealintersection, METH_VARARGS|METH_KEYWORDS, 0},
    {"ideallist", (PyCFunction)__pyx_pw_3gen_3gen_501ideallist, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_500ideallist},
    {"ideallog", (PyCFunction)__pyx_pw_3gen_3gen_503ideallog, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_502ideallog},
    {"idealmul", (PyCFunction)__pyx_pw_3gen_3gen_505idealmul, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealnorm", (PyCFunction)__pyx_pw_3gen_3gen_507idealnorm, METH_O, 0},
    {"idealprimedec", (PyCFunction)__pyx_pw_3gen_3gen_509idealprimedec, METH_O, __pyx_doc_3gen_3gen_508idealprimedec},
    {"idealstar", (PyCFunction)__pyx_pw_3gen_3gen_511idealstar, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_510idealstar},
    {"idealtwoelt", (PyCFunction)__pyx_pw_3gen_3gen_513idealtwoelt, METH_VARARGS|METH_KEYWORDS, 0},
    {"idealval", (PyCFunction)__pyx_pw_3gen_3gen_515idealval, METH_VARARGS|METH_KEYWORDS, 0},
    {"elementval", (PyCFunction)__pyx_pw_3gen_3gen_517elementval, METH_VARARGS|METH_KEYWORDS, 0},
    {"modreverse", (PyCFunction)__pyx_pw_3gen_3gen_519modreverse, METH_NOARGS, __pyx_doc_3gen_3gen_518modreverse},
    {"nfbasis", (PyCFunction)__pyx_pw_3gen_3gen_521nfbasis, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_520nfbasis},
    {"nfbasis_d", (PyCFunction)__pyx_pw_3gen_3gen_523nfbasis_d, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_522nfbasis_d},
    {"nfbasistoalg", (PyCFunction)__pyx_pw_3gen_3gen_525nfbasistoalg, METH_O, __pyx_doc_3gen_3gen_524nfbasistoalg},
    {"nfbasistoalg_lift", (PyCFunction)__pyx_pw_3gen_3gen_527nfbasistoalg_lift, METH_O, __pyx_doc_3gen_3gen_526nfbasistoalg_lift},
    {"nfdisc", (PyCFunction)__pyx_pw_3gen_3gen_529nfdisc, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_528nfdisc},
    {"nfeltdiveuc", (PyCFunction)__pyx_pw_3gen_3gen_531nfeltdiveuc, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_530nfeltdiveuc},
    {"nfeltreduce", (PyCFunction)__pyx_pw_3gen_3gen_533nfeltreduce, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_532nfeltreduce},
    {"nffactor", (PyCFunction)__pyx_pw_3gen_3gen_535nffactor, METH_O, 0},
    {"nfgenerator", (PyCFunction)__pyx_pw_3gen_3gen_537nfgenerator, METH_NOARGS, 0},
    {"nfhilbert", (PyCFunction)__pyx_pw_3gen_3gen_539nfhilbert, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_538nfhilbert},
    {"nfhnf", (PyCFunction)__pyx_pw_3gen_3gen_541nfhnf, METH_O, __pyx_doc_3gen_3gen_540nfhnf},
    {"nfinit", (PyCFunction)__pyx_pw_3gen_3gen_543nfinit, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_542nfinit},
    {"nfisisom", (PyCFunction)__pyx_pw_3gen_3gen_545nfisisom, METH_O, __pyx_doc_3gen_3gen_544nfisisom},
    {"nfrootsof1", (PyCFunction)__pyx_pw_3gen_3gen_547nfrootsof1, METH_NOARGS, __pyx_doc_3gen_3gen_546nfrootsof1},
    {"nfsubfields", (PyCFunction)__pyx_pw_3gen_3gen_549nfsubfields, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_548nfsubfields},
    {"rnfcharpoly", (PyCFunction)__pyx_pw_3gen_3gen_551rnfcharpoly, METH_VARARGS|METH_KEYWORDS, 0},
    {"rnfdisc", (PyCFunction)__pyx_pw_3gen_3gen_553rnfdisc, METH_O, 0},
    {"rnfeltabstorel", (PyCFunction)__pyx_pw_3gen_3gen_555rnfeltabstorel, METH_O, 0},
    {"rnfeltreltoabs", (PyCFunction)__pyx_pw_3gen_3gen_557rnfeltreltoabs, METH_O, 0},
    {"rnfequation", (PyCFunction)__pyx_pw_3gen_3gen_559rnfequation, METH_VARARGS|METH_KEYWORDS, 0},
    {"rnfidealabstorel", (PyCFunction)__pyx_pw_3gen_3gen_561rnfidealabstorel, METH_O, 0},
    {"rnfidealdown", (PyCFunction)__pyx_pw_3gen_3gen_563rnfidealdown, METH_O, __pyx_doc_3gen_3gen_562rnfidealdown},
    {"rnfidealhnf", (PyCFunction)__pyx_pw_3gen_3gen_565rnfidealhnf, METH_O, 0},
    {"rnfidealnormrel", (PyCFunction)__pyx_pw_3gen_3gen_567rnfidealnormrel, METH_O, 0},
    {"rnfidealreltoabs", (PyCFunction)__pyx_pw_3gen_3gen_569rnfidealreltoabs, METH_O, 0},
    {"rnfidealtwoelt", (PyCFunction)__pyx_pw_3gen_3gen_571rnfidealtwoelt, METH_O, 0},
    {"rnfinit", (PyCFunction)__pyx_pw_3gen_3gen_573rnfinit, METH_O, __pyx_doc_3gen_3gen_572rnfinit},
    {"rnfisfree", (PyCFunction)__pyx_pw_3gen_3gen_575rnfisfree, METH_O, 0},
    {"quadhilbert", (PyCFunction)__pyx_pw_3gen_3gen_577quadhilbert, METH_NOARGS, __pyx_doc_3gen_3gen_576quadhilbert},
    {"reverse", (PyCFunction)__pyx_pw_3gen_3gen_579reverse, METH_NOARGS, __pyx_doc_3gen_3gen_578reverse},
    {"content", (PyCFunction)__pyx_pw_3gen_3gen_581content, METH_NOARGS, __pyx_doc_3gen_3gen_580content},
    {"deriv", (PyCFunction)__pyx_pw_3gen_3gen_583deriv, METH_VARARGS|METH_KEYWORDS, 0},
    {"eval", (PyCFunction)__pyx_pw_3gen_3gen_585eval, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_584eval},
    {"factornf", (PyCFunction)__pyx_pw_3gen_3gen_589factornf, METH_O, __pyx_doc_3gen_3gen_588factornf},
    {"factorpadic", (PyCFunction)__pyx_pw_3gen_3gen_591factorpadic, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_590factorpadic},
    {"factormod", (PyCFunction)__pyx_pw_3gen_3gen_593factormod, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_592factormod},
    {"intformal", (PyCFunction)__pyx_pw_3gen_3gen_595intformal, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_594intformal},
    {"padicappr", (PyCFunction)__pyx_pw_3gen_3gen_597padicappr, METH_O, __pyx_doc_3gen_3gen_596padicappr},
    {"newtonpoly", (PyCFunction)__pyx_pw_3gen_3gen_599newtonpoly, METH_O, __pyx_doc_3gen_3gen_598newtonpoly},
    {"polcoeff", (PyCFunction)__pyx_pw_3gen_3gen_601polcoeff, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_600polcoeff},
    {"polcompositum", (PyCFunction)__pyx_pw_3gen_3gen_603polcompositum, METH_VARARGS|METH_KEYWORDS, 0},
    {"poldegree", (PyCFunction)__pyx_pw_3gen_3gen_605poldegree, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_604poldegree},
    {"poldisc", (PyCFunction)__pyx_pw_3gen_3gen_607poldisc, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_606poldisc},
    {"poldiscreduced", (PyCFunction)__pyx_pw_3gen_3gen_609poldiscreduced, METH_NOARGS, 0},
    {"polgalois", (PyCFunction)__pyx_pw_3gen_3gen_611polgalois, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_610polgalois},
    {"nfgaloisconj", (PyCFunction)__pyx_pw_3gen_3gen_613nfgaloisconj, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_612nfgaloisconj},
    {"nfroots", (PyCFunction)__pyx_pw_3gen_3gen_615nfroots, METH_O, __pyx_doc_3gen_3gen_614nfroots},
    {"polhensellift", (PyCFunction)__pyx_pw_3gen_3gen_617polhensellift, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_616polhensellift},
    {"polisirreducible", (PyCFunction)__pyx_pw_3gen_3gen_619polisirreducible, METH_NOARGS, __pyx_doc_3gen_3gen_618polisirreducible},
    {"pollead", (PyCFunction)__pyx_pw_3gen_3gen_621pollead, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_620pollead},
    {"polrecip", (PyCFunction)__pyx_pw_3gen_3gen_623polrecip, METH_NOARGS, 0},
    {"polred", (PyCFunction)__pyx_pw_3gen_3gen_625polred, METH_VARARGS|METH_KEYWORDS, 0},
    {"polredabs", (PyCFunction)__pyx_pw_3gen_3gen_627polredabs, METH_VARARGS|METH_KEYWORDS, 0},
    {"polredbest", (PyCFunction)__pyx_pw_3gen_3gen_629polredbest, METH_VARARGS|METH_KEYWORDS, 0},
    {"polresultant", (PyCFunction)__pyx_pw_3gen_3gen_631polresultant, METH_VARARGS|METH_KEYWORDS, 0},
    {"polroots", (PyCFunction)__pyx_pw_3gen_3gen_633polroots, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_632polroots},
    {"polrootsmod", (PyCFunction)__pyx_pw_3gen_3gen_635polrootsmod, METH_VARARGS|METH_KEYWORDS, 0},
    {"polrootspadic", (PyCFunction)__pyx_pw_3gen_3gen_637polrootspadic, METH_VARARGS|METH_KEYWORDS, 0},
    {"polrootspadicfast", (PyCFunction)__pyx_pw_3gen_3gen_639polrootspadicfast, METH_VARARGS|METH_KEYWORDS, 0},
    {"polsturm", (PyCFunction)__pyx_pw_3gen_3gen_641polsturm, METH_VARARGS|METH_KEYWORDS, 0},
    {"polsturm_full", (PyCFunction)__pyx_pw_3gen_3gen_643polsturm_full, METH_NOARGS, 0},
    {"polsylvestermatrix", (PyCFunction)__pyx_pw_3gen_3gen_645polsylvestermatrix, METH_O, 0},
    {"polsym", (PyCFunction)__pyx_pw_3gen_3gen_647polsym, METH_O, 0},
    {"serconvol", (PyCFunction)__pyx_pw_3gen_3gen_649serconvol, METH_O, 0},
    {"serlaplace", (PyCFunction)__pyx_pw_3gen_3gen_651serlaplace, METH_NOARGS, 0},
    {"serreverse", (PyCFunction)__pyx_pw_3gen_3gen_653serreverse, METH_NOARGS, __pyx_doc_3gen_3gen_652serreverse},
    {"thueinit", (PyCFunction)__pyx_pw_3gen_3gen_655thueinit, METH_VARARGS|METH_KEYWORDS, 0},
    {"rnfisnorminit", (PyCFunction)__pyx_pw_3gen_3gen_657rnfisnorminit, METH_VARARGS|METH_KEYWORDS, 0},
    {"rnfisnorm", (PyCFunction)__pyx_pw_3gen_3gen_659rnfisnorm, METH_VARARGS|METH_KEYWORDS, 0},
    {"vecextract", (PyCFunction)__pyx_pw_3gen_3gen_661vecextract, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_660vecextract},
    {"ncols", (PyCFunction)__pyx_pw_3gen_3gen_663ncols, METH_NOARGS, __pyx_doc_3gen_3gen_662ncols},
    {"nrows", (PyCFunction)__pyx_pw_3gen_3gen_665nrows, METH_NOARGS, __pyx_doc_3gen_3gen_664nrows},
    {"mattranspose", (PyCFunction)__pyx_pw_3gen_3gen_667mattranspose, METH_NOARGS, __pyx_doc_3gen_3gen_666mattranspose},
    {"matadjoint", (PyCFunction)__pyx_pw_3gen_3gen_669matadjoint, METH_NOARGS, __pyx_doc_3gen_3gen_668matadjoint},
    {"qflll", (PyCFunction)__pyx_pw_3gen_3gen_671qflll, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_670qflll},
    {"qflllgram", (PyCFunction)__pyx_pw_3gen_3gen_673qflllgram, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_672qflllgram},
    {"lllgram", (PyCFunction)__pyx_pw_3gen_3gen_675lllgram, METH_NOARGS, 0},
    {"lllgramint", (PyCFunction)__pyx_pw_3gen_3gen_677lllgramint, METH_NOARGS, 0},
    {"qfminim", (PyCFunction)__pyx_pw_3gen_3gen_679qfminim, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_678qfminim},
    {"qfrep", (PyCFunction)__pyx_pw_3gen_3gen_681qfrep, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_680qfrep},
    {"matsolve", (PyCFunction)__pyx_pw_3gen_3gen_683matsolve, METH_O, __pyx_doc_3gen_3gen_682matsolve},
    {"matsolvemod", (PyCFunction)__pyx_pw_3gen_3gen_685matsolvemod, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_684matsolvemod},
    {"matker", (PyCFunction)__pyx_pw_3gen_3gen_687matker, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_686matker},
    {"matkerint", (PyCFunction)__pyx_pw_3gen_3gen_689matkerint, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_688matkerint},
    {"matdet", (PyCFunction)__pyx_pw_3gen_3gen_691matdet, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_690matdet},
    {"trace", (PyCFunction)__pyx_pw_3gen_3gen_693trace, METH_NOARGS, __pyx_doc_3gen_3gen_692trace},
    {"mathnf", (PyCFunction)__pyx_pw_3gen_3gen_695mathnf, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_694mathnf},
    {"mathnfmod", (PyCFunction)__pyx_pw_3gen_3gen_697mathnfmod, METH_O, __pyx_doc_3gen_3gen_696mathnfmod},
    {"mathnfmodid", (PyCFunction)__pyx_pw_3gen_3gen_699mathnfmodid, METH_O, __pyx_doc_3gen_3gen_698mathnfmodid},
    {"matsnf", (PyCFunction)__pyx_pw_3gen_3gen_701matsnf, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_700matsnf},
    {"matfrobenius", (PyCFunction)__pyx_pw_3gen_3gen_703matfrobenius, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_702matfrobenius},
    {"factor", (PyCFunction)__pyx_pw_3gen_3gen_705factor, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_704factor},
    {"hilbert", (PyCFunction)__pyx_pw_3gen_3gen_707hilbert, METH_VARARGS|METH_KEYWORDS, 0},
    {"chinese", (PyCFunction)__pyx_pw_3gen_3gen_709chinese, METH_O, 0},
    {"order", (PyCFunction)__pyx_pw_3gen_3gen_711order, METH_NOARGS, 0},
    {"norm", (PyCFunction)__pyx_pw_3gen_3gen_715norm, METH_NOARGS, 0},
    {"nextprime", (PyCFunction)__pyx_pw_3gen_3gen_717nextprime, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_716nextprime},
    {"change_variable_name", (PyCFunction)__pyx_pw_3gen_3gen_719change_variable_name, METH_O, __pyx_doc_3gen_3gen_718change_variable_name},
    {"subst", (PyCFunction)__pyx_pw_3gen_3gen_721subst, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_720subst},
    {"substpol", (PyCFunction)__pyx_pw_3gen_3gen_723substpol, METH_VARARGS|METH_KEYWORDS, 0},
    {"nf_subst", (PyCFunction)__pyx_pw_3gen_3gen_725nf_subst, METH_O, __pyx_doc_3gen_3gen_724nf_subst},
    {"taylor", (PyCFunction)__pyx_pw_3gen_3gen_727taylor, METH_VARARGS|METH_KEYWORDS, 0},
    {"thue", (PyCFunction)__pyx_pw_3gen_3gen_729thue, METH_VARARGS|METH_KEYWORDS, 0},
    {"charpoly", (PyCFunction)__pyx_pw_3gen_3gen_731charpoly, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_730charpoly},
    {"kronecker", (PyCFunction)__pyx_pw_3gen_3gen_733kronecker, METH_O, 0},
    {"type", (PyCFunction)__pyx_pw_3gen_3gen_735type, METH_NOARGS, __pyx_doc_3gen_3gen_734type},
    {"polinterpolate", (PyCFunction)__pyx_pw_3gen_3gen_737polinterpolate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_736polinterpolate},
    {"algdep", (PyCFunction)__pyx_pw_3gen_3gen_739algdep, METH_O, __pyx_doc_3gen_3gen_738algdep},
    {"concat", (PyCFunction)__pyx_pw_3gen_3gen_741concat, METH_O, 0},
    {"lindep", (PyCFunction)__pyx_pw_3gen_3gen_743lindep, METH_VARARGS|METH_KEYWORDS, 0},
    {"listinsert", (PyCFunction)__pyx_pw_3gen_3gen_745listinsert, METH_VARARGS|METH_KEYWORDS, 0},
    {"listput", (PyCFunction)__pyx_pw_3gen_3gen_747listput, METH_VARARGS|METH_KEYWORDS, 0},
    {"elleisnum", (PyCFunction)__pyx_pw_3gen_3gen_749elleisnum, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_748elleisnum},
    {"ellwp", (PyCFunction)__pyx_pw_3gen_3gen_751ellwp, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_750ellwp},
    {"ellchangepoint", (PyCFunction)__pyx_pw_3gen_3gen_753ellchangepoint, METH_O, __pyx_doc_3gen_3gen_752ellchangepoint},
    {"debug", (PyCFunction)__pyx_pw_3gen_3gen_755debug, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3gen_3gen_754debug},
    {0, 0, 0, 0}
  };

  static PyNumberMethods __pyx_tp_as_number_gen = {
    __pyx_pw_3gen_3gen_41__add__, /*nb_add*/
    __pyx_pw_3gen_3gen_43__sub__, /*nb_subtract*/
    __pyx_pw_3gen_3gen_45__mul__, /*nb_multiply*/
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_3gen_3gen_47__div__, /*nb_divide*/
    #endif
    __pyx_pw_3gen_3gen_27__mod__, /*nb_remainder*/
    0, /*nb_divmod*/
    __pyx_pw_3gen_3gen_29__pow__, /*nb_power*/
    __pyx_pw_3gen_3gen_31__neg__, /*nb_negative*/
    0, /*nb_positive*/
    __pyx_pw_3gen_3gen_713__abs__, /*nb_absolute*/
    __pyx_pw_3gen_3gen_111__nonzero__, /*nb_nonzero*/
    __pyx_pw_3gen_3gen_39__invert__, /*nb_invert*/
    __pyx_pw_3gen_3gen_37__lshift__, /*nb_lshift*/
    __pyx_pw_3gen_3gen_35__rshift__, /*nb_rshift*/
    0, /*nb_and*/
    __pyx_pw_3gen_3gen_33__xor__, /*nb_xor*/
    0, /*nb_or*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_coerce*/
    #endif
    __pyx_pw_3gen_3gen_97__int__, /*nb_int*/
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_3gen_3gen_105__long__, /*nb_long*/
    #else
    0, /*reserved*/
    #endif
    __pyx_pw_3gen_3gen_107__float__, /*nb_float*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_oct*/
    #endif
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_3gen_3gen_95__hex__, /*nb_hex*/
    #endif
    0, /*nb_inplace_add*/
    0, /*nb_inplace_subtract*/
    0, /*nb_inplace_multiply*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_inplace_divide*/
    #endif
    0, /*nb_inplace_remainder*/
    0, /*nb_inplace_power*/
    0, /*nb_inplace_lshift*/
    0, /*nb_inplace_rshift*/
    0, /*nb_inplace_and*/
    0, /*nb_inplace_xor*/
    0, /*nb_inplace_or*/
    0, /*nb_floor_divide*/
    0, /*nb_true_divide*/
    0, /*nb_inplace_floor_divide*/
    0, /*nb_inplace_true_divide*/
    0, /*nb_index*/
    #if PY_VERSION_HEX >= 0x03050000
    0, /*nb_matrix_multiply*/
    #endif
    #if PY_VERSION_HEX >= 0x03050000
    0, /*nb_inplace_matrix_multiply*/
    #endif
  };

  static PySequenceMethods __pyx_tp_as_sequence_gen = {
    __pyx_pw_3gen_3gen_85__len__, /*sq_length*/
    0, /*sq_concat*/
    0, /*sq_repeat*/
    __pyx_sq_item_3gen_gen, /*sq_item*/
    0, /*sq_slice*/
    0, /*sq_ass_item*/
    0, /*sq_ass_slice*/
    0, /*sq_contains*/
    0, /*sq_inplace_concat*/
    0, /*sq_inplace_repeat*/
  };

  static PyMappingMethods __pyx_tp_as_mapping_gen = {
    __pyx_pw_3gen_3gen_85__len__, /*mp_length*/
    __pyx_pw_3gen_3gen_81__getitem__, /*mp_subscript*/
    __pyx_mp_ass_subscript_3gen_gen, /*mp_ass_subscript*/
  };

  static PyTypeObject __pyx_type_3gen_gen = {
    PyVarObject_HEAD_INIT(0, 0)
    "gen.gen", /*tp_name*/
    sizeof(struct __pyx_obj_3gen_gen), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_3gen_gen, /*tp_dealloc*/
    0, /*tp_print*/
    0, /*tp_getattr*/
    0, /*tp_setattr*/
    #if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
    #else
    0, /*reserved*/
    #endif
    __pyx_pw_3gen_3gen_7__repr__, /*tp_repr*/
    &__pyx_tp_as_number_gen, /*tp_as_number*/
    &__pyx_tp_as_sequence_gen, /*tp_as_sequence*/
    &__pyx_tp_as_mapping_gen, /*tp_as_mapping*/
    __pyx_pw_3gen_3gen_9__hash__, /*tp_hash*/
    __pyx_pw_3gen_3gen_587__call__, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    0, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    "\n    Python extension class that models the PARI GEN type.\n    ", /*tp_doc*/
    __pyx_tp_traverse_3gen_gen, /*tp_traverse*/
    __pyx_tp_clear_3gen_gen, /*tp_clear*/
    __pyx_pw_3gen_3gen_87__richcmp__, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    __pyx_methods_3gen_gen, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    __pyx_pw_3gen_3gen_1__init__, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_3gen_gen, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    0, /*tp_version_tag*/
    #if PY_VERSION_HEX >= 0x030400a1
    0, /*tp_finalize*/
    #endif
  };

  static PyMethodDef __pyx_methods[] = {
    {0, 0, 0, 0}
  };

  #if PY_MAJOR_VERSION >= 3
  static struct PyModuleDef __pyx_moduledef = {
    #if PY_VERSION_HEX < 0x03020000
      { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
    #else
      PyModuleDef_HEAD_INIT,
    #endif
      "gen",
      __pyx_k_Sage_class_for_PARI_s_GEN_type, /* m_doc */
      -1, /* m_size */
      __pyx_methods /* m_methods */,
      NULL, /* m_reload */
      NULL, /* m_traverse */
      NULL, /* m_clear */
      NULL /* m_free */
  };
  #endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_s_0, __pyx_k_0, sizeof(__pyx_k_0), 0, 0, 1, 0},
  {&__pyx_n_s_A, __pyx_k_A, sizeof(__pyx_k_A), 0, 0, 1, 1},
  {&__pyx_n_s_AttributeError, __pyx_k_AttributeError, sizeof(__pyx_k_AttributeError), 0, 0, 1, 1},
  {&__pyx_n_s_B, __pyx_k_B, sizeof(__pyx_k_B), 0, 0, 1, 1},
  {&__pyx_kp_s_BIG_WARNING_The_number_s_wasn_t, __pyx_k_BIG_WARNING_The_number_s_wasn_t, sizeof(__pyx_k_BIG_WARNING_The_number_s_wasn_t), 0, 0, 1, 0},
  {&__pyx_n_s_D, __pyx_k_D, sizeof(__pyx_k_D), 0, 0, 1, 1},
  {&__pyx_kp_s_Error_raised_by_PARI, __pyx_k_Error_raised_by_PARI, sizeof(__pyx_k_Error_raised_by_PARI), 0, 0, 1, 0},
  {&__pyx_n_s_GeneratorType, __pyx_k_GeneratorType, sizeof(__pyx_k_GeneratorType), 0, 0, 1, 1},
  {&__pyx_n_s_I, __pyx_k_I, sizeof(__pyx_k_I), 0, 0, 1, 1},
  {&__pyx_n_s_IndexError, __pyx_k_IndexError, sizeof(__pyx_k_IndexError), 0, 0, 1, 1},
  {&__pyx_n_s_Integer, __pyx_k_Integer, sizeof(__pyx_k_Integer), 0, 0, 1, 1},
  {&__pyx_n_s_ListType, __pyx_k_ListType, sizeof(__pyx_k_ListType), 0, 0, 1, 1},
  {&__pyx_kp_s_Mat, __pyx_k_Mat, sizeof(__pyx_k_Mat), 0, 0, 1, 0},
  {&__pyx_n_s_Mat_2, __pyx_k_Mat_2, sizeof(__pyx_k_Mat_2), 0, 0, 1, 1},
  {&__pyx_n_s_Mod, __pyx_k_Mod, sizeof(__pyx_k_Mod), 0, 0, 1, 1},
  {&__pyx_kp_s_Not_an_INTMOD_or_POLMOD_in_mod, __pyx_k_Not_an_INTMOD_or_POLMOD_in_mod, sizeof(__pyx_k_Not_an_INTMOD_or_POLMOD_in_mod), 0, 0, 1, 0},
  {&__pyx_kp_s_Object_s_must_be_of_type_t_VEC, __pyx_k_Object_s_must_be_of_type_t_VEC, sizeof(__pyx_k_Object_s_must_be_of_type_t_VEC), 0, 0, 1, 0},
  {&__pyx_kp_s_Object_s_must_be_of_type_t_VECSM, __pyx_k_Object_s_must_be_of_type_t_VECSM, sizeof(__pyx_k_Object_s_must_be_of_type_t_VECSM), 0, 0, 1, 0},
  {&__pyx_kp_s_PARI_closure_takes_at_most_d_arg, __pyx_k_PARI_closure_takes_at_most_d_arg, sizeof(__pyx_k_PARI_closure_takes_at_most_d_arg), 0, 0, 1, 0},
  {&__pyx_kp_s_PARI_objects_cannot_be_instantia, __pyx_k_PARI_objects_cannot_be_instantia, sizeof(__pyx_k_PARI_objects_cannot_be_instantia), 0, 0, 1, 0},
  {&__pyx_n_s_PariError, __pyx_k_PariError, sizeof(__pyx_k_PariError), 0, 0, 1, 1},
  {&__pyx_n_s_PariError___repr, __pyx_k_PariError___repr, sizeof(__pyx_k_PariError___repr), 0, 0, 1, 1},
  {&__pyx_n_s_PariError___str, __pyx_k_PariError___str, sizeof(__pyx_k_PariError___str), 0, 0, 1, 1},
  {&__pyx_kp_s_PariError_d, __pyx_k_PariError_d, sizeof(__pyx_k_PariError_d), 0, 0, 1, 0},
  {&__pyx_n_s_PariError_errnum, __pyx_k_PariError_errnum, sizeof(__pyx_k_PariError_errnum), 0, 0, 1, 1},
  {&__pyx_n_s_PariError_errtext, __pyx_k_PariError_errtext, sizeof(__pyx_k_PariError_errtext), 0, 0, 1, 1},
  {&__pyx_n_s_Polrev, __pyx_k_Polrev, sizeof(__pyx_k_Polrev), 0, 0, 1, 1},
  {&__pyx_n_s_RuntimeError, __pyx_k_RuntimeError, sizeof(__pyx_k_RuntimeError), 0, 0, 1, 1},
  {&__pyx_n_s_S, __pyx_k_S, sizeof(__pyx_k_S), 0, 0, 1, 1},
  {&__pyx_n_s_Strtex, __pyx_k_Strtex, sizeof(__pyx_k_Strtex), 0, 0, 1, 1},
  {&__pyx_n_s_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 1, 1},
  {&__pyx_kp_s_The_method_lngamma_is_deprecated, __pyx_k_The_method_lngamma_is_deprecated, sizeof(__pyx_k_The_method_lngamma_is_deprecated), 0, 0, 1, 0},
  {&__pyx_kp_s_This_is_probably_an_infinite_loo, __pyx_k_This_is_probably_an_infinite_loo, sizeof(__pyx_k_This_is_probably_an_infinite_loo), 0, 0, 1, 0},
  {&__pyx_n_s_TupleType, __pyx_k_TupleType, sizeof(__pyx_k_TupleType), 0, 0, 1, 1},
  {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
  {&__pyx_kp_s_Unknown_PARI_type_s, __pyx_k_Unknown_PARI_type_s, sizeof(__pyx_k_Unknown_PARI_type_s), 0, 0, 1, 0},
  {&__pyx_kp_s_Use_for_exponentiation_not_which, __pyx_k_Use_for_exponentiation_not_which, sizeof(__pyx_k_Use_for_exponentiation_not_which), 0, 0, 1, 0},
  {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
  {&__pyx_n_s_Vec, __pyx_k_Vec, sizeof(__pyx_k_Vec), 0, 0, 1, 1},
  {&__pyx_n_s_Vecrev, __pyx_k_Vecrev, sizeof(__pyx_k_Vecrev), 0, 0, 1, 1},
  {&__pyx_n_s_XRangeType, __pyx_k_XRangeType, sizeof(__pyx_k_XRangeType), 0, 0, 1, 1},
  {&__pyx_n_s_ZeroDivisionError, __pyx_k_ZeroDivisionError, sizeof(__pyx_k_ZeroDivisionError), 0, 0, 1, 1},
  {&__pyx_kp_s__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 0, 1, 0},
  {&__pyx_kp_s__11, __pyx_k__11, sizeof(__pyx_k__11), 0, 0, 1, 0},
  {&__pyx_kp_s__12, __pyx_k__12, sizeof(__pyx_k__12), 0, 0, 1, 0},
  {&__pyx_kp_s__14, __pyx_k__14, sizeof(__pyx_k__14), 0, 0, 1, 0},
  {&__pyx_kp_s__16, __pyx_k__16, sizeof(__pyx_k__16), 0, 0, 1, 0},
  {&__pyx_kp_s__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 0, 1, 0},
  {&__pyx_kp_s__29, __pyx_k__29, sizeof(__pyx_k__29), 0, 0, 1, 0},
  {&__pyx_kp_s__31, __pyx_k__31, sizeof(__pyx_k__31), 0, 0, 1, 0},
  {&__pyx_kp_s__33, __pyx_k__33, sizeof(__pyx_k__33), 0, 0, 1, 0},
  {&__pyx_kp_s__5, __pyx_k__5, sizeof(__pyx_k__5), 0, 0, 1, 0},
  {&__pyx_kp_s__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 0, 1, 0},
  {&__pyx_kp_s__8, __pyx_k__8, sizeof(__pyx_k__8), 0, 0, 1, 0},
  {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
  {&__pyx_n_s_abs, __pyx_k_abs, sizeof(__pyx_k_abs), 0, 0, 1, 1},
  {&__pyx_n_s_add_one, __pyx_k_add_one, sizeof(__pyx_k_add_one), 0, 0, 1, 1},
  {&__pyx_n_s_allocatemem, __pyx_k_allocatemem, sizeof(__pyx_k_allocatemem), 0, 0, 1, 1},
  {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
  {&__pyx_kp_s_attempt_to_assign_sequence_of_si, __pyx_k_attempt_to_assign_sequence_of_si, sizeof(__pyx_k_attempt_to_assign_sequence_of_si), 0, 0, 1, 0},
  {&__pyx_n_s_aut, __pyx_k_aut, sizeof(__pyx_k_aut), 0, 0, 1, 1},
  {&__pyx_n_s_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 0, 1, 1},
  {&__pyx_n_s_bezout, __pyx_k_bezout, sizeof(__pyx_k_bezout), 0, 0, 1, 1},
  {&__pyx_n_s_bid, __pyx_k_bid, sizeof(__pyx_k_bid), 0, 0, 1, 1},
  {&__pyx_n_s_bound, __pyx_k_bound, sizeof(__pyx_k_bound), 0, 0, 1, 1},
  {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
  {&__pyx_kp_s_cannot_evaluate_PARI_s_using_unn, __pyx_k_cannot_evaluate_PARI_s_using_unn, sizeof(__pyx_k_cannot_evaluate_PARI_s_using_unn), 0, 0, 1, 0},
  {&__pyx_kp_s_cannot_evaluate_a_PARI_closure_u, __pyx_k_cannot_evaluate_a_PARI_closure_u, sizeof(__pyx_k_cannot_evaluate_a_PARI_closure_u), 0, 0, 1, 0},
  {&__pyx_kp_s_cannot_index_PARI_type_s_by_tupl, __pyx_k_cannot_index_PARI_type_s_by_tupl, sizeof(__pyx_k_cannot_index_PARI_type_s_by_tupl), 0, 0, 1, 0},
  {&__pyx_n_s_chr, __pyx_k_chr, sizeof(__pyx_k_chr), 0, 0, 1, 1},
  {&__pyx_n_s_cmp_c_impl, __pyx_k_cmp_c_impl, sizeof(__pyx_k_cmp_c_impl), 0, 0, 1, 1},
  {&__pyx_kp_s_column_index_out_of_bounds, __pyx_k_column_index_out_of_bounds, sizeof(__pyx_k_column_index_out_of_bounds), 0, 0, 1, 0},
  {&__pyx_kp_s_column_j_s_must_be_between_0_and, __pyx_k_column_j_s_must_be_between_0_and, sizeof(__pyx_k_column_j_s_must_be_between_0_and), 0, 0, 1, 0},
  {&__pyx_n_s_component, __pyx_k_component, sizeof(__pyx_k_component), 0, 0, 1, 1},
  {&__pyx_n_s_d, __pyx_k_d, sizeof(__pyx_k_d), 0, 0, 1, 1},
  {&__pyx_n_s_den, __pyx_k_den, sizeof(__pyx_k_den), 0, 0, 1, 1},
  {&__pyx_n_s_denom, __pyx_k_denom, sizeof(__pyx_k_denom), 0, 0, 1, 1},
  {&__pyx_n_s_deprecation, __pyx_k_deprecation, sizeof(__pyx_k_deprecation), 0, 0, 1, 1},
  {&__pyx_n_s_depth, __pyx_k_depth, sizeof(__pyx_k_depth), 0, 0, 1, 1},
  {&__pyx_n_s_doc, __pyx_k_doc, sizeof(__pyx_k_doc), 0, 0, 1, 1},
  {&__pyx_n_s_e, __pyx_k_e, sizeof(__pyx_k_e), 0, 0, 1, 1},
  {&__pyx_n_s_ellaplist, __pyx_k_ellaplist, sizeof(__pyx_k_ellaplist), 0, 0, 1, 1},
  {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
  {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
  {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
  {&__pyx_n_s_errnum, __pyx_k_errnum, sizeof(__pyx_k_errnum), 0, 0, 1, 1},
  {&__pyx_n_s_errtext, __pyx_k_errtext, sizeof(__pyx_k_errtext), 0, 0, 1, 1},
  {&__pyx_n_s_estimate, __pyx_k_estimate, sizeof(__pyx_k_estimate), 0, 0, 1, 1},
  {&__pyx_n_s_eval, __pyx_k_eval, sizeof(__pyx_k_eval), 0, 0, 1, 1},
  {&__pyx_n_s_eval_2, __pyx_k_eval_2, sizeof(__pyx_k_eval_2), 0, 0, 1, 1},
  {&__pyx_kp_s_evaluating_PARI_s_takes_exactly, __pyx_k_evaluating_PARI_s_takes_exactly, sizeof(__pyx_k_evaluating_PARI_s_takes_exactly), 0, 0, 1, 0},
  {&__pyx_n_s_fa, __pyx_k_fa, sizeof(__pyx_k_fa), 0, 0, 1, 1},
  {&__pyx_n_s_factor, __pyx_k_factor, sizeof(__pyx_k_factor), 0, 0, 1, 1},
  {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
  {&__pyx_n_s_find, __pyx_k_find, sizeof(__pyx_k_find), 0, 0, 1, 1},
  {&__pyx_n_s_find_root, __pyx_k_find_root, sizeof(__pyx_k_find_root), 0, 0, 1, 1},
  {&__pyx_n_s_flag, __pyx_k_flag, sizeof(__pyx_k_flag), 0, 0, 1, 1},
  {&__pyx_n_s_gen, __pyx_k_gen, sizeof(__pyx_k_gen), 0, 0, 1, 1},
  {&__pyx_kp_s_gen_must_be_of_PARI_type_t_INT, __pyx_k_gen_must_be_of_PARI_type_t_INT, sizeof(__pyx_k_gen_must_be_of_PARI_type_t_INT), 0, 0, 1, 0},
  {&__pyx_n_s_gen_py, __pyx_k_gen_py, sizeof(__pyx_k_gen_py), 0, 0, 1, 1},
  {&__pyx_n_s_get_real_precision, __pyx_k_get_real_precision, sizeof(__pyx_k_get_real_precision), 0, 0, 1, 1},
  {&__pyx_n_s_get_series_precision, __pyx_k_get_series_precision, sizeof(__pyx_k_get_series_precision), 0, 0, 1, 1},
  {&__pyx_n_s_getitem, __pyx_k_getitem, sizeof(__pyx_k_getitem), 0, 0, 1, 1},
  {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
  {&__pyx_kp_s_in_Python_and_has_the_wrong_prec, __pyx_k_in_Python_and_has_the_wrong_prec, sizeof(__pyx_k_in_Python_and_has_the_wrong_prec), 0, 0, 1, 0},
  {&__pyx_kp_s_index_must_be_an_integer_or_a_2, __pyx_k_index_must_be_an_integer_or_a_2, sizeof(__pyx_k_index_must_be_an_integer_or_a_2), 0, 0, 1, 0},
  {&__pyx_kp_s_index_out_of_bounds, __pyx_k_index_out_of_bounds, sizeof(__pyx_k_index_out_of_bounds), 0, 0, 1, 0},
  {&__pyx_kp_s_index_s_must_be_between_0_and_s, __pyx_k_index_s_must_be_between_0_and_s, sizeof(__pyx_k_index_s_must_be_between_0_and_s), 0, 0, 1, 0},
  {&__pyx_n_s_indices, __pyx_k_indices, sizeof(__pyx_k_indices), 0, 0, 1, 1},
  {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
  {&__pyx_n_s_init_pari_stack, __pyx_k_init_pari_stack, sizeof(__pyx_k_init_pari_stack), 0, 0, 1, 1},
  {&__pyx_kp_s_init_pari_stack_is_deprecated_us, __pyx_k_init_pari_stack_is_deprecated_us, sizeof(__pyx_k_init_pari_stack_is_deprecated_us), 0, 0, 1, 0},
  {&__pyx_n_s_init_primes, __pyx_k_init_primes, sizeof(__pyx_k_init_primes), 0, 0, 1, 1},
  {&__pyx_n_s_isprime, __pyx_k_isprime, sizeof(__pyx_k_isprime), 0, 0, 1, 1},
  {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
  {&__pyx_n_s_keys, __pyx_k_keys, sizeof(__pyx_k_keys), 0, 0, 1, 1},
  {&__pyx_n_s_limit, __pyx_k_limit, sizeof(__pyx_k_limit), 0, 0, 1, 1},
  {&__pyx_n_s_line, __pyx_k_line, sizeof(__pyx_k_line), 0, 0, 1, 1},
  {&__pyx_n_s_lines, __pyx_k_lines, sizeof(__pyx_k_lines), 0, 0, 1, 1},
  {&__pyx_n_s_lmax, __pyx_k_lmax, sizeof(__pyx_k_lmax), 0, 0, 1, 1},
  {&__pyx_n_s_locals, __pyx_k_locals, sizeof(__pyx_k_locals), 0, 0, 1, 1},
  {&__pyx_n_s_log_gamma, __pyx_k_log_gamma, sizeof(__pyx_k_log_gamma), 0, 0, 1, 1},
  {&__pyx_n_s_lstrip, __pyx_k_lstrip, sizeof(__pyx_k_lstrip), 0, 0, 1, 1},
  {&__pyx_n_s_m, __pyx_k_m, sizeof(__pyx_k_m), 0, 0, 1, 1},
  {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
  {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
  {&__pyx_n_s_matrix, __pyx_k_matrix, sizeof(__pyx_k_matrix), 0, 0, 1, 1},
  {&__pyx_kp_s_matrix_index_must_be_of_the_form, __pyx_k_matrix_index_must_be_of_the_form, sizeof(__pyx_k_matrix_index_must_be_of_the_form), 0, 0, 1, 0},
  {&__pyx_n_s_metaclass, __pyx_k_metaclass, sizeof(__pyx_k_metaclass), 0, 0, 1, 1},
  {&__pyx_kp_s_mixing_unnamed_and_keyword_argum, __pyx_k_mixing_unnamed_and_keyword_argum, sizeof(__pyx_k_mixing_unnamed_and_keyword_argum), 0, 0, 1, 0},
  {&__pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_k_mnt_E_Programmation_Pari_Sage_T, sizeof(__pyx_k_mnt_E_Programmation_Pari_Sage_T), 0, 0, 1, 0},
  {&__pyx_n_s_module, __pyx_k_module, sizeof(__pyx_k_module), 0, 0, 1, 1},
  {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
  {&__pyx_n_s_n11, __pyx_k_n11, sizeof(__pyx_k_n11), 0, 0, 1, 1},
  {&__pyx_n_s_ncols, __pyx_k_ncols, sizeof(__pyx_k_ncols), 0, 0, 1, 1},
  {&__pyx_n_s_ne, __pyx_k_ne, sizeof(__pyx_k_ne), 0, 0, 1, 1},
  {&__pyx_n_s_nfinit, __pyx_k_nfinit, sizeof(__pyx_k_nfinit), 0, 0, 1, 1},
  {&__pyx_n_s_nrows, __pyx_k_nrows, sizeof(__pyx_k_nrows), 0, 0, 1, 1},
  {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
  {&__pyx_n_s_operator, __pyx_k_operator, sizeof(__pyx_k_operator), 0, 0, 1, 1},
  {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
  {&__pyx_n_s_pari, __pyx_k_pari, sizeof(__pyx_k_pari), 0, 0, 1, 1},
  {&__pyx_n_s_pari_2, __pyx_k_pari_2, sizeof(__pyx_k_pari_2), 0, 0, 1, 1},
  {&__pyx_n_s_pari_instance, __pyx_k_pari_instance, sizeof(__pyx_k_pari_instance), 0, 0, 1, 1},
  {&__pyx_n_s_perm, __pyx_k_perm, sizeof(__pyx_k_perm), 0, 0, 1, 1},
  {&__pyx_n_s_pol2, __pyx_k_pol2, sizeof(__pyx_k_pol2), 0, 0, 1, 1},
  {&__pyx_n_s_polcoeff, __pyx_k_polcoeff, sizeof(__pyx_k_polcoeff), 0, 0, 1, 1},
  {&__pyx_n_s_polrel, __pyx_k_polrel, sizeof(__pyx_k_polrel), 0, 0, 1, 1},
  {&__pyx_n_s_poly, __pyx_k_poly, sizeof(__pyx_k_poly), 0, 0, 1, 1},
  {&__pyx_n_s_precision, __pyx_k_precision, sizeof(__pyx_k_precision), 0, 0, 1, 1},
  {&__pyx_n_s_prepare, __pyx_k_prepare, sizeof(__pyx_k_prepare), 0, 0, 1, 1},
  {&__pyx_n_s_primelimit, __pyx_k_primelimit, sizeof(__pyx_k_primelimit), 0, 0, 1, 1},
  {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
  {&__pyx_n_s_proof, __pyx_k_proof, sizeof(__pyx_k_proof), 0, 0, 1, 1},
  {&__pyx_n_s_pt, __pyx_k_pt, sizeof(__pyx_k_pt), 0, 0, 1, 1},
  {&__pyx_n_s_python, __pyx_k_python, sizeof(__pyx_k_python), 0, 0, 1, 1},
  {&__pyx_n_s_python_ints, __pyx_k_python_ints, sizeof(__pyx_k_python_ints), 0, 0, 1, 1},
  {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
  {&__pyx_n_s_qflllgram, __pyx_k_qflllgram, sizeof(__pyx_k_qflllgram), 0, 0, 1, 1},
  {&__pyx_n_s_qualname, __pyx_k_qualname, sizeof(__pyx_k_qualname), 0, 0, 1, 1},
  {&__pyx_n_s_r, __pyx_k_r, sizeof(__pyx_k_r), 0, 0, 1, 1},
  {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
  {&__pyx_n_s_replace, __pyx_k_replace, sizeof(__pyx_k_replace), 0, 0, 1, 1},
  {&__pyx_n_s_repr, __pyx_k_repr, sizeof(__pyx_k_repr), 0, 0, 1, 1},
  {&__pyx_n_s_rhs, __pyx_k_rhs, sizeof(__pyx_k_rhs), 0, 0, 1, 1},
  {&__pyx_kp_s_row_i_s_must_be_between_0_and_s, __pyx_k_row_i_s_must_be_between_0_and_s, sizeof(__pyx_k_row_i_s_must_be_between_0_and_s), 0, 0, 1, 0},
  {&__pyx_kp_s_row_index_out_of_bounds, __pyx_k_row_index_out_of_bounds, sizeof(__pyx_k_row_index_out_of_bounds), 0, 0, 1, 0},
  {&__pyx_n_s_rstrip, __pyx_k_rstrip, sizeof(__pyx_k_rstrip), 0, 0, 1, 1},
  {&__pyx_n_s_s, __pyx_k_s, sizeof(__pyx_k_s), 0, 0, 1, 1},
  {&__pyx_kp_s_s_is_not_a_square_modulo_s, __pyx_k_s_is_not_a_square_modulo_s, sizeof(__pyx_k_s_is_not_a_square_modulo_s), 0, 0, 1, 0},
  {&__pyx_n_s_sage, __pyx_k_sage, sizeof(__pyx_k_sage), 0, 0, 1, 1},
  {&__pyx_n_s_sage_2, __pyx_k_sage_2, sizeof(__pyx_k_sage_2), 0, 0, 1, 1},
  {&__pyx_n_s_sage_misc_superseded, __pyx_k_sage_misc_superseded, sizeof(__pyx_k_sage_misc_superseded), 0, 0, 1, 1},
  {&__pyx_n_s_self, __pyx_k_self, sizeof(__pyx_k_self), 0, 0, 1, 1},
  {&__pyx_kp_s_self_must_be_of_pari_type_t_MAT, __pyx_k_self_must_be_of_pari_type_t_MAT, sizeof(__pyx_k_self_must_be_of_pari_type_t_MAT), 0, 0, 1, 0},
  {&__pyx_kp_s_set_variable_only_works_for_poly, __pyx_k_set_variable_only_works_for_poly, sizeof(__pyx_k_set_variable_only_works_for_poly), 0, 0, 1, 0},
  {&__pyx_n_s_silent, __pyx_k_silent, sizeof(__pyx_k_silent), 0, 0, 1, 1},
  {&__pyx_n_s_split, __pyx_k_split, sizeof(__pyx_k_split), 0, 0, 1, 1},
  {&__pyx_n_s_str, __pyx_k_str, sizeof(__pyx_k_str), 0, 0, 1, 1},
  {&__pyx_kp_s_substituting_0_in_Laurent_series, __pyx_k_substituting_0_in_Laurent_series, sizeof(__pyx_k_substituting_0_in_Laurent_series), 0, 0, 1, 0},
  {&__pyx_n_s_sunit_data, __pyx_k_sunit_data, sizeof(__pyx_k_sunit_data), 0, 0, 1, 1},
  {&__pyx_kp_s_syntax_error, __pyx_k_syntax_error, sizeof(__pyx_k_syntax_error), 0, 0, 1, 0},
  {&__pyx_n_s_t_CLOSURE, __pyx_k_t_CLOSURE, sizeof(__pyx_k_t_CLOSURE), 0, 0, 1, 1},
  {&__pyx_n_s_t_COL, __pyx_k_t_COL, sizeof(__pyx_k_t_COL), 0, 0, 1, 1},
  {&__pyx_n_s_t_COMPLEX, __pyx_k_t_COMPLEX, sizeof(__pyx_k_t_COMPLEX), 0, 0, 1, 1},
  {&__pyx_n_s_t_FFELT, __pyx_k_t_FFELT, sizeof(__pyx_k_t_FFELT), 0, 0, 1, 1},
  {&__pyx_n_s_t_FRAC, __pyx_k_t_FRAC, sizeof(__pyx_k_t_FRAC), 0, 0, 1, 1},
  {&__pyx_n_s_t_INT, __pyx_k_t_INT, sizeof(__pyx_k_t_INT), 0, 0, 1, 1},
  {&__pyx_n_s_t_INTMOD, __pyx_k_t_INTMOD, sizeof(__pyx_k_t_INTMOD), 0, 0, 1, 1},
  {&__pyx_n_s_t_LIST, __pyx_k_t_LIST, sizeof(__pyx_k_t_LIST), 0, 0, 1, 1},
  {&__pyx_n_s_t_MAT, __pyx_k_t_MAT, sizeof(__pyx_k_t_MAT), 0, 0, 1, 1},
  {&__pyx_n_s_t_PADIC, __pyx_k_t_PADIC, sizeof(__pyx_k_t_PADIC), 0, 0, 1, 1},
  {&__pyx_n_s_t_POL, __pyx_k_t_POL, sizeof(__pyx_k_t_POL), 0, 0, 1, 1},
  {&__pyx_n_s_t_POLMOD, __pyx_k_t_POLMOD, sizeof(__pyx_k_t_POLMOD), 0, 0, 1, 1},
  {&__pyx_n_s_t_QFI, __pyx_k_t_QFI, sizeof(__pyx_k_t_QFI), 0, 0, 1, 1},
  {&__pyx_n_s_t_QFR, __pyx_k_t_QFR, sizeof(__pyx_k_t_QFR), 0, 0, 1, 1},
  {&__pyx_n_s_t_QUAD, __pyx_k_t_QUAD, sizeof(__pyx_k_t_QUAD), 0, 0, 1, 1},
  {&__pyx_n_s_t_REAL, __pyx_k_t_REAL, sizeof(__pyx_k_t_REAL), 0, 0, 1, 1},
  {&__pyx_n_s_t_RFRAC, __pyx_k_t_RFRAC, sizeof(__pyx_k_t_RFRAC), 0, 0, 1, 1},
  {&__pyx_n_s_t_SER, __pyx_k_t_SER, sizeof(__pyx_k_t_SER), 0, 0, 1, 1},
  {&__pyx_n_s_t_STR, __pyx_k_t_STR, sizeof(__pyx_k_t_STR), 0, 0, 1, 1},
  {&__pyx_n_s_t_VEC, __pyx_k_t_VEC, sizeof(__pyx_k_t_VEC), 0, 0, 1, 1},
  {&__pyx_n_s_t_VECSMALL, __pyx_k_t_VECSMALL, sizeof(__pyx_k_t_VECSMALL), 0, 0, 1, 1},
  {&__pyx_n_s_tech, __pyx_k_tech, sizeof(__pyx_k_tech), 0, 0, 1, 1},
  {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
  {&__pyx_n_s_test_2, __pyx_k_test_2, sizeof(__pyx_k_test_2), 0, 0, 1, 1},
  {&__pyx_n_s_testclass, __pyx_k_testclass, sizeof(__pyx_k_testclass), 0, 0, 1, 1},
  {&__pyx_n_s_type, __pyx_k_type, sizeof(__pyx_k_type), 0, 0, 1, 1},
  {&__pyx_n_s_types, __pyx_k_types, sizeof(__pyx_k_types), 0, 0, 1, 1},
  {&__pyx_kp_s_unindexable_object, __pyx_k_unindexable_object, sizeof(__pyx_k_unindexable_object), 0, 0, 1, 0},
  {&__pyx_kp_s_utf_8, __pyx_k_utf_8, sizeof(__pyx_k_utf_8), 0, 0, 1, 0},
  {&__pyx_n_s_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 0, 1, 1},
  {&__pyx_n_s_values, __pyx_k_values, sizeof(__pyx_k_values), 0, 0, 1, 1},
  {&__pyx_n_s_var, __pyx_k_var, sizeof(__pyx_k_var), 0, 0, 1, 1},
  {&__pyx_n_s_variable, __pyx_k_variable, sizeof(__pyx_k_variable), 0, 0, 1, 1},
  {&__pyx_n_s_vdir, __pyx_k_vdir, sizeof(__pyx_k_vdir), 0, 0, 1, 1},
  {&__pyx_n_s_vecextract, __pyx_k_vecextract, sizeof(__pyx_k_vecextract), 0, 0, 1, 1},
  {&__pyx_n_s_vector, __pyx_k_vector, sizeof(__pyx_k_vector), 0, 0, 1, 1},
  {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
  {&__pyx_kp_s_x_must_be_of_type_t_VEC, __pyx_k_x_must_be_of_type_t_VEC, sizeof(__pyx_k_x_must_be_of_type_t_VEC), 0, 0, 1, 0},
  {&__pyx_kp_s_x_s_must_be_of_type_t_INT_but_is, __pyx_k_x_s_must_be_of_type_t_INT_but_is, sizeof(__pyx_k_x_s_must_be_of_type_t_INT_but_is), 0, 0, 1, 0},
  {&__pyx_kp_s_x_s_must_be_of_type_t_VEC_but_is, __pyx_k_x_s_must_be_of_type_t_VEC_but_is, sizeof(__pyx_k_x_s_must_be_of_type_t_VEC_but_is), 0, 0, 1, 0},
  {&__pyx_n_s_xrange, __pyx_k_xrange, sizeof(__pyx_k_xrange), 0, 0, 1, 1},
  {&__pyx_n_s_y, __pyx_k_y, sizeof(__pyx_k_y), 0, 0, 1, 1},
  {&__pyx_n_s_ya, __pyx_k_ya, sizeof(__pyx_k_ya), 0, 0, 1, 1},
  {&__pyx_n_s_z, __pyx_k_z, sizeof(__pyx_k_z), 0, 0, 1, 1},
  {&__pyx_n_s_z0, __pyx_k_z0, sizeof(__pyx_k_z0), 0, 0, 1, 1},
  {&__pyx_n_s_z1, __pyx_k_z1, sizeof(__pyx_k_z1), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_RuntimeError = __Pyx_GetBuiltinName(__pyx_n_s_RuntimeError); if (!__pyx_builtin_RuntimeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION >= 3
  __pyx_builtin_xrange = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_xrange) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #else
  __pyx_builtin_xrange = __Pyx_GetBuiltinName(__pyx_n_s_xrange); if (!__pyx_builtin_xrange) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_chr = __Pyx_GetBuiltinName(__pyx_n_s_chr); if (!__pyx_builtin_chr) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_eval = __Pyx_GetBuiltinName(__pyx_n_s_eval); if (!__pyx_builtin_eval) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_ZeroDivisionError = __Pyx_GetBuiltinName(__pyx_n_s_ZeroDivisionError); if (!__pyx_builtin_ZeroDivisionError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_AttributeError = __Pyx_GetBuiltinName(__pyx_n_s_AttributeError); if (!__pyx_builtin_AttributeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "gen.pyx":88
 *     """
 *     def __init__(self):
 *         raise RuntimeError("PARI objects cannot be instantiated directly; use pari(x) to convert x to PARI")             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_PARI_objects_cannot_be_instantia); if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 88; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple_);
  __Pyx_GIVEREF(__pyx_tuple_);

  /* "gen.pyx":418
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")             # <<<<<<<<<<<<<<
 *         pari_catch_sig_on()
 *         # The hardcoded 1 below refers to the position in the internal
 */
  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_Not_an_INTMOD_or_POLMOD_in_mod); if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__3);
  __Pyx_GIVEREF(__pyx_tuple__3);

  /* "gen.pyx":865
 *             # fast exit
 *             if k==0:
 *                 return P.vector(0)             # <<<<<<<<<<<<<<
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 */
  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__4);
  __Pyx_GIVEREF(__pyx_tuple__4);

  /* "gen.pyx":1179
 *         """
 *         s = str(self)
 *         if s[:4] == "Mat(":             # <<<<<<<<<<<<<<
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 */
  __pyx_slice__7 = PySlice_New(Py_None, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_slice__7);
  __Pyx_GIVEREF(__pyx_slice__7);

  /* "gen.pyx":1180
 *         s = str(self)
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"             # <<<<<<<<<<<<<<
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 */
  __pyx_slice__9 = PySlice_New(__pyx_int_4, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_slice__9);
  __Pyx_GIVEREF(__pyx_slice__9);

  /* "gen.pyx":1181
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")             # <<<<<<<<<<<<<<
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 */
  __pyx_tuple__13 = PyTuple_Pack(2, __pyx_kp_s__11, __pyx_kp_s__12); if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__13);
  __Pyx_GIVEREF(__pyx_tuple__13);

  /* "gen.pyx":1182
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 *         if s.find(";") != -1:             # <<<<<<<<<<<<<<
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 */
  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s__14); if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__15);
  __Pyx_GIVEREF(__pyx_tuple__15);

  /* "gen.pyx":1183
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")             # <<<<<<<<<<<<<<
 *             s = "[" + s + "]"
 *             return eval(s)
 */
  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_kp_s__14, __pyx_kp_s__16); if (unlikely(!__pyx_tuple__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__17);
  __Pyx_GIVEREF(__pyx_tuple__17);

  /* "gen.pyx":1738
 *             if n == 0:
 *                 pari_catch_sig_off()
 *                 return False, None             # <<<<<<<<<<<<<<
 *             else:
 *                 return k, P.new_gen(x)
 */
  __pyx_tuple__18 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__18);
  __Pyx_GIVEREF(__pyx_tuple__18);

  /* "gen.pyx":4692
 *         """
 *         from sage.misc.superseded import deprecation
 *         deprecation(6992, "The method lngamma() is deprecated. Use log_gamma() instead.")             # <<<<<<<<<<<<<<
 *         return x.log_gamma(precision)
 * 
 */
  __pyx_tuple__19 = PyTuple_Pack(2, __pyx_int_6992, __pyx_kp_s_The_method_lngamma_is_deprecated); if (unlikely(!__pyx_tuple__19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4692; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__19);
  __Pyx_GIVEREF(__pyx_tuple__19);

  /* "gen.pyx":5271
 *             else:
 *                 P.clear_stack()
 *                 return False, None             # <<<<<<<<<<<<<<
 *         else:
 *             t = issquare(x.g)
 */
  __pyx_tuple__20 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__20);
  __Pyx_GIVEREF(__pyx_tuple__20);

  /* "gen.pyx":6603
 *             [1.26920930427955, -0.634604652139777 - 1.45881661693850*I]
 *         """
 *         return self[14:16]             # <<<<<<<<<<<<<<
 * 
 *     def disc(self):
 */
  __pyx_slice__21 = PySlice_New(__pyx_int_14, __pyx_int_16, Py_None); if (unlikely(!__pyx_slice__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_slice__21);
  __Pyx_GIVEREF(__pyx_slice__21);

  /* "gen.pyx":7786
 *         if t == t_CLOSURE:
 *             if nkwds > 0:
 *                 raise TypeError("cannot evaluate a PARI closure using keyword arguments")             # <<<<<<<<<<<<<<
 *             # XXX: use undocumented internals to get arity of closure
 *             # (In PARI 2.6, there is closure_arity() which does this)
 */
  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_cannot_evaluate_a_PARI_closure_u); if (unlikely(!__pyx_tuple__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__22);
  __Pyx_GIVEREF(__pyx_tuple__22);

  /* "gen.pyx":7805
 *         if nargs > 0:
 *             if nkwds > 0:
 *                 raise TypeError("mixing unnamed and keyword arguments not allowed when evaluating a PARI object")             # <<<<<<<<<<<<<<
 *             if not (t == t_POL or t == t_RFRAC or t == t_SER):
 *                 raise TypeError("cannot evaluate PARI %s using unnamed arguments" % self.type())
 */
  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_mixing_unnamed_and_keyword_argum); if (unlikely(!__pyx_tuple__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__23);
  __Pyx_GIVEREF(__pyx_tuple__23);

  /* "gen.pyx":7825
 *                     if valp(self.g) < 0:
 *                         pari_catch_sig_off()
 *                         raise ZeroDivisionError('substituting 0 in Laurent series with negative valuation')             # <<<<<<<<<<<<<<
 *                     elif valp(self.g) == 0:
 *                         return P.new_gen(polcoeff0(self.g, 0, -1))
 */
  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_substituting_0_in_Laurent_series); if (unlikely(!__pyx_tuple__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__24);
  __Pyx_GIVEREF(__pyx_tuple__24);

  /* "gen.pyx":8345
 * 
 *     def lllgram(self):
 *         return self.qflllgram(0)             # <<<<<<<<<<<<<<
 * 
 *     def lllgramint(self):
 */
  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_tuple__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__25);
  __Pyx_GIVEREF(__pyx_tuple__25);

  /* "gen.pyx":8348
 * 
 *     def lllgramint(self):
 *         return self.qflllgram(1)             # <<<<<<<<<<<<<<
 * 
 *     def qfminim(self, b=None, m=None, long flag=0, unsigned long precision=0):
 */
  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_int_1); if (unlikely(!__pyx_tuple__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__26);
  __Pyx_GIVEREF(__pyx_tuple__26);

  /* "gen.pyx":9328
 *     """
 *     from sage.misc.superseded import deprecation
 *     deprecation(10018, 'init_pari_stack() is deprecated; use pari.allocatemem() instead.')             # <<<<<<<<<<<<<<
 *     P.allocatemem(s, silent=True)
 * 
 */
  __pyx_tuple__27 = PyTuple_Pack(2, __pyx_int_10018, __pyx_kp_s_init_pari_stack_is_deprecated_us); if (unlikely(!__pyx_tuple__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__27);
  __Pyx_GIVEREF(__pyx_tuple__27);

  /* "gen.pyx":9353
 * 
 *         pari_catch_sig_on()
 *         ustring = (s).encode("utf-8")             # <<<<<<<<<<<<<<
 *         c_string = ustring
 *         g = gp_read_str(c_string)
 */
  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_utf_8); if (unlikely(!__pyx_tuple__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__28);
  __Pyx_GIVEREF(__pyx_tuple__28);

  /* "gen.pyx":9510
 *             PariError: syntax error, unexpected $undefined: !@#$%^&*()
 *         """
 *         lines = self.errtext().split('\n')             # <<<<<<<<<<<<<<
 *         if self.errnum() == e_SYNTAX:
 *             for line in lines:
 */
  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s__29); if (unlikely(!__pyx_tuple__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__30);
  __Pyx_GIVEREF(__pyx_tuple__30);

  /* "gen.pyx":9514
 *             for line in lines:
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")             # <<<<<<<<<<<<<<
 *         return lines[-1].lstrip(" *").rstrip(" .:")
 * 
 */
  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_s__31); if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__32);
  __Pyx_GIVEREF(__pyx_tuple__32);
  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s__33); if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__34);
  __Pyx_GIVEREF(__pyx_tuple__34);

  /* "gen.pyx":9515
 *                 if "syntax error" in line:
 *                     return line.lstrip(" *").rstrip(" .:")
 *         return lines[-1].lstrip(" *").rstrip(" .:")             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s__31); if (unlikely(!__pyx_tuple__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__35);
  __Pyx_GIVEREF(__pyx_tuple__35);
  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s__33); if (unlikely(!__pyx_tuple__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__36);
  __Pyx_GIVEREF(__pyx_tuple__36);

  /* "gen.pyx":9314
 * 
 * 
 * def init_pari_stack(s=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Deprecated, use ``pari.allocatemem()`` instead.
 */
  __pyx_tuple__37 = PyTuple_Pack(2, __pyx_n_s_s, __pyx_n_s_deprecation); if (unlikely(!__pyx_tuple__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__37);
  __Pyx_GIVEREF(__pyx_tuple__37);
  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_n_s_init_pari_stack, 9314, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":9445
 *     Error raised by PARI
 *     """
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */
  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__39);
  __Pyx_GIVEREF(__pyx_tuple__39);
  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_n_s_errnum, 9445, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":9459
 *         return self.args[0]
 * 
 *     def errtext(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the message output by PARI when this error occurred.
 */
  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__41);
  __Pyx_GIVEREF(__pyx_tuple__41);
  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_n_s_errtext, 9459, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":9477
 *         return self.args[1]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */
  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__43);
  __Pyx_GIVEREF(__pyx_tuple__43);
  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_n_s_repr, 9477, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":9486
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a suitable message for displaying this exception.
 */
  __pyx_tuple__45 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_lines, __pyx_n_s_line); if (unlikely(!__pyx_tuple__45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_tuple__45);
  __Pyx_GIVEREF(__pyx_tuple__45);
  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mnt_E_Programmation_Pari_Sage_T, __pyx_n_s_str, 9486, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_10 = PyInt_FromLong(10); if (unlikely(!__pyx_int_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_14 = PyInt_FromLong(14); if (unlikely(!__pyx_int_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_16 = PyInt_FromLong(16); if (unlikely(!__pyx_int_16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_20 = PyInt_FromLong(20); if (unlikely(!__pyx_int_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_6992 = PyInt_FromLong(6992); if (unlikely(!__pyx_int_6992)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_10018 = PyInt_FromLong(10018L); if (unlikely(!__pyx_int_10018)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_8000000 = PyInt_FromLong(8000000L); if (unlikely(!__pyx_int_8000000)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initgen(void); /*proto*/
PyMODINIT_FUNC initgen(void)
#else
PyMODINIT_FUNC PyInit_gen(void); /*proto*/
PyMODINIT_FUNC PyInit_gen(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_gen(void)", 0);
  if ( __Pyx_check_binary_version() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #ifdef __Pyx_CyFunction_USED
  if (__Pyx_CyFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("gen", __pyx_methods, __pyx_k_Sage_class_for_PARI_s_GEN_type, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  if (__pyx_module_is_main_gen) {
    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!PyDict_GetItemString(modules, "gen")) {
      if (unlikely(PyDict_SetItemString(modules, "gen", __pyx_m) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
  }
  #endif
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Constants init code ---*/
  if (unlikely(__Pyx_InitCachedConstants() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Global init code ---*/
  __pyx_v_3gen_P = ((struct __pyx_obj_13pari_instance_PariInstance *)Py_None); Py_INCREF(Py_None);
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  if (__Pyx_ExportFunction("objtogen", (void (*)(void))__pyx_f_3gen_objtogen, "struct __pyx_obj_3gen_gen *(PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Type init code ---*/
  if (PyType_Ready(&__pyx_type_3gen_gen) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_type_3gen_gen.tp_print = 0;
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__hash__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_8__hash__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_8__hash__.doc = __pyx_doc_3gen_3gen_8__hash__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_8__hash__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__mod__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_26__mod__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_26__mod__.doc = __pyx_doc_3gen_3gen_26__mod__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_26__mod__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__pow__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_28__pow__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_28__pow__.doc = __pyx_doc_3gen_3gen_28__pow__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_28__pow__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__rshift__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_34__rshift__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_34__rshift__.doc = __pyx_doc_3gen_3gen_34__rshift__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_34__rshift__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__lshift__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_36__lshift__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_36__lshift__.doc = __pyx_doc_3gen_3gen_36__lshift__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_36__lshift__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__getitem__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_80__getitem__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_80__getitem__.doc = __pyx_doc_3gen_3gen_80__getitem__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_80__getitem__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__setitem__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_82__setitem__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_82__setitem__.doc = __pyx_doc_3gen_3gen_82__setitem__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_82__setitem__;
    }
  }
  #endif
  #if PY_MAJOR_VERSION < 3
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__hex__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_94__hex__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_94__hex__.doc = __pyx_doc_3gen_3gen_94__hex__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_94__hex__;
    }
  }
  #endif
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__int__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_96__int__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_96__int__.doc = __pyx_doc_3gen_3gen_96__int__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_96__int__;
    }
  }
  #endif
  #if PY_MAJOR_VERSION < 3
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__long__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_104__long__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_104__long__.doc = __pyx_doc_3gen_3gen_104__long__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_104__long__;
    }
  }
  #endif
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__float__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_106__float__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_106__float__.doc = __pyx_doc_3gen_3gen_106__float__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_106__float__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = PyObject_GetAttrString((PyObject *)&__pyx_type_3gen_gen, "__call__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_3gen_3gen_586__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_3gen_3gen_586__call__.doc = __pyx_doc_3gen_3gen_586__call__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_3gen_3gen_586__call__;
    }
  }
  #endif
  if (PyObject_SetAttrString(__pyx_m, "gen", (PyObject *)&__pyx_type_3gen_gen) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_3gen_gen = &__pyx_type_3gen_gen;
  /*--- Type import code ---*/
  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), 0); if (unlikely(!__pyx_ptype_7cpython_7complex_complex)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_13pari_instance_PariInstance = __Pyx_ImportType("pari_instance", "PariInstance", sizeof(struct __pyx_obj_13pari_instance_PariInstance), 1); if (unlikely(!__pyx_ptype_13pari_instance_PariInstance)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_vtabptr_13pari_instance_PariInstance = (struct __pyx_vtabstruct_13pari_instance_PariInstance*)__Pyx_GetVtable(__pyx_ptype_13pari_instance_PariInstance->tp_dict); if (unlikely(!__pyx_vtabptr_13pari_instance_PariInstance)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Variable import code ---*/
  __pyx_t_1 = __Pyx_ImportModule("handle_error"); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportVoidPtr(__pyx_t_1, "pari_error_string", (void **)&__pyx_vp_12handle_error_pari_error_string, "PyObject *") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  /*--- Function import code ---*/
  __pyx_t_2 = __Pyx_ImportModule("handle_error"); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_t_2, "_pari_check_warning", (void (**)(void))&_pari_check_warning, "void (void)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_ImportModule("pari_instance"); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_t_3, "prec_bits_to_words", (void (**)(void))&__pyx_f_13pari_instance_prec_bits_to_words, "long (unsigned long, int __pyx_skip_dispatch)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  /*--- Execution code ---*/

  /* "gen.pyx":42
 * 
 * 
 * import math             # <<<<<<<<<<<<<<
 * import types
 * import operator
 */
  __pyx_t_4 = __Pyx_Import(__pyx_n_s_math, 0, -1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_math, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 42; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "gen.pyx":43
 * 
 * import math
 * import types             # <<<<<<<<<<<<<<
 * import operator
 * #import sage.structure.element
 */
  __pyx_t_4 = __Pyx_Import(__pyx_n_s_types, 0, -1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_types, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "gen.pyx":44
 * import math
 * import types
 * import operator             # <<<<<<<<<<<<<<
 * #import sage.structure.element
 * #from sage.structure.element cimport ModuleElement, RingElement, Element
 */
  __pyx_t_4 = __Pyx_Import(__pyx_n_s_operator, 0, -1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_operator, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "ext/stdsage.pxi":49
 * 
 * # Do this for every single module that links in stdsage.
 * init_csage_module()             # <<<<<<<<<<<<<<
 */
  init_csage_module();

  /* "gen.pyx":75
 * 
 * # Will be imported as needed
 * Integer = None             # <<<<<<<<<<<<<<
 * 
 * import pari_instance
 */
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Integer, Py_None) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 75; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "gen.pyx":77
 * Integer = None
 * 
 * import pari_instance             # <<<<<<<<<<<<<<
 * from pari_instance cimport PariInstance, prec_bits_to_words
 * cdef PariInstance P = pari_instance.pari
 */
  __pyx_t_4 = __Pyx_Import(__pyx_n_s_pari_instance, 0, -1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pari_instance, __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 77; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "gen.pyx":79
 * import pari_instance
 * from pari_instance cimport PariInstance, prec_bits_to_words
 * cdef PariInstance P = pari_instance.pari             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_pari_instance); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_pari); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_13pari_instance_PariInstance))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_XGOTREF(((PyObject *)__pyx_v_3gen_P));
  __Pyx_DECREF_SET(__pyx_v_3gen_P, ((struct __pyx_obj_13pari_instance_PariInstance *)__pyx_t_5));
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_t_5 = 0;

  /* "gen.pyx":1375
 *         return gen_py.python(self, locals=locals)
 * 
 *     sage = python             # <<<<<<<<<<<<<<
 * 
 *     _sage_ = _eval_ = python
 */
  __pyx_t_5 = __Pyx_GetNameInClass((PyObject *)__pyx_ptype_3gen_gen, __pyx_n_s_python); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_3gen_gen->tp_dict, __pyx_n_s_sage, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  PyType_Modified(__pyx_ptype_3gen_gen);

  /* "gen.pyx":1377
 *     sage = python
 * 
 *     _sage_ = _eval_ = python             # <<<<<<<<<<<<<<
 * 
 *     def __long__(gen self):
 */
  __pyx_t_5 = __Pyx_GetNameInClass((PyObject *)__pyx_ptype_3gen_gen, __pyx_n_s_python); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_3gen_gen->tp_dict, __pyx_n_s_sage_2, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyType_Modified(__pyx_ptype_3gen_gen);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_3gen_gen->tp_dict, __pyx_n_s_eval_2, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyType_Modified(__pyx_ptype_3gen_gen);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "gen.pyx":9314
 * 
 * 
 * def init_pari_stack(s=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Deprecated, use ``pari.allocatemem()`` instead.
 */
  __pyx_t_5 = PyCFunction_NewEx(&__pyx_mdef_3gen_1init_pari_stack, NULL, __pyx_n_s_gen); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_init_pari_stack, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "gen.pyx":9441
 * # We derive PariError from RuntimeError, for backward compatibility with
 * # code that catches the latter.
 * class PariError(RuntimeError):             # <<<<<<<<<<<<<<
 *     """
 *     Error raised by PARI
 */
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_INCREF(__pyx_builtin_RuntimeError);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_builtin_RuntimeError);
  __Pyx_GIVEREF(__pyx_builtin_RuntimeError);
  __pyx_t_4 = __Pyx_CalculateMetaclass(NULL, __pyx_t_5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_Py3MetaclassPrepare(__pyx_t_4, __pyx_t_5, __pyx_n_s_PariError, __pyx_n_s_PariError, (PyObject *) NULL, __pyx_n_s_gen, __pyx_kp_s_Error_raised_by_PARI); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);

  /* "gen.pyx":9445
 *     Error raised by PARI
 *     """
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */
  __pyx_t_7 = __Pyx_CyFunction_NewEx(&__pyx_mdef_3gen_9PariError_1errnum, 0, __pyx_n_s_PariError_errnum, NULL, __pyx_n_s_gen, __pyx_d, ((PyObject *)__pyx_codeobj__40)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  if (PyObject_SetItem(__pyx_t_6, __pyx_n_s_errnum, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "gen.pyx":9459
 *         return self.args[0]
 * 
 *     def errtext(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the message output by PARI when this error occurred.
 */
  __pyx_t_7 = __Pyx_CyFunction_NewEx(&__pyx_mdef_3gen_9PariError_3errtext, 0, __pyx_n_s_PariError_errtext, NULL, __pyx_n_s_gen, __pyx_d, ((PyObject *)__pyx_codeobj__42)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  if (PyObject_SetItem(__pyx_t_6, __pyx_n_s_errtext, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "gen.pyx":9477
 *         return self.args[1]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */
  __pyx_t_7 = __Pyx_CyFunction_NewEx(&__pyx_mdef_3gen_9PariError_5__repr__, 0, __pyx_n_s_PariError___repr, NULL, __pyx_n_s_gen, __pyx_d, ((PyObject *)__pyx_codeobj__44)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  if (PyObject_SetItem(__pyx_t_6, __pyx_n_s_repr, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "gen.pyx":9486
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return a suitable message for displaying this exception.
 */
  __pyx_t_7 = __Pyx_CyFunction_NewEx(&__pyx_mdef_3gen_9PariError_7__str__, 0, __pyx_n_s_PariError___str, NULL, __pyx_n_s_gen, __pyx_d, ((PyObject *)__pyx_codeobj__46)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  if (PyObject_SetItem(__pyx_t_6, __pyx_n_s_str, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "gen.pyx":9441
 * # We derive PariError from RuntimeError, for backward compatibility with
 * # code that catches the latter.
 * class PariError(RuntimeError):             # <<<<<<<<<<<<<<
 *     """
 *     Error raised by PARI
 */
  __pyx_t_7 = __Pyx_Py3ClassCreate(__pyx_t_4, __pyx_n_s_PariError, __pyx_t_5, __pyx_t_6, NULL, 0, 1); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_7);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_PariError, __pyx_t_7) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "gen.pyx":1
 * """             # <<<<<<<<<<<<<<
 * Sage class for PARI's GEN type
 * 
 */
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test_2, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init gen");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* --- Runtime support code --- */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
    if (unlikely(!result)) {
        PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
            "name '%U' is not defined", name);
#else
            "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
    }
    return result;
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
#if CYTHON_COMPILING_IN_PYPY
    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
        goto invalid_keyword;
    return 1;
#else
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #endif
            if (unlikely(!PyUnicode_Check(key)))
                goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    return 0;
#endif
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = func->ob_type->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_Restore(type, value, tb);
#endif
}
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(type, value, tb);
#endif
}

#if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                        CYTHON_UNUSED PyObject *cause) {
    Py_XINCREF(type);
    if (!value || value == Py_None)
        value = NULL;
    else
        Py_INCREF(value);
    if (!tb || tb == Py_None)
        tb = NULL;
    else {
        Py_INCREF(tb);
        if (!PyTraceBack_Check(tb)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: arg 3 must be a traceback or None");
            goto raise_error;
        }
    }
    if (PyType_Check(type)) {
#if CYTHON_COMPILING_IN_PYPY
        if (!value) {
            Py_INCREF(Py_None);
            value = Py_None;
        }
#endif
        PyErr_NormalizeException(&type, &value, &tb);
    } else {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        value = type;
        type = (PyObject*) Py_TYPE(type);
        Py_INCREF(type);
        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: exception class must be a subclass of BaseException");
            goto raise_error;
        }
    }
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}
#else
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *instance_class = NULL;
        if (value && PyExceptionInstance_Check(value)) {
            instance_class = (PyObject*) Py_TYPE(value);
            if (instance_class != type) {
                if (PyObject_IsSubclass(instance_class, type)) {
                    type = instance_class;
                } else {
                    instance_class = NULL;
                }
            }
        }
        if (!instance_class) {
            PyObject *args;
            if (!value)
                args = PyTuple_New(0);
            else if (PyTuple_Check(value)) {
                Py_INCREF(value);
                args = value;
            } else
                args = PyTuple_Pack(1, value);
            if (!args)
                goto bad;
            owned_instance = PyObject_Call(type, args, NULL);
            Py_DECREF(args);
            if (!owned_instance)
                goto bad;
            value = owned_instance;
            if (!PyExceptionInstance_Check(value)) {
                PyErr_Format(PyExc_TypeError,
                             "calling %R should have returned an instance of "
                             "BaseException, not %R",
                             type, Py_TYPE(value));
                goto bad;
            }
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
#if PY_VERSION_HEX >= 0x03030000
    if (cause) {
#else
    if (cause && cause != Py_None) {
#endif
        PyObject *fixed_cause;
        if (cause == Py_None) {
            fixed_cause = NULL;
        } else if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        } else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        } else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject *tmp_type, *tmp_value, *tmp_tb;
        PyErr_Fetch(tmp_type, tmp_value, tmp_tb);
        Py_INCREF(tb);
        PyErr_Restore(tmp_type, tmp_value, tb);
        Py_XDECREF(tmp_tb);
#else
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
#endif
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}
#endif

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AsString(kw_name));
        #endif
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;
    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
            continue;
        }
        name = first_kw_arg;
        #if PY_MAJOR_VERSION < 3
        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
            while (*name) {
                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                        && _PyString_Eq(**name, key)) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    if ((**argname == key) || (
                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
                             && _PyString_Eq(**argname, key))) {
                        goto arg_passed_twice;
                    }
                    argname++;
                }
            }
        } else
        #endif
        if (likely(PyUnicode_Check(key))) {
            while (*name) {
                int cmp = (**name == key) ? 0 :
                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
                #endif
                    PyUnicode_Compare(**name, key);
                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                if (cmp == 0) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    int cmp = (**argname == key) ? 0 :
                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
                    #endif
                        PyUnicode_Compare(**argname, key);
                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                    if (cmp == 0) goto arg_passed_twice;
                    argname++;
                }
            }
        } else
            goto invalid_keyword_type;
        if (kwds2) {
            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
        } else {
            goto invalid_keyword;
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%.200s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%.200s() got an unexpected keyword argument '%.200s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = PyCFunction_GET_FUNCTION(func);
    self = PyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args)) return NULL;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
            return __Pyx_PyObject_CallMethO(func, arg);
        }
    }
    return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject* args = PyTuple_Pack(1, arg);
    return (likely(args)) ? __Pyx_PyObject_Call(func, args, NULL) : NULL;
}
#endif

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
            return __Pyx_PyObject_CallMethO(func, NULL);
        }
    }
    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static void __Pyx_RaiseArgumentTypeInvalid(const char* name, PyObject *obj, PyTypeObject *type) {
    PyErr_Format(PyExc_TypeError,
        "Argument '%.200s' has incorrect type (expected %.200s, got %.200s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
}
static CYTHON_INLINE int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (likely(Py_TYPE(obj) == type)) return 1;
        #if PY_MAJOR_VERSION == 2
        else if ((type == &PyBaseString_Type) && likely(__Pyx_PyBaseString_CheckExact(obj))) return 1;
        #endif
    }
    else {
        if (likely(PyObject_TypeCheck(obj, type))) return 1;
    }
    __Pyx_RaiseArgumentTypeInvalid(name, obj, type);
    return 0;
}

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyList_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyTuple_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (PyErr_ExceptionMatches(PyExc_OverflowError))
                        PyErr_Clear();
                    else
                        return NULL;
                }
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (is_list || PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
    int r;
    if (!j) return -1;
    r = PyObject_SetItem(o, j, v);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                               int is_list, int wraparound, int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = (!wraparound) ? i : ((likely(i >= 0)) ? i : i + PyList_GET_SIZE(o));
        if ((!boundscheck) || likely((n >= 0) & (n < PyList_GET_SIZE(o)))) {
            PyObject* old = PyList_GET_ITEM(o, n);
            Py_INCREF(v);
            PyList_SET_ITEM(o, n, v);
            Py_DECREF(old);
            return 1;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_ass_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (PyErr_ExceptionMatches(PyExc_OverflowError))
                        PyErr_Clear();
                    else
                        return -1;
                }
            }
            return m->sq_ass_item(o, i, v);
        }
    }
#else
#if CYTHON_COMPILING_IN_PYPY
    if (is_list || (PySequence_Check(o) && !PyDict_Check(o))) {
#else
    if (is_list || PySequence_Check(o)) {
#endif
        return PySequence_SetItem(o, i, v);
    }
#endif
    return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
}

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *local_type, *local_value, *local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    local_type = tstate->curexc_type;
    local_value = tstate->curexc_value;
    local_tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(&local_type, &local_value, &local_tb);
#endif
    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
#if CYTHON_COMPILING_IN_CPYTHON
    if (unlikely(tstate->curexc_type))
#else
    if (unlikely(PyErr_Occurred()))
#endif
        goto bad;
    #if PY_MAJOR_VERSION >= 3
    if (local_tb) {
        if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
            goto bad;
    }
    #endif
    Py_XINCREF(local_tb);
    Py_XINCREF(local_type);
    Py_XINCREF(local_value);
    *type = local_type;
    *value = local_value;
    *tb = local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = local_type;
    tstate->exc_value = local_value;
    tstate->exc_traceback = local_tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_SetExcInfo(local_type, local_value, local_tb);
#endif
    return 0;
bad:
    *type = 0;
    *value = 0;
    *tb = 0;
    Py_XDECREF(local_type);
    Py_XDECREF(local_value);
    Py_XDECREF(local_tb);
    return -1;
}

static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = *type;
    tstate->exc_value = *value;
    tstate->exc_traceback = *tb;
#else
    PyErr_GetExcInfo(&tmp_type, &tmp_value, &tmp_tb);
    PyErr_SetExcInfo(*type, *value, *tb);
#endif
    *type = tmp_type;
    *value = tmp_value;
    *tb = tmp_tb;
}

static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
#else
    PyErr_GetExcInfo(type, value, tb);
#endif
}
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_SetExcInfo(type, value, tb);
#endif
}

static CYTHON_INLINE PyObject* __Pyx_PyObject_GetSlice(
        PyObject* obj, Py_ssize_t cstart, Py_ssize_t cstop,
        PyObject** _py_start, PyObject** _py_stop, PyObject** _py_slice,
        int has_cstart, int has_cstop, CYTHON_UNUSED int wraparound) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyMappingMethods* mp;
#if PY_MAJOR_VERSION < 3
    PySequenceMethods* ms = Py_TYPE(obj)->tp_as_sequence;
    if (likely(ms && ms->sq_slice)) {
        if (!has_cstart) {
            if (_py_start && (*_py_start != Py_None)) {
                cstart = __Pyx_PyIndex_AsSsize_t(*_py_start);
                if ((cstart == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstart = 0;
        }
        if (!has_cstop) {
            if (_py_stop && (*_py_stop != Py_None)) {
                cstop = __Pyx_PyIndex_AsSsize_t(*_py_stop);
                if ((cstop == (Py_ssize_t)-1) && PyErr_Occurred()) goto bad;
            } else
                cstop = PY_SSIZE_T_MAX;
        }
        if (wraparound && unlikely((cstart < 0) | (cstop < 0)) && likely(ms->sq_length)) {
            Py_ssize_t l = ms->sq_length(obj);
            if (likely(l >= 0)) {
                if (cstop < 0) {
                    cstop += l;
                    if (cstop < 0) cstop = 0;
                }
                if (cstart < 0) {
                    cstart += l;
                    if (cstart < 0) cstart = 0;
                }
            } else {
                if (PyErr_ExceptionMatches(PyExc_OverflowError))
                    PyErr_Clear();
                else
                    goto bad;
            }
        }
        return ms->sq_slice(obj, cstart, cstop);
    }
#endif
    mp = Py_TYPE(obj)->tp_as_mapping;
    if (likely(mp && mp->mp_subscript))
#endif
    {
        PyObject* result;
        PyObject *py_slice, *py_start, *py_stop;
        if (_py_slice) {
            py_slice = *_py_slice;
        } else {
            PyObject* owned_start = NULL;
            PyObject* owned_stop = NULL;
            if (_py_start) {
                py_start = *_py_start;
            } else {
                if (has_cstart) {
                    owned_start = py_start = PyInt_FromSsize_t(cstart);
                    if (unlikely(!py_start)) goto bad;
                } else
                    py_start = Py_None;
            }
            if (_py_stop) {
                py_stop = *_py_stop;
            } else {
                if (has_cstop) {
                    owned_stop = py_stop = PyInt_FromSsize_t(cstop);
                    if (unlikely(!py_stop)) {
                        Py_XDECREF(owned_start);
                        goto bad;
                    }
                } else
                    py_stop = Py_None;
            }
            py_slice = PySlice_New(py_start, py_stop, Py_None);
            Py_XDECREF(owned_start);
            Py_XDECREF(owned_stop);
            if (unlikely(!py_slice)) goto bad;
        }
#if CYTHON_COMPILING_IN_CPYTHON
        result = mp->mp_subscript(obj, py_slice);
#else
        result = PyObject_GetItem(obj, py_slice);
#endif
        if (!_py_slice) {
            Py_DECREF(py_slice);
        }
        return result;
    }
    PyErr_Format(PyExc_TypeError,
        "'%.200s' object is unsliceable", Py_TYPE(obj)->tp_name);
bad:
    return NULL;
}

static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
    if (s1 == s2) {
        return (equals == Py_EQ);
    } else if (PyBytes_CheckExact(s1) & PyBytes_CheckExact(s2)) {
        const char *ps1, *ps2;
        Py_ssize_t length = PyBytes_GET_SIZE(s1);
        if (length != PyBytes_GET_SIZE(s2))
            return (equals == Py_NE);
        ps1 = PyBytes_AS_STRING(s1);
        ps2 = PyBytes_AS_STRING(s2);
        if (ps1[0] != ps2[0]) {
            return (equals == Py_NE);
        } else if (length == 1) {
            return (equals == Py_EQ);
        } else {
            int result = memcmp(ps1, ps2, (size_t)length);
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & PyBytes_CheckExact(s2)) {
        return (equals == Py_NE);
    } else if ((s2 == Py_None) & PyBytes_CheckExact(s1)) {
        return (equals == Py_NE);
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
#endif
}

static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals) {
#if CYTHON_COMPILING_IN_PYPY
    return PyObject_RichCompareBool(s1, s2, equals);
#else
#if PY_MAJOR_VERSION < 3
    PyObject* owned_ref = NULL;
#endif
    int s1_is_unicode, s2_is_unicode;
    if (s1 == s2) {
        goto return_eq;
    }
    s1_is_unicode = PyUnicode_CheckExact(s1);
    s2_is_unicode = PyUnicode_CheckExact(s2);
#if PY_MAJOR_VERSION < 3
    if ((s1_is_unicode & (!s2_is_unicode)) && PyString_CheckExact(s2)) {
        owned_ref = PyUnicode_FromObject(s2);
        if (unlikely(!owned_ref))
            return -1;
        s2 = owned_ref;
        s2_is_unicode = 1;
    } else if ((s2_is_unicode & (!s1_is_unicode)) && PyString_CheckExact(s1)) {
        owned_ref = PyUnicode_FromObject(s1);
        if (unlikely(!owned_ref))
            return -1;
        s1 = owned_ref;
        s1_is_unicode = 1;
    } else if (((!s2_is_unicode) & (!s1_is_unicode))) {
        return __Pyx_PyBytes_Equals(s1, s2, equals);
    }
#endif
    if (s1_is_unicode & s2_is_unicode) {
        Py_ssize_t length;
        int kind;
        void *data1, *data2;
        if (unlikely(__Pyx_PyUnicode_READY(s1) < 0) || unlikely(__Pyx_PyUnicode_READY(s2) < 0))
            return -1;
        length = __Pyx_PyUnicode_GET_LENGTH(s1);
        if (length != __Pyx_PyUnicode_GET_LENGTH(s2)) {
            goto return_ne;
        }
        kind = __Pyx_PyUnicode_KIND(s1);
        if (kind != __Pyx_PyUnicode_KIND(s2)) {
            goto return_ne;
        }
        data1 = __Pyx_PyUnicode_DATA(s1);
        data2 = __Pyx_PyUnicode_DATA(s2);
        if (__Pyx_PyUnicode_READ(kind, data1, 0) != __Pyx_PyUnicode_READ(kind, data2, 0)) {
            goto return_ne;
        } else if (length == 1) {
            goto return_eq;
        } else {
            int result = memcmp(data1, data2, (size_t)(length * kind));
            #if PY_MAJOR_VERSION < 3
            Py_XDECREF(owned_ref);
            #endif
            return (equals == Py_EQ) ? (result == 0) : (result != 0);
        }
    } else if ((s1 == Py_None) & s2_is_unicode) {
        goto return_ne;
    } else if ((s2 == Py_None) & s1_is_unicode) {
        goto return_ne;
    } else {
        int result;
        PyObject* py_result = PyObject_RichCompare(s1, s2, equals);
        if (!py_result)
            return -1;
        result = __Pyx_PyObject_IsTrue(py_result);
        Py_DECREF(py_result);
        return result;
    }
return_eq:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_EQ);
return_ne:
    #if PY_MAJOR_VERSION < 3
    Py_XDECREF(owned_ref);
    #endif
    return (equals == Py_NE);
#endif
}

static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
    PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
    if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
        PyErr_Format(PyExc_ImportError,
        #if PY_MAJOR_VERSION < 3
            "cannot import name %.230s", PyString_AS_STRING(name));
        #else
            "cannot import name %S", name);
        #endif
    }
    return value;
}

static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
    PyObject *result;
#if CYTHON_COMPILING_IN_CPYTHON
    result = PyDict_GetItem(__pyx_d, name);
    if (likely(result)) {
        Py_INCREF(result);
    } else {
#else
    result = PyObject_GetItem(__pyx_d, name);
    if (!result) {
        PyErr_Clear();
#endif
        result = __Pyx_GetBuiltinName(name);
    }
    return result;
}

static PyObject* __Pyx_PyObject_CallMethod1(PyObject* obj, PyObject* method_name, PyObject* arg) {
    PyObject *method, *result = NULL;
    method = __Pyx_PyObject_GetAttrStr(obj, method_name);
    if (unlikely(!method)) goto bad;
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyMethod_Check(method))) {
        PyObject *self = PyMethod_GET_SELF(method);
        if (likely(self)) {
            PyObject *args;
            PyObject *function = PyMethod_GET_FUNCTION(method);
            args = PyTuple_New(2);
            if (unlikely(!args)) goto bad;
            Py_INCREF(self);
            PyTuple_SET_ITEM(args, 0, self);
            Py_INCREF(arg);
            PyTuple_SET_ITEM(args, 1, arg);
            Py_INCREF(function);
            Py_DECREF(method); method = NULL;
            result = __Pyx_PyObject_Call(function, args, NULL);
            Py_DECREF(args);
            Py_DECREF(function);
            return result;
        }
    }
#endif
    result = __Pyx_PyObject_CallOneArg(method, arg);
bad:
    Py_XDECREF(method);
    return result;
}

static CYTHON_INLINE PyObject* __Pyx_PyDict_Keys(PyObject* d) {
    if (PY_MAJOR_VERSION >= 3)
        return __Pyx_PyObject_CallMethod1((PyObject*)&PyDict_Type, __pyx_n_s_keys, d);
    else
        return PyDict_Keys(d);
}

static CYTHON_INLINE PyObject* __Pyx_PyDict_Values(PyObject* d) {
    if (PY_MAJOR_VERSION >= 3)
        return __Pyx_PyObject_CallMethod1((PyObject*)&PyDict_Type, __pyx_n_s_values, d);
    else
        return PyDict_Values(d);
}

static void* __Pyx_GetVtable(PyObject *dict) {
    void* ptr;
    PyObject *ob = PyObject_GetItem(dict, __pyx_n_s_pyx_vtable);
    if (!ob)
        goto bad;
#if PY_VERSION_HEX >= 0x02070000
    ptr = PyCapsule_GetPointer(ob, 0);
#else
    ptr = PyCObject_AsVoidPtr(ob);
#endif
    if (!ptr && !PyErr_Occurred())
        PyErr_SetString(PyExc_RuntimeError, "invalid vtable found for imported type");
    Py_DECREF(ob);
    return ptr;
bad:
    Py_XDECREF(ob);
    return NULL;
}

static PyObject *__Pyx_GetNameInClass(PyObject *nmspace, PyObject *name) {
    PyObject *result;
    result = __Pyx_PyObject_GetAttrStr(nmspace, name);
    if (!result)
        result = __Pyx_GetModuleGlobalName(name);
    return result;
}

static PyObject *__Pyx_CalculateMetaclass(PyTypeObject *metaclass, PyObject *bases) {
    Py_ssize_t i, nbases = PyTuple_GET_SIZE(bases);
    for (i=0; i < nbases; i++) {
        PyTypeObject *tmptype;
        PyObject *tmp = PyTuple_GET_ITEM(bases, i);
        tmptype = Py_TYPE(tmp);
#if PY_MAJOR_VERSION < 3
        if (tmptype == &PyClass_Type)
            continue;
#endif
        if (!metaclass) {
            metaclass = tmptype;
            continue;
        }
        if (PyType_IsSubtype(metaclass, tmptype))
            continue;
        if (PyType_IsSubtype(tmptype, metaclass)) {
            metaclass = tmptype;
            continue;
        }
        PyErr_SetString(PyExc_TypeError,
                        "metaclass conflict: "
                        "the metaclass of a derived class "
                        "must be a (non-strict) subclass "
                        "of the metaclasses of all its bases");
        return NULL;
    }
    if (!metaclass) {
#if PY_MAJOR_VERSION < 3
        metaclass = &PyClass_Type;
#else
        metaclass = &PyType_Type;
#endif
    }
    Py_INCREF((PyObject*) metaclass);
    return (PyObject*) metaclass;
}

static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
    PyObject* fake_module;
    PyTypeObject* cached_type = NULL;
    fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
    if (!fake_module) return NULL;
    Py_INCREF(fake_module);
    cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
    if (cached_type) {
        if (!PyType_Check((PyObject*)cached_type)) {
            PyErr_Format(PyExc_TypeError,
                "Shared Cython type %.200s is not a type object",
                type->tp_name);
            goto bad;
        }
        if (cached_type->tp_basicsize != type->tp_basicsize) {
            PyErr_Format(PyExc_TypeError,
                "Shared Cython type %.200s has the wrong size, try recompiling",
                type->tp_name);
            goto bad;
        }
    } else {
        if (!PyErr_ExceptionMatches(PyExc_AttributeError)) goto bad;
        PyErr_Clear();
        if (PyType_Ready(type) < 0) goto bad;
        if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject*) type) < 0)
            goto bad;
        Py_INCREF(type);
        cached_type = type;
    }
done:
    Py_DECREF(fake_module);
    return cached_type;
bad:
    Py_XDECREF(cached_type);
    cached_type = NULL;
    goto done;
}

static PyObject *
__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
{
    if (unlikely(op->func_doc == NULL)) {
        if (op->func.m_ml->ml_doc) {
#if PY_MAJOR_VERSION >= 3
            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
#else
            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
#endif
            if (unlikely(op->func_doc == NULL))
                return NULL;
        } else {
            Py_INCREF(Py_None);
            return Py_None;
        }
    }
    Py_INCREF(op->func_doc);
    return op->func_doc;
}
static int
__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp = op->func_doc;
    if (value == NULL) {
        value = Py_None;
    }
    Py_INCREF(value);
    op->func_doc = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_name == NULL)) {
#if PY_MAJOR_VERSION >= 3
        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
#else
        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
#endif
        if (unlikely(op->func_name == NULL))
            return NULL;
    }
    Py_INCREF(op->func_name);
    return op->func_name;
}
static int
__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__name__ must be set to a string object");
        return -1;
    }
    tmp = op->func_name;
    Py_INCREF(value);
    op->func_name = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op)
{
    Py_INCREF(op->func_qualname);
    return op->func_qualname;
}
static int
__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__qualname__ must be set to a string object");
        return -1;
    }
    tmp = op->func_qualname;
    Py_INCREF(value);
    op->func_qualname = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
{
    PyObject *self;
    self = m->func_closure;
    if (self == NULL)
        self = Py_None;
    Py_INCREF(self);
    return self;
}
static PyObject *
__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_dict == NULL)) {
        op->func_dict = PyDict_New();
        if (unlikely(op->func_dict == NULL))
            return NULL;
    }
    Py_INCREF(op->func_dict);
    return op->func_dict;
}
static int
__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
    if (unlikely(value == NULL)) {
        PyErr_SetString(PyExc_TypeError,
               "function's dictionary may not be deleted");
        return -1;
    }
    if (unlikely(!PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
               "setting function's dictionary to a non-dict");
        return -1;
    }
    tmp = op->func_dict;
    Py_INCREF(value);
    op->func_dict = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op)
{
    Py_INCREF(op->func_globals);
    return op->func_globals;
}
static PyObject *
__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op)
{
    Py_INCREF(Py_None);
    return Py_None;
}
static PyObject *
__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op)
{
    PyObject* result = (op->func_code) ? op->func_code : Py_None;
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
    PyObject *res = op->defaults_getter((PyObject *) op);
    if (unlikely(!res))
        return -1;
    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
    Py_INCREF(op->defaults_tuple);
    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
    Py_INCREF(op->defaults_kwdict);
    Py_DECREF(res);
    return 0;
}
static int
__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value) {
        value = Py_None;
    } else if (value != Py_None && !PyTuple_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__defaults__ must be set to a tuple object");
        return -1;
    }
    Py_INCREF(value);
    tmp = op->defaults_tuple;
    op->defaults_tuple = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_tuple;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
            result = op->defaults_tuple;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value) {
        value = Py_None;
    } else if (value != Py_None && !PyDict_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__kwdefaults__ must be set to a dict object");
        return -1;
    }
    Py_INCREF(value);
    tmp = op->defaults_kwdict;
    op->defaults_kwdict = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op) {
    PyObject* result = op->defaults_kwdict;
    if (unlikely(!result)) {
        if (op->defaults_getter) {
            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
            result = op->defaults_kwdict;
        } else {
            result = Py_None;
        }
    }
    Py_INCREF(result);
    return result;
}
static int
__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value) {
    PyObject* tmp;
    if (!value || value == Py_None) {
        value = NULL;
    } else if (!PyDict_Check(value)) {
        PyErr_SetString(PyExc_TypeError,
                        "__annotations__ must be set to a dict object");
        return -1;
    }
    Py_XINCREF(value);
    tmp = op->func_annotations;
    op->func_annotations = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op) {
    PyObject* result = op->func_annotations;
    if (unlikely(!result)) {
        result = PyDict_New();
        if (unlikely(!result)) return NULL;
        op->func_annotations = result;
    }
    Py_INCREF(result);
    return result;
}
static PyGetSetDef __pyx_CyFunction_getsets[] = {
    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
    {(char *) "__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
    {(char *) "__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
    {0, 0, 0, 0, 0}
};
static PyMemberDef __pyx_CyFunction_members[] = {
    {(char *) "__module__", T_OBJECT, offsetof(__pyx_CyFunctionObject, func.m_module), PY_WRITE_RESTRICTED, 0},
    {0, 0, 0,  0, 0}
};
static PyObject *
__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromString(m->func.m_ml->ml_name);
#else
    return PyString_FromString(m->func.m_ml->ml_name);
#endif
}
static PyMethodDef __pyx_CyFunction_methods[] = {
    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
    {0, 0, 0, 0}
};
#if PY_VERSION_HEX < 0x030500A0
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
#else
#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
#endif
static PyObject *__Pyx_CyFunction_New(PyTypeObject *type, PyMethodDef *ml, int flags, PyObject* qualname,
                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
    __pyx_CyFunctionObject *op = PyObject_GC_New(__pyx_CyFunctionObject, type);
    if (op == NULL)
        return NULL;
    op->flags = flags;
    __Pyx_CyFunction_weakreflist(op) = NULL;
    op->func.m_ml = ml;
    op->func.m_self = (PyObject *) op;
    Py_XINCREF(closure);
    op->func_closure = closure;
    Py_XINCREF(module);
    op->func.m_module = module;
    op->func_dict = NULL;
    op->func_name = NULL;
    Py_INCREF(qualname);
    op->func_qualname = qualname;
    op->func_doc = NULL;
    op->func_classobj = NULL;
    op->func_globals = globals;
    Py_INCREF(op->func_globals);
    Py_XINCREF(code);
    op->func_code = code;
    op->defaults_pyobjects = 0;
    op->defaults = NULL;
    op->defaults_tuple = NULL;
    op->defaults_kwdict = NULL;
    op->defaults_getter = NULL;
    op->func_annotations = NULL;
    PyObject_GC_Track(op);
    return (PyObject *) op;
}
static int
__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
{
    Py_CLEAR(m->func_closure);
    Py_CLEAR(m->func.m_module);
    Py_CLEAR(m->func_dict);
    Py_CLEAR(m->func_name);
    Py_CLEAR(m->func_qualname);
    Py_CLEAR(m->func_doc);
    Py_CLEAR(m->func_globals);
    Py_CLEAR(m->func_code);
    Py_CLEAR(m->func_classobj);
    Py_CLEAR(m->defaults_tuple);
    Py_CLEAR(m->defaults_kwdict);
    Py_CLEAR(m->func_annotations);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_XDECREF(pydefaults[i]);
        PyMem_Free(m->defaults);
        m->defaults = NULL;
    }
    return 0;
}
static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
{
    PyObject_GC_UnTrack(m);
    if (__Pyx_CyFunction_weakreflist(m) != NULL)
        PyObject_ClearWeakRefs((PyObject *) m);
    __Pyx_CyFunction_clear(m);
    PyObject_GC_Del(m);
}
static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
{
    Py_VISIT(m->func_closure);
    Py_VISIT(m->func.m_module);
    Py_VISIT(m->func_dict);
    Py_VISIT(m->func_name);
    Py_VISIT(m->func_qualname);
    Py_VISIT(m->func_doc);
    Py_VISIT(m->func_globals);
    Py_VISIT(m->func_code);
    Py_VISIT(m->func_classobj);
    Py_VISIT(m->defaults_tuple);
    Py_VISIT(m->defaults_kwdict);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_VISIT(pydefaults[i]);
    }
    return 0;
}
static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
{
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
        Py_INCREF(func);
        return func;
    }
    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
        if (type == NULL)
            type = (PyObject *)(Py_TYPE(obj));
        return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
    }
    if (obj == Py_None)
        obj = NULL;
    return __Pyx_PyMethod_New(func, obj, type);
}
static PyObject*
__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromFormat("<cyfunction %U at %p>",
                                op->func_qualname, (void *)op);
#else
    return PyString_FromFormat("<cyfunction %s at %p>",
                               PyString_AsString(op->func_qualname), (void *)op);
#endif
}
#if CYTHON_COMPILING_IN_PYPY
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyCFunctionObject* f = (PyCFunctionObject*)func;
    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
    PyObject *self = PyCFunction_GET_SELF(func);
    Py_ssize_t size;
    switch (PyCFunction_GET_FLAGS(func) & ~(METH_CLASS | METH_STATIC | METH_COEXIST)) {
    case METH_VARARGS:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0)
            return (*meth)(self, arg);
        break;
    case METH_VARARGS | METH_KEYWORDS:
        return (*(PyCFunctionWithKeywords)meth)(self, arg, kw);
    case METH_NOARGS:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0) {
            size = PyTuple_GET_SIZE(arg);
            if (size == 0)
                return (*meth)(self, NULL);
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    case METH_O:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0) {
            size = PyTuple_GET_SIZE(arg);
            if (size == 1)
                return (*meth)(self, PyTuple_GET_ITEM(arg, 0));
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T "d given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    default:
        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
                        "longer supported!");
        return NULL;
    }
    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
                 f->m_ml->ml_name);
    return NULL;
}
#else
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
	return PyCFunction_Call(func, arg, kw);
}
#endif
static PyTypeObject __pyx_CyFunctionType_type = {
    PyVarObject_HEAD_INIT(0, 0)
    "cython_function_or_method",
    sizeof(__pyx_CyFunctionObject),
    0,
    (destructor) __Pyx_CyFunction_dealloc,
    0,
    0,
    0,
#if PY_MAJOR_VERSION < 3
    0,
#else
    0,
#endif
    (reprfunc) __Pyx_CyFunction_repr,
    0,
    0,
    0,
    0,
    __Pyx_CyFunction_Call,
    0,
    0,
    0,
    0,
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
    0,
    (traverseproc) __Pyx_CyFunction_traverse,
    (inquiry) __Pyx_CyFunction_clear,
    0,
#if PY_VERSION_HEX < 0x030500A0
    offsetof(__pyx_CyFunctionObject, func_weakreflist),
#else
    offsetof(PyCFunctionObject, m_weakreflist),
#endif
    0,
    0,
    __pyx_CyFunction_methods,
    __pyx_CyFunction_members,
    __pyx_CyFunction_getsets,
    0,
    0,
    __Pyx_CyFunction_descr_get,
    0,
    offsetof(__pyx_CyFunctionObject, func_dict),
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
    0,
#if PY_VERSION_HEX >= 0x030400a1
    0,
#endif
};
static int __Pyx_CyFunction_init(void) {
#if !CYTHON_COMPILING_IN_PYPY
    __pyx_CyFunctionType_type.tp_call = PyCFunction_Call;
#endif
    __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
    if (__pyx_CyFunctionType == NULL) {
        return -1;
    }
    return 0;
}
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults = PyMem_Malloc(size);
    if (!m->defaults)
        return PyErr_NoMemory();
    memset(m->defaults, 0, size);
    m->defaults_pyobjects = pyobjects;
    return m->defaults;
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_tuple = tuple;
    Py_INCREF(tuple);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_kwdict = dict;
    Py_INCREF(dict);
}
static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->func_annotations = dict;
    Py_INCREF(dict);
}

static PyObject *__Pyx_Py3MetaclassPrepare(PyObject *metaclass, PyObject *bases, PyObject *name,
                                           PyObject *qualname, PyObject *mkw, PyObject *modname, PyObject *doc) {
    PyObject *ns;
    if (metaclass) {
        PyObject *prep = __Pyx_PyObject_GetAttrStr(metaclass, __pyx_n_s_prepare);
        if (prep) {
            PyObject *pargs = PyTuple_Pack(2, name, bases);
            if (unlikely(!pargs)) {
                Py_DECREF(prep);
                return NULL;
            }
            ns = PyObject_Call(prep, pargs, mkw);
            Py_DECREF(prep);
            Py_DECREF(pargs);
        } else {
            if (unlikely(!PyErr_ExceptionMatches(PyExc_AttributeError)))
                return NULL;
            PyErr_Clear();
            ns = PyDict_New();
        }
    } else {
        ns = PyDict_New();
    }
    if (unlikely(!ns))
        return NULL;
    if (unlikely(PyObject_SetItem(ns, __pyx_n_s_module, modname) < 0)) goto bad;
    if (unlikely(PyObject_SetItem(ns, __pyx_n_s_qualname, qualname) < 0)) goto bad;
    if (unlikely(doc && PyObject_SetItem(ns, __pyx_n_s_doc, doc) < 0)) goto bad;
    return ns;
bad:
    Py_DECREF(ns);
    return NULL;
}
static PyObject *__Pyx_Py3ClassCreate(PyObject *metaclass, PyObject *name, PyObject *bases,
                                      PyObject *dict, PyObject *mkw,
                                      int calculate_metaclass, int allow_py2_metaclass) {
    PyObject *result, *margs;
    PyObject *owned_metaclass = NULL;
    if (allow_py2_metaclass) {
        owned_metaclass = PyObject_GetItem(dict, __pyx_n_s_metaclass);
        if (owned_metaclass) {
            metaclass = owned_metaclass;
        } else if (likely(PyErr_ExceptionMatches(PyExc_KeyError))) {
            PyErr_Clear();
        } else {
            return NULL;
        }
    }
    if (calculate_metaclass && (!metaclass || PyType_Check(metaclass))) {
        metaclass = __Pyx_CalculateMetaclass((PyTypeObject*) metaclass, bases);
        Py_XDECREF(owned_metaclass);
        if (unlikely(!metaclass))
            return NULL;
        owned_metaclass = metaclass;
    }
    margs = PyTuple_Pack(3, name, bases, dict);
    if (unlikely(!margs)) {
        result = NULL;
    } else {
        result = PyObject_Call(metaclass, margs, mkw);
        Py_DECREF(margs);
    }
    Py_XDECREF(owned_metaclass);
    return result;
}

static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = (start + end) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,
        0,
        0,
        0,
        0,
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        __pyx_d,      /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import;
    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0;
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

#define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)       \
    {                                                                     \
        func_type value = func_value;                                     \
        if (sizeof(target_type) < sizeof(func_type)) {                    \
            if (unlikely(value != (func_type) (target_type) value)) {     \
                func_type zero = 0;                                       \
                if (is_unsigned && unlikely(value < zero))                \
                    goto raise_neg_overflow;                              \
                else                                                      \
                    goto raise_overflow;                                  \
            }                                                             \
        }                                                                 \
        return (target_type) value;                                       \
    }

#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
  #include "longintrepr.h"
 #endif
#endif

static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
    const long neg_one = (long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(long, digit, ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
            if (sizeof(long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT(long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(long) <= sizeof(unsigned long long)) {
                __PYX_VERIFY_RETURN_INT(long, unsigned long long, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(long,  digit, +(((PyLongObject*)x)->ob_digit[0]));
                case -1: __PYX_VERIFY_RETURN_INT(long, sdigit, -(sdigit) ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (sizeof(long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT(long, long, PyLong_AsLong(x))
            } else if (sizeof(long) <= sizeof(long long)) {
                __PYX_VERIFY_RETURN_INT(long, long long, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            long val;
            PyObject *v = __Pyx_PyNumber_Int(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (long) -1;
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyInt_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
    const int neg_one = (int) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(int) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (int) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(int, digit, ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
            if (sizeof(int) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT(int, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(int) <= sizeof(unsigned long long)) {
                __PYX_VERIFY_RETURN_INT(int, unsigned long long, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(int,  digit, +(((PyLongObject*)x)->ob_digit[0]));
                case -1: __PYX_VERIFY_RETURN_INT(int, sdigit, -(sdigit) ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (sizeof(int) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT(int, long, PyLong_AsLong(x))
            } else if (sizeof(int) <= sizeof(long long)) {
                __PYX_VERIFY_RETURN_INT(int, long long, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            int val;
            PyObject *v = __Pyx_PyNumber_Int(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (int) -1;
        }
    } else {
        int val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyInt_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

static CYTHON_INLINE unsigned long __Pyx_PyInt_As_unsigned_long(PyObject *x) {
    const unsigned long neg_one = (unsigned long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(unsigned long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(unsigned long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (unsigned long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(unsigned long, digit, ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
            if (sizeof(unsigned long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT(unsigned long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(unsigned long) <= sizeof(unsigned long long)) {
                __PYX_VERIFY_RETURN_INT(unsigned long, unsigned long long, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
 #if CYTHON_USE_PYLONG_INTERNALS
            switch (Py_SIZE(x)) {
                case  0: return 0;
                case  1: __PYX_VERIFY_RETURN_INT(unsigned long,  digit, +(((PyLongObject*)x)->ob_digit[0]));
                case -1: __PYX_VERIFY_RETURN_INT(unsigned long, sdigit, -(sdigit) ((PyLongObject*)x)->ob_digit[0]);
            }
 #endif
#endif
            if (sizeof(unsigned long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT(unsigned long, long, PyLong_AsLong(x))
            } else if (sizeof(unsigned long) <= sizeof(long long)) {
                __PYX_VERIFY_RETURN_INT(unsigned long, long long, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            unsigned long val;
            PyObject *v = __Pyx_PyNumber_Int(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (unsigned long) -1;
        }
    } else {
        unsigned long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned long) -1;
        val = __Pyx_PyInt_As_unsigned_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to unsigned long");
    return (unsigned long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to unsigned long");
    return (unsigned long) -1;
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
    const long neg_one = (long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(long) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_char(char value) {
    const char neg_one = (char) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(char) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(char) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(char) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(char) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(char) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(char),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
    const int neg_one = (int) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(int) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(int) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(int) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(int),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject *__Pyx_GetAttr(PyObject *o, PyObject *n) {
#if CYTHON_COMPILING_IN_CPYTHON
#if PY_MAJOR_VERSION >= 3
    if (likely(PyUnicode_Check(n)))
#else
    if (likely(PyString_Check(n)))
#endif
        return __Pyx_PyObject_GetAttrStr(o, n);
#endif
    return PyObject_GetAttr(o, n);
}

static PyObject* __Pyx_Globals(void) {
    Py_ssize_t i;
    PyObject *names;
    PyObject *globals = __pyx_d;
    Py_INCREF(globals);
    names = PyObject_Dir(__pyx_m);
    if (!names)
        goto bad;
    for (i = PyList_GET_SIZE(names)-1; i >= 0; i--) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject* name = PySequence_GetItem(names, i);
        if (!name)
            goto bad;
#else
        PyObject* name = PyList_GET_ITEM(names, i);
#endif
        if (!PyDict_Contains(globals, name)) {
            PyObject* value = __Pyx_GetAttr(__pyx_m, name);
            if (!value) {
#if CYTHON_COMPILING_IN_PYPY
                Py_DECREF(name);
#endif
                goto bad;
            }
            if (PyDict_SetItem(globals, name, value) < 0) {
#if CYTHON_COMPILING_IN_PYPY
                Py_DECREF(name);
#endif
                Py_DECREF(value);
                goto bad;
            }
        }
#if CYTHON_COMPILING_IN_PYPY
        Py_DECREF(name);
#endif
    }
    Py_DECREF(names);
    return globals;
bad:
    Py_XDECREF(names);
    Py_XDECREF(globals);
    return NULL;
}

static CYTHON_INLINE PyObject* __Pyx_PyInt_From_unsigned_long(unsigned long value) {
    const unsigned long neg_one = (unsigned long) -1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(unsigned long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(unsigned long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(unsigned long) <= sizeof(unsigned long long)) {
            return PyLong_FromUnsignedLongLong((unsigned long long) value);
        }
    } else {
        if (sizeof(unsigned long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(unsigned long) <= sizeof(long long)) {
            return PyLong_FromLongLong((long long) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(unsigned long),
                                     little, !is_unsigned);
    }
}

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject((char *)"stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}
static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
    int i;
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        PyObject* v;
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                goto error;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            goto error;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0) {
                switch (s[len-1]) {
                    case ' ': break;
                    case '\f': case '\r': case '\n': case '\t': case '\v':
                        PyFile_SoftSpace(f, 0);
                        break;
                    default:  break;
                }
            }
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            goto error;
        PyFile_SoftSpace(f, 0);
    }
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
}
#else
static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (unlikely(!__pyx_print)) {
        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
        if (!__pyx_print)
            return -1;
    }
    if (stream) {
        kwargs = PyDict_New();
        if (unlikely(!kwargs))
            return -1;
        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
            goto bad;
        if (!newline) {
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                goto bad;
            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                goto bad;
            }
            Py_DECREF(end_string);
        }
    } else if (!newline) {
        if (unlikely(!__pyx_print_kwargs)) {
            __pyx_print_kwargs = PyDict_New();
            if (unlikely(!__pyx_print_kwargs))
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                return -1;
            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
        Py_DECREF(kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
bad:
    if (kwargs != __pyx_print_kwargs)
        Py_XDECREF(kwargs);
    return -1;
}
#endif

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    if (PyFile_SoftSpace(f, 0)) {
        if (PyFile_WriteString(" ", f) < 0)
            goto error;
    }
    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
        goto error;
    if (PyFile_WriteString("\n", f) < 0)
        goto error;
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
    /* the line below is just to avoid C compiler
     * warnings about unused functions */
    return __Pyx_Print(f, NULL, 0);
}
#else
static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
    int res;
    PyObject* arg_tuple = PyTuple_Pack(1, o);
    if (unlikely(!arg_tuple))
        return -1;
    res = __Pyx_Print(stream, arg_tuple, 1);
    Py_DECREF(arg_tuple);
    return res;
}
#endif

static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        return PyErr_WarnEx(NULL, message, 1);
    }
    return 0;
}

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;
    d = PyObject_GetAttrString(__pyx_m, (char *)"__pyx_capi__");
    if (!d) {
        PyErr_Clear();
        d = PyDict_New();
        if (!d)
            goto bad;
        Py_INCREF(d);
        if (PyModule_AddObject(__pyx_m, (char *)"__pyx_capi__", d) < 0)
            goto bad;
    }
    tmp.fp = f;
#if PY_VERSION_HEX >= 0x02070000
    cobj = PyCapsule_New(tmp.p, sig, 0);
#else
    cobj = PyCObject_FromVoidPtrAndDesc(tmp.p, (void *)sig, 0);
#endif
    if (!cobj)
        goto bad;
    if (PyDict_SetItemString(d, name, cobj) < 0)
        goto bad;
    Py_DECREF(cobj);
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(cobj);
    Py_XDECREF(d);
    return -1;
}

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;
    py_name = __Pyx_PyIdentifier_FromString(name);
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];
    Py_ssize_t basicsize;
#ifdef Py_LIMITED_API
    PyObject *py_basicsize;
#endif
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    py_name = __Pyx_PyIdentifier_FromString(class_name);
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%.200s.%.200s is not a type object",
            module_name, class_name);
        goto bad;
    }
#ifndef Py_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
#else
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (!strict && (size_t)basicsize > size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility",
            module_name, class_name);
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
    }
    else if ((size_t)basicsize != size) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s has the wrong size, try recompiling",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

#ifndef __PYX_HAVE_RT_ImportVoidPtr
#define __PYX_HAVE_RT_ImportVoidPtr
static int __Pyx_ImportVoidPtr(PyObject *module, const char *name, void **p, const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
    if (!d)
        goto bad;
    cobj = PyDict_GetItemString(d, name);
    if (!cobj) {
        PyErr_Format(PyExc_ImportError,
            "%.200s does not export expected C variable %.200s",
                PyModule_GetName(module), name);
        goto bad;
    }
#if PY_VERSION_HEX >= 0x02070000
    if (!PyCapsule_IsValid(cobj, sig)) {
        PyErr_Format(PyExc_TypeError,
            "C variable %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
             PyModule_GetName(module), name, sig, PyCapsule_GetName(cobj));
        goto bad;
    }
    *p = PyCapsule_GetPointer(cobj, sig);
#else
    {const char *desc, *s1, *s2;
    desc = (const char *)PyCObject_GetDesc(cobj);
    if (!desc)
        goto bad;
    s1 = desc; s2 = sig;
    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
    if (*s1 != *s2) {
        PyErr_Format(PyExc_TypeError,
            "C variable %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
             PyModule_GetName(module), name, sig, desc);
        goto bad;
    }
    *p = PyCObject_AsVoidPtr(cobj);}
#endif
    if (!(*p))
        goto bad;
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(d);
    return -1;
}
#endif

#ifndef __PYX_HAVE_RT_ImportFunction
#define __PYX_HAVE_RT_ImportFunction
static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;
    d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
    if (!d)
        goto bad;
    cobj = PyDict_GetItemString(d, funcname);
    if (!cobj) {
        PyErr_Format(PyExc_ImportError,
            "%.200s does not export expected C function %.200s",
                PyModule_GetName(module), funcname);
        goto bad;
    }
#if PY_VERSION_HEX >= 0x02070000
    if (!PyCapsule_IsValid(cobj, sig)) {
        PyErr_Format(PyExc_TypeError,
            "C function %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
             PyModule_GetName(module), funcname, sig, PyCapsule_GetName(cobj));
        goto bad;
    }
    tmp.p = PyCapsule_GetPointer(cobj, sig);
#else
    {const char *desc, *s1, *s2;
    desc = (const char *)PyCObject_GetDesc(cobj);
    if (!desc)
        goto bad;
    s1 = desc; s2 = sig;
    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
    if (*s1 != *s2) {
        PyErr_Format(PyExc_TypeError,
            "C function %.200s.%.200s has wrong signature (expected %.500s, got %.500s)",
             PyModule_GetName(module), funcname, sig, desc);
        goto bad;
    }
    tmp.p = PyCObject_AsVoidPtr(cobj);}
#endif
    *f = tmp.fp;
    if (!(*f))
        goto bad;
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(d);
    return -1;
}
#endif

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
    if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
            __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
            PyUnicode_Check(o)) {
#if PY_VERSION_HEX < 0x03030000
        char* defenc_c;
        PyObject* defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
        if (!defenc) return NULL;
        defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        {
            char* end = defenc_c + PyBytes_GET_SIZE(defenc);
            char* c;
            for (c = defenc_c; c < end; c++) {
                if ((unsigned char) (*c) >= 128) {
                    PyUnicode_AsASCIIString(o);
                    return NULL;
                }
            }
        }
#endif
        *length = PyBytes_GET_SIZE(defenc);
        return defenc_c;
#else
        if (__Pyx_PyUnicode_READY(o) == -1) return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        if (PyUnicode_IS_ASCII(o)) {
            *length = PyUnicode_GET_LENGTH(o);
            return PyUnicode_AsUTF8(o);
        } else {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
#else
        return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
    } else
#endif
#if !CYTHON_COMPILING_IN_PYPY
    if (PyByteArray_Check(o)) {
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
    } else
#endif
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_MAJOR_VERSION < 3
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%.4s__ returned non-%.4s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b)))
      return PyInt_AS_LONG(b);
#endif
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
     #if CYTHON_USE_PYLONG_INTERNALS
       switch (Py_SIZE(b)) {
       case -1: return -(sdigit)((PyLongObject*)b)->ob_digit[0];
       case  0: return 0;
       case  1: return ((PyLongObject*)b)->ob_digit[0];
       }
     #endif
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
    return PyInt_FromSize_t(ival);
}


#endif /* Py_PYTHON_H */
