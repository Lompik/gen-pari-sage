/* Generated by Cython 0.18 on Wed Jul 31 23:38:29 2013 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02040000
    #error Cython requires Python 2.4+.
#else
#include <stddef.h> /* For offsetof */
#ifndef offsetof
#define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
#define CYTHON_COMPILING_IN_PYPY 1
#define CYTHON_COMPILING_IN_CPYTHON 0
#else
#define CYTHON_COMPILING_IN_PYPY 0
#define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PY_FORMAT_SIZE_T ""
  #define CYTHON_FORMAT_SSIZE_T ""
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   __Pyx_PyInt_AsInt(o)
  #define PyNumber_Index(o)    ((PyNumber_Check(o) && !PyFloat_Check(o)) ? PyNumber_Int(o) : \
                                (PyErr_Format(PyExc_TypeError, \
                                              "expected index value, got %.200s", Py_TYPE(o)->tp_name), \
                                 (PyObject*)0))
  #define __Pyx_PyIndex_Check(o) (PyNumber_Check(o) && !PyFloat_Check(o) && \
                                  !PyComplex_Check(o))
  #define PyIndex_Check __Pyx_PyIndex_Check
  #define PyErr_WarnEx(category, message, stacklevel) PyErr_Warn(category, message)
  #define __PYX_BUILD_PY_SSIZE_T "i"
#else
  #define __PYX_BUILD_PY_SSIZE_T "n"
  #define CYTHON_FORMAT_SSIZE_T "z"
  #define __Pyx_PyIndex_Check PyIndex_Check
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)
  typedef struct {
     void *buf;
     PyObject *obj;
     Py_ssize_t len;
     Py_ssize_t itemsize;
     int readonly;
     int ndim;
     char *format;
     Py_ssize_t *shape;
     Py_ssize_t *strides;
     Py_ssize_t *suboffsets;
     void *internal;
  } Py_buffer;
  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)
  #define PyBUF_RECORDS (PyBUF_STRIDES | PyBUF_FORMAT | PyBUF_WRITABLE)
  #define PyBUF_FULL (PyBUF_INDIRECT | PyBUF_FORMAT | PyBUF_WRITABLE)
  typedef int (*getbufferproc)(PyObject *, Py_buffer *, int);
  typedef void (*releasebufferproc)(PyObject *, Py_buffer *);
#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos) \
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
#endif
#if PY_MAJOR_VERSION < 3 && PY_MINOR_VERSION < 6
  #define PyUnicode_FromString(s) PyUnicode_Decode(s, strlen(s), "UTF-8", "strict")
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ? \
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((k=k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_VERSION_HEX < 0x02060000
  #define PyBytesObject                PyStringObject
  #define PyBytes_Type                 PyString_Type
  #define PyBytes_Check                PyString_Check
  #define PyBytes_CheckExact           PyString_CheckExact
  #define PyBytes_FromString           PyString_FromString
  #define PyBytes_FromStringAndSize    PyString_FromStringAndSize
  #define PyBytes_FromFormat           PyString_FromFormat
  #define PyBytes_DecodeEscape         PyString_DecodeEscape
  #define PyBytes_AsString             PyString_AsString
  #define PyBytes_AsStringAndSize      PyString_AsStringAndSize
  #define PyBytes_Size                 PyString_Size
  #define PyBytes_AS_STRING            PyString_AS_STRING
  #define PyBytes_GET_SIZE             PyString_GET_SIZE
  #define PyBytes_Repr                 PyString_Repr
  #define PyBytes_Concat               PyString_Concat
  #define PyBytes_ConcatAndDel         PyString_ConcatAndDel
#endif
#if PY_VERSION_HEX < 0x02060000
  #define PySet_Check(obj)             PyObject_TypeCheck(obj, &PySet_Type)
  #define PyFrozenSet_Check(obj)       PyObject_TypeCheck(obj, &PyFrozenSet_Type)
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_VERSION_HEX < 0x03020000
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if (PY_MAJOR_VERSION < 3) || (PY_VERSION_HEX >= 0x03010300)
  #define __Pyx_PySequence_GetSlice(obj, a, b) PySequence_GetSlice(obj, a, b)
  #define __Pyx_PySequence_SetSlice(obj, a, b, value) PySequence_SetSlice(obj, a, b, value)
  #define __Pyx_PySequence_DelSlice(obj, a, b) PySequence_DelSlice(obj, a, b)
#else
  #define __Pyx_PySequence_GetSlice(obj, a, b) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), (PyObject*)0) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_GetSlice(obj, a, b)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object is unsliceable", (obj)->ob_type->tp_name), (PyObject*)0)))
  #define __Pyx_PySequence_SetSlice(obj, a, b, value) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), -1) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_SetSlice(obj, a, b, value)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object doesn't support slice assignment", (obj)->ob_type->tp_name), -1)))
  #define __Pyx_PySequence_DelSlice(obj, a, b) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), -1) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_DelSlice(obj, a, b)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object doesn't support slice deletion", (obj)->ob_type->tp_name), -1)))
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),((char *)(n)))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),((char *)(n)),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),((char *)(n)))
#else
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),(n))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),(n),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),(n))
#endif
#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_NAMESTR(n) ((char *)(n))
  #define __Pyx_DOCSTR(n)  ((char *)(n))
#else
  #define __Pyx_NAMESTR(n) (n)
  #define __Pyx_DOCSTR(n)  (n)
#endif


#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
#define _USE_MATH_DEFINES
#endif
#include <math.h>
#define __PYX_HAVE__example
#define __PYX_HAVE_API__example
#include "stdsage.h"
#include "string.h"
#include "stdio.h"
#include "pythread.h"
#include <math.h>
#include "pari/paricfg.h"
#include "setjmp.h"
#include "pari/pari.h"
#include "pari/paripriv.h"
#include "interrupt.h"
#include "pari_err.h"
#include "misc.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif
#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; char *s; const long n; const char* encoding; const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry; /*proto*/

#define __Pyx_PyBytes_FromUString(s) PyBytes_FromString((char*)s)
#define __Pyx_PyBytes_AsUString(s)   ((unsigned char*) PyBytes_AsString(s))
#define __Pyx_Owned_Py_None(b) (Py_INCREF(Py_None), Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))


#ifdef __GNUC__
  /* Test for GCC > 2.95 */
  #if __GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95))
    #define likely(x)   __builtin_expect(!!(x), 1)
    #define unlikely(x) __builtin_expect(!!(x), 0)
  #else /* __GNUC__ > 2 ... */
    #define likely(x)   (x)
    #define unlikely(x) (x)
  #endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "example.pyx",
  "type.pxd",
  "bool.pxd",
  "complex.pxd",
};

/* "E:\Programmation\Packages\Sage\Test\decl.pxi":49
 *     int longjmp (jmp_buf __env, int val)
 * 
 * ctypedef unsigned long ulong             # <<<<<<<<<<<<<<
 * 
 * 
 */
typedef unsigned long __pyx_t_7example_ulong;

/*--- Type declarations ---*/
struct __pyx_obj_7example_gen;
struct __pyx_obj_7example_PariInstance;

/* "example.pxd":3
 * include 'decl.pxi'
 * 
 * cdef class gen:             # <<<<<<<<<<<<<<
 *     cdef GEN g
 *     cdef object _refers_to
 */
struct __pyx_obj_7example_gen {
  PyObject_HEAD
  struct __pyx_vtabstruct_7example_gen *__pyx_vtab;
  GEN g;
  PyObject *_refers_to;
  pari_sp b;
};


/* "example.pxd":15
 *     cdef long get_var(self, v)
 *     cdef GEN get_nf(self) except NULL
 * cdef class PariInstance:             # <<<<<<<<<<<<<<
 *     cdef gen PARI_ZERO, PARI_ONE, PARI_TWO
 *     cdef gen new_gen(self, GEN x)
 */
struct __pyx_obj_7example_PariInstance {
  PyObject_HEAD
  struct __pyx_vtabstruct_7example_PariInstance *__pyx_vtab;
  struct __pyx_obj_7example_gen *PARI_ZERO;
  struct __pyx_obj_7example_gen *PARI_ONE;
  struct __pyx_obj_7example_gen *PARI_TWO;
};



/* "example.pyx":193
 * 
 * 
 * cdef class gen:             # <<<<<<<<<<<<<<
 *     """
 *     Python extension class that models the PARI GEN type.
 */

struct __pyx_vtabstruct_7example_gen {
  void (*init)(struct __pyx_obj_7example_gen *, GEN, pari_sp);
  GEN (*_gen)(struct __pyx_obj_7example_gen *);
  struct __pyx_obj_7example_gen *(*new_gen)(struct __pyx_obj_7example_gen *, GEN);
  struct __pyx_obj_7example_gen *(*new_gen_noclear)(struct __pyx_obj_7example_gen *, GEN);
  struct __pyx_obj_7example_gen *(*pari)(struct __pyx_obj_7example_gen *, PyObject *);
  GEN (*_deepcopy_to_python_heap)(struct __pyx_obj_7example_gen *, GEN, pari_sp *);
  long (*get_var)(struct __pyx_obj_7example_gen *, PyObject *);
  GEN (*get_nf)(struct __pyx_obj_7example_gen *);
};
static struct __pyx_vtabstruct_7example_gen *__pyx_vtabptr_7example_gen;


/* "example.pyx":8924
 * 
 * 
 * cdef class PariInstance:             # <<<<<<<<<<<<<<
 *     def __init__(self, long size=16000000, unsigned long maxprime=500000):
 *         """
 */

struct __pyx_vtabstruct_7example_PariInstance {
  struct __pyx_obj_7example_gen *(*new_gen)(struct __pyx_obj_7example_PariInstance *, GEN);
  PyObject *(*new_gen_to_string)(struct __pyx_obj_7example_PariInstance *, GEN);
  struct __pyx_obj_7example_gen *(*new_gen_noclear)(struct __pyx_obj_7example_PariInstance *, GEN);
  struct __pyx_obj_7example_gen *(*new_gen_from_int)(struct __pyx_obj_7example_PariInstance *, int);
  void (*clear_stack)(struct __pyx_obj_7example_PariInstance *);
  void (*set_mytop_to_avma)(struct __pyx_obj_7example_PariInstance *);
  struct __pyx_obj_7example_gen *(*double_to_gen_c)(struct __pyx_obj_7example_PariInstance *, double);
  GEN (*double_to_GEN)(struct __pyx_obj_7example_PariInstance *, double);
  GEN (*deepcopy_to_python_heap)(struct __pyx_obj_7example_PariInstance *, GEN, pari_sp *);
  struct __pyx_obj_7example_gen *(*new_ref)(struct __pyx_obj_7example_PariInstance *, GEN, struct __pyx_obj_7example_gen *);
  struct __pyx_obj_7example_gen *(*_empty_vector)(struct __pyx_obj_7example_PariInstance *, long);
  long (*get_var)(struct __pyx_obj_7example_PariInstance *, PyObject *);
  GEN (*toGEN)(struct __pyx_obj_7example_PariInstance *, PyObject *, int);
};
static struct __pyx_vtabstruct_7example_PariInstance *__pyx_vtabptr_7example_PariInstance;
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname); /*proto*/
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          if (acquire_gil) { \
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure(); \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
              PyGILState_Release(__pyx_gilstate_save); \
          } else { \
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__); \
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil) \
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext() \
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif /* CYTHON_REFNANNY */
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[], \
    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args, \
    const char* function_name); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static CYTHON_INLINE int __Pyx_div_int(int, int); /* proto */

#define UNARY_NEG_WOULD_OVERFLOW(x)            (((x) < 0) & ((unsigned long)(x) == 0-(unsigned long)(x)))

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact); /*proto*/

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause); /*proto*/

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
#define __Pyx_GetItemInt_List(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_List_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    else if ((-PyList_GET_SIZE(o) <= i) & (i < 0)) {
        PyObject *r = PyList_GET_ITEM(o, PyList_GET_SIZE(o) + i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Tuple_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    else if ((-PyTuple_GET_SIZE(o) <= i) & (i < 0)) {
        PyObject *r = PyTuple_GET_ITEM(o, PyTuple_GET_SIZE(o) + i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
#define __Pyx_GetItemInt(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (PyList_CheckExact(o)) {
        Py_ssize_t n = (likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if (likely((n >= 0) & (n < PyList_GET_SIZE(o)))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = (likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if (likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {  /* inlined PySequence_GetItem() */
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (unlikely(l < 0)) return NULL;
                i += l;
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static CYTHON_INLINE int __Pyx_IterFinish(void); /*proto*/

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected); /*proto*/

#define __Pyx_SetItemInt(o, i, v, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_SetItemInt_Fast(o, i, v) : \
                                                    __Pyx_SetItemInt_Generic(o, to_py_func(i), v))
static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
    int r;
    if (!j) return -1;
    r = PyObject_SetItem(o, j, v);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (PyList_CheckExact(o)) {
        Py_ssize_t n = (likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if (likely((n >= 0) & (n < PyList_GET_SIZE(o)))) {
            PyObject* old = PyList_GET_ITEM(o, n);
            Py_INCREF(v);
            PyList_SET_ITEM(o, n, v);
            Py_DECREF(old);
            return 1;
        }
    } else {  /* inlined PySequence_SetItem() */
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_ass_item)) {
            if (unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (unlikely(l < 0)) return -1;
                i += l;
            }
            return m->sq_ass_item(o, i, v);
        }
    }
#else
#if CYTHON_COMPILING_IN_PYPY
    if (PySequence_Check(o) && !PyDict_Check(o)) {
#else
    if (PySequence_Check(o)) {
#endif
        return PySequence_SetItem(o, i, v);
    }
#endif
    return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
}

static CYTHON_INLINE PyObject* __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (unlikely(PyList_Append(L, x) < 0)) return NULL;
        Py_INCREF(Py_None);
        return Py_None; /* this is just to have an accurate signature */
    } else {
        PyObject *r, *m;
        m = __Pyx_GetAttrString(L, "append");
        if (!m) return NULL;
        r = PyObject_CallFunctionObjArgs(m, x, NULL);
        Py_DECREF(m);
        return r;
    }
}

#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE int __Pyx_PyList_Append(PyObject* list, PyObject* x) {
    PyListObject* L = (PyListObject*) list;
    Py_ssize_t len = Py_SIZE(list);
    if (likely(L->allocated > len)) {
        Py_INCREF(x);
        PyList_SET_ITEM(list, len, x);
        Py_SIZE(list) = len+1;
        return 0;
    }
    return PyList_Append(list, x);
}
#else
#define __Pyx_PyList_Append(L,x) PyList_Append(L,x)
#endif

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static double __Pyx__PyObject_AsDouble(PyObject* obj); /* proto */
#if CYTHON_COMPILING_IN_PYPY
#define __Pyx_PyObject_AsDouble(obj) \
(likely(PyFloat_CheckExact(obj)) ? PyFloat_AS_DOUBLE(obj) : \
 likely(PyInt_CheckExact(obj)) ? \
 PyFloat_AsDouble(obj) : __Pyx__PyObject_AsDouble(obj))
#else
#define __Pyx_PyObject_AsDouble(obj) \
((likely(PyFloat_CheckExact(obj))) ? \
 PyFloat_AS_DOUBLE(obj) : __Pyx__PyObject_AsDouble(obj))
#endif

static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb); /*proto*/
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level); /*proto*/

static CYTHON_INLINE void __Pyx_RaiseImportError(PyObject *name);

static PyObject *__Pyx_FindPy2Metaclass(PyObject *bases); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name,
                                   PyObject *qualname, PyObject *modname); /*proto*/

#define __Pyx_CyFunction_USED 1
#include <structmember.h>
#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
#define __Pyx_CYFUNCTION_CCLASS        0x04
#define __Pyx_CyFunction_GetClosure(f) \
    (((__pyx_CyFunctionObject *) (f))->func_closure)
#define __Pyx_CyFunction_GetClassObj(f) \
    (((__pyx_CyFunctionObject *) (f))->func_classobj)
#define __Pyx_CyFunction_Defaults(type, f) \
    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
#define __Pyx_CyFunction_SetDefaultsGetter(f, g) \
    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
typedef struct {
    PyCFunctionObject func;
    int flags;
    PyObject *func_dict;
    PyObject *func_weakreflist;
    PyObject *func_name;
    PyObject *func_qualname;
    PyObject *func_doc;
    PyObject *func_code;
    PyObject *func_closure;
    PyObject *func_classobj; /* No-args super() class cell */
    void *defaults;
    int defaults_pyobjects;
    PyObject *defaults_tuple; /* Const defaults tuple */
    PyObject *(*defaults_getter)(PyObject *);
} __pyx_CyFunctionObject;
static PyTypeObject *__pyx_CyFunctionType = 0;
#define __Pyx_CyFunction_NewEx(ml, flags, qualname, self, module, code) \
    __Pyx_CyFunction_New(__pyx_CyFunctionType, ml, flags, qualname, self, module, code)
static PyObject *__Pyx_CyFunction_New(PyTypeObject *, PyMethodDef *ml,
                                      int flags, PyObject* qualname,
                                      PyObject *self, PyObject *module,
                                      PyObject* code);
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
                                                         size_t size,
                                                         int pyobjects);
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
                                                            PyObject *tuple);
static int __Pyx_CyFunction_init(void);

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_pari_sp(pari_sp);

static PyObject* __Pyx_Globals(void); /*proto*/

static CYTHON_INLINE pari_sp __Pyx_PyInt_from_py_pari_sp(PyObject *);

static int __Pyx_Print(PyObject*, PyObject *, int); /*proto*/
#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

static int __Pyx_PrintOne(PyObject* stream, PyObject *o); /*proto*/

static CYTHON_INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject *);

static CYTHON_INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject *);

static CYTHON_INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject *);

static CYTHON_INLINE char __Pyx_PyInt_AsChar(PyObject *);

static CYTHON_INLINE short __Pyx_PyInt_AsShort(PyObject *);

static CYTHON_INLINE int __Pyx_PyInt_AsInt(PyObject *);

static CYTHON_INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject *);

static CYTHON_INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject *);

static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject *);

static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject *);

static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject *);

static CYTHON_INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject *);

static CYTHON_INLINE long __Pyx_PyInt_AsLong(PyObject *);

static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject *);

static CYTHON_INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject *);

static CYTHON_INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject *);

static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                  int lineno, const char *filename); /*proto*/

static int __Pyx_check_binary_version(void);

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

#if !defined(__Pyx_PyIdentifier_FromString)
#if PY_MAJOR_VERSION < 3
  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
#else
  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
#endif
#endif

static PyObject *__Pyx_ImportModule(const char *name); /*proto*/

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);  /*proto*/

typedef struct {
    int code_line;
    PyCodeObject* code_object;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/


/* Module declarations from 'cpython.version' */

/* Module declarations from 'cpython.ref' */

/* Module declarations from 'cpython.exc' */

/* Module declarations from 'cpython.module' */

/* Module declarations from 'cpython.mem' */

/* Module declarations from 'cpython.tuple' */

/* Module declarations from 'cpython.list' */

/* Module declarations from 'libc.string' */

/* Module declarations from 'libc.stdio' */

/* Module declarations from 'cpython.object' */

/* Module declarations from 'cpython.sequence' */

/* Module declarations from 'cpython.mapping' */

/* Module declarations from 'cpython.iterator' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.type' */
static PyTypeObject *__pyx_ptype_7cpython_4type_type = 0;

/* Module declarations from 'cpython.number' */

/* Module declarations from 'cpython.int' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.bool' */
static PyTypeObject *__pyx_ptype_7cpython_4bool_bool = 0;

/* Module declarations from 'cpython.long' */

/* Module declarations from 'cpython.float' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.complex' */
static PyTypeObject *__pyx_ptype_7cpython_7complex_complex = 0;

/* Module declarations from 'cpython.string' */

/* Module declarations from 'cpython.unicode' */

/* Module declarations from 'cpython.dict' */

/* Module declarations from 'cpython.instance' */

/* Module declarations from 'cpython.function' */

/* Module declarations from 'cpython.method' */

/* Module declarations from 'cpython.weakref' */

/* Module declarations from 'cpython.getargs' */

/* Module declarations from 'cpython.pythread' */

/* Module declarations from 'cpython.pystate' */

/* Module declarations from 'cpython.cobject' */

/* Module declarations from 'cpython.oldbuffer' */

/* Module declarations from 'cpython.set' */

/* Module declarations from 'cpython.buffer' */

/* Module declarations from 'cpython.bytes' */

/* Module declarations from 'cpython.pycapsule' */

/* Module declarations from 'cpython' */

/* Module declarations from 'example' */
static PyTypeObject *__pyx_ptype_7example_gen = 0;
static PyTypeObject *__pyx_ptype_7example_PariInstance = 0;
static struct __pyx_obj_7example_PariInstance *__pyx_v_7example_pari_instance = 0;
static struct __pyx_obj_7example_PariInstance *__pyx_v_7example_P = 0;
static GEN __pyx_v_7example_t0;
static GEN __pyx_v_7example_t1;
static GEN __pyx_v_7example_t2;
static GEN __pyx_v_7example_t3;
static GEN __pyx_v_7example_t4;
static unsigned long __pyx_v_7example_num_primes;
static GEN __pyx_f_7example__Vec_append(GEN, GEN, long); /*proto*/
static PyObject *__pyx_f_7example_t0GEN(PyObject *); /*proto*/
static PyObject *__pyx_f_7example_t1GEN(PyObject *); /*proto*/
static PyObject *__pyx_f_7example_t2GEN(PyObject *); /*proto*/
static void __pyx_f_7example_sage_putchar(char); /*proto*/
static void __pyx_f_7example_sage_puts(char *); /*proto*/
static void __pyx_f_7example_sage_flush(void); /*proto*/
static int __pyx_f_7example_init_stack(size_t); /*proto*/
static size_t __pyx_f_7example_fix_size(size_t); /*proto*/
static GEN __pyx_f_7example_deepcopy_to_python_heap(GEN, pari_sp *); /*proto*/
static struct __pyx_obj_7example_gen *__pyx_f_7example__new_gen(GEN); /*proto*/
__PYX_EXTERN_C DL_EXPORT(void) _pari_trap(long, long); /*proto*/
#define __Pyx_MODULE_NAME "example"
int __pyx_module_is_main_example = 0;

/* Implementation of 'example' */
static PyObject *__pyx_builtin_staticmethod;
static PyObject *__pyx_builtin_TypeError;
static PyObject *__pyx_builtin_IndexError;
static PyObject *__pyx_builtin_xrange;
static PyObject *__pyx_builtin_enumerate;
static PyObject *__pyx_builtin_chr;
static PyObject *__pyx_builtin_ValueError;
static PyObject *__pyx_builtin_eval;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_AttributeError;
static PyObject *__pyx_builtin_MemoryError;
static PyObject *__pyx_pf_7example_prec_bits_to_dec(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_bits); /* proto */
static PyObject *__pyx_pf_7example_2prec_dec_to_bits(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_dec); /* proto */
static PyObject *__pyx_pf_7example_4prec_bits_to_words(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_bits); /* proto */
static PyObject *__pyx_pf_7example_6prec_words_to_bits(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_words); /* proto */
static PyObject *__pyx_pf_7example_8prec_dec_to_words(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_dec); /* proto */
static PyObject *__pyx_pf_7example_10prec_words_to_dec(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_words); /* proto */
static int __pyx_pf_7example_3gen___init__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_2parent(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static void __pyx_pf_7example_3gen_4__dealloc__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_6__repr__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static Py_hash_t __pyx_pf_7example_3gen_8__hash__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_10_testclass(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_12list(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_14__reduce__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_16__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_18_add_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_20__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_22_sub_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_24__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_26_mul_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_28__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /* proto */
#endif
static PyObject *__pyx_pf_7example_3gen_30_div_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right); /* proto */
static PyObject *__pyx_pf_7example_3gen_32_add_one(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_34__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_7example_3gen_36__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *__pyx_v_m); /* proto */
static PyObject *__pyx_pf_7example_3gen_38__neg__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_40__xor__(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_42__rshift__(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_44__lshift__(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_46__invert__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_48getattr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
static PyObject *__pyx_pf_7example_3gen_50mod(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_52nf_get_pol(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_54nf_get_diff(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_56nf_get_sign(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_58nf_get_zk(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_60bnf_get_no(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_62bnf_get_cyc(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_64bnf_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_66bnf_get_reg(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_68pr_get_p(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_70pr_get_e(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_72pr_get_f(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_74pr_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_76bid_get_cyc(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_78bid_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_80__getitem__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_82_gen_length(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static int __pyx_pf_7example_3gen_84__setitem__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y); /* proto */
static Py_ssize_t __pyx_pf_7example_3gen_86__len__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_88__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, CYTHON_UNUSED int __pyx_v_op); /* proto */
static PyObject *__pyx_pf_7example_3gen_90__copy__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_92list_str(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_94__hex__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
#endif
static PyObject *__pyx_pf_7example_3gen_96__int__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_98int_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_100intvec_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_102python_list_small(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_104python_list(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_106__long__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
#endif
static PyObject *__pyx_pf_7example_3gen_108__float__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_110__complex__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static int __pyx_pf_7example_3gen_112__nonzero__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_114gequal(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_7example_3gen_116gequal0(struct __pyx_obj_7example_gen *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_7example_3gen_118gequal_long(struct __pyx_obj_7example_gen *__pyx_v_a, long __pyx_v_b); /* proto */
static PyObject *__pyx_pf_7example_3gen_120isprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_122qfbhclassno(struct __pyx_obj_7example_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_124ispseudoprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_126ispower(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_k); /* proto */
static PyObject *__pyx_pf_7example_3gen_128divrem(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_7example_3gen_130lex(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_132max(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_134min(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_136shift(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_138shiftmul(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_140moebius(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_142sign(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_144vecmax(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_146vecmin(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_148Col(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_150Colrev(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_152List(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_154Mat(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_156Mod(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_158Pol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_160Polrev(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_162Qfb(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_D); /* proto */
static PyObject *__pyx_pf_7example_3gen_164Ser(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v, long __pyx_v_seriesprecision); /* proto */
static PyObject *__pyx_pf_7example_3gen_166Set(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_168Str(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_170Strchr(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_172Strexpand(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_174Strtex(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_176printtex(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_178Vec(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_180Vecrev(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_182Vecsmall(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_184binary(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_186bitand(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_188bitneg(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_190bitnegimply(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_192bitor(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_194bittest(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_196bitxor(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_198ceil(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_200centerlift(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_202component(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_204conj(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_206conjvec(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_208denominator(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_210floor(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_212frac(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_214imag(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_216length(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_218lift(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_220numbpart(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_222numerator(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_224numtoperm(struct __pyx_obj_7example_gen *__pyx_v_k, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_226padicprec(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_228padicprime(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_230permtonum(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_232precision(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_234random(struct __pyx_obj_7example_gen *__pyx_v_N); /* proto */
static PyObject *__pyx_pf_7example_3gen_236real(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_238round(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_estimate); /* proto */
static PyObject *__pyx_pf_7example_3gen_240simplify(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_242sizeword(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_244sizebyte(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_246sizedigit(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_248truncate(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_estimate); /* proto */
static PyObject *__pyx_pf_7example_3gen_250valuation(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_252_valp(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_254variable(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_256abs(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_258acos(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_260acosh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_262agm(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_264arg(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_266asin(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_268asinh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_270atan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_272atanh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_274bernfrac(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_276bernreal(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_278bernvec(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_280besselh1(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_282besselh2(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_284besselj(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_286besseljh(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_288besseli(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_290besselk(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_292besseln(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_294cos(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_296cosh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_298cotan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_300dilog(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_302eint1(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_304erfc(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_306eta(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_308exp(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_310gamma(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_312gammah(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_314hyperu(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_316incgam(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_318incgamc(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_320log(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_322lngamma(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_324log_gamma(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_326polylog(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_m, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_328psi(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_330sin(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_332sinh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_334sqr(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_336sqrt(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_338sqrtn(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_n, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_340tan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_342tanh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_344teichmuller(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_346theta(struct __pyx_obj_7example_gen *__pyx_v_q, PyObject *__pyx_v_z, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_348thetanullk(struct __pyx_obj_7example_gen *__pyx_v_q, long __pyx_v_k, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_350weber(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_352zeta(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_354bezout(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_356binomial(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_k); /* proto */
static PyObject *__pyx_pf_7example_3gen_358contfrac(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_b, long __pyx_v_lmax); /* proto */
static PyObject *__pyx_pf_7example_3gen_360contfracpnqn(struct __pyx_obj_7example_gen *__pyx_v_x, CYTHON_UNUSED PyObject *__pyx_v_b, CYTHON_UNUSED long __pyx_v_lmax); /* proto */
static PyObject *__pyx_pf_7example_3gen_362fibonacci(struct __pyx_obj_7example_gen *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_364gcd(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_366issquare(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_find_root); /* proto */
static PyObject *__pyx_pf_7example_3gen_368issquarefree(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_370lcm(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_372numdiv(struct __pyx_obj_7example_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_374phi(struct __pyx_obj_7example_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_376primepi(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_378sumdiv(struct __pyx_obj_7example_gen *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_380sumdivk(struct __pyx_obj_7example_gen *__pyx_v_n, long __pyx_v_k); /* proto */
static PyObject *__pyx_pf_7example_3gen_382xgcd(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_384ellinit(struct __pyx_obj_7example_gen *__pyx_v_self, int __pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_386ellglobalred(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_388elladd(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1); /* proto */
static PyObject *__pyx_pf_7example_3gen_390ellak(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_392ellan(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints); /* proto */
static PyObject *__pyx_pf_7example_3gen_394ellanalyticrank(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_396ellap(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_398ellaplist(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints); /* proto */
static PyObject *__pyx_pf_7example_3gen_400ellbil(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1); /* proto */
static PyObject *__pyx_pf_7example_3gen_402ellchangecurve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_ch); /* proto */
static PyObject *__pyx_pf_7example_3gen_404elleta(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_406ellheight(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_408ellheightmatrix(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_410ellisoncurve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_412elllocalred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_414elllseries(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_A); /* proto */
static PyObject *__pyx_pf_7example_3gen_416ellminimalmodel(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_418ellorder(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_420ellordinate(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_422ellpointtoz(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_P, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_424ellpow(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_426ellrootno(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_428ellsigma(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_430ellsub(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1); /* proto */
static PyObject *__pyx_pf_7example_3gen_432elltaniyama(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_434elltors(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_436ellzeta(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_438ellztopoint(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_440omega(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_442disc(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_444j(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_446ellj(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_448bnfcertify(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_450bnfinit(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_tech); /* proto */
static PyObject *__pyx_pf_7example_3gen_452bnfisintnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_454bnfisnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_456bnfisprincipal(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_458bnfnarrow(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_460bnfsunit(struct __pyx_obj_7example_gen *__pyx_v_bnf, PyObject *__pyx_v_S, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_462bnfunit(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_464bnfisunit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_466dirzetak(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_468galoisapply(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_aut, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_470galoisinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_den); /* proto */
static PyObject *__pyx_pf_7example_3gen_472galoispermtopol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_perm); /* proto */
static PyObject *__pyx_pf_7example_3gen_474galoisfixedfield(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_perm, long __pyx_v_flag, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_476idealred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_I, PyObject *__pyx_v_vdir); /* proto */
static PyObject *__pyx_pf_7example_3gen_478idealadd(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_480idealaddtoone(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_482idealappr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_484idealcoprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_486idealdiv(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_488idealfactor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_490idealhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_7example_3gen_492idealintersection(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_494ideallist(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_bound, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_496ideallog(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_bid); /* proto */
static PyObject *__pyx_pf_7example_3gen_498idealmul(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_500idealnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_502idealprimedec(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_504idealstar(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_I, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_506idealtwoelt(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_7example_3gen_508idealval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_510elementval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_512modreverse(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_514nfbasis(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_7example_3gen_516nfbasis_d(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_7example_3gen_518nfbasistoalg(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_520nfbasistoalg_lift(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_522nfdisc(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_524nfeltreduce(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_I); /* proto */
static PyObject *__pyx_pf_7example_3gen_526nffactor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_528nfgenerator(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_530nfhilbert(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_532nfhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_534nfinit(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_536_nfinit_with_prec(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_538nfisisom(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_other); /* proto */
static PyObject *__pyx_pf_7example_3gen_540nfrootsof1(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_542nfsubfields(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_d); /* proto */
static PyObject *__pyx_pf_7example_3gen_544rnfcharpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_T, PyObject *__pyx_v_a, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_546rnfdisc(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_548rnfeltabstorel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_550rnfeltreltoabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_552rnfequation(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_554rnfidealabstorel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_556rnfidealdown(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_558rnfidealhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_560rnfidealnormrel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_562rnfidealreltoabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_564rnfidealtwoelt(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_566rnfinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_7example_3gen_568rnfisfree(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_7example_3gen_570quadhilbert(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_572reverse(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_574content(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_576deriv(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_578eval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_580__call__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_582factornf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_t); /* proto */
static PyObject *__pyx_pf_7example_3gen_584factorpadic(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_r, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_586factormod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_588intformal(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_590padicappr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a); /* proto */
static PyObject *__pyx_pf_7example_3gen_592newtonpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_594polcoeff(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_7example_3gen_596polcompositum(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_pol2, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_598poldegree(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_7example_3gen_600poldisc(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_7example_3gen_602poldiscreduced(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_604polgalois(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_606nfgaloisconj(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_denom, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_608nfroots(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly); /* proto */
static PyObject *__pyx_pf_7example_3gen_610polhensellift(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_p, long __pyx_v_e); /* proto */
static PyObject *__pyx_pf_7example_3gen_612polisirreducible(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_614pollead(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_616polrecip(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_618polred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag, PyObject *__pyx_v_fa); /* proto */
static PyObject *__pyx_pf_7example_3gen_620polredabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_622polresultant(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_var, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_624polroots(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_3gen_626polrootsmod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_628polrootspadic(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r); /* proto */
static PyObject *__pyx_pf_7example_3gen_630polrootspadicfast(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r); /* proto */
static PyObject *__pyx_pf_7example_3gen_632polsturm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b); /* proto */
static PyObject *__pyx_pf_7example_3gen_634polsturm_full(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_636polsylvestermatrix(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_g); /* proto */
static PyObject *__pyx_pf_7example_3gen_638polsym(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_640serconvol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_g); /* proto */
static PyObject *__pyx_pf_7example_3gen_642serlaplace(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_644serreverse(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_646thueinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_648rnfisnorminit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_polrel, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_650rnfisnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_T, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_652vecextract(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_654ncols(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_656nrows(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_658mattranspose(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_660matadjoint(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_662qflll(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_664qflllgram(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_666lllgram(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_668lllgramint(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_670qfminim(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B, PyObject *__pyx_v_max, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_672qfrep(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_674matsolve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B); /* proto */
static PyObject *__pyx_pf_7example_3gen_676matker(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_678matkerint(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_680matdet(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_682trace(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_684mathnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_686mathnfmod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_d); /* proto */
static PyObject *__pyx_pf_7example_3gen_688mathnfmodid(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_d); /* proto */
static PyObject *__pyx_pf_7example_3gen_690matsnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_692matfrobenius(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_694factor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_limit, CYTHON_UNUSED int __pyx_v_proof); /* proto */
static PyObject *__pyx_pf_7example_3gen_696hilbert(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_p); /* proto */
static PyObject *__pyx_pf_7example_3gen_698chinese(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_700order(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_702znprimroot(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_704__abs__(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_706norm(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_708nextprime(struct __pyx_obj_7example_gen *__pyx_v_self, int __pyx_v_add_one); /* proto */
static PyObject *__pyx_pf_7example_3gen_710change_variable_name(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var); /* proto */
static PyObject *__pyx_pf_7example_3gen_712subst(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_714substpol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_716nf_subst(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z); /* proto */
static PyObject *__pyx_pf_7example_3gen_718taylor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_3gen_720thue(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_rhs, PyObject *__pyx_v_ne); /* proto */
static PyObject *__pyx_pf_7example_3gen_722charpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_724kronecker(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_726type(struct __pyx_obj_7example_gen *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_3gen_728polinterpolate(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_ya, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_3gen_730algdep(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_732concat(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_734lindep(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_736listinsert(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_738listput(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_3gen_740elleisnum(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_k, int __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_742ellwp(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, long __pyx_v_n, long __pyx_v_flag); /* proto */
static PyObject *__pyx_pf_7example_3gen_744ellchangepoint(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y); /* proto */
static PyObject *__pyx_pf_7example_3gen_746debug(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_depth); /* proto */
static int __pyx_pf_7example_12PariInstance___init__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_size, unsigned long __pyx_v_maxprime); /* proto */
static void __pyx_pf_7example_12PariInstance_2__dealloc__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_4__repr__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static Py_hash_t __pyx_pf_7example_12PariInstance_6__hash__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_8__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, CYTHON_UNUSED int __pyx_v_op); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_10default(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_variable, PyObject *__pyx_v_value); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_12set_debug_level(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_level); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_14get_debug_level(struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_16set_real_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_18get_real_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_20set_series_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_22get_series_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_24double_to_gen(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_x); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_26complex(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_re, PyObject *__pyx_v_im); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_28__call__(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_30new_with_bits_prec(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s, long __pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_32allocatemem(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_silent); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_34pari_version(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_36init_primes(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v__M); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_38read(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_filename); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_40_primelimit(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_42prime_list(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_44primes_up_to_n(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_46__nth_prime(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_48nth_prime(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_50euler(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_52pi(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_54pollegendre(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_56TestBesselk(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, int __pyx_v_n11, PyObject *__pyx_v_precision); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_58get_stack_info(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_60poltchebi(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_62factorial(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_64polcyclo(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_66polcyclo_eval(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_68polsubcyclo(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, long __pyx_v_d, PyObject *__pyx_v_v); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_70polzagier(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, long __pyx_v_m); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_72setrand(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_seed); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_74getrand(struct __pyx_obj_7example_PariInstance *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_76vector(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_entries); /* proto */
static PyObject *__pyx_pf_7example_12PariInstance_78matrix(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_m, long __pyx_v_n, PyObject *__pyx_v_entries); /* proto */
static PyObject *__pyx_pf_7example_12init_pari_stack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_size); /* proto */
static PyObject *__pyx_pf_7example_14__errmessage(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_d); /* proto */
static PyObject *__pyx_pf_7example_9PariError_errnum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_9PariError_2__repr__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_9PariError_4__str__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
static PyObject *__pyx_pf_7example_16vecsmall_to_intlist(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_7example_gen *__pyx_v_v); /* proto */
static char __pyx_k_1[] = "sage.libs.pari.gen_py";
static char __pyx_k_2[] = "Use ** for exponentiation, not '^', which means xor\n";
static char __pyx_k_3[] = "in Python, and has the wrong precedence.";
static char __pyx_k_4[] = ".";
static char __pyx_k_5[] = "Not an INTMOD or POLMOD in mod()";
static char __pyx_k_7[] = "Not a PARI number field";
static char __pyx_k_9[] = "self must be of pari type t_MAT";
static char __pyx_k_10[] = "index must be an integer or a 2-tuple (i,j)";
static char __pyx_k_11[] = "row index out of bounds";
static char __pyx_k_12[] = "column index out of bounds";
static char __pyx_k_14[] = "\"";
static char __pyx_k_15[] = "..";
static char __pyx_k_16[] = "index out of bounds";
static char __pyx_k_17[] = "unindexable object";
static char __pyx_k_18[] = "cannot index Pari type %s by tuple";
static char __pyx_k_19[] = "matrix index must be of the form [row, column]";
static char __pyx_k_20[] = "row i(=%s) must be between 0 and %s";
static char __pyx_k_21[] = "column j(=%s) must be between 0 and %s";
static char __pyx_k_22[] = "attempt to assign sequence of size %s to slice of size %s";
static char __pyx_k_23[] = "index (%s) must be between 0 and %s";
static char __pyx_k_24[] = "Mat(";
static char __pyx_k_25[] = "[";
static char __pyx_k_26[] = "]";
static char __pyx_k_27[] = "~";
static char __pyx_k_28[] = "";
static char __pyx_k_30[] = ";";
static char __pyx_k_32[] = "], [";
static char __pyx_k_34[] = "gen must be of PARI type t_INT";
static char __pyx_k_35[] = "gen must be of PARI type t_INT or t_POL of degree 0";
static char __pyx_k_36[] = "gen must be of PARI type t_VEC";
static char __pyx_k_37[] = "Object (=%s) must be of type t_VECSMALL.";
static char __pyx_k_38[] = "Object (=%s) must be of type t_VEC.";
static char __pyx_k_39[] = "x must be of type t_VEC.";
static char __pyx_k_40[] = "x (=%s) must be of type t_INT, but is of type %s.";
static char __pyx_k_41[] = "p (=%s) must be of type t_INT, but is of type %s.";
static char __pyx_k_42[] = "not the same prime in padicprec";
static char __pyx_k_44[] = "x (=%s) must be of type t_VEC, but is of type %s.";
static char __pyx_k_52[] = "set_variable() only works for polynomials or power series";
static char __pyx_k_53[] = "Unknown Pari type: %s";
static char __pyx_k_56[] = "Interface to the PARI C library";
static char __pyx_k_57[] = "default(%s, %s)";
static char __pyx_k_58[] = "default(%s)";
static char __pyx_k_60[] = "evaluating PARI string";
static char __pyx_k_62[] = "Doubling the PARI stack.";
static char __pyx_k_63[] = "s must be nonnegative and not too big.";
static char __pyx_k_64[] = "sage.rings.all";
static char __pyx_k_65[] = "nth prime meaningless for non-positive n (=%s)";
static char __pyx_k_66[] = "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n";
static char __pyx_k_67[] = " Used :                         %ld  long words  (%ld K)\n";
static char __pyx_k_68[] = " Available :                    %ld  long words  (%ld K)\n";
static char __pyx_k_69[] = " Occupation of the PARI stack : %6.2f percent\n";
static char __pyx_k_70[] = " %ld objects on heap occupy %ld long words\n\n";
static char __pyx_k_71[] = " %ld variable names used (%ld user + %ld private) out of %d\n\n";
static char __pyx_k_72[] = "length of entries (=%s) must equal n (=%s)";
static char __pyx_k_73[] = "len of entries (=%s) must be %s*%s=%s";
static char __pyx_k_74[] = "Unable to allocate %s bytes memory for PARI.";
static char __pyx_k_75[] = "_pari_trap recursion too deep";
static char __pyx_k_76[] = "PARI user exception";
static char __pyx_k_78[] = "PariError(%d)";
static char __pyx_k_79[] = "%s (%d)";
static char __pyx_k_80[] = "input v must be of type vecsmall (use v.Vecsmall())";
static char __pyx_k_83[] = "E:\\Programmation\\Packages\\Sage\\Test\\example.pyx";
static char __pyx_k__0[] = "0";
static char __pyx_k__A[] = "A";
static char __pyx_k__B[] = "B";
static char __pyx_k__D[] = "D";
static char __pyx_k__I[] = "I";
static char __pyx_k__P[] = "P";
static char __pyx_k__S[] = "S";
static char __pyx_k__T[] = "T";
static char __pyx_k__a[] = "a";
static char __pyx_k__b[] = "b";
static char __pyx_k__c[] = "c";
static char __pyx_k__d[] = "d";
static char __pyx_k__e[] = "e";
static char __pyx_k__k[] = "k";
static char __pyx_k__m[] = "m";
static char __pyx_k__n[] = "n";
static char __pyx_k__p[] = "p";
static char __pyx_k__r[] = "r";
static char __pyx_k__s[] = "s";
static char __pyx_k__v[] = "v";
static char __pyx_k__x[] = "x";
static char __pyx_k__y[] = "y";
static char __pyx_k__z[] = "z";
static char __pyx_k_101[] = "PariError.errnum";
static char __pyx_k_104[] = "PariError.__repr__";
static char __pyx_k_107[] = "PariError.__str__";
static char __pyx_k__ZZ[] = "ZZ";
static char __pyx_k__fa[] = "fa";
static char __pyx_k__im[] = "im";
static char __pyx_k__ne[] = "ne";
static char __pyx_k__re[] = "re";
static char __pyx_k__ya[] = "ya";
static char __pyx_k__z0[] = "z0";
static char __pyx_k__z1[] = "z1";
static char __pyx_k__Mat[] = "Mat";
static char __pyx_k__Mod[] = "Mod";
static char __pyx_k__Vec[] = "Vec";
static char __pyx_k__abs[] = "abs";
static char __pyx_k__aut[] = "aut";
static char __pyx_k__bid[] = "bid";
static char __pyx_k__chr[] = "chr";
static char __pyx_k__den[] = "den";
static char __pyx_k__max[] = "max";
static char __pyx_k__n11[] = "n11";
static char __pyx_k__obj[] = "obj";
static char __pyx_k__pbw[] = "pbw";
static char __pyx_k__rhs[] = "rhs";
static char __pyx_k__sys[] = "sys";
static char __pyx_k__var[] = "var";
static char __pyx_k__args[] = "args";
static char __pyx_k__eval[] = "eval";
static char __pyx_k__find[] = "find";
static char __pyx_k__flag[] = "flag";
static char __pyx_k__libs[] = "libs";
static char __pyx_k__lmax[] = "lmax";
static char __pyx_k__math[] = "math";
static char __pyx_k__pari[] = "pari";
static char __pyx_k__perm[] = "perm";
static char __pyx_k__pol2[] = "pol2";
static char __pyx_k__poly[] = "poly";
static char __pyx_k__prec[] = "prec";
static char __pyx_k__self[] = "self";
static char __pyx_k__size[] = "size";
static char __pyx_k__tech[] = "tech";
static char __pyx_k__test[] = "test";
static char __pyx_k__type[] = "type";
static char __pyx_k__vdir[] = "vdir";
static char __pyx_k___init[] = "_init";
static char __pyx_k__bound[] = "bound";
static char __pyx_k__debug[] = "debug";
static char __pyx_k__denom[] = "denom";
static char __pyx_k__depth[] = "depth";
static char __pyx_k__flush[] = "flush";
static char __pyx_k__limit[] = "limit";
static char __pyx_k__log_2[] = "log_2";
static char __pyx_k__mytop[] = "mytop";
static char __pyx_k__ncols[] = "ncols";
static char __pyx_k__nrows[] = "nrows";
static char __pyx_k__proof[] = "proof";
static char __pyx_k__range[] = "range";
static char __pyx_k__t_COL[] = "t_COL";
static char __pyx_k__t_INT[] = "t_INT";
static char __pyx_k__t_MAT[] = "t_MAT";
static char __pyx_k__t_POL[] = "t_POL";
static char __pyx_k__t_QFI[] = "t_QFI";
static char __pyx_k__t_QFR[] = "t_QFR";
static char __pyx_k__t_SER[] = "t_SER";
static char __pyx_k__t_STR[] = "t_STR";
static char __pyx_k__t_VEC[] = "t_VEC";
static char __pyx_k__types[] = "types";
static char __pyx_k__value[] = "value";
static char __pyx_k__write[] = "write";
static char __pyx_k__Polrev[] = "Polrev";
static char __pyx_k__Strtex[] = "Strtex";
static char __pyx_k__Vecrev[] = "Vecrev";
static char __pyx_k___pari_[] = "_pari_";
static char __pyx_k__bezout[] = "bezout";
static char __pyx_k__errnum[] = "errnum";
static char __pyx_k__gen_py[] = "gen_py";
static char __pyx_k__log_10[] = "log_10";
static char __pyx_k__polrel[] = "polrel";
static char __pyx_k__silent[] = "silent";
static char __pyx_k__stdout[] = "stdout";
static char __pyx_k__t0heap[] = "t0heap";
static char __pyx_k__t_FRAC[] = "t_FRAC";
static char __pyx_k__t_LIST[] = "t_LIST";
static char __pyx_k__t_QUAD[] = "t_QUAD";
static char __pyx_k__t_REAL[] = "t_REAL";
static char __pyx_k__vector[] = "vector";
static char __pyx_k__xrange[] = "xrange";
static char __pyx_k____str__[] = "__str__";
static char __pyx_k__add_one[] = "add_one";
static char __pyx_k__default[] = "default";
static char __pyx_k__entries[] = "entries";
static char __pyx_k__example[] = "example";
static char __pyx_k__indices[] = "indices";
static char __pyx_k__primepi[] = "primepi";
static char __pyx_k__replace[] = "replace";
static char __pyx_k__t_FFELT[] = "t_FFELT";
static char __pyx_k__t_PADIC[] = "t_PADIC";
static char __pyx_k__t_RFRAC[] = "t_RFRAC";
static char __pyx_k__unknown[] = "unknown";
static char __pyx_k__ListType[] = "ListType";
static char __pyx_k____main__[] = "__main__";
static char __pyx_k____repr__[] = "__repr__";
static char __pyx_k____test__[] = "__test__";
static char __pyx_k__estimate[] = "estimate";
static char __pyx_k__maxprime[] = "maxprime";
static char __pyx_k__operator[] = "operator";
static char __pyx_k__polcoeff[] = "polcoeff";
static char __pyx_k__t_INTMOD[] = "t_INTMOD";
static char __pyx_k__t_POLMOD[] = "t_POLMOD";
static char __pyx_k__variable[] = "variable";
static char __pyx_k__wordsize[] = "wordsize";
static char __pyx_k__PariError[] = "PariError";
static char __pyx_k__TupleType[] = "TupleType";
static char __pyx_k__TypeError[] = "TypeError";
static char __pyx_k__component[] = "component";
static char __pyx_k__enumerate[] = "enumerate";
static char __pyx_k__find_root[] = "find_root";
static char __pyx_k__log_gamma[] = "log_gamma";
static char __pyx_k__nth_prime[] = "nth_prime";
static char __pyx_k__poldegree[] = "poldegree";
static char __pyx_k__precision[] = "precision";
static char __pyx_k__qflllgram[] = "qflllgram";
static char __pyx_k__t_CLOSURE[] = "t_CLOSURE";
static char __pyx_k__t_COMPLEX[] = "t_COMPLEX";
static char __pyx_k__testclass[] = "testclass";
static char __pyx_k__IndexError[] = "IndexError";
static char __pyx_k__ValueError[] = "ValueError";
static char __pyx_k__XRangeType[] = "XRangeType";
static char __pyx_k__errmessage[] = "errmessage";
static char __pyx_k__exceptions[] = "exceptions";
static char __pyx_k__prime_list[] = "prime_list";
static char __pyx_k__t_VECSMALL[] = "t_VECSMALL";
static char __pyx_k__vecextract[] = "vecextract";
static char __pyx_k__MemoryError[] = "MemoryError";
static char __pyx_k__NumberOfGEN[] = "NumberOfGEN";
static char __pyx_k____getitem__[] = "__getitem__";
static char __pyx_k____nth_prime[] = "__nth_prime";
static char __pyx_k__allocatemem[] = "allocatemem";
static char __pyx_k__init_primes[] = "init_primes";
static char __pyx_k__padded_bits[] = "padded_bits";
static char __pyx_k__prec_in_dec[] = "prec_in_dec";
static char __pyx_k__python_ints[] = "python_ints";
static char __pyx_k__RuntimeError[] = "RuntimeError";
static char __pyx_k____errmessage[] = "__errmessage";
static char __pyx_k__prec_in_bits[] = "prec_in_bits";
static char __pyx_k__staticmethod[] = "staticmethod";
static char __pyx_k__GeneratorType[] = "GeneratorType";
static char __pyx_k__prec_in_words[] = "prec_in_words";
static char __pyx_k__AttributeError[] = "AttributeError";
static char __pyx_k__init_pari_stack[] = "init_pari_stack";
static char __pyx_k__seriesprecision[] = "seriesprecision";
static char __pyx_k__0123456789abcdef[] = "0123456789abcdef";
static char __pyx_k__prec_bits_to_dec[] = "prec_bits_to_dec";
static char __pyx_k__prec_dec_to_bits[] = "prec_dec_to_bits";
static char __pyx_k___nfinit_with_prec[] = "_nfinit_with_prec";
static char __pyx_k__prec_dec_to_words[] = "prec_dec_to_words";
static char __pyx_k__prec_words_to_dec[] = "prec_words_to_dec";
static char __pyx_k__prec_bits_to_words[] = "prec_bits_to_words";
static char __pyx_k__prec_words_to_bits[] = "prec_words_to_bits";
static char __pyx_k__set_real_precision[] = "set_real_precision";
static char __pyx_k__vecsmall_to_intlist[] = "vecsmall_to_intlist";
static PyObject *__pyx_n_s_1;
static PyObject *__pyx_kp_s_10;
static PyObject *__pyx_n_s_101;
static PyObject *__pyx_n_s_104;
static PyObject *__pyx_n_s_107;
static PyObject *__pyx_kp_s_11;
static PyObject *__pyx_kp_s_12;
static PyObject *__pyx_kp_s_14;
static PyObject *__pyx_kp_s_15;
static PyObject *__pyx_kp_s_16;
static PyObject *__pyx_kp_s_17;
static PyObject *__pyx_kp_s_18;
static PyObject *__pyx_kp_s_19;
static PyObject *__pyx_kp_s_2;
static PyObject *__pyx_kp_s_20;
static PyObject *__pyx_kp_s_21;
static PyObject *__pyx_kp_s_22;
static PyObject *__pyx_kp_s_23;
static PyObject *__pyx_kp_s_24;
static PyObject *__pyx_kp_s_25;
static PyObject *__pyx_kp_s_26;
static PyObject *__pyx_kp_s_27;
static PyObject *__pyx_kp_s_28;
static PyObject *__pyx_kp_s_3;
static PyObject *__pyx_kp_s_30;
static PyObject *__pyx_kp_s_32;
static PyObject *__pyx_kp_s_34;
static PyObject *__pyx_kp_s_35;
static PyObject *__pyx_kp_s_36;
static PyObject *__pyx_kp_s_37;
static PyObject *__pyx_kp_s_38;
static PyObject *__pyx_kp_s_39;
static PyObject *__pyx_kp_s_4;
static PyObject *__pyx_kp_s_40;
static PyObject *__pyx_kp_s_41;
static PyObject *__pyx_kp_s_42;
static PyObject *__pyx_kp_s_44;
static PyObject *__pyx_kp_s_5;
static PyObject *__pyx_kp_s_52;
static PyObject *__pyx_kp_s_53;
static PyObject *__pyx_kp_s_56;
static PyObject *__pyx_kp_s_57;
static PyObject *__pyx_kp_s_58;
static PyObject *__pyx_kp_s_62;
static PyObject *__pyx_kp_s_63;
static PyObject *__pyx_n_s_64;
static PyObject *__pyx_kp_s_65;
static PyObject *__pyx_kp_s_66;
static PyObject *__pyx_kp_s_67;
static PyObject *__pyx_kp_s_68;
static PyObject *__pyx_kp_s_69;
static PyObject *__pyx_kp_s_7;
static PyObject *__pyx_kp_s_70;
static PyObject *__pyx_kp_s_71;
static PyObject *__pyx_kp_s_72;
static PyObject *__pyx_kp_s_73;
static PyObject *__pyx_kp_s_74;
static PyObject *__pyx_kp_s_75;
static PyObject *__pyx_kp_s_76;
static PyObject *__pyx_kp_s_78;
static PyObject *__pyx_kp_s_79;
static PyObject *__pyx_kp_s_80;
static PyObject *__pyx_kp_s_83;
static PyObject *__pyx_kp_s_9;
static PyObject *__pyx_kp_s__0;
static PyObject *__pyx_n_s__A;
static PyObject *__pyx_n_s__AttributeError;
static PyObject *__pyx_n_s__B;
static PyObject *__pyx_n_s__D;
static PyObject *__pyx_n_s__GeneratorType;
static PyObject *__pyx_n_s__I;
static PyObject *__pyx_n_s__IndexError;
static PyObject *__pyx_n_s__ListType;
static PyObject *__pyx_n_s__Mat;
static PyObject *__pyx_n_s__MemoryError;
static PyObject *__pyx_n_s__Mod;
static PyObject *__pyx_n_s__NumberOfGEN;
static PyObject *__pyx_n_s__P;
static PyObject *__pyx_n_s__PariError;
static PyObject *__pyx_n_s__Polrev;
static PyObject *__pyx_n_s__RuntimeError;
static PyObject *__pyx_n_s__S;
static PyObject *__pyx_n_s__Strtex;
static PyObject *__pyx_n_s__T;
static PyObject *__pyx_n_s__TupleType;
static PyObject *__pyx_n_s__TypeError;
static PyObject *__pyx_n_s__ValueError;
static PyObject *__pyx_n_s__Vec;
static PyObject *__pyx_n_s__Vecrev;
static PyObject *__pyx_n_s__XRangeType;
static PyObject *__pyx_n_s__ZZ;
static PyObject *__pyx_n_s____errmessage;
static PyObject *__pyx_n_s____getitem__;
static PyObject *__pyx_n_s____main__;
static PyObject *__pyx_n_s____nth_prime;
static PyObject *__pyx_n_s____repr__;
static PyObject *__pyx_n_s____str__;
static PyObject *__pyx_n_s____test__;
static PyObject *__pyx_n_s___init;
static PyObject *__pyx_n_s___nfinit_with_prec;
static PyObject *__pyx_n_s___pari_;
static PyObject *__pyx_n_s__a;
static PyObject *__pyx_n_s__abs;
static PyObject *__pyx_n_s__add_one;
static PyObject *__pyx_n_s__allocatemem;
static PyObject *__pyx_n_s__args;
static PyObject *__pyx_n_s__aut;
static PyObject *__pyx_n_s__b;
static PyObject *__pyx_n_s__bezout;
static PyObject *__pyx_n_s__bid;
static PyObject *__pyx_n_s__bound;
static PyObject *__pyx_n_s__c;
static PyObject *__pyx_n_s__chr;
static PyObject *__pyx_n_s__component;
static PyObject *__pyx_n_s__d;
static PyObject *__pyx_n_s__debug;
static PyObject *__pyx_n_s__default;
static PyObject *__pyx_n_s__den;
static PyObject *__pyx_n_s__denom;
static PyObject *__pyx_n_s__depth;
static PyObject *__pyx_n_s__e;
static PyObject *__pyx_n_s__entries;
static PyObject *__pyx_n_s__enumerate;
static PyObject *__pyx_n_s__errmessage;
static PyObject *__pyx_n_s__errnum;
static PyObject *__pyx_n_s__estimate;
static PyObject *__pyx_n_s__eval;
static PyObject *__pyx_n_s__example;
static PyObject *__pyx_n_s__exceptions;
static PyObject *__pyx_n_s__fa;
static PyObject *__pyx_n_s__find;
static PyObject *__pyx_n_s__find_root;
static PyObject *__pyx_n_s__flag;
static PyObject *__pyx_n_s__flush;
static PyObject *__pyx_n_s__gen_py;
static PyObject *__pyx_n_s__im;
static PyObject *__pyx_n_s__indices;
static PyObject *__pyx_n_s__init_pari_stack;
static PyObject *__pyx_n_s__init_primes;
static PyObject *__pyx_n_s__k;
static PyObject *__pyx_n_s__libs;
static PyObject *__pyx_n_s__limit;
static PyObject *__pyx_n_s__lmax;
static PyObject *__pyx_n_s__log_10;
static PyObject *__pyx_n_s__log_2;
static PyObject *__pyx_n_s__log_gamma;
static PyObject *__pyx_n_s__m;
static PyObject *__pyx_n_s__math;
static PyObject *__pyx_n_s__max;
static PyObject *__pyx_n_s__maxprime;
static PyObject *__pyx_n_s__mytop;
static PyObject *__pyx_n_s__n;
static PyObject *__pyx_n_s__n11;
static PyObject *__pyx_n_s__ncols;
static PyObject *__pyx_n_s__ne;
static PyObject *__pyx_n_s__nrows;
static PyObject *__pyx_n_s__nth_prime;
static PyObject *__pyx_n_s__obj;
static PyObject *__pyx_n_s__operator;
static PyObject *__pyx_n_s__p;
static PyObject *__pyx_n_s__padded_bits;
static PyObject *__pyx_n_s__pari;
static PyObject *__pyx_n_s__pbw;
static PyObject *__pyx_n_s__perm;
static PyObject *__pyx_n_s__pol2;
static PyObject *__pyx_n_s__polcoeff;
static PyObject *__pyx_n_s__poldegree;
static PyObject *__pyx_n_s__polrel;
static PyObject *__pyx_n_s__poly;
static PyObject *__pyx_n_s__prec;
static PyObject *__pyx_n_s__prec_bits_to_dec;
static PyObject *__pyx_n_s__prec_bits_to_words;
static PyObject *__pyx_n_s__prec_dec_to_bits;
static PyObject *__pyx_n_s__prec_dec_to_words;
static PyObject *__pyx_n_s__prec_in_bits;
static PyObject *__pyx_n_s__prec_in_dec;
static PyObject *__pyx_n_s__prec_in_words;
static PyObject *__pyx_n_s__prec_words_to_bits;
static PyObject *__pyx_n_s__prec_words_to_dec;
static PyObject *__pyx_n_s__precision;
static PyObject *__pyx_n_s__prime_list;
static PyObject *__pyx_n_s__primepi;
static PyObject *__pyx_n_s__proof;
static PyObject *__pyx_n_s__python_ints;
static PyObject *__pyx_n_s__qflllgram;
static PyObject *__pyx_n_s__r;
static PyObject *__pyx_n_s__range;
static PyObject *__pyx_n_s__re;
static PyObject *__pyx_n_s__replace;
static PyObject *__pyx_n_s__rhs;
static PyObject *__pyx_n_s__s;
static PyObject *__pyx_n_s__self;
static PyObject *__pyx_n_s__seriesprecision;
static PyObject *__pyx_n_s__set_real_precision;
static PyObject *__pyx_n_s__silent;
static PyObject *__pyx_n_s__size;
static PyObject *__pyx_n_s__staticmethod;
static PyObject *__pyx_n_s__stdout;
static PyObject *__pyx_n_s__sys;
static PyObject *__pyx_n_s__t0heap;
static PyObject *__pyx_n_s__t_CLOSURE;
static PyObject *__pyx_n_s__t_COL;
static PyObject *__pyx_n_s__t_COMPLEX;
static PyObject *__pyx_n_s__t_FFELT;
static PyObject *__pyx_n_s__t_FRAC;
static PyObject *__pyx_n_s__t_INT;
static PyObject *__pyx_n_s__t_INTMOD;
static PyObject *__pyx_n_s__t_LIST;
static PyObject *__pyx_n_s__t_MAT;
static PyObject *__pyx_n_s__t_PADIC;
static PyObject *__pyx_n_s__t_POL;
static PyObject *__pyx_n_s__t_POLMOD;
static PyObject *__pyx_n_s__t_QFI;
static PyObject *__pyx_n_s__t_QFR;
static PyObject *__pyx_n_s__t_QUAD;
static PyObject *__pyx_n_s__t_REAL;
static PyObject *__pyx_n_s__t_RFRAC;
static PyObject *__pyx_n_s__t_SER;
static PyObject *__pyx_n_s__t_STR;
static PyObject *__pyx_n_s__t_VEC;
static PyObject *__pyx_n_s__t_VECSMALL;
static PyObject *__pyx_n_s__tech;
static PyObject *__pyx_n_s__test;
static PyObject *__pyx_n_s__testclass;
static PyObject *__pyx_n_s__type;
static PyObject *__pyx_n_s__types;
static PyObject *__pyx_n_s__unknown;
static PyObject *__pyx_n_s__v;
static PyObject *__pyx_n_s__value;
static PyObject *__pyx_n_s__var;
static PyObject *__pyx_n_s__variable;
static PyObject *__pyx_n_s__vdir;
static PyObject *__pyx_n_s__vecextract;
static PyObject *__pyx_n_s__vecsmall_to_intlist;
static PyObject *__pyx_n_s__vector;
static PyObject *__pyx_n_s__wordsize;
static PyObject *__pyx_n_s__write;
static PyObject *__pyx_n_s__x;
static PyObject *__pyx_n_s__xrange;
static PyObject *__pyx_n_s__y;
static PyObject *__pyx_n_s__ya;
static PyObject *__pyx_n_s__z;
static PyObject *__pyx_n_s__z0;
static PyObject *__pyx_n_s__z1;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_neg_1;
static PyObject *__pyx_int_10;
static PyObject *__pyx_int_20;
static PyObject *__pyx_int_53;
static PyObject *__pyx_int_500000;
static PyObject *__pyx_int_8000000;
static PyObject *__pyx_int_16000000;
static PyObject *__pyx_k_45;
static PyObject *__pyx_k_46;
static PyObject *__pyx_k_47;
static PyObject *__pyx_k_48;
static PyObject *__pyx_k_49;
static PyObject *__pyx_k_61;
static PyObject *__pyx_k_tuple_6;
static PyObject *__pyx_k_tuple_8;
static PyObject *__pyx_k_tuple_13;
static PyObject *__pyx_k_tuple_29;
static PyObject *__pyx_k_tuple_31;
static PyObject *__pyx_k_tuple_33;
static PyObject *__pyx_k_tuple_43;
static PyObject *__pyx_k_tuple_50;
static PyObject *__pyx_k_tuple_51;
static PyObject *__pyx_k_tuple_54;
static PyObject *__pyx_k_tuple_55;
static PyObject *__pyx_k_tuple_59;
static PyObject *__pyx_k_tuple_77;
static PyObject *__pyx_k_tuple_81;
static PyObject *__pyx_k_tuple_84;
static PyObject *__pyx_k_tuple_86;
static PyObject *__pyx_k_tuple_88;
static PyObject *__pyx_k_tuple_90;
static PyObject *__pyx_k_tuple_92;
static PyObject *__pyx_k_tuple_94;
static PyObject *__pyx_k_tuple_95;
static PyObject *__pyx_k_tuple_97;
static PyObject *__pyx_k_tuple_99;
static PyObject *__pyx_k_tuple_102;
static PyObject *__pyx_k_tuple_105;
static PyObject *__pyx_k_tuple_108;
static PyObject *__pyx_k_codeobj_82;
static PyObject *__pyx_k_codeobj_85;
static PyObject *__pyx_k_codeobj_87;
static PyObject *__pyx_k_codeobj_89;
static PyObject *__pyx_k_codeobj_91;
static PyObject *__pyx_k_codeobj_93;
static PyObject *__pyx_k_codeobj_96;
static PyObject *__pyx_k_codeobj_98;
static PyObject *__pyx_k_codeobj_100;
static PyObject *__pyx_k_codeobj_103;
static PyObject *__pyx_k_codeobj_106;
static PyObject *__pyx_k_codeobj_109;

/* Python wrapper */
static PyObject *__pyx_pw_7example_1prec_bits_to_dec(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_bits); /*proto*/
static char __pyx_doc_7example_prec_bits_to_dec[] = "\n    Convert from precision expressed in bits to precision expressed in\n    decimal.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_bits_to_dec(53)\n        15\n        sage: [(32*n,gen.prec_bits_to_dec(32*n)) for n in range(1,9)]\n        [(32, 9),\n        (64, 19),\n        (96, 28),\n        (128, 38),\n        (160, 48),\n        (192, 57),\n        (224, 67),\n        (256, 77)]\n    ";
static PyMethodDef __pyx_mdef_7example_1prec_bits_to_dec = {__Pyx_NAMESTR("prec_bits_to_dec"), (PyCFunction)__pyx_pw_7example_1prec_bits_to_dec, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_prec_bits_to_dec)};
static PyObject *__pyx_pw_7example_1prec_bits_to_dec(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_bits) {
  int __pyx_v_prec_in_bits;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_bits_to_dec (wrapper)", 0);
  assert(__pyx_arg_prec_in_bits); {
    __pyx_v_prec_in_bits = __Pyx_PyInt_AsInt(__pyx_arg_prec_in_bits); if (unlikely((__pyx_v_prec_in_bits == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_bits_to_dec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_prec_bits_to_dec(__pyx_self, ((int)__pyx_v_prec_in_bits));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":14
 * #    int PyObject_HasAttrString(object o, char *attr_name)
 * 
 * def prec_bits_to_dec(int prec_in_bits):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to precision expressed in
 */

static PyObject *__pyx_pf_7example_prec_bits_to_dec(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_bits) {
  double __pyx_v_log_2;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_bits_to_dec", 0);

  /* "example.pyx":34
 *         (256, 77)]
 *     """
 *     log_2 = 0.301029995663981             # <<<<<<<<<<<<<<
 *     return int(prec_in_bits*log_2)
 * 
 */
  __pyx_v_log_2 = 0.301029995663981;

  /* "example.pyx":35
 *     """
 *     log_2 = 0.301029995663981
 *     return int(prec_in_bits*log_2)             # <<<<<<<<<<<<<<
 * 
 * def prec_dec_to_bits(int prec_in_dec):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_prec_in_bits * __pyx_v_log_2)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.prec_bits_to_dec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3prec_dec_to_bits(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_dec); /*proto*/
static char __pyx_doc_7example_2prec_dec_to_bits[] = "\n    Convert from precision expressed in decimal to precision expressed\n    in bits.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_dec_to_bits(15)\n        49\n        sage: [(n,gen.prec_dec_to_bits(n)) for n in range(10,100,10)]\n        [(10, 33),\n        (20, 66),\n        (30, 99),\n        (40, 132),\n        (50, 166),\n        (60, 199),\n        (70, 232),\n        (80, 265),\n        (90, 298)]\n    ";
static PyMethodDef __pyx_mdef_7example_3prec_dec_to_bits = {__Pyx_NAMESTR("prec_dec_to_bits"), (PyCFunction)__pyx_pw_7example_3prec_dec_to_bits, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_2prec_dec_to_bits)};
static PyObject *__pyx_pw_7example_3prec_dec_to_bits(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_dec) {
  int __pyx_v_prec_in_dec;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_dec_to_bits (wrapper)", 0);
  assert(__pyx_arg_prec_in_dec); {
    __pyx_v_prec_in_dec = __Pyx_PyInt_AsInt(__pyx_arg_prec_in_dec); if (unlikely((__pyx_v_prec_in_dec == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_dec_to_bits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_2prec_dec_to_bits(__pyx_self, ((int)__pyx_v_prec_in_dec));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":37
 *     return int(prec_in_bits*log_2)
 * 
 * def prec_dec_to_bits(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */

static PyObject *__pyx_pf_7example_2prec_dec_to_bits(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_dec) {
  double __pyx_v_log_10;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_dec_to_bits", 0);

  /* "example.pyx":58
 *         (90, 298)]
 *     """
 *     log_10 = 3.32192809488736             # <<<<<<<<<<<<<<
 *     return int(prec_in_dec*log_10)
 * 
 */
  __pyx_v_log_10 = 3.32192809488736;

  /* "example.pyx":59
 *     """
 *     log_10 = 3.32192809488736
 *     return int(prec_in_dec*log_10)             # <<<<<<<<<<<<<<
 * 
 * def prec_bits_to_words(int prec_in_bits=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_prec_in_dec * __pyx_v_log_10)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 59; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.prec_dec_to_bits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_5prec_bits_to_words(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_4prec_bits_to_words[] = "\n    Convert from precision expressed in bits to pari real precision\n    expressed in words. Note: this rounds up to the nearest word,\n    adjusts for the two codewords of a pari real, and is\n    architecture-dependent.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_bits_to_words(70)\n        5   # 32-bit\n        4   # 64-bit\n\n    ::\n\n        sage: [(32*n,gen.prec_bits_to_words(32*n)) for n in range(1,9)]\n        [(32, 3), (64, 4), (96, 5), (128, 6), (160, 7), (192, 8), (224, 9), (256, 10)] # 32-bit\n        [(32, 3), (64, 3), (96, 4), (128, 4), (160, 5), (192, 5), (224, 6), (256, 6)] # 64-bit\n    ";
static PyMethodDef __pyx_mdef_7example_5prec_bits_to_words = {__Pyx_NAMESTR("prec_bits_to_words"), (PyCFunction)__pyx_pw_7example_5prec_bits_to_words, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_4prec_bits_to_words)};
static PyObject *__pyx_pw_7example_5prec_bits_to_words(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_prec_in_bits;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_bits_to_words (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__prec_in_bits,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__prec_in_bits);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "prec_bits_to_words") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_prec_in_bits = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_prec_in_bits == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_prec_in_bits = ((int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("prec_bits_to_words", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_bits_to_words", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_4prec_bits_to_words(__pyx_self, __pyx_v_prec_in_bits);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":61
 *     return int(prec_in_dec*log_10)
 * 
 * def prec_bits_to_words(int prec_in_bits=0):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to pari real precision
 */

static PyObject *__pyx_pf_7example_4prec_bits_to_words(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_bits) {
  int __pyx_v_wordsize;
  int __pyx_v_padded_bits;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_bits_to_words", 0);

  /* "example.pyx":81
 *         [(32, 3), (64, 3), (96, 4), (128, 4), (160, 5), (192, 5), (224, 6), (256, 6)] # 64-bit
 *     """
 *     if not prec_in_bits:             # <<<<<<<<<<<<<<
 *         return prec
 *     cdef int wordsize
 */
  __pyx_t_1 = (!__pyx_v_prec_in_bits);
  if (__pyx_t_1) {

    /* "example.pyx":82
 *     """
 *     if not prec_in_bits:
 *         return prec             # <<<<<<<<<<<<<<
 *     cdef int wordsize
 *     wordsize = BITS_IN_LONG
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":84
 *         return prec
 *     cdef int wordsize
 *     wordsize = BITS_IN_LONG             # <<<<<<<<<<<<<<
 * 
 *     # increase prec_in_bits to the nearest multiple of wordsize
 */
  __pyx_v_wordsize = BITS_IN_LONG;

  /* "example.pyx":88
 *     # increase prec_in_bits to the nearest multiple of wordsize
 *     cdef int padded_bits
 *     padded_bits = (prec_in_bits + wordsize - 1) & ~(wordsize - 1)             # <<<<<<<<<<<<<<
 *     return int(padded_bits/wordsize + 2)
 * 
 */
  __pyx_v_padded_bits = (((__pyx_v_prec_in_bits + __pyx_v_wordsize) - 1) & (~(__pyx_v_wordsize - 1)));

  /* "example.pyx":89
 *     cdef int padded_bits
 *     padded_bits = (prec_in_bits + wordsize - 1) & ~(wordsize - 1)
 *     return int(padded_bits/wordsize + 2)             # <<<<<<<<<<<<<<
 * 
 * pbw = prec_bits_to_words
 */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(__pyx_v_wordsize == 0)) {
    PyErr_Format(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  else if (sizeof(int) == sizeof(long) && unlikely(__pyx_v_wordsize == -1) && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_padded_bits))) {
    PyErr_Format(PyExc_OverflowError, "value too large to perform division");
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_t_2 = PyInt_FromLong((__Pyx_div_int(__pyx_v_padded_bits, __pyx_v_wordsize) + 2)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.prec_bits_to_words", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_7prec_words_to_bits(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_words); /*proto*/
static char __pyx_doc_7example_6prec_words_to_bits[] = "\n    Convert from pari real precision expressed in words to precision\n    expressed in bits. Note: this adjusts for the two codewords of a\n    pari real, and is architecture-dependent.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_words_to_bits(10)\n        256   # 32-bit\n        512   # 64-bit\n        sage: [(n,gen.prec_words_to_bits(n)) for n in range(3,10)]\n        [(3, 32), (4, 64), (5, 96), (6, 128), (7, 160), (8, 192), (9, 224)]  # 32-bit\n        [(3, 64), (4, 128), (5, 192), (6, 256), (7, 320), (8, 384), (9, 448)] # 64-bit\n    ";
static PyMethodDef __pyx_mdef_7example_7prec_words_to_bits = {__Pyx_NAMESTR("prec_words_to_bits"), (PyCFunction)__pyx_pw_7example_7prec_words_to_bits, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_6prec_words_to_bits)};
static PyObject *__pyx_pw_7example_7prec_words_to_bits(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_words) {
  int __pyx_v_prec_in_words;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_words_to_bits (wrapper)", 0);
  assert(__pyx_arg_prec_in_words); {
    __pyx_v_prec_in_words = __Pyx_PyInt_AsInt(__pyx_arg_prec_in_words); if (unlikely((__pyx_v_prec_in_words == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_words_to_bits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_6prec_words_to_bits(__pyx_self, ((int)__pyx_v_prec_in_words));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":93
 * pbw = prec_bits_to_words
 * 
 * def prec_words_to_bits(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from pari real precision expressed in words to precision
 */

static PyObject *__pyx_pf_7example_6prec_words_to_bits(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_words) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_words_to_bits", 0);

  /* "example.pyx":110
 *     """
 *     # see user's guide to the pari library, page 10
 *     return int((prec_in_words - 2) * BITS_IN_LONG)             # <<<<<<<<<<<<<<
 * 
 * def prec_dec_to_words(int prec_in_dec):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((__pyx_v_prec_in_words - 2) * BITS_IN_LONG)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.prec_words_to_bits", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_9prec_dec_to_words(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_dec); /*proto*/
static char __pyx_doc_7example_8prec_dec_to_words[] = "\n    Convert from precision expressed in decimal to precision expressed\n    in words. Note: this rounds up to the nearest word, adjusts for the\n    two codewords of a pari real, and is architecture-dependent.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_dec_to_words(38)\n        6   # 32-bit\n        4   # 64-bit\n        sage: [(n,gen.prec_dec_to_words(n)) for n in range(10,90,10)]\n        [(10, 4), (20, 5), (30, 6), (40, 7), (50, 8), (60, 9), (70, 10), (80, 11)] # 32-bit\n        [(10, 3), (20, 4), (30, 4), (40, 5), (50, 5), (60, 6), (70, 6), (80, 7)] # 64-bit\n    ";
static PyMethodDef __pyx_mdef_7example_9prec_dec_to_words = {__Pyx_NAMESTR("prec_dec_to_words"), (PyCFunction)__pyx_pw_7example_9prec_dec_to_words, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_8prec_dec_to_words)};
static PyObject *__pyx_pw_7example_9prec_dec_to_words(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_dec) {
  int __pyx_v_prec_in_dec;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_dec_to_words (wrapper)", 0);
  assert(__pyx_arg_prec_in_dec); {
    __pyx_v_prec_in_dec = __Pyx_PyInt_AsInt(__pyx_arg_prec_in_dec); if (unlikely((__pyx_v_prec_in_dec == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_dec_to_words", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_8prec_dec_to_words(__pyx_self, ((int)__pyx_v_prec_in_dec));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":112
 *     return int((prec_in_words - 2) * BITS_IN_LONG)
 * 
 * def prec_dec_to_words(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */

static PyObject *__pyx_pf_7example_8prec_dec_to_words(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_dec) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_dec_to_words", 0);

  /* "example.pyx":128
 *         [(10, 3), (20, 4), (30, 4), (40, 5), (50, 5), (60, 6), (70, 6), (80, 7)] # 64-bit
 *     """
 *     return prec_bits_to_words(prec_dec_to_bits(prec_in_dec))             # <<<<<<<<<<<<<<
 * 
 * def prec_words_to_dec(int prec_in_words):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_words); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_dec_to_bits); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyInt_FromLong(__pyx_v_prec_in_dec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.prec_dec_to_words", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_11prec_words_to_dec(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_words); /*proto*/
static char __pyx_doc_7example_10prec_words_to_dec[] = "\n    Convert from precision expressed in words to precision expressed in\n    decimal. Note: this adjusts for the two codewords of a pari real,\n    and is architecture-dependent.\n\n    EXAMPLES::\n\n        sage: import sage.libs.pari.gen as gen\n        sage: gen.prec_words_to_dec(5)\n        28   # 32-bit\n        57   # 64-bit\n        sage: [(n,gen.prec_words_to_dec(n)) for n in range(3,10)]\n        [(3, 9), (4, 19), (5, 28), (6, 38), (7, 48), (8, 57), (9, 67)] # 32-bit\n        [(3, 19), (4, 38), (5, 57), (6, 77), (7, 96), (8, 115), (9, 134)] # 64-bit\n    ";
static PyMethodDef __pyx_mdef_7example_11prec_words_to_dec = {__Pyx_NAMESTR("prec_words_to_dec"), (PyCFunction)__pyx_pw_7example_11prec_words_to_dec, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_10prec_words_to_dec)};
static PyObject *__pyx_pw_7example_11prec_words_to_dec(PyObject *__pyx_self, PyObject *__pyx_arg_prec_in_words) {
  int __pyx_v_prec_in_words;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("prec_words_to_dec (wrapper)", 0);
  assert(__pyx_arg_prec_in_words); {
    __pyx_v_prec_in_words = __Pyx_PyInt_AsInt(__pyx_arg_prec_in_words); if (unlikely((__pyx_v_prec_in_words == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.prec_words_to_dec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_10prec_words_to_dec(__pyx_self, ((int)__pyx_v_prec_in_words));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":130
 *     return prec_bits_to_words(prec_dec_to_bits(prec_in_dec))
 * 
 * def prec_words_to_dec(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in words to precision expressed in
 */

static PyObject *__pyx_pf_7example_10prec_words_to_dec(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_prec_in_words) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("prec_words_to_dec", 0);

  /* "example.pyx":146
 *         [(3, 19), (4, 38), (5, 57), (6, 77), (7, 96), (8, 115), (9, 134)] # 64-bit
 *     """
 *     return prec_bits_to_dec(prec_words_to_bits(prec_in_words))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_dec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_words_to_bits); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyInt_FromLong(__pyx_v_prec_in_words); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.prec_words_to_dec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":172
 * t0heap = [0]*5
 * 
 * cdef t0GEN(x):             # <<<<<<<<<<<<<<
 *     global t0
 *     t0 = P.toGEN(x, 0)
 */

static PyObject *__pyx_f_7example_t0GEN(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("t0GEN", 0);

  /* "example.pyx":174
 * cdef t0GEN(x):
 *     global t0
 *     t0 = P.toGEN(x, 0)             # <<<<<<<<<<<<<<
 * 
 * cdef t1GEN(x):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->toGEN(__pyx_v_7example_P, __pyx_v_x, 0); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_7example_t0 = __pyx_t_1;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.t0GEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":176
 *     t0 = P.toGEN(x, 0)
 * 
 * cdef t1GEN(x):             # <<<<<<<<<<<<<<
 *     global t1
 *     t1 = P.toGEN(x, 1)
 */

static PyObject *__pyx_f_7example_t1GEN(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("t1GEN", 0);

  /* "example.pyx":178
 * cdef t1GEN(x):
 *     global t1
 *     t1 = P.toGEN(x, 1)             # <<<<<<<<<<<<<<
 * 
 * cdef t2GEN(x):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->toGEN(__pyx_v_7example_P, __pyx_v_x, 1); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_7example_t1 = __pyx_t_1;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.t1GEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":180
 *     t1 = P.toGEN(x, 1)
 * 
 * cdef t2GEN(x):             # <<<<<<<<<<<<<<
 *     global t2
 *     t2 = P.toGEN(x, 2)
 */

static PyObject *__pyx_f_7example_t2GEN(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("t2GEN", 0);

  /* "example.pyx":182
 * cdef t2GEN(x):
 *     global t2
 *     t2 = P.toGEN(x, 2)             # <<<<<<<<<<<<<<
 * 
 * cdef t3GEN(x):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->toGEN(__pyx_v_7example_P, __pyx_v_x, 2); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_7example_t2 = __pyx_t_1;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.t2GEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":184
 *     t2 = P.toGEN(x, 2)
 * 
 * cdef t3GEN(x):             # <<<<<<<<<<<<<<
 *     global t3
 *     t3 = P.toGEN(x, 3)
 */

static PyObject *__pyx_f_7example_t3GEN(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("t3GEN", 0);

  /* "example.pyx":186
 * cdef t3GEN(x):
 *     global t3
 *     t3 = P.toGEN(x, 3)             # <<<<<<<<<<<<<<
 * 
 * cdef t4GEN(x):
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->toGEN(__pyx_v_7example_P, __pyx_v_x, 3); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_7example_t3 = __pyx_t_1;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.t3GEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":188
 *     t3 = P.toGEN(x, 3)
 * 
 * cdef t4GEN(x):             # <<<<<<<<<<<<<<
 *     global t4
 *     t4 = P.toGEN(x, 4)
 */

static PyObject *__pyx_f_7example_t4GEN(PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("t4GEN", 0);

  /* "example.pyx":190
 * cdef t4GEN(x):
 *     global t4
 *     t4 = P.toGEN(x, 4)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->toGEN(__pyx_v_7example_P, __pyx_v_x, 4); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_7example_t4 = __pyx_t_1;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.t4GEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_7example_3gen_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_7example_3gen_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_7example_3gen___init__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":197
 *     Python extension class that models the PARI GEN type.
 *     """
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         self.b = 0
 *         #self._parent = P
 */

static int __pyx_pf_7example_3gen___init__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__", 0);

  /* "example.pyx":198
 *     """
 *     def __init__(self):
 *         self.b = 0             # <<<<<<<<<<<<<<
 *         #self._parent = P
 *         global NumberOfGEN
 */
  __pyx_v_self->b = 0;

  /* "example.pyx":201
 *         #self._parent = P
 *         global NumberOfGEN
 *         NumberOfGEN=NumberOfGEN+1             # <<<<<<<<<<<<<<
 *         self._refers_to = {}
 * 
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__NumberOfGEN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NumberOfGEN, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":202
 *         global NumberOfGEN
 *         NumberOfGEN=NumberOfGEN+1
 *         self._refers_to = {}             # <<<<<<<<<<<<<<
 * 
 *     def parent(self):
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
  __Pyx_GOTREF(__pyx_v_self->_refers_to);
  __Pyx_DECREF(__pyx_v_self->_refers_to);
  __pyx_v_self->_refers_to = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_3parent(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7example_3gen_3parent(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("parent (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_2parent(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":204
 *         self._refers_to = {}
 * 
 *     def parent(self):             # <<<<<<<<<<<<<<
 *         return pari_instance
 * 
 */

static PyObject *__pyx_pf_7example_3gen_2parent(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("parent", 0);

  /* "example.pyx":205
 * 
 *     def parent(self):
 *         return pari_instance             # <<<<<<<<<<<<<<
 * 
 *     cdef void init(self, GEN g, pari_sp b):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_7example_pari_instance));
  __pyx_r = ((PyObject *)__pyx_v_7example_pari_instance);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":207
 *         return pari_instance
 * 
 *     cdef void init(self, GEN g, pari_sp b):             # <<<<<<<<<<<<<<
 *         """
 *         g - PARI GEN b - pointer to memory chunk where PARI gen lives (if
 */

static void __pyx_f_7example_3gen_init(struct __pyx_obj_7example_gen *__pyx_v_self, GEN __pyx_v_g, pari_sp __pyx_v_b) {
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("init", 0);

  /* "example.pyx":214
 *         """
 *         global NumberOfGEN
 *         NumberOfGEN=NumberOfGEN+1             # <<<<<<<<<<<<<<
 *         self.g = g
 *         self.b = b
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__NumberOfGEN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NumberOfGEN, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":215
 *         global NumberOfGEN
 *         NumberOfGEN=NumberOfGEN+1
 *         self.g = g             # <<<<<<<<<<<<<<
 *         self.b = b
 *         #self._parent = P
 */
  __pyx_v_self->g = __pyx_v_g;

  /* "example.pyx":216
 *         NumberOfGEN=NumberOfGEN+1
 *         self.g = g
 *         self.b = b             # <<<<<<<<<<<<<<
 *         #self._parent = P
 *         self._refers_to = {}
 */
  __pyx_v_self->b = __pyx_v_b;

  /* "example.pyx":218
 *         self.b = b
 *         #self._parent = P
 *         self._refers_to = {}             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
  __Pyx_GOTREF(__pyx_v_self->_refers_to);
  __Pyx_DECREF(__pyx_v_self->_refers_to);
  __pyx_v_self->_refers_to = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_WriteUnraisable("example.gen.init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
}

/* Python wrapper */
static void __pyx_pw_7example_3gen_5__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_7example_3gen_5__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
  __pyx_pf_7example_3gen_4__dealloc__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
}

/* "example.pyx":220
 *         self._refers_to = {}
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         if self.b:
 *             global NumberOfGEN
 */

static void __pyx_pf_7example_3gen_4__dealloc__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__dealloc__", 0);

  /* "example.pyx":221
 * 
 *     def __dealloc__(self):
 *         if self.b:             # <<<<<<<<<<<<<<
 *             global NumberOfGEN
 *             NumberOfGEN=NumberOfGEN-1;
 */
  if (__pyx_v_self->b) {

    /* "example.pyx":223
 *         if self.b:
 *             global NumberOfGEN
 *             NumberOfGEN=NumberOfGEN-1;             # <<<<<<<<<<<<<<
 *             memfree(<void*> self.b)
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__NumberOfGEN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NumberOfGEN, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":224
 *             global NumberOfGEN
 *             NumberOfGEN=NumberOfGEN-1;
 *             memfree(<void*> self.b)             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
    memfree(((void *)__pyx_v_self->b));
    goto __pyx_L3;
  }
  __pyx_L3:;

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_7__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_7example_3gen_7__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_6__repr__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":226
 *             memfree(<void*> self.b)
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen_to_string(self.g)
 */

static PyObject *__pyx_pf_7example_3gen_6__repr__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__repr__", 0);

  /* "example.pyx":227
 * 
 *     def __repr__(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen_to_string(self.g)
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":228
 *     def __repr__(self):
 *         sig_on()
 *         return P.new_gen_to_string(self.g)             # <<<<<<<<<<<<<<
 * 
 *     def __hash__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_to_string(__pyx_v_7example_P, __pyx_v_self->g); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static Py_hash_t __pyx_pw_7example_3gen_9__hash__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_7example_3gen_8__hash__[] = "\n        Return the hash of self, computed using PARI's hash_GEN().\n\n        TESTS::\n\n            sage: type(pari('1 + 2.0*I').__hash__())\n            <type 'int'>\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_8__hash__;
#endif
static Py_hash_t __pyx_pw_7example_3gen_9__hash__(PyObject *__pyx_v_self) {
  Py_hash_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__hash__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_8__hash__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":230
 *         return P.new_gen_to_string(self.g)
 * 
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hash of self, computed using PARI's hash_GEN().
 */

static Py_hash_t __pyx_pf_7example_3gen_8__hash__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_h;
  Py_hash_t __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__hash__", 0);

  /* "example.pyx":240
 *         """
 *         cdef long h
 *         sig_on()             # <<<<<<<<<<<<<<
 *         h = hash_GEN(self.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":241
 *         cdef long h
 *         sig_on()
 *         h = hash_GEN(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return h
 */
  __pyx_v_h = hash_GEN(__pyx_v_self->g);

  /* "example.pyx":242
 *         sig_on()
 *         h = hash_GEN(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return h
 * 
 */
  _pari_sig_off();

  /* "example.pyx":243
 *         h = hash_GEN(self.g)
 *         sig_off()
 *         return h             # <<<<<<<<<<<<<<
 * 
 *     def _testclass(self):
 */
  __pyx_r = __pyx_v_h;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("example.gen.__hash__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  if (unlikely(__pyx_r == -1) && !PyErr_Occurred()) __pyx_r = -2;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_11_testclass(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7example_3gen_11_testclass(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_testclass (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_10_testclass(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":245
 *         return h
 * 
 *     def _testclass(self):             # <<<<<<<<<<<<<<
 *         import test
 *         T = test.testclass()
 */

static PyObject *__pyx_pf_7example_3gen_10_testclass(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_v_test = NULL;
  PyObject *__pyx_v_T = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_testclass", 0);

  /* "example.pyx":246
 * 
 *     def _testclass(self):
 *         import test             # <<<<<<<<<<<<<<
 *         T = test.testclass()
 *         T._init(self)
 */
  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__test), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_test = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "example.pyx":247
 *     def _testclass(self):
 *         import test
 *         T = test.testclass()             # <<<<<<<<<<<<<<
 *         T._init(self)
 *         return T
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_test, __pyx_n_s__testclass); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_T = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":248
 *         import test
 *         T = test.testclass()
 *         T._init(self)             # <<<<<<<<<<<<<<
 *         return T
 * 
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_T, __pyx_n_s___init); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "example.pyx":249
 *         T = test.testclass()
 *         T._init(self)
 *         return T             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN _gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_T);
  __pyx_r = __pyx_v_T;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen._testclass", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_test);
  __Pyx_XDECREF(__pyx_v_T);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":251
 *         return T
 * 
 *     cdef GEN _gen(self):             # <<<<<<<<<<<<<<
 *         return self.g
 * 
 */

static GEN __pyx_f_7example_3gen__gen(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_gen", 0);

  /* "example.pyx":252
 * 
 *     cdef GEN _gen(self):
 *         return self.g             # <<<<<<<<<<<<<<
 * 
 *     def list(self):
 */
  __pyx_r = __pyx_v_self->g;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_13list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_12list[] = "\n        Convert self to a list of PARI gens.\n\n        EXAMPLES:\n\n        A PARI vector becomes a Sage list::\n\n            sage: L = pari(\"vector(10,i,i^2)\").list()\n            sage: L\n            [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n            sage: type(L)\n            <type 'list'>\n            sage: type(L[0])\n            <type 'sage.libs.pari.gen.gen'>\n\n        For polynomials, list() behaves as for ordinary Sage polynomials::\n\n            sage: pol = pari(\"x^3 + 5/3*x\"); pol.list()\n            [0, 5/3, 0, 1]\n\n        For power series or laurent series, we get all coefficients starting\n        from the lowest degree term.  This includes trailing zeros::\n\n            sage: R.<x> = LaurentSeriesRing(QQ)\n            sage: s = x^2 + O(x^8)\n            sage: s.list()\n            [1]\n            sage: pari(s).list()\n            [1, 0, 0, 0, 0, 0]\n            sage: s = x^-2 + O(x^0)\n            sage: s.list()\n            [1]\n            sage: pari(s).list()\n            [1, 0]\n\n        For matrices, we get a list of columns::\n\n            sage: M = matrix(ZZ,3,2,[1,4,2,5,3,6]); M\n            [1 4]\n            [2 5]\n            [3 6]\n            sage: pari(M).list()\n            [[1, 2, 3]~, [4, 5, 6]~]\n\n        For \"scalar\" types, we get a 1-element list containing ``self``::\n\n            sage: pari(\"42\").list()\n            [42]\n        ";
static PyObject *__pyx_pw_7example_3gen_13list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("list (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_12list(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":254
 *         return self.g
 * 
 *     def list(self):             # <<<<<<<<<<<<<<
 *         """
 *         Convert self to a list of PARI gens.
 */

static PyObject *__pyx_pf_7example_3gen_12list(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("list", 0);

  /* "example.pyx":304
 *             [42]
 *         """
 *         if typ(self.g) == t_POL:             # <<<<<<<<<<<<<<
 *             return list(self.Vecrev())
 *         return list(self.Vec())
 */
  __pyx_t_1 = (typ(__pyx_v_self->g) == t_POL);
  if (__pyx_t_1) {

    /* "example.pyx":305
 *         """
 *         if typ(self.g) == t_POL:
 *             return list(self.Vecrev())             # <<<<<<<<<<<<<<
 *         return list(self.Vec())
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__Vecrev); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":306
 *         if typ(self.g) == t_POL:
 *             return list(self.Vecrev())
 *         return list(self.Vec())             # <<<<<<<<<<<<<<
 * 
 *     def __reduce__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__Vec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_15__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_14__reduce__[] = "\n        EXAMPLES::\n\n            sage: f = pari('x^3 - 3')\n            sage: loads(dumps(f)) == f\n            True\n        ";
static PyObject *__pyx_pw_7example_3gen_15__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_14__reduce__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":308
 *         return list(self.Vec())
 * 
 *     def __reduce__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

static PyObject *__pyx_pf_7example_3gen_14__reduce__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_sage = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__reduce__", 0);

  /* "example.pyx":316
 *             True
 *         """
 *         s = str(self)             # <<<<<<<<<<<<<<
 *         import sage.libs.pari.gen_py
 *         return sage.libs.pari.gen_py.pari, (s,)
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":317
 *         """
 *         s = str(self)
 *         import sage.libs.pari.gen_py             # <<<<<<<<<<<<<<
 *         return sage.libs.pari.gen_py.pari, (s,)
 * 
 */
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s_1), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_sage = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":318
 *         s = str(self)
 *         import sage.libs.pari.gen_py
 *         return sage.libs.pari.gen_py.pari, (s,)             # <<<<<<<<<<<<<<
 * 
 *     def __add__(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_sage, __pyx_n_s__libs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__pari); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__gen_py); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__pari); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_s);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_s);
  __Pyx_GIVEREF(__pyx_v_s);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_t_2));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_r = ((PyObject *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XDECREF(__pyx_v_sage);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_17__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_7example_3gen_17__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__add__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_16__add__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_right));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":320
 *         return sage.libs.pari.gen_py.pari, (s,)
 * 
 *     def __add__(self,  right):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 */

static PyObject *__pyx_pf_7example_3gen_16__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__add__", 0);

  /* "example.pyx":321
 * 
 *     def __add__(self,  right):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gadd(t0, t1))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":322
 *     def __add__(self,  right):
 *         sig_on()
 *         t0GEN(self);t1GEN(right);             # <<<<<<<<<<<<<<
 *         return P.new_gen(gadd(t0, t1))
 * 
 */
  __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_self); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_7example_t1GEN(__pyx_v_right); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":323
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gadd(t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def _add_unsafe(gen self, gen right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gadd(__pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__add__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_19_add_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static char __pyx_doc_7example_3gen_18_add_unsafe[] = "\n        VERY FAST addition of self and right on stack (and leave on stack)\n        without any type checking.\n\n        Basically, this is often about 10 times faster than just typing\n        \"self + right\". The drawback is that (1) if self + right would give\n        an error in PARI, it will totally crash Sage, and (2) the memory\n        used by self + right is *never* returned - it gets allocated on\n        the PARI stack and will never be freed.\n\n        EXAMPLES::\n\n            sage: pari(2)._add_unsafe(pari(3))\n            5\n        ";
static PyObject *__pyx_pw_7example_3gen_19_add_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_add_unsafe (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_right), __pyx_ptype_7example_gen, 1, "right", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_18_add_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((struct __pyx_obj_7example_gen *)__pyx_v_right));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":325
 *         return P.new_gen(gadd(t0, t1))
 * 
 *     def _add_unsafe(gen self, gen right):             # <<<<<<<<<<<<<<
 *         """
 *         VERY FAST addition of self and right on stack (and leave on stack)
 */

static PyObject *__pyx_pf_7example_3gen_18_add_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right) {
  GEN __pyx_v_z;
  struct __pyx_obj_7example_gen *__pyx_v_w = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_add_unsafe", 0);

  /* "example.pyx":344
 *         cdef GEN z
 *         cdef gen w
 *         z = gadd(self.g, right.g)             # <<<<<<<<<<<<<<
 *         w = PY_NEW(gen)
 *         w.init(z,0)
 */
  __pyx_v_z = gadd(__pyx_v_self->g, __pyx_v_right->g);

  /* "example.pyx":345
 *         cdef gen w
 *         z = gadd(self.g, right.g)
 *         w = PY_NEW(gen)             # <<<<<<<<<<<<<<
 *         w.init(z,0)
 *         mytop = avma
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_w = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":346
 *         z = gadd(self.g, right.g)
 *         w = PY_NEW(gen)
 *         w.init(z,0)             # <<<<<<<<<<<<<<
 *         mytop = avma
 *         return w
 */
  ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_w->__pyx_vtab)->init(__pyx_v_w, __pyx_v_z, 0);

  /* "example.pyx":347
 *         w = PY_NEW(gen)
 *         w.init(z,0)
 *         mytop = avma             # <<<<<<<<<<<<<<
 *         return w
 * 
 */
  __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":348
 *         w.init(z,0)
 *         mytop = avma
 *         return w             # <<<<<<<<<<<<<<
 * 
 *     def  __sub__(self, right):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_w));
  __pyx_r = ((PyObject *)__pyx_v_w);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen._add_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_w);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_21__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_7example_3gen_21__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__sub__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_20__sub__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_right));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":350
 *         return w
 * 
 *     def  __sub__(self, right):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 */

static PyObject *__pyx_pf_7example_3gen_20__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__sub__", 0);

  /* "example.pyx":351
 * 
 *     def  __sub__(self, right):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gsub(t0, t1))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":352
 *     def  __sub__(self, right):
 *         sig_on()
 *         t0GEN(self);t1GEN(right);             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsub(t0, t1))
 * 
 */
  __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_self); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_7example_t1GEN(__pyx_v_right); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 352; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":353
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gsub(t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def _sub_unsafe(gen self, gen right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsub(__pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__sub__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_23_sub_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static char __pyx_doc_7example_3gen_22_sub_unsafe[] = "\n        VERY FAST subtraction of self and right on stack (and leave on\n        stack) without any type checking.\n\n        Basically, this is often about 10 times faster than just typing\n        \"self - right\". The drawback is that (1) if self - right would give\n        an error in PARI, it will totally crash Sage, and (2) the memory\n        used by self - right is *never* returned - it gets allocated on\n        the PARI stack and will never be freed.\n\n        EXAMPLES::\n\n            sage: pari(2)._sub_unsafe(pari(3))\n            -1\n        ";
static PyObject *__pyx_pw_7example_3gen_23_sub_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_sub_unsafe (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_right), __pyx_ptype_7example_gen, 1, "right", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_22_sub_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((struct __pyx_obj_7example_gen *)__pyx_v_right));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":355
 *         return P.new_gen(gsub(t0, t1))
 * 
 *     def _sub_unsafe(gen self, gen right):             # <<<<<<<<<<<<<<
 *         """
 *         VERY FAST subtraction of self and right on stack (and leave on
 */

static PyObject *__pyx_pf_7example_3gen_22_sub_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right) {
  GEN __pyx_v_z;
  struct __pyx_obj_7example_gen *__pyx_v_w = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_sub_unsafe", 0);

  /* "example.pyx":374
 *         cdef GEN z
 *         cdef gen w
 *         z = gsub(self.g, right.g)             # <<<<<<<<<<<<<<
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 */
  __pyx_v_z = gsub(__pyx_v_self->g, __pyx_v_right->g);

  /* "example.pyx":375
 *         cdef gen w
 *         z = gsub(self.g, right.g)
 *         w = PY_NEW(gen)             # <<<<<<<<<<<<<<
 *         w.init(z, 0)
 *         mytop = avma
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_w = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":376
 *         z = gsub(self.g, right.g)
 *         w = PY_NEW(gen)
 *         w.init(z, 0)             # <<<<<<<<<<<<<<
 *         mytop = avma
 *         return w
 */
  ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_w->__pyx_vtab)->init(__pyx_v_w, __pyx_v_z, 0);

  /* "example.pyx":377
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 *         mytop = avma             # <<<<<<<<<<<<<<
 *         return w
 * 
 */
  __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":378
 *         w.init(z, 0)
 *         mytop = avma
 *         return w             # <<<<<<<<<<<<<<
 * 
 *     def  __mul__(self, right):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_w));
  __pyx_r = ((PyObject *)__pyx_v_w);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen._sub_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_w);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_25__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_7example_3gen_25__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__mul__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_24__mul__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_right));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":380
 *         return w
 * 
 *     def  __mul__(self, right):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 */

static PyObject *__pyx_pf_7example_3gen_24__mul__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__mul__", 0);

  /* "example.pyx":381
 * 
 *     def  __mul__(self, right):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gmul(t0, t1))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":382
 *     def  __mul__(self, right):
 *         sig_on()
 *         t0GEN(self);t1GEN(right);             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmul(t0, t1))
 * 
 */
  __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_self); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_7example_t1GEN(__pyx_v_right); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":383
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gmul(t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def _mul_unsafe(gen self, gen right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmul(__pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__mul__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_27_mul_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static char __pyx_doc_7example_3gen_26_mul_unsafe[] = "\n        VERY FAST multiplication of self and right on stack (and leave on\n        stack) without any type checking.\n\n        Basically, this is often about 10 times faster than just typing\n        \"self \\* right\". The drawback is that (1) if self \\* right would\n        give an error in PARI, it will totally crash Sage, and (2) the\n        memory used by self \\* right is *never* returned - it gets\n        allocated on the PARI stack and will never be freed.\n\n        EXAMPLES::\n\n            sage: pari(2)._mul_unsafe(pari(3))\n            6\n        ";
static PyObject *__pyx_pw_7example_3gen_27_mul_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_mul_unsafe (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_right), __pyx_ptype_7example_gen, 1, "right", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_26_mul_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((struct __pyx_obj_7example_gen *)__pyx_v_right));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":385
 *         return P.new_gen(gmul(t0, t1))
 * 
 *     def _mul_unsafe(gen self, gen right):             # <<<<<<<<<<<<<<
 *         """
 *         VERY FAST multiplication of self and right on stack (and leave on
 */

static PyObject *__pyx_pf_7example_3gen_26_mul_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right) {
  GEN __pyx_v_z;
  struct __pyx_obj_7example_gen *__pyx_v_w = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_mul_unsafe", 0);

  /* "example.pyx":404
 *         cdef GEN z
 *         cdef gen w
 *         z = gmul(self.g, right.g)             # <<<<<<<<<<<<<<
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 */
  __pyx_v_z = gmul(__pyx_v_self->g, __pyx_v_right->g);

  /* "example.pyx":405
 *         cdef gen w
 *         z = gmul(self.g, right.g)
 *         w = PY_NEW(gen)             # <<<<<<<<<<<<<<
 *         w.init(z, 0)
 *         mytop = avma
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_w = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":406
 *         z = gmul(self.g, right.g)
 *         w = PY_NEW(gen)
 *         w.init(z, 0)             # <<<<<<<<<<<<<<
 *         mytop = avma
 *         return w
 */
  ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_w->__pyx_vtab)->init(__pyx_v_w, __pyx_v_z, 0);

  /* "example.pyx":407
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 *         mytop = avma             # <<<<<<<<<<<<<<
 *         return w
 * 
 */
  __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":408
 *         w.init(z, 0)
 *         mytop = avma
 *         return w             # <<<<<<<<<<<<<<
 * 
 *     def  __div__(self,  right):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_w));
  __pyx_r = ((PyObject *)__pyx_v_w);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen._mul_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_w);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_7example_3gen_29__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static PyObject *__pyx_pw_7example_3gen_29__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__div__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_28__div__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_right));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "example.pyx":410
 *         return w
 * 
 *     def  __div__(self,  right):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 */

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_28__div__(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__div__", 0);

  /* "example.pyx":411
 * 
 *     def  __div__(self,  right):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gdiv(t0,t1))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":412
 *     def  __div__(self,  right):
 *         sig_on()
 *         t0GEN(self);t1GEN(right);             # <<<<<<<<<<<<<<
 *         return P.new_gen(gdiv(t0,t1))
 * 
 */
  __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_self); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_f_7example_t1GEN(__pyx_v_right); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "example.pyx":413
 *         sig_on()
 *         t0GEN(self);t1GEN(right);
 *         return P.new_gen(gdiv(t0,t1))             # <<<<<<<<<<<<<<
 * 
 *     def _div_unsafe(gen self, gen right):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gdiv(__pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__div__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_31_div_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right); /*proto*/
static char __pyx_doc_7example_3gen_30_div_unsafe[] = "\n        VERY FAST division of self and right on stack (and leave on stack)\n        without any type checking.\n\n        Basically, this is often about 10 times faster than just typing\n        \"self / right\". The drawback is that (1) if self / right would give\n        an error in PARI, it will totally crash Sage, and (2) the memory\n        used by self / right is *never* returned - it gets allocated on\n        the PARI stack and will never be freed.\n\n        EXAMPLES::\n\n            sage: pari(2)._div_unsafe(pari(3))\n            2/3\n        ";
static PyObject *__pyx_pw_7example_3gen_31_div_unsafe(PyObject *__pyx_v_self, PyObject *__pyx_v_right) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_div_unsafe (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_right), __pyx_ptype_7example_gen, 1, "right", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_30_div_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((struct __pyx_obj_7example_gen *)__pyx_v_right));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":415
 *         return P.new_gen(gdiv(t0,t1))
 * 
 *     def _div_unsafe(gen self, gen right):             # <<<<<<<<<<<<<<
 *         """
 *         VERY FAST division of self and right on stack (and leave on stack)
 */

static PyObject *__pyx_pf_7example_3gen_30_div_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_right) {
  GEN __pyx_v_z;
  struct __pyx_obj_7example_gen *__pyx_v_w = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_div_unsafe", 0);

  /* "example.pyx":434
 *         cdef GEN z
 *         cdef gen w
 *         z = gdiv(self.g, right.g)             # <<<<<<<<<<<<<<
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 */
  __pyx_v_z = gdiv(__pyx_v_self->g, __pyx_v_right->g);

  /* "example.pyx":435
 *         cdef gen w
 *         z = gdiv(self.g, right.g)
 *         w = PY_NEW(gen)             # <<<<<<<<<<<<<<
 *         w.init(z, 0)
 *         mytop = avma
 */
  __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_w = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":436
 *         z = gdiv(self.g, right.g)
 *         w = PY_NEW(gen)
 *         w.init(z, 0)             # <<<<<<<<<<<<<<
 *         mytop = avma
 *         return w
 */
  ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_w->__pyx_vtab)->init(__pyx_v_w, __pyx_v_z, 0);

  /* "example.pyx":437
 *         w = PY_NEW(gen)
 *         w.init(z, 0)
 *         mytop = avma             # <<<<<<<<<<<<<<
 *         return w
 * 
 */
  __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":438
 *         w.init(z, 0)
 *         mytop = avma
 *         return w             # <<<<<<<<<<<<<<
 * 
 *     #################################################################
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_w));
  __pyx_r = ((PyObject *)__pyx_v_w);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen._div_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_w);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_33_add_one(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_32_add_one[] = "\n        Return self + 1.\n\n        OUTPUT: pari gen\n\n        EXAMPLES::\n\n            sage: n = pari(5)\n            sage: n._add_one()\n            6\n            sage: n = pari('x^3')\n            sage: n._add_one()\n            x^3 + 1\n        ";
static PyObject *__pyx_pw_7example_3gen_33_add_one(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_add_one (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_32_add_one(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":442
 *     #################################################################
 * 
 *     def _add_one(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return self + 1.
 */

static PyObject *__pyx_pf_7example_3gen_32_add_one(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_add_one", 0);

  /* "example.pyx":457
 *             x^3 + 1
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gaddsg(1, self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":458
 *         """
 *         sig_on()
 *         return P.new_gen(gaddsg(1, self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __mod__(self, other):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gaddsg(1, __pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen._add_one", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_35__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_7example_3gen_35__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__mod__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_34__mod__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":460
 *         return P.new_gen(gaddsg(1, self.g))
 * 
 *     def __mod__(self, other):             # <<<<<<<<<<<<<<
 *         cdef gen selfgen
 *         cdef gen othergen
 */

static PyObject *__pyx_pf_7example_3gen_34__mod__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_obj_7example_gen *__pyx_v_selfgen = 0;
  struct __pyx_obj_7example_gen *__pyx_v_othergen = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__mod__", 0);

  /* "example.pyx":463
 *         cdef gen selfgen
 *         cdef gen othergen
 *         if isinstance(other, gen) and isinstance(self, gen):             # <<<<<<<<<<<<<<
 *             selfgen = self
 *             othergen = other
 */
  __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, ((PyObject*)__pyx_ptype_7example_gen)); 
  if (__pyx_t_1) {
    __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_self, ((PyObject*)__pyx_ptype_7example_gen)); 
    __pyx_t_3 = __pyx_t_2;
  } else {
    __pyx_t_3 = __pyx_t_1;
  }
  if (__pyx_t_3) {

    /* "example.pyx":464
 *         cdef gen othergen
 *         if isinstance(other, gen) and isinstance(self, gen):
 *             selfgen = self             # <<<<<<<<<<<<<<
 *             othergen = other
 *             sig_on()
 */
    if (!(likely(((__pyx_v_self) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_self, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_INCREF(__pyx_v_self);
    __pyx_v_selfgen = ((struct __pyx_obj_7example_gen *)__pyx_v_self);

    /* "example.pyx":465
 *         if isinstance(other, gen) and isinstance(self, gen):
 *             selfgen = self
 *             othergen = other             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return P.new_gen(gmod(selfgen.g, othergen.g))
 */
    if (!(likely(((__pyx_v_other) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_other, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_INCREF(__pyx_v_other);
    __pyx_v_othergen = ((struct __pyx_obj_7example_gen *)__pyx_v_other);

    /* "example.pyx":466
 *             selfgen = self
 *             othergen = other
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(gmod(selfgen.g, othergen.g))
 *         return 0
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":467
 *             othergen = other
 *             sig_on()
 *             return P.new_gen(gmod(selfgen.g, othergen.g))             # <<<<<<<<<<<<<<
 *         return 0
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmod(__pyx_v_selfgen->g, __pyx_v_othergen->g))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":468
 *             sig_on()
 *             return P.new_gen(gmod(selfgen.g, othergen.g))
 *         return 0             # <<<<<<<<<<<<<<
 * 
 *     def __pow__(self, n, m):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_int_0);
  __pyx_r = __pyx_int_0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("example.gen.__mod__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_selfgen);
  __Pyx_XDECREF((PyObject *)__pyx_v_othergen);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_37__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m); /*proto*/
static PyObject *__pyx_pw_7example_3gen_37__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_m) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__pow__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_36__pow__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_n), ((PyObject *)__pyx_v_m));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":470
 *         return 0
 * 
 *     def __pow__(self, n, m):             # <<<<<<<<<<<<<<
 *         t0GEN(self)
 *         t1GEN(n)
 */

static PyObject *__pyx_pf_7example_3gen_36__pow__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *__pyx_v_m) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  long __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__pow__", 0);

  /* "example.pyx":471
 * 
 *     def __pow__(self, n, m):
 *         t0GEN(self)             # <<<<<<<<<<<<<<
 *         t1GEN(n)
 *         sig_on()
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_self); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":472
 *     def __pow__(self, n, m):
 *         t0GEN(self)
 *         t1GEN(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # Note: the prec parameter here has no effect when t0,t1 are
 */
  __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":473
 *         t0GEN(self)
 *         t1GEN(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # Note: the prec parameter here has no effect when t0,t1 are
 *         # real; the precision of the result is the minimum of the
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":478
 *         # precisions of t0 and t1.  In any case the 3rd parameter to
 *         # gpow should be a word-precision, not a decimal precision.
 *         return P.new_gen(gpow(t0, t1, prec))             # <<<<<<<<<<<<<<
 * 
 *     def __neg__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gpow(__pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.__pow__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_39__neg__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_7example_3gen_39__neg__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__neg__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_38__neg__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":480
 *         return P.new_gen(gpow(t0, t1, prec))
 * 
 *     def __neg__(gen self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gneg(self.g))
 */

static PyObject *__pyx_pf_7example_3gen_38__neg__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__neg__", 0);

  /* "example.pyx":481
 * 
 *     def __neg__(gen self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gneg(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":482
 *     def __neg__(gen self):
 *         sig_on()
 *         return P.new_gen(gneg(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __xor__(gen self, n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gneg(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__neg__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_41__xor__(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
static PyObject *__pyx_pw_7example_3gen_41__xor__(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__xor__ (wrapper)", 0);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_self), __pyx_ptype_7example_gen, 1, "self", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_40__xor__(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":484
 *         return P.new_gen(gneg(self.g))
 * 
 *     def __xor__(gen self, n):             # <<<<<<<<<<<<<<
 *         raise RuntimeError, "Use ** for exponentiation, not '^', which means xor\n"+\
 *               "in Python, and has the wrong precedence."
 */

static PyObject *__pyx_pf_7example_3gen_40__xor__(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__xor__", 0);

  /* "example.pyx":485
 * 
 *     def __xor__(gen self, n):
 *         raise RuntimeError, "Use ** for exponentiation, not '^', which means xor\n"+\             # <<<<<<<<<<<<<<
 *               "in Python, and has the wrong precedence."
 * 
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__RuntimeError); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyNumber_Add(((PyObject *)__pyx_kp_s_2), ((PyObject *)__pyx_kp_s_3)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_Raise(__pyx_t_1, ((PyObject *)__pyx_t_2), 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__xor__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_43__rshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
static PyObject *__pyx_pw_7example_3gen_43__rshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__rshift__ (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.__rshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_self), __pyx_ptype_7example_gen, 1, "self", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_42__rshift__(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((long)__pyx_v_n));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":488
 *               "in Python, and has the wrong precedence."
 * 
 *     def __rshift__(gen self, long n):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gshift(self.g, -n))
 */

static PyObject *__pyx_pf_7example_3gen_42__rshift__(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__rshift__", 0);

  /* "example.pyx":489
 * 
 *     def __rshift__(gen self, long n):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(self.g, -n))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":490
 *     def __rshift__(gen self, long n):
 *         sig_on()
 *         return P.new_gen(gshift(self.g, -n))             # <<<<<<<<<<<<<<
 * 
 *     def __lshift__(gen self, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gshift(__pyx_v_self->g, (-__pyx_v_n)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__rshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_45__lshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
static PyObject *__pyx_pw_7example_3gen_45__lshift__(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__lshift__ (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.__lshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_self), __pyx_ptype_7example_gen, 1, "self", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_pf_7example_3gen_44__lshift__(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((long)__pyx_v_n));
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":492
 *         return P.new_gen(gshift(self.g, -n))
 * 
 *     def __lshift__(gen self, long n):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gshift(self.g, n))
 */

static PyObject *__pyx_pf_7example_3gen_44__lshift__(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__lshift__", 0);

  /* "example.pyx":493
 * 
 *     def __lshift__(gen self, long n):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(self.g, n))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":494
 *     def __lshift__(gen self, long n):
 *         sig_on()
 *         return P.new_gen(gshift(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def __invert__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gshift(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__lshift__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_47__invert__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_7example_3gen_47__invert__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__invert__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_46__invert__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":496
 *         return P.new_gen(gshift(self.g, n))
 * 
 *     def __invert__(gen self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(ginv(self.g))
 */

static PyObject *__pyx_pf_7example_3gen_46__invert__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__invert__", 0);

  /* "example.pyx":497
 * 
 *     def __invert__(gen self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ginv(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":498
 *     def __invert__(gen self):
 *         sig_on()
 *         return P.new_gen(ginv(self.g))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ginv(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__invert__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_49getattr(PyObject *__pyx_v_self, PyObject *__pyx_v_attr); /*proto*/
static PyObject *__pyx_pw_7example_3gen_49getattr(PyObject *__pyx_v_self, PyObject *__pyx_v_attr) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("getattr (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_48getattr(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_attr));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":503
 *     # ACCESS
 *     ###########################################
 *     def getattr(self, attr):             # <<<<<<<<<<<<<<
 *         t0GEN(str(self) + '.' + str(attr))
 *         sig_on()
 */

static PyObject *__pyx_pf_7example_3gen_48getattr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_attr) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("getattr", 0);

  /* "example.pyx":504
 *     ###########################################
 *     def getattr(self, attr):
 *         t0GEN(str(self) + '.' + str(attr))             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(t0)
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Add(__pyx_t_2, ((PyObject *)__pyx_kp_s_4)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_v_attr);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_attr);
  __Pyx_GIVEREF(__pyx_v_attr);
  __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_f_7example_t0GEN(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "example.pyx":505
 *     def getattr(self, attr):
 *         t0GEN(str(self) + '.' + str(attr))
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(t0)
 * 
 */
  __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":506
 *         t0GEN(str(self) + '.' + str(attr))
 *         sig_on()
 *         return self.new_gen(t0)             # <<<<<<<<<<<<<<
 * 
 *     def mod(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_7example_t0)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.getattr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_51mod(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_50mod[] = "\n        Given an INTMOD or POLMOD ``Mod(a,m)``, return the modulus `m`.\n\n        EXAMPLES::\n\n            sage: pari(4).Mod(5).mod()\n            5\n            sage: pari(\"Mod(x, x*y)\").mod()\n            y*x\n            sage: pari(\"[Mod(4,5)]\").mod()\n            Traceback (most recent call last):\n            ...\n            TypeError: Not an INTMOD or POLMOD in mod()\n        ";
static PyObject *__pyx_pw_7example_3gen_51mod(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("mod (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_50mod(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":508
 *         return self.new_gen(t0)
 * 
 *     def mod(self):             # <<<<<<<<<<<<<<
 *         """
 *         Given an INTMOD or POLMOD ``Mod(a,m)``, return the modulus `m`.
 */

static PyObject *__pyx_pf_7example_3gen_50mod(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("mod", 0);

  /* "example.pyx":523
 *             TypeError: Not an INTMOD or POLMOD in mod()
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:             # <<<<<<<<<<<<<<
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")
 *         sig_on()
 */
  __pyx_t_1 = (typ(__pyx_v_self->g) != t_INTMOD);
  if (__pyx_t_1) {
    __pyx_t_2 = (typ(__pyx_v_self->g) != t_POLMOD);
    __pyx_t_3 = __pyx_t_2;
  } else {
    __pyx_t_3 = __pyx_t_1;
  }
  if (__pyx_t_3) {

    /* "example.pyx":524
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # The hardcoded 1 below refers to the position in the internal
 */
    __pyx_t_4 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_6), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":525
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # The hardcoded 1 below refers to the position in the internal
 *         # representation of a INTMOD or POLDMOD where the modulus is
 */
  __pyx_t_5 = _pari_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":529
 *         # representation of a INTMOD or POLDMOD where the modulus is
 *         # stored.
 *         return self.new_gen(gel(self.g, 1))             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN get_nf(self) except NULL:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gel(__pyx_v_self->g, 1))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.gen.mod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":531
 *         return self.new_gen(gel(self.g, 1))
 * 
 *     cdef GEN get_nf(self) except NULL:             # <<<<<<<<<<<<<<
 *         """
 *         Given a PARI object `self`, convert it to a proper PARI number
 */

static GEN __pyx_f_7example_3gen_get_nf(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_nf;
  long __pyx_v_nftyp;
  GEN __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("get_nf", 0);

  /* "example.pyx":568
 *         cdef GEN nf
 *         cdef long nftyp
 *         sig_on()             # <<<<<<<<<<<<<<
 *         nf = get_nf(self.g, &nftyp)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":569
 *         cdef long nftyp
 *         sig_on()
 *         nf = get_nf(self.g, &nftyp)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         if not nf:
 */
  __pyx_v_nf = get_nf(__pyx_v_self->g, (&__pyx_v_nftyp));

  /* "example.pyx":570
 *         sig_on()
 *         nf = get_nf(self.g, &nftyp)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         if not nf:
 *             raise TypeError("Not a PARI number field")
 */
  _pari_sig_off();

  /* "example.pyx":571
 *         nf = get_nf(self.g, &nftyp)
 *         sig_off()
 *         if not nf:             # <<<<<<<<<<<<<<
 *             raise TypeError("Not a PARI number field")
 *         return nf
 */
  __pyx_t_2 = (!(__pyx_v_nf != 0));
  if (__pyx_t_2) {

    /* "example.pyx":572
 *         sig_off()
 *         if not nf:
 *             raise TypeError("Not a PARI number field")             # <<<<<<<<<<<<<<
 *         return nf
 * 
 */
    __pyx_t_3 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_8), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":573
 *         if not nf:
 *             raise TypeError("Not a PARI number field")
 *         return nf             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_pol(self):
 */
  __pyx_r = __pyx_v_nf;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.get_nf", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_53nf_get_pol(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_52nf_get_pol[] = "\n        Returns the defining polynomial of this number field.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_pol()\n            y^4 - 4*y^2 + 1\n            sage: bnr = pari(\"K = bnfinit(x^4 - 4*x^2 + 1); bnrinit(K, 2*x)\")\n            sage: bnr.nf_get_pol()\n            x^4 - 4*x^2 + 1\n\n        For relative extensions, we can only get the absolute polynomial,\n        not the relative one::\n\n            sage: L.<b> = K.extension(x^2 - 5)\n            sage: pari(L).nf_get_pol()   # Absolute polynomial\n            y^8 - 28*y^6 + 208*y^4 - 408*y^2 + 36\n            sage: L.pari_rnf().nf_get_pol()\n            Traceback (most recent call last):\n            ...\n            TypeError: Not a PARI number field\n        ";
static PyObject *__pyx_pw_7example_3gen_53nf_get_pol(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_pol (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_52nf_get_pol(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":575
 *         return nf
 * 
 *     def nf_get_pol(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the defining polynomial of this number field.
 */

static PyObject *__pyx_pf_7example_3gen_52nf_get_pol(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_nf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_pol", 0);

  /* "example.pyx":604
 *             TypeError: Not a PARI number field
 *         """
 *         cdef GEN nf = self.get_nf()             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nf_get_pol(nf))
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_nf(__pyx_v_self); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_nf = __pyx_t_1;

  /* "example.pyx":605
 *         """
 *         cdef GEN nf = self.get_nf()
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nf_get_pol(nf))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":606
 *         cdef GEN nf = self.get_nf()
 *         sig_on()
 *         return self.new_gen(nf_get_pol(nf))             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_diff(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nf_get_pol(__pyx_v_nf))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.nf_get_pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_55nf_get_diff(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_54nf_get_diff[] = "\n        Returns the different of this number field as a PARI ideal.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_diff()\n            [12, 0, 0, 0; 0, 12, 8, 0; 0, 0, 4, 0; 0, 0, 0, 4]\n        ";
static PyObject *__pyx_pw_7example_3gen_55nf_get_diff(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_diff (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_54nf_get_diff(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":608
 *         return self.new_gen(nf_get_pol(nf))
 * 
 *     def nf_get_diff(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the different of this number field as a PARI ideal.
 */

static PyObject *__pyx_pf_7example_3gen_54nf_get_diff(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_nf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_diff", 0);

  /* "example.pyx":623
 *             [12, 0, 0, 0; 0, 12, 8, 0; 0, 0, 4, 0; 0, 0, 0, 4]
 *         """
 *         cdef GEN nf = self.get_nf()             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # Very bad code, but there doesn't seem to be a better way
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_nf(__pyx_v_self); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_nf = __pyx_t_1;

  /* "example.pyx":624
 *         """
 *         cdef GEN nf = self.get_nf()
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # Very bad code, but there doesn't seem to be a better way
 *         return self.new_gen(gel(gel(nf, 5), 5))
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":626
 *         sig_on()
 *         # Very bad code, but there doesn't seem to be a better way
 *         return self.new_gen(gel(gel(nf, 5), 5))             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_sign(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gel(gel(__pyx_v_nf, 5), 5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.nf_get_diff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_57nf_get_sign(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_56nf_get_sign[] = "\n        Returns a Python list ``[r1, r2]``, where ``r1`` and ``r2`` are\n        Python ints representing the number of real embeddings and pairs\n        of complex embeddings of this number field, respectively.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: s = K.pari_nf().nf_get_sign(); s\n            [4, 0]\n            sage: type(s); type(s[0])\n            <type 'list'>\n            <type 'int'>\n            sage: CyclotomicField(15).pari_nf().nf_get_sign()\n            [0, 4]\n        ";
static PyObject *__pyx_pw_7example_3gen_57nf_get_sign(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_sign (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_56nf_get_sign(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":628
 *         return self.new_gen(gel(gel(nf, 5), 5))
 * 
 *     def nf_get_sign(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a Python list ``[r1, r2]``, where ``r1`` and ``r2`` are
 */

static PyObject *__pyx_pf_7example_3gen_56nf_get_sign(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_r1;
  long __pyx_v_r2;
  GEN __pyx_v_nf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_sign", 0);

  /* "example.pyx":652
 *         cdef long r1
 *         cdef long r2
 *         cdef GEN nf = self.get_nf()             # <<<<<<<<<<<<<<
 *         nf_get_sign(nf, &r1, &r2)
 *         return [r1, r2]
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_nf(__pyx_v_self); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_nf = __pyx_t_1;

  /* "example.pyx":653
 *         cdef long r2
 *         cdef GEN nf = self.get_nf()
 *         nf_get_sign(nf, &r1, &r2)             # <<<<<<<<<<<<<<
 *         return [r1, r2]
 * 
 */
  nf_get_sign(__pyx_v_nf, (&__pyx_v_r1), (&__pyx_v_r2));

  /* "example.pyx":654
 *         cdef GEN nf = self.get_nf()
 *         nf_get_sign(nf, &r1, &r2)
 *         return [r1, r2]             # <<<<<<<<<<<<<<
 * 
 *     def nf_get_zk(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_r1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyInt_FromLong(__pyx_v_r2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_r = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.gen.nf_get_sign", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_59nf_get_zk(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_58nf_get_zk[] = "\n        Returns a vector with a `\\ZZ`-basis for the ring of integers of\n        this number field. The first element is always `1`.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: pari(K).nf_get_zk()\n            [1, y, y^3 - 4*y, y^2 - 2]\n        ";
static PyObject *__pyx_pw_7example_3gen_59nf_get_zk(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("nf_get_zk (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_58nf_get_zk(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":656
 *         return [r1, r2]
 * 
 *     def nf_get_zk(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector with a `\ZZ`-basis for the ring of integers of
 */

static PyObject *__pyx_pf_7example_3gen_58nf_get_zk(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_nf;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("nf_get_zk", 0);

  /* "example.pyx":672
 *             [1, y, y^3 - 4*y, y^2 - 2]
 *         """
 *         cdef GEN nf = self.get_nf()             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nf_get_zk(nf))
 */
  __pyx_t_1 = ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_nf(__pyx_v_self); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 672; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_nf = __pyx_t_1;

  /* "example.pyx":673
 *         """
 *         cdef GEN nf = self.get_nf()
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nf_get_zk(nf))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":674
 *         cdef GEN nf = self.get_nf()
 *         sig_on()
 *         return self.new_gen(nf_get_zk(nf))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_no(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nf_get_zk(__pyx_v_nf))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.nf_get_zk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_61bnf_get_no(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_60bnf_get_no[] = "\n        Returns the class number of ``self``, a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: K.pari_bnf().bnf_get_no()\n            8\n        ";
static PyObject *__pyx_pw_7example_3gen_61bnf_get_no(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_no (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_60bnf_get_no(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":676
 *         return self.new_gen(nf_get_zk(nf))
 * 
 *     def bnf_get_no(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the class number of ``self``, a "big number field" (``bnf``).
 */

static PyObject *__pyx_pf_7example_3gen_60bnf_get_no(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_no", 0);

  /* "example.pyx":686
 *             8
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnf_get_no(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":687
 *         """
 *         sig_on()
 *         return self.new_gen(bnf_get_no(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_cyc(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnf_get_no(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 687; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bnf_get_no", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_63bnf_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_62bnf_get_cyc[] = "\n        Returns the structure of the class group of this number field as\n        a vector of SNF invariants.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: K.pari_bnf().bnf_get_cyc()\n            [4, 2]\n        ";
static PyObject *__pyx_pw_7example_3gen_63bnf_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_cyc (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_62bnf_get_cyc(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":689
 *         return self.new_gen(bnf_get_no(self.g))
 * 
 *     def bnf_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the class group of this number field as
 */

static PyObject *__pyx_pf_7example_3gen_62bnf_get_cyc(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_cyc", 0);

  /* "example.pyx":702
 *             [4, 2]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnf_get_cyc(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":703
 *         """
 *         sig_on()
 *         return self.new_gen(bnf_get_cyc(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnf_get_cyc(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bnf_get_cyc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_65bnf_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_64bnf_get_gen[] = "\n        Returns a vector of generators of the class group of this\n        number field.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = QuadraticField(-65)\n            sage: G = K.pari_bnf().bnf_get_gen(); G\n            [[3, 2; 0, 1], [2, 1; 0, 1]]\n            sage: map(lambda J: K.ideal(J), G)\n            [Fractional ideal (3, a + 2), Fractional ideal (2, a + 1)]\n        ";
static PyObject *__pyx_pw_7example_3gen_65bnf_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_64bnf_get_gen(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":705
 *         return self.new_gen(bnf_get_cyc(self.g))
 * 
 *     def bnf_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the class group of this
 */

static PyObject *__pyx_pf_7example_3gen_64bnf_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_gen", 0);

  /* "example.pyx":720
 *             [Fractional ideal (3, a + 2), Fractional ideal (2, a + 1)]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnf_get_gen(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":721
 *         """
 *         sig_on()
 *         return self.new_gen(bnf_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnf_get_reg(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnf_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bnf_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_67bnf_get_reg(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_66bnf_get_reg[] = "\n        Returns the regulator of this number field.\n\n        NOTE: ``self`` must be a \"big number field\" (``bnf``).\n\n        EXAMPLES::\n\n            sage: K.<a> = NumberField(x^4 - 4*x^2 + 1)\n            sage: K.pari_bnf().bnf_get_reg()\n            2.66089858019037...\n        ";
static PyObject *__pyx_pw_7example_3gen_67bnf_get_reg(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bnf_get_reg (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_66bnf_get_reg(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":723
 *         return self.new_gen(bnf_get_gen(self.g))
 * 
 *     def bnf_get_reg(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the regulator of this number field.
 */

static PyObject *__pyx_pf_7example_3gen_66bnf_get_reg(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bnf_get_reg", 0);

  /* "example.pyx":735
 *             2.66089858019037...
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnf_get_reg(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":736
 *         """
 *         sig_on()
 *         return self.new_gen(bnf_get_reg(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_p(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnf_get_reg(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bnf_get_reg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_69pr_get_p(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_68pr_get_p[] = "\n        Returns the prime of `\\ZZ` lying below this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: F = pari(K).idealfactor(K.ideal(5)); F\n            [[5, [-2, 1]~, 1, 1, [2, 1]~], 1; [5, [2, 1]~, 1, 1, [-2, 1]~], 1]\n            sage: F[0,0].pr_get_p()\n            5\n        ";
static PyObject *__pyx_pw_7example_3gen_69pr_get_p(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_p (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_68pr_get_p(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":738
 *         return self.new_gen(bnf_get_reg(self.g))
 * 
 *     def pr_get_p(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the prime of `\ZZ` lying below this prime ideal.
 */

static PyObject *__pyx_pf_7example_3gen_68pr_get_p(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_p", 0);

  /* "example.pyx":753
 *             5
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(pr_get_p(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":754
 *         """
 *         sig_on()
 *         return self.new_gen(pr_get_p(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_e(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, pr_get_p(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.pr_get_p", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_71pr_get_e(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_70pr_get_e[] = "\n        Returns the ramification index (over `\\QQ`) of this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: pari(K).idealfactor(K.ideal(2))[0,0].pr_get_e()\n            2\n            sage: pari(K).idealfactor(K.ideal(3))[0,0].pr_get_e()\n            1\n            sage: pari(K).idealfactor(K.ideal(5))[0,0].pr_get_e()\n            1\n        ";
static PyObject *__pyx_pw_7example_3gen_71pr_get_e(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_e (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_70pr_get_e(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":756
 *         return self.new_gen(pr_get_p(self.g))
 * 
 *     def pr_get_e(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the ramification index (over `\QQ`) of this prime ideal.
 */

static PyObject *__pyx_pf_7example_3gen_70pr_get_e(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_e;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_e", 0);

  /* "example.pyx":774
 *         """
 *         cdef long e
 *         sig_on()             # <<<<<<<<<<<<<<
 *         e = pr_get_e(self.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":775
 *         cdef long e
 *         sig_on()
 *         e = pr_get_e(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return e
 */
  __pyx_v_e = pr_get_e(__pyx_v_self->g);

  /* "example.pyx":776
 *         sig_on()
 *         e = pr_get_e(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return e
 * 
 */
  _pari_sig_off();

  /* "example.pyx":777
 *         e = pr_get_e(self.g)
 *         sig_off()
 *         return e             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_f(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_e); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.pr_get_e", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_73pr_get_f(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_72pr_get_f[] = "\n        Returns the residue class degree (over `\\QQ`) of this prime ideal.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: pari(K).idealfactor(K.ideal(2))[0,0].pr_get_f()\n            1\n            sage: pari(K).idealfactor(K.ideal(3))[0,0].pr_get_f()\n            2\n            sage: pari(K).idealfactor(K.ideal(5))[0,0].pr_get_f()\n            1\n        ";
static PyObject *__pyx_pw_7example_3gen_73pr_get_f(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_f (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_72pr_get_f(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":779
 *         return e
 * 
 *     def pr_get_f(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the residue class degree (over `\QQ`) of this prime ideal.
 */

static PyObject *__pyx_pf_7example_3gen_72pr_get_f(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_f;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_f", 0);

  /* "example.pyx":797
 *         """
 *         cdef long f
 *         sig_on()             # <<<<<<<<<<<<<<
 *         f = pr_get_f(self.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":798
 *         cdef long f
 *         sig_on()
 *         f = pr_get_f(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return f
 */
  __pyx_v_f = pr_get_f(__pyx_v_self->g);

  /* "example.pyx":799
 *         sig_on()
 *         f = pr_get_f(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return f
 * 
 */
  _pari_sig_off();

  /* "example.pyx":800
 *         f = pr_get_f(self.g)
 *         sig_off()
 *         return f             # <<<<<<<<<<<<<<
 * 
 *     def pr_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyInt_FromLong(__pyx_v_f); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.pr_get_f", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_75pr_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_74pr_get_gen[] = "\n        Returns the second generator of this PARI prime ideal, where the\n        first generator is ``self.pr_get_p()``.\n\n        NOTE: ``self`` must be a PARI prime ideal (as returned by\n        ``idealfactor`` for example).\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: g = pari(K).idealfactor(K.ideal(2))[0,0].pr_get_gen(); g; K(g)\n            [1, 1]~\n            i + 1\n            sage: g = pari(K).idealfactor(K.ideal(3))[0,0].pr_get_gen(); g; K(g)\n            [3, 0]~\n            3\n            sage: g = pari(K).idealfactor(K.ideal(5))[0,0].pr_get_gen(); g; K(g)\n            [-2, 1]~\n            i - 2\n        ";
static PyObject *__pyx_pw_7example_3gen_75pr_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("pr_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_74pr_get_gen(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":802
 *         return f
 * 
 *     def pr_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the second generator of this PARI prime ideal, where the
 */

static PyObject *__pyx_pf_7example_3gen_74pr_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("pr_get_gen", 0);

  /* "example.pyx":823
 *             i - 2
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(pr_get_gen(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":824
 *         """
 *         sig_on()
 *         return self.new_gen(pr_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bid_get_cyc(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, pr_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.pr_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_77bid_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_76bid_get_cyc[] = "\n        Returns the structure of the group `(O_K/I)^*`, where `I` is the\n        ideal represented by ``self``.\n\n        NOTE: ``self`` must be a \"big ideal\" (``bid``) as returned by\n        ``idealstar`` for example.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: J = pari(K).idealstar(K.ideal(4*i + 2))\n            sage: J.bid_get_cyc()\n            [4, 2]\n        ";
static PyObject *__pyx_pw_7example_3gen_77bid_get_cyc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bid_get_cyc (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_76bid_get_cyc(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":826
 *         return self.new_gen(pr_get_gen(self.g))
 * 
 *     def bid_get_cyc(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the structure of the group `(O_K/I)^*`, where `I` is the
 */

static PyObject *__pyx_pf_7example_3gen_76bid_get_cyc(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bid_get_cyc", 0);

  /* "example.pyx":841
 *             [4, 2]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bid_get_cyc(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":842
 *         """
 *         sig_on()
 *         return self.new_gen(bid_get_cyc(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bid_get_gen(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bid_get_cyc(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bid_get_cyc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_79bid_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_78bid_get_gen[] = "\n        Returns a vector of generators of the group `(O_K/I)^*`, where\n        `I` is the ideal represented by ``self``.\n\n        NOTE: ``self`` must be a \"big ideal\" (``bid``) with generators,\n        as returned by ``idealstar`` with ``flag`` = 2.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: J = pari(K).idealstar(K.ideal(4*i + 2), 2)\n            sage: J.bid_get_gen()\n            [7, [-2, -1]~]\n\n        We get an exception if we do not supply ``flag = 2`` to\n        ``idealstar``::\n\n            sage: J = pari(K).idealstar(K.ideal(3))\n            sage: J.bid_get_gen()\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n        ";
static PyObject *__pyx_pw_7example_3gen_79bid_get_gen(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("bid_get_gen (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_78bid_get_gen(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":844
 *         return self.new_gen(bid_get_cyc(self.g))
 * 
 *     def bid_get_gen(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns a vector of generators of the group `(O_K/I)^*`, where
 */

static PyObject *__pyx_pf_7example_3gen_78bid_get_gen(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("bid_get_gen", 0);

  /* "example.pyx":868
 *             PariError:  (5)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bid_get_gen(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":869
 *         """
 *         sig_on()
 *         return self.new_gen(bid_get_gen(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __getitem__(gen self, n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bid_get_gen(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.bid_get_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_81__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
static char __pyx_doc_7example_3gen_80__getitem__[] = "\n        Return the nth entry of self. The indexing is 0-based, like in\n        Python. Note that this is *different* than the default behavior\n        of the PARI/GP interpreter.\n\n        EXAMPLES::\n\n            sage: p = pari('1 + 2*x + 3*x^2')\n            sage: p[0]\n            1\n            sage: p[2]\n            3\n            sage: p[100]\n            0\n            sage: p[-1]\n            0\n            sage: q = pari('x^2 + 3*x^3 + O(x^6)')\n            sage: q[3]\n            3\n            sage: q[5]\n            0\n            sage: q[6]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: m = pari('[1,2;3,4]')\n            sage: m[0]\n            [1, 3]~\n            sage: m[1,0]\n            3\n            sage: l = pari('List([1,2,3])')\n            sage: l[1]\n            2\n            sage: s = pari('\"hello, world!\"')\n            sage: s[0]\n            'h'\n            sage: s[4]\n            'o'\n            sage: s[12]\n            '!'\n            sage: s[13]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: v = pari('[1,2,3]')\n            sage: v[0]\n            1\n            sage: c = pari('Col([1,2,3])')\n            sage: c[1]\n            2\n            sage: sv = pari('Vecsmall([1,2,3])')\n            sage: sv[2]\n            3\n            sage: type(sv[2])\n            <type 'int'>\n            sage: tuple(pari(3/5))\n            (3, 5)\n            sage: tuple(pari('1 + 5*I'))\n            (1, 5)\n            sage: tuple(pari('Qfb(1, 2, 3)'))\n            (1, 2, 3)\n            sage: pari(57)[0]\n            Traceback (most recent call last):\n            ...\n            TypeError: unindexable object\n            sage: m = pari(\"[[1,2;3,4],5]\") ; m[0][1,0]\n            3\n            sage: v = pari(xrange(20))\n            sage: v[2:5]\n            [2, 3, 4]\n     ""       sage: v[:]\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[10:]\n            [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[:5]\n            [0, 1, 2, 3, 4]\n            sage: v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: v[-1]\n            Traceback (most recent call last):\n            ...\n            IndexError: index out of bounds\n            sage: v[:-3]\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n            sage: v[5:]\n            [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: pari([])[::]\n            []\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_80__getitem__;
#endif
static PyObject *__pyx_pw_7example_3gen_81__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__getitem__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_80__getitem__(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":871
 *         return self.new_gen(bid_get_gen(self.g))
 * 
 *     def __getitem__(gen self, n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the nth entry of self. The indexing is 0-based, like in
 */

static PyObject *__pyx_pf_7example_3gen_80__getitem__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n) {
  int __pyx_v_pari_type;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_ind = NULL;
  struct __pyx_obj_7example_gen *__pyx_v_val = NULL;
  long __pyx_v_l;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_stop = NULL;
  PyObject *__pyx_v_step = NULL;
  PyObject *__pyx_v_inds = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_v = NULL;
  long __pyx_v_bound;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  Py_ssize_t __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_t_7;
  long __pyx_t_8;
  long __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  PyObject *__pyx_t_11 = NULL;
  PyObject *__pyx_t_12 = NULL;
  PyObject *(*__pyx_t_13)(PyObject *);
  PyObject *(*__pyx_t_14)(PyObject *);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__getitem__", 0);

  /* "example.pyx":963
 *         cdef int pari_type
 * 
 *         pari_type = typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *         if PyObject_TypeCheck(n, tuple):
 */
  __pyx_v_pari_type = typ(__pyx_v_self->g);

  /* "example.pyx":965
 *         pari_type = typ(self.g)
 * 
 *         if PyObject_TypeCheck(n, tuple):             # <<<<<<<<<<<<<<
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"
 */
  __pyx_t_1 = PyObject_TypeCheck(__pyx_v_n, ((PyObject *)((PyObject*)(&PyTuple_Type))));
  if (__pyx_t_1) {

    /* "example.pyx":966
 * 
 *         if PyObject_TypeCheck(n, tuple):
 *             if pari_type != t_MAT:             # <<<<<<<<<<<<<<
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:
 */
    __pyx_t_2 = (__pyx_v_pari_type != t_MAT);
    if (__pyx_t_2) {

      /* "example.pyx":967
 *         if PyObject_TypeCheck(n, tuple):
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"             # <<<<<<<<<<<<<<
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 */
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_9), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 967; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":968
 *             if pari_type != t_MAT:
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_n); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = (__pyx_t_3 != 2);
    if (__pyx_t_2) {

      /* "example.pyx":969
 *                 raise TypeError, "self must be of pari type t_MAT"
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"             # <<<<<<<<<<<<<<
 *             i = int(n[0])
 *             j = int(n[1])
 */
      __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_kp_s_10), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "example.pyx":970
 *             if len(n) != 2:
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])             # <<<<<<<<<<<<<<
 *             j = int(n[1])
 * 
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_n, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "example.pyx":971
 *                 raise IndexError, "index must be an integer or a 2-tuple (i,j)"
 *             i = int(n[0])
 *             j = int(n[1])             # <<<<<<<<<<<<<<
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 */
    __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_n, 1, sizeof(long), PyInt_FromLong); if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_v_j = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "example.pyx":973
 *             j = int(n[1])
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):
 */
    __pyx_t_4 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (!__pyx_t_2) {
      __pyx_t_4 = PyInt_FromLong(glength(((GEN)(__pyx_v_self->g[1])))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyObject_RichCompare(__pyx_v_i, __pyx_t_4, Py_GE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_7 = __pyx_t_6;
    } else {
      __pyx_t_7 = __pyx_t_2;
    }
    if (__pyx_t_7) {

      /* "example.pyx":974
 * 
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                 raise IndexError, "row index out of bounds"             # <<<<<<<<<<<<<<
 *             if j < 0 or j >= glength(self.g):
 *                 raise IndexError, "column index out of bounds"
 */
      __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_kp_s_11), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "example.pyx":975
 *             if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "column index out of bounds"
 * 
 */
    __pyx_t_5 = PyObject_RichCompare(__pyx_v_j, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (!__pyx_t_7) {
      __pyx_t_5 = PyInt_FromLong(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_j, __pyx_t_5, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __pyx_t_2;
    } else {
      __pyx_t_6 = __pyx_t_7;
    }
    if (__pyx_t_6) {

      /* "example.pyx":976
 *                 raise IndexError, "row index out of bounds"
 *             if j < 0 or j >= glength(self.g):
 *                 raise IndexError, "column index out of bounds"             # <<<<<<<<<<<<<<
 * 
 *             ind = (i,j)
 */
      __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_kp_s_12), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "example.pyx":978
 *                 raise IndexError, "column index out of bounds"
 * 
 *             ind = (i,j)             # <<<<<<<<<<<<<<
 * 
 *             if PyDict_Contains(self._refers_to, ind):
 */
    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 978; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_i);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_i);
    __Pyx_GIVEREF(__pyx_v_i);
    __Pyx_INCREF(__pyx_v_j);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_j);
    __Pyx_GIVEREF(__pyx_v_j);
    __pyx_v_ind = ((PyObject*)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "example.pyx":980
 *             ind = (i,j)
 * 
 *             if PyDict_Contains(self._refers_to, ind):             # <<<<<<<<<<<<<<
 *                 return self._refers_to[ind]
 *             else:
 */
    __pyx_t_4 = __pyx_v_self->_refers_to;
    __Pyx_INCREF(__pyx_t_4);
    __pyx_t_1 = PyDict_Contains(__pyx_t_4, ((PyObject *)__pyx_v_ind)); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 980; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_1) {

      /* "example.pyx":981
 * 
 *             if PyDict_Contains(self._refers_to, ind):
 *                 return self._refers_to[ind]             # <<<<<<<<<<<<<<
 *             else:
 *                 ## In this case, we're being asked to return
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = PyObject_GetItem(__pyx_v_self->_refers_to, ((PyObject *)__pyx_v_ind)); if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 981; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L8;
    }
    /*else*/ {

      /* "example.pyx":987
 *                 ## we need to create such a gen, add it to
 *                 ## self._refers_to, and return it.
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)             # <<<<<<<<<<<<<<
 *                 self._refers_to[ind] = val
 *                 return val
 */
      __pyx_t_4 = PyNumber_Add(__pyx_v_j, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_8 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Add(__pyx_v_i, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_9 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_ref(__pyx_v_7example_P, gmael(__pyx_v_self->g, __pyx_t_8, __pyx_t_9), __pyx_v_self)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_val = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "example.pyx":988
 *                 ## self._refers_to, and return it.
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)
 *                 self._refers_to[ind] = val             # <<<<<<<<<<<<<<
 *                 return val
 * 
 */
      if (PyObject_SetItem(__pyx_v_self->_refers_to, ((PyObject *)__pyx_v_ind), ((PyObject *)__pyx_v_val)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":989
 *                 val = P.new_ref(gmael(self.g, j+1, i+1), self)
 *                 self._refers_to[ind] = val
 *                 return val             # <<<<<<<<<<<<<<
 * 
 *         elif PyObject_TypeCheck(n, slice):
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_val));
      __pyx_r = ((PyObject *)__pyx_v_val);
      goto __pyx_L0;
    }
    __pyx_L8:;
    goto __pyx_L3;
  }

  /* "example.pyx":991
 *                 return val
 * 
 *         elif PyObject_TypeCheck(n, slice):             # <<<<<<<<<<<<<<
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)
 */
  __pyx_t_1 = PyObject_TypeCheck(__pyx_v_n, ((PyObject *)((PyObject*)(&PySlice_Type))));
  if (__pyx_t_1) {

    /* "example.pyx":992
 * 
 *         elif PyObject_TypeCheck(n, slice):
 *             l = glength(self.g)             # <<<<<<<<<<<<<<
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)
 */
    __pyx_v_l = glength(__pyx_v_self->g);

    /* "example.pyx":993
 *         elif PyObject_TypeCheck(n, slice):
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)             # <<<<<<<<<<<<<<
 *             inds = xrange(start,stop,step)
 *             k = len(inds)
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_n, __pyx_n_s__indices); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyInt_FromLong(__pyx_v_l); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_10), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
    if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
      PyObject* sequence = __pyx_t_5;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 3)) {
        if (size > 3) __Pyx_RaiseTooManyValuesError(3);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(PyTuple_CheckExact(sequence))) {
        __pyx_t_10 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
        __pyx_t_11 = PyTuple_GET_ITEM(sequence, 2); 
      } else {
        __pyx_t_10 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
        __pyx_t_11 = PyList_GET_ITEM(sequence, 2); 
      }
      __Pyx_INCREF(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_11);
      #else
      __pyx_t_10 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_10);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_11 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      #endif
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    } else
    {
      Py_ssize_t index = -1;
      __pyx_t_12 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_12);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext;
      index = 0; __pyx_t_10 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_10)) goto __pyx_L9_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_10);
      index = 1; __pyx_t_4 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_4)) goto __pyx_L9_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_4);
      index = 2; __pyx_t_11 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_11)) goto __pyx_L9_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_11);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_13(__pyx_t_12), 3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_13 = NULL;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L10_unpacking_done;
      __pyx_L9_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_13 = NULL;
      if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_L10_unpacking_done:;
    }
    __pyx_v_start = __pyx_t_10;
    __pyx_t_10 = 0;
    __pyx_v_stop = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_step = __pyx_t_11;
    __pyx_t_11 = 0;

    /* "example.pyx":994
 *             l = glength(self.g)
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)             # <<<<<<<<<<<<<<
 *             k = len(inds)
 *             # fast exit
 */
    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_start);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_start);
    __Pyx_GIVEREF(__pyx_v_start);
    __Pyx_INCREF(__pyx_v_stop);
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_stop);
    __Pyx_GIVEREF(__pyx_v_stop);
    __Pyx_INCREF(__pyx_v_step);
    PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_v_step);
    __Pyx_GIVEREF(__pyx_v_step);
    __pyx_t_11 = PyObject_Call(__pyx_builtin_xrange, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_v_inds = __pyx_t_11;
    __pyx_t_11 = 0;

    /* "example.pyx":995
 *             start,stop,step = n.indices(l)
 *             inds = xrange(start,stop,step)
 *             k = len(inds)             # <<<<<<<<<<<<<<
 *             # fast exit
 *             if k==0:
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_inds); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 995; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_11 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 995; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_v_k = __pyx_t_11;
    __pyx_t_11 = 0;

    /* "example.pyx":997
 *             k = len(inds)
 *             # fast exit
 *             if k==0:             # <<<<<<<<<<<<<<
 *                 return P.vector(0)
 *             # fast call, beware pari is one based
 */
    __pyx_t_11 = PyObject_RichCompare(__pyx_v_k, __pyx_int_0, Py_EQ); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (__pyx_t_6) {

      /* "example.pyx":998
 *             # fast exit
 *             if k==0:
 *                 return P.vector(0)             # <<<<<<<<<<<<<<
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_11 = PyObject_GetAttr(((PyObject *)__pyx_v_7example_P), __pyx_n_s__vector); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_5 = PyObject_Call(__pyx_t_11, ((PyObject *)__pyx_k_tuple_13), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L11;
    }
    __pyx_L11:;

    /* "example.pyx":1000
 *                 return P.vector(0)
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:             # <<<<<<<<<<<<<<
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 */
    __pyx_t_6 = (__pyx_v_pari_type == t_VEC);
    if (__pyx_t_6) {

      /* "example.pyx":1001
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 *                 if step==1:             # <<<<<<<<<<<<<<
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:
 */
      __pyx_t_5 = PyObject_RichCompare(__pyx_v_step, __pyx_int_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1001; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1001; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_6) {

        /* "example.pyx":1002
 *             if pari_type == t_VEC:
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')             # <<<<<<<<<<<<<<
 *                 if step==-1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__vecextract); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_11 = PyNumber_Add(__pyx_v_start, __pyx_int_1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_11);
        __Pyx_GIVEREF(__pyx_t_11);
        __pyx_t_11 = 0;
        __pyx_t_11 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_kp_s_14), __pyx_t_11); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Add(__pyx_t_4, ((PyObject *)__pyx_kp_s_15)); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_INCREF(__pyx_v_stop);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_stop);
        __Pyx_GIVEREF(__pyx_v_stop);
        __pyx_t_10 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = PyNumber_Add(__pyx_t_4, ((PyObject *)__pyx_kp_s_14)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_10);
        __Pyx_GIVEREF(__pyx_t_10);
        __pyx_t_10 = 0;
        __pyx_t_10 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        __pyx_r = __pyx_t_10;
        __pyx_t_10 = 0;
        goto __pyx_L0;
        goto __pyx_L13;
      }
      __pyx_L13:;

      /* "example.pyx":1003
 *                 if step==1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:             # <<<<<<<<<<<<<<
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 *             # slow call
 */
      __pyx_t_10 = PyObject_RichCompare(__pyx_v_step, __pyx_int_neg_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
      if (__pyx_t_6) {

        /* "example.pyx":1004
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop)+'"')
 *                 if step==-1:
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')             # <<<<<<<<<<<<<<
 *             # slow call
 *             v = P.vector(k)
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_10 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__vecextract); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __pyx_t_4 = PyNumber_Add(__pyx_v_start, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(((PyObject *)__pyx_kp_s_14), __pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(__pyx_t_5, ((PyObject *)__pyx_kp_s_15)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(__pyx_v_stop, __pyx_int_2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_11), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
        __pyx_t_11 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyNumber_Add(__pyx_t_11, ((PyObject *)__pyx_kp_s_14)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_11);
        PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = PyObject_Call(__pyx_t_10, ((PyObject *)__pyx_t_11), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
        __pyx_r = __pyx_t_5;
        __pyx_t_5 = 0;
        goto __pyx_L0;
        goto __pyx_L14;
      }
      __pyx_L14:;
      goto __pyx_L12;
    }
    __pyx_L12:;

    /* "example.pyx":1006
 *                     return self.vecextract('"'+str(start+1)+".."+str(stop+2)+'"')
 *             # slow call
 *             v = P.vector(k)             # <<<<<<<<<<<<<<
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]
 */
    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_7example_P), __pyx_n_s__vector); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_INCREF(__pyx_v_k);
    PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_k);
    __Pyx_GIVEREF(__pyx_v_k);
    __pyx_t_10 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_11), NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1006; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
    __pyx_v_v = __pyx_t_10;
    __pyx_t_10 = 0;

    /* "example.pyx":1007
 *             # slow call
 *             v = P.vector(k)
 *             for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                 v[i] = self[j]
 *             return v
 */
    __Pyx_INCREF(__pyx_int_0);
    __pyx_t_10 = __pyx_int_0;
    if (PyList_CheckExact(__pyx_v_inds) || PyTuple_CheckExact(__pyx_v_inds)) {
      __pyx_t_11 = __pyx_v_inds; __Pyx_INCREF(__pyx_t_11); __pyx_t_3 = 0;
      __pyx_t_14 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_11 = PyObject_GetIter(__pyx_v_inds); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_11);
      __pyx_t_14 = Py_TYPE(__pyx_t_11)->tp_iternext;
    }
    for (;;) {
      if (!__pyx_t_14 && PyList_CheckExact(__pyx_t_11)) {
        if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_11)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_11, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #endif
      } else if (!__pyx_t_14 && PyTuple_CheckExact(__pyx_t_11)) {
        if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_11)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_11, __pyx_t_3); __Pyx_INCREF(__pyx_t_5); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #else
        __pyx_t_5 = PySequence_ITEM(__pyx_t_11, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #endif
      } else {
        __pyx_t_5 = __pyx_t_14(__pyx_t_11);
        if (unlikely(!__pyx_t_5)) {
          if (PyErr_Occurred()) {
            if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
            else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_5);
      }
      __Pyx_XDECREF(__pyx_v_j);
      __pyx_v_j = __pyx_t_5;
      __pyx_t_5 = 0;
      __Pyx_INCREF(__pyx_t_10);
      __Pyx_XDECREF(__pyx_v_i);
      __pyx_v_i = __pyx_t_10;
      __pyx_t_5 = PyNumber_Add(__pyx_t_10, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_10);
      __pyx_t_10 = __pyx_t_5;
      __pyx_t_5 = 0;

      /* "example.pyx":1008
 *             v = P.vector(k)
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]             # <<<<<<<<<<<<<<
 *             return v
 * 
 */
      __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_self), __pyx_v_j); if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1008; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      if (PyObject_SetItem(__pyx_v_v, __pyx_v_i, __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1008; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

    /* "example.pyx":1009
 *             for i,j in enumerate(inds):
 *                 v[i] = self[j]
 *             return v             # <<<<<<<<<<<<<<
 * 
 *         ## there are no "out of bounds" problems
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_v);
    __pyx_r = __pyx_v_v;
    goto __pyx_L0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1014
 *         ## for a polynomial or power series, so these go before
 *         ## bounds testing
 *         if pari_type == t_POL:             # <<<<<<<<<<<<<<
 *             return self.polcoeff(n)
 * 
 */
  __pyx_t_6 = (__pyx_v_pari_type == t_POL);
  if (__pyx_t_6) {

    /* "example.pyx":1015
 *         ## bounds testing
 *         if pari_type == t_POL:
 *             return self.polcoeff(n)             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_SER:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_10 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__polcoeff); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __Pyx_INCREF(__pyx_v_n);
    PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_v_n);
    __Pyx_GIVEREF(__pyx_v_n);
    __pyx_t_5 = PyObject_Call(__pyx_t_10, ((PyObject *)__pyx_t_11), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L17;
  }

  /* "example.pyx":1017
 *             return self.polcoeff(n)
 * 
 *         elif pari_type == t_SER:             # <<<<<<<<<<<<<<
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:
 */
  __pyx_t_6 = (__pyx_v_pari_type == t_SER);
  if (__pyx_t_6) {

    /* "example.pyx":1018
 * 
 *         elif pari_type == t_SER:
 *             bound = valp(self.g) + lg(self.g) - 2             # <<<<<<<<<<<<<<
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"
 */
    __pyx_v_bound = ((valp(__pyx_v_self->g) + lg(__pyx_v_self->g)) - 2);

    /* "example.pyx":1019
 *         elif pari_type == t_SER:
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index out of bounds"
 *             return self.polcoeff(n)
 */
    __pyx_t_5 = PyInt_FromLong(__pyx_v_bound); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_11 = PyObject_RichCompare(__pyx_v_n, __pyx_t_5, Py_GE); __Pyx_XGOTREF(__pyx_t_11); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_11); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    if (__pyx_t_6) {

      /* "example.pyx":1020
 *             bound = valp(self.g) + lg(self.g) - 2
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"             # <<<<<<<<<<<<<<
 *             return self.polcoeff(n)
 * 
 */
      __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_kp_s_16), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L18;
    }
    __pyx_L18:;

    /* "example.pyx":1021
 *             if n >= bound:
 *                 raise IndexError, "index out of bounds"
 *             return self.polcoeff(n)             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_11 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__polcoeff); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_n);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_n);
    __Pyx_GIVEREF(__pyx_v_n);
    __pyx_t_10 = PyObject_Call(__pyx_t_11, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_10;
    __pyx_t_10 = 0;
    goto __pyx_L0;
    goto __pyx_L17;
  }

  /* "example.pyx":1023
 *             return self.polcoeff(n)
 * 
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):             # <<<<<<<<<<<<<<
 *             # these are definitely scalar!
 *             raise TypeError, "unindexable object"
 */
  __pyx_t_1 = __pyx_v_pari_type;
  __pyx_t_6 = ((int)(__pyx_t_1 == t_INT));
  if (!__pyx_t_6) {
    __pyx_t_7 = ((int)(__pyx_t_1 == t_REAL));
    __pyx_t_2 = __pyx_t_7;
  } else {
    __pyx_t_2 = __pyx_t_6;
  }
  if (!__pyx_t_2) {
    __pyx_t_6 = ((int)(__pyx_t_1 == t_PADIC));
    __pyx_t_7 = __pyx_t_6;
  } else {
    __pyx_t_7 = __pyx_t_2;
  }
  if (!__pyx_t_7) {
    __pyx_t_2 = ((int)(__pyx_t_1 == t_QUAD));
    __pyx_t_6 = __pyx_t_2;
  } else {
    __pyx_t_6 = __pyx_t_7;
  }
  __pyx_t_7 = __pyx_t_6;
  if (__pyx_t_7) {

    /* "example.pyx":1025
 *         elif pari_type in (t_INT, t_REAL, t_PADIC, t_QUAD):
 *             # these are definitely scalar!
 *             raise TypeError, "unindexable object"             # <<<<<<<<<<<<<<
 * 
 *         elif n < 0 or n >= glength(self.g):
 */
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_17), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L17;
  }

  /* "example.pyx":1027
 *             raise TypeError, "unindexable object"
 * 
 *         elif n < 0 or n >= glength(self.g):             # <<<<<<<<<<<<<<
 *             raise IndexError, "index out of bounds"
 * 
 */
  __pyx_t_10 = PyObject_RichCompare(__pyx_v_n, __pyx_int_0, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  if (!__pyx_t_7) {
    __pyx_t_10 = PyInt_FromLong(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_5 = PyObject_RichCompare(__pyx_v_n, __pyx_t_10, Py_GE); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = __pyx_t_6;
  } else {
    __pyx_t_2 = __pyx_t_7;
  }
  if (__pyx_t_2) {

    /* "example.pyx":1028
 * 
 *         elif n < 0 or n >= glength(self.g):
 *             raise IndexError, "index out of bounds"             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_VEC or pari_type == t_MAT:
 */
    __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_kp_s_16), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1028; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L17;
  }

  /* "example.pyx":1030
 *             raise IndexError, "index out of bounds"
 * 
 *         elif pari_type == t_VEC or pari_type == t_MAT:             # <<<<<<<<<<<<<<
 *             #t_VEC    : row vector        [ code ] [  x_1  ] ... [  x_k  ]
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 */
  __pyx_t_2 = (__pyx_v_pari_type == t_VEC);
  if (!__pyx_t_2) {
    __pyx_t_7 = (__pyx_v_pari_type == t_MAT);
    __pyx_t_6 = __pyx_t_7;
  } else {
    __pyx_t_6 = __pyx_t_2;
  }
  if (__pyx_t_6) {

    /* "example.pyx":1033
 *             #t_VEC    : row vector        [ code ] [  x_1  ] ... [  x_k  ]
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 *             if PyDict_Contains(self._refers_to, n):             # <<<<<<<<<<<<<<
 *                 return self._refers_to[n]
 *             else:
 */
    __pyx_t_5 = __pyx_v_self->_refers_to;
    __Pyx_INCREF(__pyx_t_5);
    __pyx_t_1 = PyDict_Contains(__pyx_t_5, __pyx_v_n); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_1) {

      /* "example.pyx":1034
 *             #t_MAT    : matrix            [ code ] [ col_1 ] ... [ col_k ]
 *             if PyDict_Contains(self._refers_to, n):
 *                 return self._refers_to[n]             # <<<<<<<<<<<<<<
 *             else:
 *                 ## In this case, we're being asked to return
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = PyObject_GetItem(__pyx_v_self->_refers_to, __pyx_v_n); if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L19;
    }
    /*else*/ {

      /* "example.pyx":1040
 *                 ## we need to create such a gen, add it to
 *                 ## self._refers_to, and return it.
 *                 val = P.new_ref(gel(self.g, n+1), self)             # <<<<<<<<<<<<<<
 *                 self._refers_to[n] = val
 *                 return val
 */
      __pyx_t_5 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_9 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_ref(__pyx_v_7example_P, gel(__pyx_v_self->g, __pyx_t_9), __pyx_v_self)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_v_val = ((struct __pyx_obj_7example_gen *)__pyx_t_5);
      __pyx_t_5 = 0;

      /* "example.pyx":1041
 *                 ## self._refers_to, and return it.
 *                 val = P.new_ref(gel(self.g, n+1), self)
 *                 self._refers_to[n] = val             # <<<<<<<<<<<<<<
 *                 return val
 * 
 */
      if (PyObject_SetItem(__pyx_v_self->_refers_to, __pyx_v_n, ((PyObject *)__pyx_v_val)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1041; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":1042
 *                 val = P.new_ref(gel(self.g, n+1), self)
 *                 self._refers_to[n] = val
 *                 return val             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_VECSMALL:
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_val));
      __pyx_r = ((PyObject *)__pyx_v_val);
      goto __pyx_L0;
    }
    __pyx_L19:;
    goto __pyx_L17;
  }

  /* "example.pyx":1044
 *                 return val
 * 
 *         elif pari_type == t_VECSMALL:             # <<<<<<<<<<<<<<
 *             #t_VECSMALL: vec. small ints  [ code ] [ x_1 ] ... [ x_k ]
 *             return self.g[n+1]
 */
  __pyx_t_6 = (__pyx_v_pari_type == t_VECSMALL);
  if (__pyx_t_6) {

    /* "example.pyx":1046
 *         elif pari_type == t_VECSMALL:
 *             #t_VECSMALL: vec. small ints  [ code ] [ x_1 ] ... [ x_k ]
 *             return self.g[n+1]             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_STR:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyInt_FromLong((__pyx_v_self->g[__pyx_t_3])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L17;
  }

  /* "example.pyx":1048
 *             return self.g[n+1]
 * 
 *         elif pari_type == t_STR:             # <<<<<<<<<<<<<<
 *             #t_STR    : string            [ code ] [ man_1 ] ... [ man_k ]
 *             return chr( (<char *>(self.g+1))[n] )
 */
  __pyx_t_6 = (__pyx_v_pari_type == t_STR);
  if (__pyx_t_6) {

    /* "example.pyx":1050
 *         elif pari_type == t_STR:
 *             #t_STR    : string            [ code ] [ man_1 ] ... [ man_k ]
 *             return chr( (<char *>(self.g+1))[n] )             # <<<<<<<<<<<<<<
 * 
 *         elif pari_type == t_LIST:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_v_n); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_5 = PyInt_FromLong((((char *)(__pyx_v_self->g + 1))[__pyx_t_3])); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_Call(__pyx_builtin_chr, ((PyObject *)__pyx_t_10), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_10)); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
    goto __pyx_L17;
  }

  /* "example.pyx":1052
 *             return chr( (<char *>(self.g+1))[n] )
 * 
 *         elif pari_type == t_LIST:             # <<<<<<<<<<<<<<
 *             #t_LIST   : list              [ code ] [ n ] [ nmax ][ vec ]
 *             return self.component(n+1)
 */
  __pyx_t_6 = (__pyx_v_pari_type == t_LIST);
  if (__pyx_t_6) {

    /* "example.pyx":1054
 *         elif pari_type == t_LIST:
 *             #t_LIST   : list              [ code ] [ n ] [ nmax ][ vec ]
 *             return self.component(n+1)             # <<<<<<<<<<<<<<
 *             #code from previous version, now segfaults:
 *             #return P.new_ref(gel(self.g,n+2), self)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__component); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1054; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_10 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1054; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_11 = PyTuple_New(1); if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1054; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_11);
    PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_10);
    __Pyx_GIVEREF(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_11), NULL); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1054; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_11)); __pyx_t_11 = 0;
    __pyx_r = __pyx_t_10;
    __pyx_t_10 = 0;
    goto __pyx_L0;
    goto __pyx_L17;
  }

  /* "example.pyx":1058
 *             #return P.new_ref(gel(self.g,n+2), self)
 * 
 *         elif pari_type in (t_INTMOD, t_POLMOD):             # <<<<<<<<<<<<<<
 *             #t_INTMOD : integermods       [ code ] [ mod  ] [ integer ]
 *             #t_POLMOD : poly mod          [ code ] [ mod  ] [ polynomial ]
 */
  __pyx_t_1 = __pyx_v_pari_type;
  __pyx_t_6 = ((int)(__pyx_t_1 == t_INTMOD));
  if (!__pyx_t_6) {
    __pyx_t_2 = ((int)(__pyx_t_1 == t_POLMOD));
    __pyx_t_7 = __pyx_t_2;
  } else {
    __pyx_t_7 = __pyx_t_6;
  }
  __pyx_t_6 = __pyx_t_7;
  if (__pyx_t_6) {

    /* "example.pyx":1066
 *             #   [1] = lift to t_INT or t_POL
 *             # do we want this? maybe the other way around?
 *             raise TypeError, "unindexable object"             # <<<<<<<<<<<<<<
 * 
 *         #elif pari_type in (t_FRAC, t_RFRAC):
 */
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_17), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1066; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L17;
  }
  /*else*/ {

    /* "example.pyx":1084
 *             ## generic code, which currently handles cases
 *             ## as mentioned above
 *             return P.new_ref(gel(self.g,n+1), self)             # <<<<<<<<<<<<<<
 * 
 *     def _gen_length(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_10 = PyNumber_Add(__pyx_v_n, __pyx_int_1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_t_9 = __Pyx_PyInt_AsLong(__pyx_t_10); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_ref(__pyx_v_7example_P, gel(__pyx_v_self->g, __pyx_t_9), __pyx_v_self)); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_10);
    __pyx_r = __pyx_t_10;
    __pyx_t_10 = 0;
    goto __pyx_L0;
  }
  __pyx_L17:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_11);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_AddTraceback("example.gen.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_j);
  __Pyx_XDECREF(__pyx_v_ind);
  __Pyx_XDECREF((PyObject *)__pyx_v_val);
  __Pyx_XDECREF(__pyx_v_start);
  __Pyx_XDECREF(__pyx_v_stop);
  __Pyx_XDECREF(__pyx_v_step);
  __Pyx_XDECREF(__pyx_v_inds);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_83_gen_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_82_gen_length[] = "\n        Return the length of self as a Pari object, *including*\n        codewords.\n\n        EXAMPLES::\n\n            sage: n = pari(30)\n            sage: n.length()\n            1\n            sage: n._gen_length()\n            3\n        ";
static PyObject *__pyx_pw_7example_3gen_83_gen_length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_gen_length (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_82_gen_length(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1086
 *             return P.new_ref(gel(self.g,n+1), self)
 * 
 *     def _gen_length(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the length of self as a Pari object, *including*
 */

static PyObject *__pyx_pf_7example_3gen_82_gen_length(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_gen_length", 0);

  /* "example.pyx":1099
 *             3
 *         """
 *         return lg(self.g)             # <<<<<<<<<<<<<<
 * 
 *     def __setitem__(gen self, n, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(lg(__pyx_v_self->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen._gen_length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_7example_3gen_85__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_7example_3gen_84__setitem__[] = "\n        Set the nth entry to a reference to y.\n\n\n            -  The indexing is 0-based, like everywhere else in Python, but\n               *unlike* in Pari/GP.\n\n            -  Assignment sets the nth entry to a reference to y, assuming y is\n               an object of type gen. This is the same as in Python, but\n               *different* than what happens in the gp interpreter, where\n               assignment makes a copy of y.\n\n            -  Because setting creates references it is *possible* to make\n               circular references, unlike in GP. Do *not* do this (see the\n               example below). If you need circular references, work at the Python\n               level (where they work well), not the PARI object level.\n\n\n\n        EXAMPLES::\n\n            sage: v = pari(range(10))\n            sage: v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[0] = 10\n            sage: w = pari([5,8,-20])\n            sage: v\n            [10, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[1] = w\n            sage: v\n            [10, [5, 8, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: w[0] = -30\n            sage: v\n            [10, [-30, 8, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: t = v[1]; t[1] = 10 ; v\n            [10, [-30, 10, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[1][0] = 54321 ; v\n            [10, [54321, 10, -20], 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: w\n            [54321, 10, -20]\n            sage: v = pari([[[[0,1],2],3],4]) ; v[0][0][0][1] = 12 ; v\n            [[[[0, 12], 2], 3], 4]\n            sage: m = pari(matrix(2,2,range(4))) ; l = pari([5,6]) ; n = pari(matrix(2,2,[7,8,9,0])) ; m[1,0] = l ; l[1] = n ; m[1,0][1][1,1] = 1111 ; m\n            [0, 1; [5, [7, 8; 9, 1111]], 3]\n            sage: m = pari(\"[[1,2;3,4],5,6]\") ; m[0][1,1] = 11 ; m\n            [[1, 2; 3, 11], 5, 6]\n\n        Finally, we create a circular reference::\n\n            sage: v = pari([0])\n            s""age: w = pari([v])\n            sage: v\n            [0]\n            sage: w\n            [[0]]\n            sage: v[0] = w\n\n        Now there is a circular reference. Accessing v[0] will crash Sage.\n\n        ::\n\n            sage: s=pari.vector(2,[0,0])\n            sage: s[:1]\n            [0]\n            sage: s[:1]=[1]\n            sage: s\n            [1, 0]\n            sage: type(s[0])\n            <type 'sage.libs.pari.gen.gen'>\n            sage: s = pari(range(20)) ; s\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: s[0:10:2] = range(50,55) ; s\n            [50, 1, 51, 3, 52, 5, 53, 7, 54, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]\n            sage: s[10:20:3] = range(100,150) ; s\n            [50, 1, 51, 3, 52, 5, 53, 7, 54, 9, 100, 11, 12, 101, 14, 15, 102, 17, 18, 103]\n\n        TESTS::\n\n            sage: v = pari(xrange(10)) ; v\n            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n            sage: v[:] = [20..29]\n            sage: v\n            [20, 21, 22, 23, 24, 25, 26, 27, 28, 29]\n            sage: type(v[0])\n            <type 'sage.libs.pari.gen.gen'>\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_84__setitem__;
#endif
static int __pyx_pw_7example_3gen_85__setitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__setitem__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_84__setitem__(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n), ((PyObject *)__pyx_v_y));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1101
 *         return lg(self.g)
 * 
 *     def __setitem__(gen self, n, y):             # <<<<<<<<<<<<<<
 *         r"""
 *         Set the nth entry to a reference to y.
 */

static int __pyx_pf_7example_3gen_84__setitem__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n, PyObject *__pyx_v_y) {
  int __pyx_v_i;
  int __pyx_v_j;
  struct __pyx_obj_7example_gen *__pyx_v_x = 0;
  long __pyx_v_l;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_inds = NULL;
  PyObject *__pyx_v_k = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  int __pyx_t_7;
  int __pyx_t_8;
  PyObject *(*__pyx_t_9)(PyObject *);
  int __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__setitem__", 0);

  /* "example.pyx":1193
 *         cdef Py_ssize_t ii, jj, step
 * 
 *         sig_on()             # <<<<<<<<<<<<<<
 *         try:
 *             if PyObject_TypeCheck(y, gen):
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1194
 * 
 *         sig_on()
 *         try:             # <<<<<<<<<<<<<<
 *             if PyObject_TypeCheck(y, gen):
 *                 x = y
 */
  /*try:*/ {

    /* "example.pyx":1195
 *         sig_on()
 *         try:
 *             if PyObject_TypeCheck(y, gen):             # <<<<<<<<<<<<<<
 *                 x = y
 *             else:
 */
    __pyx_t_1 = PyObject_TypeCheck(__pyx_v_y, ((PyObject *)((PyObject*)__pyx_ptype_7example_gen)));
    if (__pyx_t_1) {

      /* "example.pyx":1196
 *         try:
 *             if PyObject_TypeCheck(y, gen):
 *                 x = y             # <<<<<<<<<<<<<<
 *             else:
 *                 x = pari(y)
 */
      if (!(likely(((__pyx_v_y) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_y, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1196; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_INCREF(__pyx_v_y);
      __pyx_v_x = ((struct __pyx_obj_7example_gen *)__pyx_v_y);
      goto __pyx_L6;
    }
    /*else*/ {

      /* "example.pyx":1198
 *                 x = y
 *             else:
 *                 x = pari(y)             # <<<<<<<<<<<<<<
 * 
 *             if PyObject_TypeCheck(n, tuple):
 */
      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_y);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_y);
      __Pyx_GIVEREF(__pyx_v_y);
      __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __pyx_v_x = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
      __pyx_t_4 = 0;
    }
    __pyx_L6:;

    /* "example.pyx":1200
 *                 x = pari(y)
 * 
 *             if PyObject_TypeCheck(n, tuple):             # <<<<<<<<<<<<<<
 *                 if typ(self.g) != t_MAT:
 *                     raise TypeError, "cannot index Pari type %s by tuple"%typ(self.g)
 */
    __pyx_t_1 = PyObject_TypeCheck(__pyx_v_n, ((PyObject *)((PyObject*)(&PyTuple_Type))));
    if (__pyx_t_1) {

      /* "example.pyx":1201
 * 
 *             if PyObject_TypeCheck(n, tuple):
 *                 if typ(self.g) != t_MAT:             # <<<<<<<<<<<<<<
 *                     raise TypeError, "cannot index Pari type %s by tuple"%typ(self.g)
 * 
 */
      __pyx_t_5 = (typ(__pyx_v_self->g) != t_MAT);
      if (__pyx_t_5) {

        /* "example.pyx":1202
 *             if PyObject_TypeCheck(n, tuple):
 *                 if typ(self.g) != t_MAT:
 *                     raise TypeError, "cannot index Pari type %s by tuple"%typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *                 if len(n) != 2:
 */
        __pyx_t_4 = PyInt_FromLong(typ(__pyx_v_self->g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_18), __pyx_t_4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_3));
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L4;}
        goto __pyx_L8;
      }
      __pyx_L8:;

      /* "example.pyx":1204
 *                     raise TypeError, "cannot index Pari type %s by tuple"%typ(self.g)
 * 
 *                 if len(n) != 2:             # <<<<<<<<<<<<<<
 *                     raise ValueError, "matrix index must be of the form [row, column]"
 * 
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_n); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __pyx_t_5 = (__pyx_t_6 != 2);
      if (__pyx_t_5) {

        /* "example.pyx":1205
 * 
 *                 if len(n) != 2:
 *                     raise ValueError, "matrix index must be of the form [row, column]"             # <<<<<<<<<<<<<<
 * 
 *                 i = int(n[0])
 */
        __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_kp_s_19), 0, 0);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L4;}
        goto __pyx_L9;
      }
      __pyx_L9:;

      /* "example.pyx":1207
 *                     raise ValueError, "matrix index must be of the form [row, column]"
 * 
 *                 i = int(n[0])             # <<<<<<<<<<<<<<
 *                 j = int(n[1])
 *                 ind = (i,j)
 */
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_n, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1207; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1207; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1207; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_t_3); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1207; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_i = __pyx_t_1;

      /* "example.pyx":1208
 * 
 *                 i = int(n[0])
 *                 j = int(n[1])             # <<<<<<<<<<<<<<
 *                 ind = (i,j)
 * 
 */
      __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_n, 1, sizeof(long), PyInt_FromLong); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_t_3); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_j = __pyx_t_1;

      /* "example.pyx":1209
 *                 i = int(n[0])
 *                 j = int(n[1])
 *                 ind = (i,j)             # <<<<<<<<<<<<<<
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 */
      __pyx_t_3 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyInt_FromLong(__pyx_v_j); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_v_ind = ((PyObject*)__pyx_t_2);
      __pyx_t_2 = 0;

      /* "example.pyx":1211
 *                 ind = (i,j)
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):             # <<<<<<<<<<<<<<
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):
 */
      __pyx_t_5 = (__pyx_v_i < 0);
      if (!__pyx_t_5) {
        __pyx_t_7 = (__pyx_v_i >= glength(((GEN)(__pyx_v_self->g[1]))));
        __pyx_t_8 = __pyx_t_7;
      } else {
        __pyx_t_8 = __pyx_t_5;
      }
      if (__pyx_t_8) {

        /* "example.pyx":1212
 * 
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)             # <<<<<<<<<<<<<<
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 */
        __pyx_t_2 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__nrows); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Subtract(__pyx_t_3, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __pyx_t_2 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_20), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_4));
        __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L4;}
        goto __pyx_L10;
      }
      __pyx_L10:;

      /* "example.pyx":1213
 *                 if i < 0 or i >= glength(<GEN>(self.g[1])):
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):             # <<<<<<<<<<<<<<
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 *                 self._refers_to[ind] = x
 */
      __pyx_t_8 = (__pyx_v_j < 0);
      if (!__pyx_t_8) {
        __pyx_t_5 = (__pyx_v_j >= glength(__pyx_v_self->g));
        __pyx_t_7 = __pyx_t_5;
      } else {
        __pyx_t_7 = __pyx_t_8;
      }
      if (__pyx_t_7) {

        /* "example.pyx":1214
 *                     raise IndexError, "row i(=%s) must be between 0 and %s"%(i,self.nrows()-1)
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)             # <<<<<<<<<<<<<<
 *                 self._refers_to[ind] = x
 * 
 */
        __pyx_t_4 = PyInt_FromLong(__pyx_v_j); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__ncols); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_2);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_int_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_3);
        __pyx_t_4 = 0;
        __pyx_t_3 = 0;
        __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_21), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_3));
        __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_3), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L4;}
        goto __pyx_L11;
      }
      __pyx_L11:;

      /* "example.pyx":1215
 *                 if j < 0 or j >= glength(self.g):
 *                     raise IndexError, "column j(=%s) must be between 0 and %s"%(j,self.ncols()-1)
 *                 self._refers_to[ind] = x             # <<<<<<<<<<<<<<
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)
 */
      if (PyObject_SetItem(__pyx_v_self->_refers_to, ((PyObject *)__pyx_v_ind), ((PyObject *)__pyx_v_x)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1215; __pyx_clineno = __LINE__; goto __pyx_L4;}

      /* "example.pyx":1217
 *                 self._refers_to[ind] = x
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)             # <<<<<<<<<<<<<<
 *                 return
 * 
 */
      (((GEN)(__pyx_v_self->g[(__pyx_v_j + 1)]))[(__pyx_v_i + 1)]) = ((long)__pyx_v_x->g);

      /* "example.pyx":1218
 * 
 *                 (<GEN>(self.g)[j+1])[i+1] = <long>(x.g)
 *                 return             # <<<<<<<<<<<<<<
 * 
 *             elif isinstance(n, slice):
 */
      __pyx_r = 0;
      goto __pyx_L3;
      goto __pyx_L7;
    }

    /* "example.pyx":1220
 *                 return
 * 
 *             elif isinstance(n, slice):             # <<<<<<<<<<<<<<
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))
 */
    __pyx_t_7 = PySlice_Check(__pyx_v_n); 
    if (__pyx_t_7) {

      /* "example.pyx":1221
 * 
 *             elif isinstance(n, slice):
 *                 l = glength(self.g)             # <<<<<<<<<<<<<<
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)
 */
      __pyx_v_l = glength(__pyx_v_self->g);

      /* "example.pyx":1222
 *             elif isinstance(n, slice):
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))             # <<<<<<<<<<<<<<
 *                 k = len(inds)
 *                 if k > len(y):
 */
      __pyx_t_3 = PyObject_GetAttr(__pyx_v_n, __pyx_n_s__indices); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyInt_FromLong(__pyx_v_l); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_4 = PySequence_Tuple(__pyx_t_2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_builtin_xrange, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_v_inds = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "example.pyx":1223
 *                 l = glength(self.g)
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)             # <<<<<<<<<<<<<<
 *                 if k > len(y):
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_inds); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_v_k = __pyx_t_2;
      __pyx_t_2 = 0;

      /* "example.pyx":1224
 *                 inds = xrange(*n.indices(l))
 *                 k = len(inds)
 *                 if k > len(y):             # <<<<<<<<<<<<<<
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)
 * 
 */
      __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_k, __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_7 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_7) {

        /* "example.pyx":1225
 *                 k = len(inds)
 *                 if k > len(y):
 *                     raise ValueError, "attempt to assign sequence of size %s to slice of size %s"%(len(y), k)             # <<<<<<<<<<<<<<
 * 
 *                 # actually set the values
 */
        __pyx_t_6 = PyObject_Length(__pyx_v_y); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __pyx_t_4 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __Pyx_INCREF(__pyx_v_k);
        PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_k);
        __Pyx_GIVEREF(__pyx_v_k);
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_22), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_4));
        __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
        __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_t_4), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L4;}
        goto __pyx_L12;
      }
      __pyx_L12:;

      /* "example.pyx":1228
 * 
 *                 # actually set the values
 *                 for i,j in enumerate(inds):             # <<<<<<<<<<<<<<
 *                     self[j] = y[i]
 *                 return
 */
      __pyx_t_1 = 0;
      if (PyList_CheckExact(__pyx_v_inds) || PyTuple_CheckExact(__pyx_v_inds)) {
        __pyx_t_4 = __pyx_v_inds; __Pyx_INCREF(__pyx_t_4); __pyx_t_6 = 0;
        __pyx_t_9 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_inds); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = Py_TYPE(__pyx_t_4)->tp_iternext;
      }
      for (;;) {
        if (!__pyx_t_9 && PyList_CheckExact(__pyx_t_4)) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
          #endif
        } else if (!__pyx_t_9 && PyTuple_CheckExact(__pyx_t_4)) {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_6); __Pyx_INCREF(__pyx_t_2); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
          #else
          __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
          #endif
        } else {
          __pyx_t_2 = __pyx_t_9(__pyx_t_4);
          if (unlikely(!__pyx_t_2)) {
            if (PyErr_Occurred()) {
              if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_2);
        }
        __pyx_t_10 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_10 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_v_j = __pyx_t_10;
        __pyx_v_i = __pyx_t_1;
        __pyx_t_1 = (__pyx_t_1 + 1);

        /* "example.pyx":1229
 *                 # actually set the values
 *                 for i,j in enumerate(inds):
 *                     self[j] = y[i]             # <<<<<<<<<<<<<<
 *                 return
 * 
 */
        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_y, __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1229; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_GOTREF(__pyx_t_2);
        if (__Pyx_SetItemInt(((PyObject *)__pyx_v_self), __pyx_v_j, __pyx_t_2, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1229; __pyx_clineno = __LINE__; goto __pyx_L4;}
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "example.pyx":1230
 *                 for i,j in enumerate(inds):
 *                     self[j] = y[i]
 *                 return             # <<<<<<<<<<<<<<
 * 
 *             i = int(n)
 */
      __pyx_r = 0;
      goto __pyx_L3;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "example.pyx":1232
 *                 return
 * 
 *             i = int(n)             # <<<<<<<<<<<<<<
 * 
 *             if i < 0 or i >= glength(self.g):
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1232; __pyx_clineno = __LINE__; goto __pyx_L4;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_n);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_n);
    __Pyx_GIVEREF(__pyx_v_n);
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1232; __pyx_clineno = __LINE__; goto __pyx_L4;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyInt_AsInt(__pyx_t_2); if (unlikely((__pyx_t_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1232; __pyx_clineno = __LINE__; goto __pyx_L4;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_i = __pyx_t_1;

    /* "example.pyx":1234
 *             i = int(n)
 * 
 *             if i < 0 or i >= glength(self.g):             # <<<<<<<<<<<<<<
 *                 raise IndexError, "index (%s) must be between 0 and %s"%(i,glength(self.g)-1)
 * 
 */
    __pyx_t_7 = (__pyx_v_i < 0);
    if (!__pyx_t_7) {
      __pyx_t_8 = (__pyx_v_i >= glength(__pyx_v_self->g));
      __pyx_t_5 = __pyx_t_8;
    } else {
      __pyx_t_5 = __pyx_t_7;
    }
    if (__pyx_t_5) {

      /* "example.pyx":1235
 * 
 *             if i < 0 or i >= glength(self.g):
 *                 raise IndexError, "index (%s) must be between 0 and %s"%(i,glength(self.g)-1)             # <<<<<<<<<<<<<<
 * 
 *             # so python memory manager will work correctly
 */
      __pyx_t_2 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyInt_FromLong((glength(__pyx_v_self->g) - 1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_4 = 0;
      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_23), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; __pyx_clineno = __LINE__; goto __pyx_L4;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1235; __pyx_clineno = __LINE__; goto __pyx_L4;}
      goto __pyx_L15;
    }
    __pyx_L15:;

    /* "example.pyx":1240
 *             # and not free x if PARI part of self is the
 *             # only thing pointing to it.
 *             self._refers_to[i] = x             # <<<<<<<<<<<<<<
 * 
 *             ## correct indexing for t_POLs
 */
    if (__Pyx_SetItemInt(__pyx_v_self->_refers_to, __pyx_v_i, ((PyObject *)__pyx_v_x), sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1240; __pyx_clineno = __LINE__; goto __pyx_L4;}

    /* "example.pyx":1243
 * 
 *             ## correct indexing for t_POLs
 *             if typ(self.g) == t_POL:             # <<<<<<<<<<<<<<
 *                 i = i + 1
 * 
 */
    __pyx_t_5 = (typ(__pyx_v_self->g) == t_POL);
    if (__pyx_t_5) {

      /* "example.pyx":1244
 *             ## correct indexing for t_POLs
 *             if typ(self.g) == t_POL:
 *                 i = i + 1             # <<<<<<<<<<<<<<
 * 
 *             ## actually set the value
 */
      __pyx_v_i = (__pyx_v_i + 1);
      goto __pyx_L16;
    }
    __pyx_L16:;

    /* "example.pyx":1247
 * 
 *             ## actually set the value
 *             (self.g)[i+1] = <long>(x.g)             # <<<<<<<<<<<<<<
 *             return
 *         finally:
 */
    (__pyx_v_self->g[(__pyx_v_i + 1)]) = ((long)__pyx_v_x->g);

    /* "example.pyx":1248
 *             ## actually set the value
 *             (self.g)[i+1] = <long>(x.g)
 *             return             # <<<<<<<<<<<<<<
 *         finally:
 *             sig_off()
 */
    __pyx_r = 0;
    goto __pyx_L3;
  }

  /* "example.pyx":1250
 *             return
 *         finally:
 *             sig_off()             # <<<<<<<<<<<<<<
 * 
 *     def __len__(gen self):
 */
  /*finally:*/ {
    int __pyx_why;
    PyObject *__pyx_exc_type, *__pyx_exc_value, *__pyx_exc_tb;
    int __pyx_exc_lineno;
    __pyx_exc_type = 0; __pyx_exc_value = 0; __pyx_exc_tb = 0; __pyx_exc_lineno = 0;
    __pyx_why = 0; goto __pyx_L5;
    __pyx_L3: __pyx_exc_type = 0; __pyx_exc_value = 0; __pyx_exc_tb = 0; __pyx_exc_lineno = 0;
    __pyx_why = 3; goto __pyx_L5;
    __pyx_L4: {
      __pyx_why = 4;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_ErrFetch(&__pyx_exc_type, &__pyx_exc_value, &__pyx_exc_tb);
      __pyx_exc_lineno = __pyx_lineno;
      goto __pyx_L5;
    }
    __pyx_L5:;
    _pari_sig_off();
    switch (__pyx_why) {
      case 3: goto __pyx_L0;
      case 4: {
        __Pyx_ErrRestore(__pyx_exc_type, __pyx_exc_value, __pyx_exc_tb);
        __pyx_lineno = __pyx_exc_lineno;
        __pyx_exc_type = 0;
        __pyx_exc_value = 0;
        __pyx_exc_tb = 0;
        goto __pyx_L1_error;
      }
    }
  }

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.gen.__setitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_x);
  __Pyx_XDECREF(__pyx_v_ind);
  __Pyx_XDECREF(__pyx_v_inds);
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static Py_ssize_t __pyx_pw_7example_3gen_87__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_7example_3gen_87__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_86__len__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1252
 *             sig_off()
 * 
 *     def __len__(gen self):             # <<<<<<<<<<<<<<
 *         return glength(self.g)
 * 
 */

static Py_ssize_t __pyx_pf_7example_3gen_86__len__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__len__", 0);

  /* "example.pyx":1253
 * 
 *     def __len__(gen self):
 *         return glength(self.g)             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
  __pyx_r = glength(__pyx_v_self->g);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_89__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op); /*proto*/
static PyObject *__pyx_pw_7example_3gen_89__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__richcmp__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_88__richcmp__(((PyObject *)__pyx_v_left), ((PyObject *)__pyx_v_right), ((int)__pyx_v_op));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1262
 *     ###########################################
 * 
 *     def __richcmp__(left, right, int op):             # <<<<<<<<<<<<<<
 *         return gcmp_sage((<gen>left).g, (<gen>right).g)
 * 
 */

static PyObject *__pyx_pf_7example_3gen_88__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, CYTHON_UNUSED int __pyx_v_op) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__richcmp__", 0);

  /* "example.pyx":1263
 * 
 *     def __richcmp__(left, right, int op):
 *         return gcmp_sage((<gen>left).g, (<gen>right).g)             # <<<<<<<<<<<<<<
 * 
 *     #cdef int _cmp_c_impl(left, Element right) except -2:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(gcmp_sage(((struct __pyx_obj_7example_gen *)__pyx_v_left)->g, ((struct __pyx_obj_7example_gen *)__pyx_v_right)->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_91__copy__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_7example_3gen_91__copy__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__copy__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_90__copy__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1307
 *         #return gcmp_sage((<gen>left).g, (<gen>right).g)
 * 
 *     def __copy__(gen self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gcopy(self.g))
 */

static PyObject *__pyx_pf_7example_3gen_90__copy__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__copy__", 0);

  /* "example.pyx":1308
 * 
 *     def __copy__(gen self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcopy(self.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1309
 *     def __copy__(gen self):
 *         sig_on()
 *         return P.new_gen(gcopy(self.g))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gcopy(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__copy__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_93list_str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_92list_str[] = "\n        Return str that might correctly evaluate to a Python-list.\n        ";
static PyObject *__pyx_pw_7example_3gen_93list_str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("list_str (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_92list_str(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1317
 *     ###########################################
 * 
 *     def list_str(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return str that might correctly evaluate to a Python-list.
 */

static PyObject *__pyx_pf_7example_3gen_92list_str(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("list_str", 0);

  /* "example.pyx":1321
 *         Return str that might correctly evaluate to a Python-list.
 *         """
 *         s = str(self)             # <<<<<<<<<<<<<<
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":1322
 *         """
 *         s = str(self)
 *         if s[:4] == "Mat(":             # <<<<<<<<<<<<<<
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 */
  __pyx_t_2 = __Pyx_PySequence_GetSlice(__pyx_v_s, 0, 4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_RichCompare(__pyx_t_2, ((PyObject *)__pyx_kp_s_24), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_3) {

    /* "example.pyx":1323
 *         s = str(self)
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"             # <<<<<<<<<<<<<<
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 */
    __pyx_t_1 = __Pyx_PySequence_GetSlice(__pyx_v_s, 4, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyNumber_Add(((PyObject *)__pyx_kp_s_25), __pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Add(__pyx_t_2, ((PyObject *)__pyx_kp_s_26)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_s);
    __pyx_v_s = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1324
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")             # <<<<<<<<<<<<<<
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_s, __pyx_n_s__replace); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_k_tuple_29), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_v_s);
  __pyx_v_s = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":1325
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 *         if s.find(";") != -1:             # <<<<<<<<<<<<<<
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_s, __pyx_n_s__find); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_k_tuple_31), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_neg_1, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "example.pyx":1326
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")             # <<<<<<<<<<<<<<
 *             s = "[" + s + "]"
 *             return eval(s)
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_s, __pyx_n_s__replace); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_k_tuple_33), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_s);
    __pyx_v_s = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "example.pyx":1327
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"             # <<<<<<<<<<<<<<
 *             return eval(s)
 *         else:
 */
    __pyx_t_1 = PyNumber_Add(((PyObject *)__pyx_kp_s_25), __pyx_v_s); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyNumber_Add(__pyx_t_1, ((PyObject *)__pyx_kp_s_26)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_v_s);
    __pyx_v_s = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "example.pyx":1328
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 *             return eval(s)             # <<<<<<<<<<<<<<
 *         else:
 *             return eval(s)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_Globals(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    if (((PyObject *)__pyx_v_self)) {
      if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__self), ((PyObject *)__pyx_v_self)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    if (__pyx_v_s) {
      if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__s), __pyx_v_s) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_t_2));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
    PyTuple_SET_ITEM(__pyx_t_4, 2, ((PyObject *)__pyx_t_1));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(__pyx_builtin_eval, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L4;
  }
  /*else*/ {

    /* "example.pyx":1330
 *             return eval(s)
 *         else:
 *             return eval(s)             # <<<<<<<<<<<<<<
 * 
 *     def __hex__(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_Globals(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    if (((PyObject *)__pyx_v_self)) {
      if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__self), ((PyObject *)__pyx_v_self)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    if (__pyx_v_s) {
      if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__s), __pyx_v_s) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_t_1));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_t_4));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
    __pyx_t_1 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_builtin_eval, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
  __pyx_L4:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.gen.list_str", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_s);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_7example_3gen_95__hex__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_7example_3gen_94__hex__[] = "\n        Return the hexadecimal digits of self in lower case.\n\n        EXAMPLES::\n\n            sage: print hex(pari(0))\n            0\n            sage: print hex(pari(15))\n            f\n            sage: print hex(pari(16))\n            10\n            sage: print hex(pari(16938402384092843092843098243))\n            36bb1e3929d1a8fe2802f083\n            sage: print hex(long(16938402384092843092843098243))\n            0x36bb1e3929d1a8fe2802f083L\n            sage: print hex(pari(-16938402384092843092843098243))\n            -36bb1e3929d1a8fe2802f083\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_94__hex__;
#endif
static PyObject *__pyx_pw_7example_3gen_95__hex__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__hex__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_94__hex__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "example.pyx":1332
 *             return eval(s)
 * 
 *     def __hex__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the hexadecimal digits of self in lower case.
 */

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_94__hex__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_x;
  long __pyx_v_lx;
  long *__pyx_v_xp;
  long __pyx_v_w;
  char *__pyx_v_s;
  char *__pyx_v_sp;
  char *__pyx_v_hexdigits;
  CYTHON_UNUSED int __pyx_v_i;
  CYTHON_UNUSED int __pyx_v_j;
  int __pyx_v_size;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  long __pyx_t_3;
  size_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__hex__", 0);

  /* "example.pyx":1356
 *         cdef char *s, *sp
 *         cdef char *hexdigits
 *         hexdigits = "0123456789abcdef"             # <<<<<<<<<<<<<<
 *         cdef int i, j
 *         cdef int size
 */
  __pyx_v_hexdigits = __pyx_k__0123456789abcdef;

  /* "example.pyx":1359
 *         cdef int i, j
 *         cdef int size
 *         x = self.g             # <<<<<<<<<<<<<<
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"
 */
  __pyx_t_1 = __pyx_v_self->g;
  __pyx_v_x = __pyx_t_1;

  /* "example.pyx":1360
 *         cdef int size
 *         x = self.g
 *         if typ(x) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):
 */
  __pyx_t_2 = (typ(__pyx_v_x) != t_INT);
  if (__pyx_t_2) {

    /* "example.pyx":1361
 *         x = self.g
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"             # <<<<<<<<<<<<<<
 *         if not signe(x):
 *             return "0"
 */
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_34), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1362
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):             # <<<<<<<<<<<<<<
 *             return "0"
 *         lx = lgefint(x)-2  # number of words
 */
  __pyx_t_2 = (!signe(__pyx_v_x));
  if (__pyx_t_2) {

    /* "example.pyx":1363
 *             raise TypeError, "gen must be of PARI type t_INT"
 *         if not signe(x):
 *             return "0"             # <<<<<<<<<<<<<<
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_kp_s__0));
    __pyx_r = ((PyObject *)__pyx_kp_s__0);
    goto __pyx_L0;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "example.pyx":1364
 *         if not signe(x):
 *             return "0"
 *         lx = lgefint(x)-2  # number of words             # <<<<<<<<<<<<<<
 *         size = lx*2*sizeof(long)
 *         s = <char *>memmalloc(size+2) # 1 char for sign, 1 char for '\0'
 */
  __pyx_v_lx = (lgefint(__pyx_v_x) - 2);

  /* "example.pyx":1365
 *             return "0"
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)             # <<<<<<<<<<<<<<
 *         s = <char *>memmalloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1
 */
  __pyx_v_size = ((__pyx_v_lx * 2) * (sizeof(long)));

  /* "example.pyx":1366
 *         lx = lgefint(x)-2  # number of words
 *         size = lx*2*sizeof(long)
 *         s = <char *>memmalloc(size+2) # 1 char for sign, 1 char for '\0'             # <<<<<<<<<<<<<<
 *         sp = s + size+1
 *         sp[0] = 0
 */
  __pyx_v_s = ((char *)memmalloc((__pyx_v_size + 2)));

  /* "example.pyx":1367
 *         size = lx*2*sizeof(long)
 *         s = <char *>memmalloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1             # <<<<<<<<<<<<<<
 *         sp[0] = 0
 *         xp = int_LSW(x)
 */
  __pyx_v_sp = ((__pyx_v_s + __pyx_v_size) + 1);

  /* "example.pyx":1368
 *         s = <char *>memmalloc(size+2) # 1 char for sign, 1 char for '\0'
 *         sp = s + size+1
 *         sp[0] = 0             # <<<<<<<<<<<<<<
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:
 */
  (__pyx_v_sp[0]) = 0;

  /* "example.pyx":1369
 *         sp = s + size+1
 *         sp[0] = 0
 *         xp = int_LSW(x)             # <<<<<<<<<<<<<<
 *         for i from 0 <= i < lx:
 *             w = xp[0]
 */
  __pyx_v_xp = int_LSW(__pyx_v_x);

  /* "example.pyx":1370
 *         sp[0] = 0
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:             # <<<<<<<<<<<<<<
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):
 */
  __pyx_t_3 = __pyx_v_lx;
  for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_3; __pyx_v_i++) {

    /* "example.pyx":1371
 *         xp = int_LSW(x)
 *         for i from 0 <= i < lx:
 *             w = xp[0]             # <<<<<<<<<<<<<<
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1
 */
    __pyx_v_w = (__pyx_v_xp[0]);

    /* "example.pyx":1372
 *         for i from 0 <= i < lx:
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):             # <<<<<<<<<<<<<<
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]
 */
    __pyx_t_4 = (2 * (sizeof(long)));
    for (__pyx_v_j = 0; __pyx_v_j < __pyx_t_4; __pyx_v_j++) {

      /* "example.pyx":1373
 *             w = xp[0]
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1             # <<<<<<<<<<<<<<
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4
 */
      __pyx_v_sp = (__pyx_v_sp - 1);

      /* "example.pyx":1374
 *             for j from 0 <= j < 2*sizeof(long):
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]             # <<<<<<<<<<<<<<
 *                 w = w>>4
 *             xp = int_nextW(xp)
 */
      (__pyx_v_sp[0]) = (__pyx_v_hexdigits[(__pyx_v_w & 15)]);

      /* "example.pyx":1375
 *                 sp = sp-1
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4             # <<<<<<<<<<<<<<
 *             xp = int_nextW(xp)
 *         # remove leading zeros!
 */
      __pyx_v_w = (__pyx_v_w >> 4);
    }

    /* "example.pyx":1376
 *                 sp[0] = hexdigits[w & 15]
 *                 w = w>>4
 *             xp = int_nextW(xp)             # <<<<<<<<<<<<<<
 *         # remove leading zeros!
 *         while sp[0] == c'0':
 */
    __pyx_v_xp = int_nextW(__pyx_v_xp);
  }

  /* "example.pyx":1378
 *             xp = int_nextW(xp)
 *         # remove leading zeros!
 *         while sp[0] == c'0':             # <<<<<<<<<<<<<<
 *             sp = sp+1
 *         if signe(x) < 0:
 */
  while (1) {
    __pyx_t_2 = ((__pyx_v_sp[0]) == '0');
    if (!__pyx_t_2) break;

    /* "example.pyx":1379
 *         # remove leading zeros!
 *         while sp[0] == c'0':
 *             sp = sp+1             # <<<<<<<<<<<<<<
 *         if signe(x) < 0:
 *             sp = sp-1
 */
    __pyx_v_sp = (__pyx_v_sp + 1);
  }

  /* "example.pyx":1380
 *         while sp[0] == c'0':
 *             sp = sp+1
 *         if signe(x) < 0:             # <<<<<<<<<<<<<<
 *             sp = sp-1
 *             sp[0] = c'-'
 */
  __pyx_t_2 = (signe(__pyx_v_x) < 0);
  if (__pyx_t_2) {

    /* "example.pyx":1381
 *             sp = sp+1
 *         if signe(x) < 0:
 *             sp = sp-1             # <<<<<<<<<<<<<<
 *             sp[0] = c'-'
 *         k = <object>sp
 */
    __pyx_v_sp = (__pyx_v_sp - 1);

    /* "example.pyx":1382
 *         if signe(x) < 0:
 *             sp = sp-1
 *             sp[0] = c'-'             # <<<<<<<<<<<<<<
 *         k = <object>sp
 *         memfree(s)
 */
    (__pyx_v_sp[0]) = '-';
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "example.pyx":1383
 *             sp = sp-1
 *             sp[0] = c'-'
 *         k = <object>sp             # <<<<<<<<<<<<<<
 *         memfree(s)
 *         return k
 */
  __pyx_t_5 = PyBytes_FromString(__pyx_v_sp); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  __Pyx_INCREF(((PyObject *)__pyx_t_5));
  __pyx_v_k = ((PyObject *)__pyx_t_5);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;

  /* "example.pyx":1384
 *             sp[0] = c'-'
 *         k = <object>sp
 *         memfree(s)             # <<<<<<<<<<<<<<
 *         return k
 * 
 */
  memfree(__pyx_v_s);

  /* "example.pyx":1385
 *         k = <object>sp
 *         memfree(s)
 *         return k             # <<<<<<<<<<<<<<
 * 
 *     def __int__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_k);
  __pyx_r = __pyx_v_k;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("example.gen.__hex__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_97__int__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_7example_3gen_96__int__[] = "\n        Return Python int. Very fast, and if the number is too large to fit\n        into a C int, a Python long is returned instead.\n\n        EXAMPLES::\n\n            sage: int(pari(0))\n            0\n            sage: int(pari(10))\n            10\n            sage: int(pari(-10))\n            -10\n            sage: int(pari(123456789012345678901234567890))\n            123456789012345678901234567890L\n            sage: int(pari(-123456789012345678901234567890))\n            -123456789012345678901234567890L\n            sage: int(pari(2^31-1))\n            2147483647\n            sage: int(pari(-2^31))\n            -2147483648\n            sage: int(pari(\"Pol(10)\"))\n            10\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_96__int__;
#endif
static PyObject *__pyx_pw_7example_3gen_97__int__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__int__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_96__int__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1387
 *         return k
 * 
 *     def __int__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python int. Very fast, and if the number is too large to fit
 */

static PyObject *__pyx_pf_7example_3gen_96__int__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  GEN __pyx_v_x;
  long __pyx_v_lx;
  long *__pyx_v_xp;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  GEN __pyx_t_6;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__int__", 0);

  /* "example.pyx":1413
 *         cdef GEN x
 *         cdef long lx, *xp
 *         if  typ(self.g)==t_POL and self.poldegree()<=0:             # <<<<<<<<<<<<<<
 *             # Change a constant polynomial to its constant term
 *             x = constant_term(self.g)
 */
  __pyx_t_1 = (typ(__pyx_v_self->g) == t_POL);
  if (__pyx_t_1) {
    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__poldegree); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_int_0, Py_LE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __pyx_t_4;
  } else {
    __pyx_t_5 = __pyx_t_1;
  }
  if (__pyx_t_5) {

    /* "example.pyx":1415
 *         if  typ(self.g)==t_POL and self.poldegree()<=0:
 *             # Change a constant polynomial to its constant term
 *             x = constant_term(self.g)             # <<<<<<<<<<<<<<
 *         else:
 *             x = self.g
 */
    __pyx_v_x = constant_term(__pyx_v_self->g);
    goto __pyx_L3;
  }
  /*else*/ {

    /* "example.pyx":1417
 *             x = constant_term(self.g)
 *         else:
 *             x = self.g             # <<<<<<<<<<<<<<
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT or t_POL of degree 0"
 */
    __pyx_t_6 = __pyx_v_self->g;
    __pyx_v_x = __pyx_t_6;
  }
  __pyx_L3:;

  /* "example.pyx":1418
 *         else:
 *             x = self.g
 *         if typ(x) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "gen must be of PARI type t_INT or t_POL of degree 0"
 *         if not signe(x):
 */
  __pyx_t_5 = (typ(__pyx_v_x) != t_INT);
  if (__pyx_t_5) {

    /* "example.pyx":1419
 *             x = self.g
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT or t_POL of degree 0"             # <<<<<<<<<<<<<<
 *         if not signe(x):
 *             return 0
 */
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_35), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "example.pyx":1420
 *         if typ(x) != t_INT:
 *             raise TypeError, "gen must be of PARI type t_INT or t_POL of degree 0"
 *         if not signe(x):             # <<<<<<<<<<<<<<
 *             return 0
 *         lx = lgefint(x)-3   # take 1 to account for the MSW
 */
  __pyx_t_5 = (!signe(__pyx_v_x));
  if (__pyx_t_5) {

    /* "example.pyx":1421
 *             raise TypeError, "gen must be of PARI type t_INT or t_POL of degree 0"
 *         if not signe(x):
 *             return 0             # <<<<<<<<<<<<<<
 *         lx = lgefint(x)-3   # take 1 to account for the MSW
 *         xp = int_MSW(x)
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "example.pyx":1422
 *         if not signe(x):
 *             return 0
 *         lx = lgefint(x)-3   # take 1 to account for the MSW             # <<<<<<<<<<<<<<
 *         xp = int_MSW(x)
 *         # special case 1 word so we return int if it fits
 */
  __pyx_v_lx = (lgefint(__pyx_v_x) - 3);

  /* "example.pyx":1423
 *             return 0
 *         lx = lgefint(x)-3   # take 1 to account for the MSW
 *         xp = int_MSW(x)             # <<<<<<<<<<<<<<
 *         # special case 1 word so we return int if it fits
 *         if not lx:
 */
  __pyx_v_xp = int_MSW(__pyx_v_x);

  /* "example.pyx":1425
 *         xp = int_MSW(x)
 *         # special case 1 word so we return int if it fits
 *         if not lx:             # <<<<<<<<<<<<<<
 *             if   signe(x) |  xp[0] > 0:     # both positive
 *                 return xp[0]
 */
  __pyx_t_5 = (!__pyx_v_lx);
  if (__pyx_t_5) {

    /* "example.pyx":1426
 *         # special case 1 word so we return int if it fits
 *         if not lx:
 *             if   signe(x) |  xp[0] > 0:     # both positive             # <<<<<<<<<<<<<<
 *                 return xp[0]
 *             elif signe(x) & -xp[0] < 0:     # both negative
 */
    __pyx_t_5 = ((signe(__pyx_v_x) | (__pyx_v_xp[0])) > 0);
    if (__pyx_t_5) {

      /* "example.pyx":1427
 *         if not lx:
 *             if   signe(x) |  xp[0] > 0:     # both positive
 *                 return xp[0]             # <<<<<<<<<<<<<<
 *             elif signe(x) & -xp[0] < 0:     # both negative
 *                 return -xp[0]
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyInt_FromLong((__pyx_v_xp[0])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L7;
    }

    /* "example.pyx":1428
 *             if   signe(x) |  xp[0] > 0:     # both positive
 *                 return xp[0]
 *             elif signe(x) & -xp[0] < 0:     # both negative             # <<<<<<<<<<<<<<
 *                 return -xp[0]
 *         i = <ulong>xp[0]
 */
    __pyx_t_5 = ((signe(__pyx_v_x) & (-(__pyx_v_xp[0]))) < 0);
    if (__pyx_t_5) {

      /* "example.pyx":1429
 *                 return xp[0]
 *             elif signe(x) & -xp[0] < 0:     # both negative
 *                 return -xp[0]             # <<<<<<<<<<<<<<
 *         i = <ulong>xp[0]
 *         while lx:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyInt_FromLong((-(__pyx_v_xp[0]))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L7;
    }
    __pyx_L7:;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "example.pyx":1430
 *             elif signe(x) & -xp[0] < 0:     # both negative
 *                 return -xp[0]
 *         i = <ulong>xp[0]             # <<<<<<<<<<<<<<
 *         while lx:
 *             xp = int_precW(xp)
 */
  __pyx_t_2 = PyLong_FromUnsignedLong(((__pyx_t_7example_ulong)(__pyx_v_xp[0]))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_i = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "example.pyx":1431
 *                 return -xp[0]
 *         i = <ulong>xp[0]
 *         while lx:             # <<<<<<<<<<<<<<
 *             xp = int_precW(xp)
 *             i = i << BITS_IN_LONG | <ulong>xp[0]
 */
  while (1) {
    if (!__pyx_v_lx) break;

    /* "example.pyx":1432
 *         i = <ulong>xp[0]
 *         while lx:
 *             xp = int_precW(xp)             # <<<<<<<<<<<<<<
 *             i = i << BITS_IN_LONG | <ulong>xp[0]
 *             lx = lx-1
 */
    __pyx_v_xp = int_precW(__pyx_v_xp);

    /* "example.pyx":1433
 *         while lx:
 *             xp = int_precW(xp)
 *             i = i << BITS_IN_LONG | <ulong>xp[0]             # <<<<<<<<<<<<<<
 *             lx = lx-1
 *         if signe(x) > 0:
 */
    __pyx_t_2 = PyInt_FromLong(BITS_IN_LONG); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyNumber_Lshift(__pyx_v_i, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyLong_FromUnsignedLong(((__pyx_t_7example_ulong)(__pyx_v_xp[0]))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = PyNumber_Or(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "example.pyx":1434
 *             xp = int_precW(xp)
 *             i = i << BITS_IN_LONG | <ulong>xp[0]
 *             lx = lx-1             # <<<<<<<<<<<<<<
 *         if signe(x) > 0:
 *             return i
 */
    __pyx_v_lx = (__pyx_v_lx - 1);
  }

  /* "example.pyx":1435
 *             i = i << BITS_IN_LONG | <ulong>xp[0]
 *             lx = lx-1
 *         if signe(x) > 0:             # <<<<<<<<<<<<<<
 *             return i
 *         else:
 */
  __pyx_t_5 = (signe(__pyx_v_x) > 0);
  if (__pyx_t_5) {

    /* "example.pyx":1436
 *             lx = lx-1
 *         if signe(x) > 0:
 *             return i             # <<<<<<<<<<<<<<
 *         else:
 *             return -i
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_i);
    __pyx_r = __pyx_v_i;
    goto __pyx_L0;
    goto __pyx_L10;
  }
  /*else*/ {

    /* "example.pyx":1438
 *             return i
 *         else:
 *             return -i             # <<<<<<<<<<<<<<
 *         # NOTE: Could use int_unsafe below, which would be much faster, but
 *         # the default PARI prints annoying stuff to the screen when
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_7 = PyNumber_Negative(__pyx_v_i); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
  }
  __pyx_L10:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("example.gen.__int__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_99int_unsafe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_98int_unsafe[] = "\n        Returns int form of self, but raises an exception if int does not\n        fit into a long integer.\n\n        This is about 5 times faster than the usual int conversion.\n        ";
static PyObject *__pyx_pw_7example_3gen_99int_unsafe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("int_unsafe (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_98int_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1443
 *         # the number is large.
 * 
 *     def int_unsafe(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns int form of self, but raises an exception if int does not
 */

static PyObject *__pyx_pf_7example_3gen_98int_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("int_unsafe", 0);

  /* "example.pyx":1450
 *         This is about 5 times faster than the usual int conversion.
 *         """
 *         return gtolong(self.g)             # <<<<<<<<<<<<<<
 * 
 *     def intvec_unsafe(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(gtolong(__pyx_v_self->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.int_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_101intvec_unsafe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_100intvec_unsafe[] = "\n        Returns Python int list form of entries of self, but raises an\n        exception if int does not fit into a long integer. Here self must\n        be a vector.\n\n        EXAMPLES::\n\n            sage: pari('[3,4,5]').type()\n            't_VEC'\n            sage: pari('[3,4,5]').intvec_unsafe()\n            [3, 4, 5]\n            sage: type(pari('[3,4,5]').intvec_unsafe()[0])\n            <type 'int'>\n\n        TESTS::\n\n            sage: pari(3).intvec_unsafe()\n            Traceback (most recent call last):\n            ...\n            TypeError: gen must be of PARI type t_VEC\n            sage: pari('[2^150,1]').intvec_unsafe()\n            Traceback (most recent call last):\n            ...\n            PariError:  (15)\n        ";
static PyObject *__pyx_pw_7example_3gen_101intvec_unsafe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("intvec_unsafe (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_100intvec_unsafe(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1452
 *         return gtolong(self.g)
 * 
 *     def intvec_unsafe(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns Python int list form of entries of self, but raises an
 */

static PyObject *__pyx_pf_7example_3gen_100intvec_unsafe(struct __pyx_obj_7example_gen *__pyx_v_self) {
  int __pyx_v_n;
  int __pyx_v_L;
  PyObject *__pyx_v_v = 0;
  GEN __pyx_v_g;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  GEN __pyx_t_1;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("intvec_unsafe", 0);

  /* "example.pyx":1481
 *         cdef object v
 *         cdef GEN g
 *         g = self.g             # <<<<<<<<<<<<<<
 *         if typ(g) != t_VEC:
 *             raise TypeError, "gen must be of PARI type t_VEC"
 */
  __pyx_t_1 = __pyx_v_self->g;
  __pyx_v_g = __pyx_t_1;

  /* "example.pyx":1482
 *         cdef GEN g
 *         g = self.g
 *         if typ(g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "gen must be of PARI type t_VEC"
 * 
 */
  __pyx_t_2 = (typ(__pyx_v_g) != t_VEC);
  if (__pyx_t_2) {

    /* "example.pyx":1483
 *         g = self.g
 *         if typ(g) != t_VEC:
 *             raise TypeError, "gen must be of PARI type t_VEC"             # <<<<<<<<<<<<<<
 * 
 *         sig_on()
 */
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_36), 0, 0);
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1485
 *             raise TypeError, "gen must be of PARI type t_VEC"
 * 
 *         sig_on()             # <<<<<<<<<<<<<<
 *         L = glength(g)
 *         v = []
 */
  __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1486
 * 
 *         sig_on()
 *         L = glength(g)             # <<<<<<<<<<<<<<
 *         v = []
 *         for n from 0 <= n < L:
 */
  __pyx_v_L = glength(__pyx_v_g);

  /* "example.pyx":1487
 *         sig_on()
 *         L = glength(g)
 *         v = []             # <<<<<<<<<<<<<<
 *         for n from 0 <= n < L:
 *             v.append(gtolong(<GEN> (g[n+1])))
 */
  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_v_v = ((PyObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "example.pyx":1488
 *         L = glength(g)
 *         v = []
 *         for n from 0 <= n < L:             # <<<<<<<<<<<<<<
 *             v.append(gtolong(<GEN> (g[n+1])))
 *         sig_off()
 */
  __pyx_t_3 = __pyx_v_L;
  for (__pyx_v_n = 0; __pyx_v_n < __pyx_t_3; __pyx_v_n++) {

    /* "example.pyx":1489
 *         v = []
 *         for n from 0 <= n < L:
 *             v.append(gtolong(<GEN> (g[n+1])))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return v
 */
    __pyx_t_4 = PyInt_FromLong(gtolong(((GEN)(__pyx_v_g[(__pyx_v_n + 1)])))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyObject_Append(__pyx_v_v, __pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }

  /* "example.pyx":1490
 *         for n from 0 <= n < L:
 *             v.append(gtolong(<GEN> (g[n+1])))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1491
 *             v.append(gtolong(<GEN> (g[n+1])))
 *         sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def python_list_small(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_v);
  __pyx_r = __pyx_v_v;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("example.gen.intvec_unsafe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_103python_list_small(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_102python_list_small[] = "\n        Return a Python list of the PARI gens. This object must be of type\n        t_VECSMALL, and the resulting list contains python 'int's\n\n        EXAMPLES::\n\n            sage: v=pari([1,2,3,10,102,10]).Vecsmall()\n            sage: w = v.python_list_small()\n            sage: w\n            [1, 2, 3, 10, 102, 10]\n            sage: type(w[0])\n            <type 'int'>\n        ";
static PyObject *__pyx_pw_7example_3gen_103python_list_small(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("python_list_small (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_102python_list_small(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1493
 *         return v
 * 
 *     def python_list_small(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

static PyObject *__pyx_pf_7example_3gen_102python_list_small(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_n;
  PyObject *__pyx_v_V = NULL;
  long __pyx_v_m;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  long __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("python_list_small", 0);

  /* "example.pyx":1508
 *         """
 *         cdef long n
 *         if typ(self.g) != t_VECSMALL:             # <<<<<<<<<<<<<<
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []
 */
  __pyx_t_1 = (typ(__pyx_v_self->g) != t_VECSMALL);
  if (__pyx_t_1) {

    /* "example.pyx":1509
 *         cdef long n
 *         if typ(self.g) != t_VECSMALL:
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self             # <<<<<<<<<<<<<<
 *         V = []
 *         m = glength(self.g)
 */
    __pyx_t_2 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_37), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_2), 0, 0);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1510
 *         if typ(self.g) != t_VECSMALL:
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []             # <<<<<<<<<<<<<<
 *         m = glength(self.g)
 *         for n from 0 <= n < m:
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_V = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "example.pyx":1511
 *             raise TypeError, "Object (=%s) must be of type t_VECSMALL."%self
 *         V = []
 *         m = glength(self.g)             # <<<<<<<<<<<<<<
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])
 */
  __pyx_v_m = glength(__pyx_v_self->g);

  /* "example.pyx":1512
 *         V = []
 *         m = glength(self.g)
 *         for n from 0 <= n < m:             # <<<<<<<<<<<<<<
 *             V.append(self.g[n+1])
 *         return V
 */
  __pyx_t_3 = __pyx_v_m;
  for (__pyx_v_n = 0; __pyx_v_n < __pyx_t_3; __pyx_v_n++) {

    /* "example.pyx":1513
 *         m = glength(self.g)
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])             # <<<<<<<<<<<<<<
 *         return V
 * 
 */
    __pyx_t_2 = PyInt_FromLong((__pyx_v_self->g[(__pyx_v_n + 1)])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyList_Append(__pyx_v_V, __pyx_t_2); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  }

  /* "example.pyx":1514
 *         for n from 0 <= n < m:
 *             V.append(self.g[n+1])
 *         return V             # <<<<<<<<<<<<<<
 * 
 *     def python_list(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_V));
  __pyx_r = ((PyObject *)__pyx_v_V);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.python_list_small", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_V);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_105python_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_104python_list[] = "\n        Return a Python list of the PARI gens. This object must be of type\n        t_VEC\n\n        INPUT: NoneOUTPUT:\n\n\n        -  ``list`` - Python list whose elements are the\n           elements of the input gen.\n\n\n        EXAMPLES::\n\n            sage: v=pari([1,2,3,10,102,10])\n            sage: w = v.python_list()\n            sage: w\n            [1, 2, 3, 10, 102, 10]\n            sage: type(w[0])\n            <type 'sage.libs.pari.gen.gen'>\n            sage: pari(\"[1,2,3]\").python_list()\n            [1, 2, 3]\n        ";
static PyObject *__pyx_pw_7example_3gen_105python_list(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("python_list (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_104python_list(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1516
 *         return V
 * 
 *     def python_list(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a Python list of the PARI gens. This object must be of type
 */

static PyObject *__pyx_pf_7example_3gen_104python_list(struct __pyx_obj_7example_gen *__pyx_v_self) {
  long __pyx_v_n;
  long __pyx_v_m;
  PyObject *__pyx_v_V = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  long __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("python_list", 0);

  /* "example.pyx":1542
 *         cdef gen t
 * 
 *         if typ(self.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)
 */
  __pyx_t_1 = (typ(__pyx_v_self->g) != t_VEC);
  if (__pyx_t_1) {

    /* "example.pyx":1543
 * 
 *         if typ(self.g) != t_VEC:
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self             # <<<<<<<<<<<<<<
 *         m = glength(self.g)
 *         V = []
 */
    __pyx_t_2 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_38), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_2), 0, 0);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "example.pyx":1544
 *         if typ(self.g) != t_VEC:
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)             # <<<<<<<<<<<<<<
 *         V = []
 *         for n from 0 <= n < m:
 */
  __pyx_v_m = glength(__pyx_v_self->g);

  /* "example.pyx":1545
 *             raise TypeError, "Object (=%s) must be of type t_VEC."%self
 *         m = glength(self.g)
 *         V = []             # <<<<<<<<<<<<<<
 *         for n from 0 <= n < m:
 * ##            t = P.new_ref(<GEN> (self.g[n+1]), V)
 */
  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1545; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_V = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "example.pyx":1546
 *         m = glength(self.g)
 *         V = []
 *         for n from 0 <= n < m:             # <<<<<<<<<<<<<<
 * ##            t = P.new_ref(<GEN> (self.g[n+1]), V)
 * ##            V.append(t)
 */
  __pyx_t_3 = __pyx_v_m;
  for (__pyx_v_n = 0; __pyx_v_n < __pyx_t_3; __pyx_v_n++) {

    /* "example.pyx":1549
 * ##            t = P.new_ref(<GEN> (self.g[n+1]), V)
 * ##            V.append(t)
 *             V.append(self.__getitem__(n))             # <<<<<<<<<<<<<<
 *         return V
 * 
 */
    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s____getitem__); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_6 = PyList_Append(__pyx_v_V, __pyx_t_4); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }

  /* "example.pyx":1550
 * ##            V.append(t)
 *             V.append(self.__getitem__(n))
 *         return V             # <<<<<<<<<<<<<<
 * 
 *     #def python(self, locals=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_V));
  __pyx_r = ((PyObject *)__pyx_v_V);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("example.gen.python_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_V);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pw_7example_3gen_107__long__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_7example_3gen_106__long__[] = "\n        Return Python long.\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_106__long__;
#endif
static PyObject *__pyx_pw_7example_3gen_107__long__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__long__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_106__long__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* "example.pyx":1611
 * #_sage_ = _eval_ = python
 * 
 *     def __long__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python long.
 */

#if PY_MAJOR_VERSION < 3
static PyObject *__pyx_pf_7example_3gen_106__long__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__long__", 0);

  /* "example.pyx":1615
 *         Return Python long.
 *         """
 *         return long(int(self))             # <<<<<<<<<<<<<<
 * 
 *     def __float__(gen self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1615; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_self));
  PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1615; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1615; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyLong_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1615; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__long__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
#endif /*!(#if PY_MAJOR_VERSION < 3)*/

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_109__float__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_7example_3gen_108__float__[] = "\n        Return Python float.\n        ";
#if CYTHON_COMPILING_IN_CPYTHON
struct wrapperbase __pyx_wrapperbase_7example_3gen_108__float__;
#endif
static PyObject *__pyx_pw_7example_3gen_109__float__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__float__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_108__float__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1617
 *         return long(int(self))
 * 
 *     def __float__(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return Python float.
 */

static PyObject *__pyx_pf_7example_3gen_108__float__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  double __pyx_v_d;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__float__", 0);

  /* "example.pyx":1622
 *         """
 *         cdef double d
 *         sig_on()             # <<<<<<<<<<<<<<
 *         d = gtodouble(self.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1623
 *         cdef double d
 *         sig_on()
 *         d = gtodouble(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return d
 */
  __pyx_v_d = gtodouble(__pyx_v_self->g);

  /* "example.pyx":1624
 *         sig_on()
 *         d = gtodouble(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return d
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1625
 *         d = gtodouble(self.g)
 *         sig_off()
 *         return d             # <<<<<<<<<<<<<<
 * 
 *     def __complex__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_d); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.__float__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_111__complex__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_110__complex__[] = "\n        Return ``self`` as a Python ``complex``\n        value.\n\n        EXAMPLES::\n\n            sage: g = pari(-1.0)^(1/5); g\n            0.809016994374947 + 0.587785252292473*I\n            sage: g.__complex__()\n            (0.8090169943749475+0.5877852522924731j)\n            sage: complex(g)\n            (0.8090169943749475+0.5877852522924731j)\n\n        ::\n\n            sage: g = pari(Integers(5)(3)); g\n            Mod(3, 5)\n            sage: complex(g)\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
static PyObject *__pyx_pw_7example_3gen_111__complex__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__complex__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_110__complex__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1627
 *         return d
 * 
 *     def __complex__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return ``self`` as a Python ``complex``
 */

static PyObject *__pyx_pf_7example_3gen_110__complex__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  double __pyx_v_re;
  double __pyx_v_im;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__complex__", 0);

  /* "example.pyx":1651
 *         """
 *         cdef double re, im
 *         sig_on()             # <<<<<<<<<<<<<<
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1652
 *         cdef double re, im
 *         sig_on()
 *         re = gtodouble(greal(self.g))             # <<<<<<<<<<<<<<
 *         im = gtodouble(gimag(self.g))
 *         sig_off()
 */
  __pyx_v_re = gtodouble(greal(__pyx_v_self->g));

  /* "example.pyx":1653
 *         sig_on()
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return complex(re, im)
 */
  __pyx_v_im = gtodouble(gimag(__pyx_v_self->g));

  /* "example.pyx":1654
 *         re = gtodouble(greal(self.g))
 *         im = gtodouble(gimag(self.g))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return complex(re, im)
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1655
 *         im = gtodouble(gimag(self.g))
 *         sig_off()
 *         return complex(re, im)             # <<<<<<<<<<<<<<
 * 
 *     def __nonzero__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_re); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_im); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_7complex_complex)), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("example.gen.__complex__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_7example_3gen_113__nonzero__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_7example_3gen_113__nonzero__(PyObject *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__nonzero__ (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_112__nonzero__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1657
 *         return complex(re, im)
 * 
 *     def __nonzero__(self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

static int __pyx_pf_7example_3gen_112__nonzero__(struct __pyx_obj_7example_gen *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__nonzero__", 0);

  /* "example.pyx":1671
 *             False
 *         """
 *         return not gequal0(self.g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = (!gequal0(__pyx_v_self->g));
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_115gequal(PyObject *__pyx_v_a, PyObject *__pyx_v_b); /*proto*/
static char __pyx_doc_7example_3gen_114gequal[] = "\n        Check whether `a` and `b` are equal using PARI's ``gequal``.\n\n        EXAMPLES::\n\n            sage: a = pari(1); b = pari(1.0); c = pari('\"some_string\"')\n            sage: a.gequal(a)\n            True\n            sage: b.gequal(b)\n            True\n            sage: c.gequal(c)\n            True\n            sage: a.gequal(b)\n            True\n            sage: a.gequal(c)\n            False\n\n        WARNING: this relation is not transitive::\n\n            sage: a = pari('[0]'); b = pari(0); c = pari('[0,0]')\n            sage: a.gequal(b)\n            True\n            sage: b.gequal(c)\n            True\n            sage: a.gequal(c)\n            False\n        ";
static PyObject *__pyx_pw_7example_3gen_115gequal(PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_114gequal(((struct __pyx_obj_7example_gen *)__pyx_v_a), ((PyObject *)__pyx_v_b));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1678
 *     ###########################################
 * 
 *     def gequal(gen a, b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` and `b` are equal using PARI's ``gequal``.
 */

static PyObject *__pyx_pf_7example_3gen_114gequal(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b) {
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal", 0);

  /* "example.pyx":1706
 *             False
 *         """
 *         t0GEN(b)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         cdef int ret = gequal(a.g, t0)
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":1707
 *         """
 *         t0GEN(b)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequal(a.g, t0)
 *         sig_off()
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1708
 *         t0GEN(b)
 *         sig_on()
 *         cdef int ret = gequal(a.g, t0)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequal(__pyx_v_a->g, __pyx_v_7example_t0);

  /* "example.pyx":1709
 *         sig_on()
 *         cdef int ret = gequal(a.g, t0)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1710
 *         cdef int ret = gequal(a.g, t0)
 *         sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 *     def gequal0(gen a):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.gequal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_117gequal0(PyObject *__pyx_v_a, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_116gequal0[] = "\n        Check whether `a` is equal to zero.\n\n        EXAMPLES::\n\n            sage: pari(0).gequal0()\n            True\n            sage: pari(1).gequal0()\n            False\n            sage: pari(1e-100).gequal0()\n            False\n            sage: pari(\"0.0 + 0.0*I\").gequal0()\n            True\n            sage: pari(GF(3^20,'t')(0)).gequal0()\n            True\n        ";
static PyObject *__pyx_pw_7example_3gen_117gequal0(PyObject *__pyx_v_a, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal0 (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_116gequal0(((struct __pyx_obj_7example_gen *)__pyx_v_a));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1712
 *         return ret != 0
 * 
 *     def gequal0(gen a):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to zero.
 */

static PyObject *__pyx_pf_7example_3gen_116gequal0(struct __pyx_obj_7example_gen *__pyx_v_a) {
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal0", 0);

  /* "example.pyx":1729
 *             True
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequal0(a.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1730
 *         """
 *         sig_on()
 *         cdef int ret = gequal0(a.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequal0(__pyx_v_a->g);

  /* "example.pyx":1731
 *         sig_on()
 *         cdef int ret = gequal0(a.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1732
 *         cdef int ret = gequal0(a.g)
 *         sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 *     def gequal_long(gen a, long b):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.gequal0", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_119gequal_long(PyObject *__pyx_v_a, PyObject *__pyx_arg_b); /*proto*/
static char __pyx_doc_7example_3gen_118gequal_long[] = "\n        Check whether `a` is equal to the ``long int`` `b` using PARI's ``gequalsg``.\n\n        EXAMPLES::\n\n            sage: a = pari(1); b = pari(2.0); c = pari('3*matid(3)')\n            sage: a.gequal_long(1)\n            True\n            sage: a.gequal_long(-1)\n            False\n            sage: a.gequal_long(0)\n            False\n            sage: b.gequal_long(2)\n            True\n            sage: b.gequal_long(-2)\n            False\n            sage: c.gequal_long(3)\n            True\n            sage: c.gequal_long(-3)\n            False\n        ";
static PyObject *__pyx_pw_7example_3gen_119gequal_long(PyObject *__pyx_v_a, PyObject *__pyx_arg_b) {
  long __pyx_v_b;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("gequal_long (wrapper)", 0);
  assert(__pyx_arg_b); {
    __pyx_v_b = __Pyx_PyInt_AsLong(__pyx_arg_b); if (unlikely((__pyx_v_b == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1734; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.gequal_long", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_118gequal_long(((struct __pyx_obj_7example_gen *)__pyx_v_a), ((long)__pyx_v_b));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1734
 *         return ret != 0
 * 
 *     def gequal_long(gen a, long b):             # <<<<<<<<<<<<<<
 *         r"""
 *         Check whether `a` is equal to the ``long int`` `b` using PARI's ``gequalsg``.
 */

static PyObject *__pyx_pf_7example_3gen_118gequal_long(struct __pyx_obj_7example_gen *__pyx_v_a, long __pyx_v_b) {
  int __pyx_v_ret;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("gequal_long", 0);

  /* "example.pyx":1756
 *             False
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef int ret = gequalsg(b, a.g)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1757
 *         """
 *         sig_on()
 *         cdef int ret = gequalsg(b, a.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return ret != 0
 */
  __pyx_v_ret = gequalsg(__pyx_v_b, __pyx_v_a->g);

  /* "example.pyx":1758
 *         sig_on()
 *         cdef int ret = gequalsg(b, a.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return ret != 0
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1759
 *         cdef int ret = gequalsg(b, a.g)
 *         sig_off()
 *         return ret != 0             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyBool_FromLong((__pyx_v_ret != 0)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.gequal_long", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_121isprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_120isprime[] = "\n        isprime(x, flag=0): Returns True if x is a PROVEN prime number, and\n        False otherwise.\n\n        INPUT:\n\n\n        -  ``flag`` - int 0 (default): use a combination of\n           algorithms. 1: certify primality using the Pocklington-Lehmer Test.\n           2: certify primality using the APRCL test.\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - True or False\n\n\n        EXAMPLES::\n\n            sage: pari(9).isprime()\n            False\n            sage: pari(17).isprime()\n            True\n            sage: n = pari(561)    # smallest Carmichael number\n            sage: n.isprime()      # not just a pseudo-primality test!\n            False\n            sage: n.isprime(1)\n            False\n            sage: n.isprime(2)\n            False\n        ";
static PyObject *__pyx_pw_7example_3gen_121isprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("isprime (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "isprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1765; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_flag = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("isprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1765; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.isprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_120isprime(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1765
 *     # arith1.c
 *     ###########################################
 *     def isprime(gen self, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         isprime(x, flag=0): Returns True if x is a PROVEN prime number, and
 */

static PyObject *__pyx_pf_7example_3gen_120isprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
  int __pyx_v_t;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  long __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("isprime", 0);

  /* "example.pyx":1799
 *         """
 *         cdef bint t
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t = (signe(gisprime(self.g, flag)) != 0)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1800
 *         cdef bint t
 *         sig_on()
 *         t = (signe(gisprime(self.g, flag)) != 0)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return t
 */
  __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_t = (signe(gisprime(__pyx_v_self->g, __pyx_t_2)) != 0);

  /* "example.pyx":1801
 *         sig_on()
 *         t = (signe(gisprime(self.g, flag)) != 0)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return t
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1802
 *         t = (signe(gisprime(self.g, flag)) != 0)
 *         sig_off()
 *         return t             # <<<<<<<<<<<<<<
 * 
 *     def qfbhclassno(gen n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyBool_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.isprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_123qfbhclassno(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_122qfbhclassno[] = "\n        Computes the Hurwitz-Kronecker class number of `n`.\n\n        INPUT:\n\n        - `n` (gen) -- a non-negative integer\n\n        .. note::\n\n           If `n` is large (more than `5*10^5`), the result is\n           conditional upon GRH.\n\n        EXAMPLES:\n\n        The Hurwitx class number is 0 is n is congruent to 1 or 2 modulo 4::\n            sage: pari(-10007).qfbhclassno()\n            0\n            sage: pari(-2).qfbhclassno()\n            0\n\n        It is -1/12 for n=0::\n\n            sage: pari(0).qfbhclassno()\n            -1/12\n\n        Otherwise it is the number of classes of positive definite\n        binary quadratic forms with discriminant `-n`, weighted by\n        `1/m` where `m` is the number of automorphisms of the form::\n\n            sage: pari(4).qfbhclassno()\n            1/2\n            sage: pari(3).qfbhclassno()\n            1/3\n            sage: pari(23).qfbhclassno()\n            3\n\n        ";
static PyObject *__pyx_pw_7example_3gen_123qfbhclassno(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("qfbhclassno (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_122qfbhclassno(((struct __pyx_obj_7example_gen *)__pyx_v_n));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1804
 *         return t
 * 
 *     def qfbhclassno(gen n):             # <<<<<<<<<<<<<<
 *         r"""
 *         Computes the Hurwitz-Kronecker class number of `n`.
 */

static PyObject *__pyx_pf_7example_3gen_122qfbhclassno(struct __pyx_obj_7example_gen *__pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("qfbhclassno", 0);

  /* "example.pyx":1842
 * 
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hclassno(n.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1843
 *         """
 *         sig_on()
 *         return P.new_gen(hclassno(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def ispseudoprime(gen self, flag=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, hclassno(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.qfbhclassno", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_125ispseudoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_124ispseudoprime[] = "\n        ispseudoprime(x, flag=0): Returns True if x is a pseudo-prime\n        number, and False otherwise.\n\n        INPUT:\n\n\n        -  ``flag`` - int 0 (default): checks whether x is a\n           Baillie-Pomerance-Selfridge-Wagstaff pseudo prime (strong\n           Rabin-Miller pseudo prime for base 2, followed by strong Lucas test\n           for the sequence (P,-1), P smallest positive integer such that\n           `P^2 - 4` is not a square mod x). 0: checks whether x is a\n           strong Miller-Rabin pseudo prime for flag randomly chosen bases\n           (with end-matching to catch square roots of -1).\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - True or False\n\n\n        EXAMPLES::\n\n            sage: pari(9).ispseudoprime()\n            False\n            sage: pari(17).ispseudoprime()\n            True\n            sage: n = pari(561)     # smallest Carmichael number\n            sage: n.ispseudoprime(2)\n            False\n        ";
static PyObject *__pyx_pw_7example_3gen_125ispseudoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_flag = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ispseudoprime (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ispseudoprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_flag = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("ispseudoprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1845; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.ispseudoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_124ispseudoprime(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1845
 *         return P.new_gen(hclassno(n.g))
 * 
 *     def ispseudoprime(gen self, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         ispseudoprime(x, flag=0): Returns True if x is a pseudo-prime
 */

static PyObject *__pyx_pf_7example_3gen_124ispseudoprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
  long __pyx_v_z;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  long __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("ispseudoprime", 0);

  /* "example.pyx":1879
 *         """
 *         cdef long z
 *         sig_on()             # <<<<<<<<<<<<<<
 *         z = ispseudoprime(self.g, flag)
 *         sig_off()
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1879; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1880
 *         cdef long z
 *         sig_on()
 *         z = ispseudoprime(self.g, flag)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return (z != 0)
 */
  __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_z = ispseudoprime(__pyx_v_self->g, __pyx_t_2);

  /* "example.pyx":1881
 *         sig_on()
 *         z = ispseudoprime(self.g, flag)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return (z != 0)
 * 
 */
  _pari_sig_off();

  /* "example.pyx":1882
 *         z = ispseudoprime(self.g, flag)
 *         sig_off()
 *         return (z != 0)             # <<<<<<<<<<<<<<
 * 
 *     def ispower(gen self, k=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyBool_FromLong((__pyx_v_z != 0)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.ispseudoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_127ispower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_126ispower[] = "\n        Determine whether or not self is a perfect k-th power. If k is not\n        specified, find the largest k so that self is a k-th power.\n\n        .. note:::\n\n           There is a BUG in the PARI C-library function (at least in\n           PARI 2.2.12-beta) that is used to implement this function! This is\n           in GP::\n\n              ? p=nextprime(10^100); n=p^100; m=p^2; m^50==n; ispower(n,50)\n\n\n        INPUT:\n\n\n        -  ``k`` - int (optional)\n\n\n        OUTPUT:\n\n\n        -  ``power`` - int, what power it is\n\n        -  ``g`` - what it is a power of\n\n\n        EXAMPLES::\n\n            sage: pari(9).ispower()\n            (2, 3)\n            sage: pari(17).ispower()\n            (1, 17)\n            sage: pari(17).ispower(2)\n            (False, None)\n            sage: pari(17).ispower(1)\n            (1, 17)\n            sage: pari(2).ispower()\n            (1, 2)\n        ";
static PyObject *__pyx_pw_7example_3gen_127ispower(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_k = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ispower (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,0};
    PyObject* values[1] = {0};

    /* "example.pyx":1884
 *         return (z != 0)
 * 
 *     def ispower(gen self, k=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         Determine whether or not self is a perfect k-th power. If k is not
 */
    values[0] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ispower") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1884; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_k = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("ispower", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1884; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.ispower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_126ispower(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_k);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_7example_3gen_126ispower(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_k) {
  int __pyx_v_n;
  GEN __pyx_v_x;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("ispower", 0);
  __Pyx_INCREF(__pyx_v_k);

  /* "example.pyx":1928
 *         cdef GEN x
 * 
 *         if k is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             n = gisanypower(self.g, &x)
 */
  __pyx_t_1 = (__pyx_v_k == Py_None);
  if (__pyx_t_1) {

    /* "example.pyx":1929
 * 
 *         if k is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             n = gisanypower(self.g, &x)
 *             if n == 0:
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1929; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":1930
 *         if k is None:
 *             sig_on()
 *             n = gisanypower(self.g, &x)             # <<<<<<<<<<<<<<
 *             if n == 0:
 *                 sig_off()
 */
    __pyx_v_n = gisanypower(__pyx_v_self->g, (&__pyx_v_x));

    /* "example.pyx":1931
 *             sig_on()
 *             n = gisanypower(self.g, &x)
 *             if n == 0:             # <<<<<<<<<<<<<<
 *                 sig_off()
 *                 return 1, self
 */
    __pyx_t_1 = (__pyx_v_n == 0);
    if (__pyx_t_1) {

      /* "example.pyx":1932
 *             n = gisanypower(self.g, &x)
 *             if n == 0:
 *                 sig_off()             # <<<<<<<<<<<<<<
 *                 return 1, self
 *             else:
 */
      _pari_sig_off();

      /* "example.pyx":1933
 *             if n == 0:
 *                 sig_off()
 *                 return 1, self             # <<<<<<<<<<<<<<
 *             else:
 *                 return n, P.new_gen(x)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      __Pyx_INCREF(((PyObject *)__pyx_v_self));
      PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_self));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
      __pyx_r = ((PyObject *)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    /*else*/ {

      /* "example.pyx":1935
 *                 return 1, self
 *             else:
 *                 return n, P.new_gen(x)             # <<<<<<<<<<<<<<
 *         else:
 *             k = int(k)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_x)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_r = ((PyObject *)__pyx_t_5);
      __pyx_t_5 = 0;
      goto __pyx_L0;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "example.pyx":1937
 *                 return n, P.new_gen(x)
 *         else:
 *             k = int(k)             # <<<<<<<<<<<<<<
 *             t0GEN(k)
 *             sig_on()
 */
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_v_k);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_k);
    __Pyx_GIVEREF(__pyx_v_k);
    __pyx_t_4 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_v_k);
    __pyx_v_k = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "example.pyx":1938
 *         else:
 *             k = int(k)
 *             t0GEN(k)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             n = ispower(self.g, t0, &x)
 */
    __pyx_t_4 = __pyx_f_7example_t0GEN(__pyx_v_k); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1938; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "example.pyx":1939
 *             k = int(k)
 *             t0GEN(k)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             n = ispower(self.g, t0, &x)
 *             if n == 0:
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":1940
 *             t0GEN(k)
 *             sig_on()
 *             n = ispower(self.g, t0, &x)             # <<<<<<<<<<<<<<
 *             if n == 0:
 *                 sig_off()
 */
    __pyx_v_n = ispower(__pyx_v_self->g, __pyx_v_7example_t0, (&__pyx_v_x));

    /* "example.pyx":1941
 *             sig_on()
 *             n = ispower(self.g, t0, &x)
 *             if n == 0:             # <<<<<<<<<<<<<<
 *                 sig_off()
 *                 return False, None
 */
    __pyx_t_1 = (__pyx_v_n == 0);
    if (__pyx_t_1) {

      /* "example.pyx":1942
 *             n = ispower(self.g, t0, &x)
 *             if n == 0:
 *                 sig_off()             # <<<<<<<<<<<<<<
 *                 return False, None
 *             else:
 */
      _pari_sig_off();

      /* "example.pyx":1943
 *             if n == 0:
 *                 sig_off()
 *                 return False, None             # <<<<<<<<<<<<<<
 *             else:
 *                 return k, P.new_gen(x)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1943; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1943; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __Pyx_INCREF(Py_None);
      PyTuple_SET_ITEM(__pyx_t_5, 1, Py_None);
      __Pyx_GIVEREF(Py_None);
      __pyx_t_4 = 0;
      __pyx_r = ((PyObject *)__pyx_t_5);
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L5;
    }
    /*else*/ {

      /* "example.pyx":1945
 *                 return False, None
 *             else:
 *                 return k, P.new_gen(x)             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_x)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_k);
      __Pyx_GIVEREF(__pyx_v_k);
      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_r = ((PyObject *)__pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    __pyx_L5:;
  }
  __pyx_L3:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("example.gen.ispower", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_k);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_129divrem(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_128divrem[] = "\n        divrem(x, y, v): Euclidean division of x by y giving as a\n        2-dimensional column vector the quotient and the remainder, with\n        respect to v (to main variable if v is omitted).\n        ";
static PyObject *__pyx_pw_7example_3gen_129divrem(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_var = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("divrem (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__var,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "divrem") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1950; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y = values[0];
    __pyx_v_var = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("divrem", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1950; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.divrem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_128divrem(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_var);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1950
 *     # 1: Standard monadic or dyadic OPERATORS
 *     ###########################################
 *     def divrem(gen x, y, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         divrem(x, y, v): Euclidean division of x by y giving as a
 */

static PyObject *__pyx_pf_7example_3gen_128divrem(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_var) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("divrem", 0);

  /* "example.pyx":1956
 *         respect to v (to main variable if v is omitted).
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(divrem(x.g, t0, P.get_var(var)))
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":1957
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(divrem(x.g, t0, P.get_var(var)))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1958
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(divrem(x.g, t0, P.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def lex(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, divrem(__pyx_v_x->g, __pyx_v_7example_t0, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_var)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.divrem", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_131lex(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_7example_3gen_130lex[] = "\n        lex(x,y): Compare x and y lexicographically (1 if xy, 0 if x==y, -1\n        if xy)\n        ";
static PyObject *__pyx_pw_7example_3gen_131lex(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("lex (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_130lex(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1960
 *         return P.new_gen(divrem(x.g, t0, P.get_var(var)))
 * 
 *     def lex(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         lex(x,y): Compare x and y lexicographically (1 if xy, 0 if x==y, -1
 */

static PyObject *__pyx_pf_7example_3gen_130lex(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("lex", 0);

  /* "example.pyx":1965
 *         if xy)
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return lexcmp(x.g, t0)
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1965; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":1966
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return lexcmp(x.g, t0)
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1967
 *         t0GEN(y)
 *         sig_on()
 *         return lexcmp(x.g, t0)             # <<<<<<<<<<<<<<
 * 
 *     def max(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(lexcmp(__pyx_v_x->g, __pyx_v_7example_t0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1967; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.lex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_133max(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_7example_3gen_132max[] = "\n        max(x,y): Return the maximum of x and y.\n        ";
static PyObject *__pyx_pw_7example_3gen_133max(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("max (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_132max(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1969
 *         return lexcmp(x.g, t0)
 * 
 *     def max(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         max(x,y): Return the maximum of x and y.
 */

static PyObject *__pyx_pf_7example_3gen_132max(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("max", 0);

  /* "example.pyx":1973
 *         max(x,y): Return the maximum of x and y.
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gmax(x.g, t0))
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":1974
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmax(x.g, t0))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1975
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gmax(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def min(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmax(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1975; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.max", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_135min(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_7example_3gen_134min[] = "\n        min(x,y): Return the minimum of x and y.\n        ";
static PyObject *__pyx_pw_7example_3gen_135min(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("min (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_134min(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1977
 *         return P.new_gen(gmax(x.g, t0))
 * 
 *     def min(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         min(x,y): Return the minimum of x and y.
 */

static PyObject *__pyx_pf_7example_3gen_134min(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("min", 0);

  /* "example.pyx":1981
 *         min(x,y): Return the minimum of x and y.
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gmin(x.g, t0))
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1981; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":1982
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmin(x.g, t0))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1982; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1983
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gmin(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def shift(gen x, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmin(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1983; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.min", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_137shift(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_7example_3gen_136shift[] = "\n        shift(x,n): shift x left n bits if n=0, right -n bits if n0.\n        ";
static PyObject *__pyx_pw_7example_3gen_137shift(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("shift (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1985; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_136shift(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((long)__pyx_v_n));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1985
 *         return P.new_gen(gmin(x.g, t0))
 * 
 *     def shift(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shift(x,n): shift x left n bits if n=0, right -n bits if n0.
 */

static PyObject *__pyx_pf_7example_3gen_136shift(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("shift", 0);

  /* "example.pyx":1989
 *         shift(x,n): shift x left n bits if n=0, right -n bits if n0.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gshift(x.g, n))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1989; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1990
 *         """
 *         sig_on()
 *         return P.new_gen(gshift(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def shiftmul(gen x, long n):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gshift(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1990; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.shift", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_139shiftmul(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
static char __pyx_doc_7example_3gen_138shiftmul[] = "\n        shiftmul(x,n): Return the product of x by `2^n`.\n        ";
static PyObject *__pyx_pw_7example_3gen_139shiftmul(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("shiftmul (wrapper)", 0);
  assert(__pyx_arg_n); {
    __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1992; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.shiftmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_138shiftmul(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((long)__pyx_v_n));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1992
 *         return P.new_gen(gshift(x.g, n))
 * 
 *     def shiftmul(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         shiftmul(x,n): Return the product of x by `2^n`.
 */

static PyObject *__pyx_pf_7example_3gen_138shiftmul(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("shiftmul", 0);

  /* "example.pyx":1996
 *         shiftmul(x,n): Return the product of x by `2^n`.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmul2n(x.g, n))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1996; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":1997
 *         """
 *         sig_on()
 *         return P.new_gen(gmul2n(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def moebius(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmul2n(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.shiftmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_141moebius(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_140moebius[] = "\n        moebius(x): Moebius function of x.\n        ";
static PyObject *__pyx_pw_7example_3gen_141moebius(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("moebius (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_140moebius(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":1999
 *         return P.new_gen(gmul2n(x.g, n))
 * 
 *     def moebius(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         moebius(x): Moebius function of x.
 */

static PyObject *__pyx_pf_7example_3gen_140moebius(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("moebius", 0);

  /* "example.pyx":2003
 *         moebius(x): Moebius function of x.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmoebius(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2004
 *         """
 *         sig_on()
 *         return P.new_gen(gmoebius(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def sign(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmoebius(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2004; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.moebius", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_143sign(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_142sign[] = "\n        sign(x): Return the sign of x, where x is of type integer, real or\n        fraction.\n        ";
static PyObject *__pyx_pw_7example_3gen_143sign(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("sign (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_142sign(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2006
 *         return P.new_gen(gmoebius(x.g))
 * 
 *     def sign(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         sign(x): Return the sign of x, where x is of type integer, real or
 */

static PyObject *__pyx_pf_7example_3gen_142sign(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("sign", 0);

  /* "example.pyx":2013
 *         # Pari throws an error if you attempt to take the sign of
 *         # a complex number.
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return gsigne(x.g)
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2013; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2014
 *         # a complex number.
 *         sig_on()
 *         return gsigne(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def vecmax(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyInt_FromLong(gsigne(__pyx_v_x->g)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.sign", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_145vecmax(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_144vecmax[] = "\n        vecmax(x): Return the maximum of the elements of the vector/matrix\n        x.\n        ";
static PyObject *__pyx_pw_7example_3gen_145vecmax(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vecmax (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_144vecmax(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2016
 *         return gsigne(x.g)
 * 
 *     def vecmax(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmax(x): Return the maximum of the elements of the vector/matrix
 */

static PyObject *__pyx_pf_7example_3gen_144vecmax(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("vecmax", 0);

  /* "example.pyx":2021
 *         x.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(vecmax(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2021; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2022
 *         """
 *         sig_on()
 *         return P.new_gen(vecmax(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, vecmax(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.vecmax", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_147vecmin(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_146vecmin[] = "\n        vecmin(x): Return the maximum of the elements of the vector/matrix\n        x.\n        ";
static PyObject *__pyx_pw_7example_3gen_147vecmin(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("vecmin (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_146vecmin(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2025
 * 
 * 
 *     def vecmin(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         vecmin(x): Return the maximum of the elements of the vector/matrix
 */

static PyObject *__pyx_pf_7example_3gen_146vecmin(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("vecmin", 0);

  /* "example.pyx":2030
 *         x.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(vecmin(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2030; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2031
 *         """
 *         sig_on()
 *         return P.new_gen(vecmin(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, vecmin(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2031; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.vecmin", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_149Col(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_148Col[] = "\n        Transform the object `x` into a column vector with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the column vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI column vector (type ``t_COL``)\n\n        EXAMPLES::\n\n            sage: pari(1.5).Col()\n            [1.50000000000000]~\n            sage: pari([1,2,3,4]).Col()\n            [1, 2, 3, 4]~\n            sage: pari('[1,2; 3,4]').Col()\n            [[1, 2], [3, 4]]~\n            sage: pari('\"Sage\"').Col()\n            [\"S\", \"a\", \"g\", \"e\"]~\n            sage: pari('x + 3*x^3').Col()\n            [3, 0, 1, 0]~\n            sage: pari('x + 3*x^3 + O(x^5)').Col()\n            [1, 0, 3, 0]~\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Col(2)\n            [1, 2, 3, 4]~\n            sage: pari([1,2,3,4]).Col(-2)\n            [1, 2, 3, 4]~\n            sage: pari([1,2,3,4]).Col(6)\n            [1, 2, 3, 4, 0, 0]~\n            sage: pari([1,2,3,4]).Col(-6)\n            [0, 0, 1, 2, 3, 4]~\n\n        See also :meth:`Vec` (create a row vector) for more examples\n        and :meth:`Colrev` (create a column in reversed order).\n        ";
static PyObject *__pyx_pw_7example_3gen_149Col(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Col (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Col") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_n = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Col", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Col", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_148Col(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2039
 *     ###########################################
 * 
 *     def Col(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

static PyObject *__pyx_pf_7example_3gen_148Col(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Col", 0);

  /* "example.pyx":2083
 *         and :meth:`Colrev` (create a column in reversed order).
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2084
 *         """
 *         sig_on()
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))             # <<<<<<<<<<<<<<
 * 
 *     def Colrev(gen x, long n = 0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_f_7example__Vec_append(gtocol(__pyx_v_x->g), gen_0, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Col", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_151Colrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_150Colrev[] = "\n        Transform the object `x` into a column vector with minimal size `|n|`.\n        The order of the resulting vector is reversed compared to :meth:`Col`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          prepend zeros; if `n < 0`, append zeros.\n\n        OUTPUT:\n\n        A PARI column vector (type ``t_COL``)\n\n        EXAMPLES::\n\n            sage: pari(1.5).Colrev()\n            [1.50000000000000]~\n            sage: pari([1,2,3,4]).Colrev()\n            [4, 3, 2, 1]~\n            sage: pari('[1,2; 3,4]').Colrev()\n            [[3, 4], [1, 2]]~\n            sage: pari('x + 3*x^3').Colrev()\n            [0, 1, 0, 3]~\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Colrev(2)\n            [4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(-2)\n            [4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(6)\n            [0, 0, 4, 3, 2, 1]~\n            sage: pari([1,2,3,4]).Colrev(-6)\n            [4, 3, 2, 1, 0, 0]~\n        ";
static PyObject *__pyx_pw_7example_3gen_151Colrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Colrev (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Colrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2086; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2086; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_n = ((long)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Colrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2086; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Colrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_150Colrev(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2086
 *         return P.new_gen(_Vec_append(gtocol(x.g), gen_0, n))
 * 
 *     def Colrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a column vector with minimal size `|n|`.
 */

static PyObject *__pyx_pf_7example_3gen_150Colrev(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
  GEN __pyx_v_v;
  GEN __pyx_v_L;
  GEN __pyx_v_R;
  long __pyx_v_t;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Colrev", 0);

  /* "example.pyx":2124
 *             [4, 3, 2, 1, 0, 0]~
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # Create a non-reversed column vector
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2126
 *         sig_on()
 *         # Create a non-reversed column vector
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)             # <<<<<<<<<<<<<<
 *         # Reverse it in-place
 *         cdef GEN L = v + 1
 */
  __pyx_v_v = __pyx_f_7example__Vec_append(gtocol(__pyx_v_x->g), gen_0, __pyx_v_n);

  /* "example.pyx":2128
 *         cdef GEN v = _Vec_append(gtocol(x.g), gen_0, n)
 *         # Reverse it in-place
 *         cdef GEN L = v + 1             # <<<<<<<<<<<<<<
 *         cdef GEN R = v + (lg(v)-1)
 *         cdef long t
 */
  __pyx_v_L = (__pyx_v_v + 1);

  /* "example.pyx":2129
 *         # Reverse it in-place
 *         cdef GEN L = v + 1
 *         cdef GEN R = v + (lg(v)-1)             # <<<<<<<<<<<<<<
 *         cdef long t
 *         while (L < R):
 */
  __pyx_v_R = (__pyx_v_v + (lg(__pyx_v_v) - 1));

  /* "example.pyx":2131
 *         cdef GEN R = v + (lg(v)-1)
 *         cdef long t
 *         while (L < R):             # <<<<<<<<<<<<<<
 *             t = L[0]
 *             L[0] = R[0]
 */
  while (1) {
    __pyx_t_2 = (__pyx_v_L < __pyx_v_R);
    if (!__pyx_t_2) break;

    /* "example.pyx":2132
 *         cdef long t
 *         while (L < R):
 *             t = L[0]             # <<<<<<<<<<<<<<
 *             L[0] = R[0]
 *             R[0] = t
 */
    __pyx_v_t = (__pyx_v_L[0]);

    /* "example.pyx":2133
 *         while (L < R):
 *             t = L[0]
 *             L[0] = R[0]             # <<<<<<<<<<<<<<
 *             R[0] = t
 *             L += 1
 */
    (__pyx_v_L[0]) = (__pyx_v_R[0]);

    /* "example.pyx":2134
 *             t = L[0]
 *             L[0] = R[0]
 *             R[0] = t             # <<<<<<<<<<<<<<
 *             L += 1
 *             R -= 1
 */
    (__pyx_v_R[0]) = __pyx_v_t;

    /* "example.pyx":2135
 *             L[0] = R[0]
 *             R[0] = t
 *             L += 1             # <<<<<<<<<<<<<<
 *             R -= 1
 *         return P.new_gen(v)
 */
    __pyx_v_L = (__pyx_v_L + 1);

    /* "example.pyx":2136
 *             R[0] = t
 *             L += 1
 *             R -= 1             # <<<<<<<<<<<<<<
 *         return P.new_gen(v)
 * 
 */
    __pyx_v_R = (__pyx_v_R - 1);
  }

  /* "example.pyx":2137
 *             L += 1
 *             R -= 1
 *         return P.new_gen(v)             # <<<<<<<<<<<<<<
 * 
 *     def List(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_v)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("example.gen.Colrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_153List(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_152List[] = "\n        List(x): transforms the PARI vector or list x into a list.\n\n        EXAMPLES::\n\n            sage: v = pari([1,2,3])\n            sage: v\n            [1, 2, 3]\n            sage: v.type()\n            't_VEC'\n            sage: w = v.List()\n            sage: w\n            List([1, 2, 3])\n            sage: w.type()\n            't_LIST'\n        ";
static PyObject *__pyx_pw_7example_3gen_153List(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("List (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_152List(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2139
 *         return P.new_gen(v)
 * 
 *     def List(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         List(x): transforms the PARI vector or list x into a list.
 */

static PyObject *__pyx_pf_7example_3gen_152List(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("List", 0);

  /* "example.pyx":2156
 *             't_LIST'
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtolist(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2157
 *         """
 *         sig_on()
 *         return P.new_gen(gtolist(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Mat(gen x):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtolist(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.List", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_155Mat(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_154Mat[] = "\n        Mat(x): Returns the matrix defined by x.\n\n        - If x is already a matrix, a copy of x is created and returned.\n\n        - If x is not a vector or a matrix, this function returns a 1x1\n          matrix.\n\n        - If x is a row (resp. column) vector, this functions returns\n          a 1-row (resp. 1-column) matrix, *unless* all elements are\n          column (resp. row) vectors of the same length, in which case\n          the vectors are concatenated sideways and the associated big\n          matrix is returned.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI matrix\n\n\n        EXAMPLES::\n\n            sage: x = pari(5)\n            sage: x.type()\n            't_INT'\n            sage: y = x.Mat()\n            sage: y\n            Mat(5)\n            sage: y.type()\n            't_MAT'\n            sage: x = pari('[1,2;3,4]')\n            sage: x.type()\n            't_MAT'\n            sage: x = pari('[1,2,3,4]')\n            sage: x.type()\n            't_VEC'\n            sage: y = x.Mat()\n            sage: y\n            Mat([1, 2, 3, 4])\n            sage: y.type()\n            't_MAT'\n\n        ::\n\n            sage: v = pari('[1,2;3,4]').Vec(); v\n            [[1, 3]~, [2, 4]~]\n            sage: v.Mat()\n            [1, 2; 3, 4]\n            sage: v = pari('[1,2;3,4]').Col(); v\n            [[1, 2], [3, 4]]~\n            sage: v.Mat()\n            [1, 2; 3, 4]\n        ";
static PyObject *__pyx_pw_7example_3gen_155Mat(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Mat (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_154Mat(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2159
 *         return P.new_gen(gtolist(x.g))
 * 
 *     def Mat(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Mat(x): Returns the matrix defined by x.
 */

static PyObject *__pyx_pf_7example_3gen_154Mat(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Mat", 0);

  /* "example.pyx":2219
 *             [1, 2; 3, 4]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtomat(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2220
 *         """
 *         sig_on()
 *         return P.new_gen(gtomat(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Mod(gen x, y):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtomat(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Mat", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_157Mod(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
static char __pyx_doc_7example_3gen_156Mod[] = "\n        Mod(x, y): Returns the object x modulo y, denoted Mod(x, y).\n\n        The input y must be a an integer or a polynomial:\n\n        - If y is an INTEGER, x must also be an integer, a rational\n          number, or a p-adic number compatible with the modulus y.\n\n        - If y is a POLYNOMIAL, x must be a scalar (which is not a\n          polmod), a polynomial, a rational function, or a power\n          series.\n\n        .. warning::\n\n           This function is not the same as ``x % y`` which is an\n           integer or a polynomial.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``y`` - integer or polynomial\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - intmod or polmod\n\n\n        EXAMPLES::\n\n            sage: z = pari(3)\n            sage: x = z.Mod(pari(7))\n            sage: x\n            Mod(3, 7)\n            sage: x^2\n            Mod(2, 7)\n            sage: x^100\n            Mod(4, 7)\n            sage: x.type()\n            't_INTMOD'\n\n        ::\n\n            sage: f = pari(\"x^2 + x + 1\")\n            sage: g = pari(\"x\")\n            sage: a = g.Mod(f)\n            sage: a\n            Mod(x, x^2 + x + 1)\n            sage: a*a\n            Mod(-x - 1, x^2 + x + 1)\n            sage: a.type()\n            't_POLMOD'\n        ";
static PyObject *__pyx_pw_7example_3gen_157Mod(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Mod (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_156Mod(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2222
 *         return P.new_gen(gtomat(x.g))
 * 
 *     def Mod(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Mod(x, y): Returns the object x modulo y, denoted Mod(x, y).
 */

static PyObject *__pyx_pf_7example_3gen_156Mod(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Mod", 0);

  /* "example.pyx":2279
 *             't_POLMOD'
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gmodulo(x.g,t0))
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":2280
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gmodulo(x.g,t0))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2281
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gmodulo(x.g,t0))             # <<<<<<<<<<<<<<
 * 
 *     def Pol(self, v=-1):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gmodulo(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.Mod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_159Pol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_158Pol[] = "\n        Pol(x, v): convert x into a polynomial with main variable v and\n        return the result.\n\n        - If x is a scalar, returns a constant polynomial.\n\n        - If x is a power series, the effect is identical to\n          ``truncate``, i.e. it chops off the `O(X^k)`.\n\n        - If x is a vector, this function creates the polynomial whose\n          coefficients are given in x, with x[0] being the leading\n          coefficient (which can be zero).\n\n        .. warning::\n\n           This is *not* a substitution function. It will not\n           transform an object containing variables of higher priority\n           than v::\n\n               sage: pari('x+y').Pol('y')\n               Traceback (most recent call last):\n               ...\n               PariError:  (5)\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - (optional) which variable, defaults to 'x'\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a polynomial\n\n\n        EXAMPLES::\n\n            sage: v = pari(\"[1,2,3,4]\")\n            sage: f = v.Pol()\n            sage: f\n            x^3 + 2*x^2 + 3*x + 4\n            sage: f*f\n            x^6 + 4*x^5 + 10*x^4 + 20*x^3 + 25*x^2 + 24*x + 16\n\n        ::\n\n            sage: v = pari(\"[1,2;3,4]\")\n            sage: v.Pol()\n            [1, 3]~*x + [2, 4]~\n        ";
static PyObject *__pyx_pw_7example_3gen_159Pol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Pol (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Pol") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2283; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Pol", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2283; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_158Pol(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_v);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2283
 *         return P.new_gen(gmodulo(x.g,t0))
 * 
 *     def Pol(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Pol(x, v): convert x into a polynomial with main variable v and
 */

static PyObject *__pyx_pf_7example_3gen_158Pol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Pol", 0);

  /* "example.pyx":2337
 *             [1, 3]~*x + [2, 4]~
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2338
 *         """
 *         sig_on()
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def Polrev(self, v=-1):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtopoly(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Pol", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_161Polrev(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_160Polrev[] = "\n        Polrev(x, v): Convert x into a polynomial with main variable v and\n        return the result. This is the reverse of Pol if x is a vector,\n        otherwise it is identical to Pol. By \"reverse\" we mean that the\n        coefficients are reversed.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT:\n\n        -  ``gen`` - a polynomial\n\n        EXAMPLES::\n\n            sage: v = pari(\"[1,2,3,4]\")\n            sage: f = v.Polrev()\n            sage: f\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: v.Pol()\n            x^3 + 2*x^2 + 3*x + 4\n            sage: v.Polrev('y')\n            4*y^3 + 3*y^2 + 2*y + 1\n\n        Note that Polrev does *not* reverse the coefficients of a\n        polynomial! ::\n\n            sage: f\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: f.Polrev()\n            4*x^3 + 3*x^2 + 2*x + 1\n            sage: v = pari(\"[1,2;3,4]\")\n            sage: v.Polrev()\n            [2, 4]~*x + [1, 3]~\n        ";
static PyObject *__pyx_pw_7example_3gen_161Polrev(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Polrev (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Polrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Polrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2340; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Polrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_160Polrev(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_v);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2340
 *         return P.new_gen(gtopoly(self.g, P.get_var(v)))
 * 
 *     def Polrev(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         Polrev(x, v): Convert x into a polynomial with main variable v and
 */

static PyObject *__pyx_pf_7example_3gen_160Polrev(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Polrev", 0);

  /* "example.pyx":2377
 *             [2, 4]~*x + [1, 3]~
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2378
 *         """
 *         sig_on()
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def Qfb(gen a, b, c, D=0):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtopolyrev(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Polrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_163Qfb(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_162Qfb[] = "\n        Qfb(a,b,c,D=0.): Returns the binary quadratic form\n\n        .. math::\n\n                                ax^2 + bxy + cy^2.\n\n\n        The optional D is 0 by default and initializes Shank's distance if\n        `b^2 - 4ac > 0`.  The discriminant of the quadratic form must not\n        be a perfect square.\n\n        .. note::\n\n           Negative definite forms are not implemented, so use their\n           positive definite counterparts instead. (I.e., if f is a\n           negative definite quadratic form, then -f is positive\n           definite.)\n\n        INPUT:\n\n\n        -  ``a`` - gen\n\n        -  ``b`` - gen\n\n        -  ``c`` - gen\n\n        -  ``D`` - gen (optional, defaults to 0)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - binary quadratic form\n\n\n        EXAMPLES::\n\n            sage: pari(3).Qfb(7, 1)\n            Qfb(3, 7, 1, 0.E-19)\n            sage: pari(3).Qfb(7, 2)  # discriminant is 25\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n        ";
static PyObject *__pyx_pw_7example_3gen_163Qfb(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_b = 0;
  PyObject *__pyx_v_c = 0;
  PyObject *__pyx_v_D = 0;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Qfb (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__b,&__pyx_n_s__c,&__pyx_n_s__D,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)__pyx_int_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__c)) != 0)) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("Qfb", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__D);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Qfb") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_b = values[0];
    __pyx_v_c = values[1];
    __pyx_v_D = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Qfb", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2380; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Qfb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_162Qfb(((struct __pyx_obj_7example_gen *)__pyx_v_a), __pyx_v_b, __pyx_v_c, __pyx_v_D);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2380
 *         return P.new_gen(gtopolyrev(self.g, P.get_var(v)))
 * 
 *     def Qfb(gen a, b, c, D=0):             # <<<<<<<<<<<<<<
 *         """
 *         Qfb(a,b,c,D=0.): Returns the binary quadratic form
 */

static PyObject *__pyx_pf_7example_3gen_162Qfb(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_D) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  long __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Qfb", 0);

  /* "example.pyx":2427
 *             PariError:  (5)
 *         """
 *         t0GEN(b); t1GEN(c); t2GEN(D)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(Qfb0(a.g, t0, t1, t2, prec))
 */
  __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_c); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_f_7example_t2GEN(__pyx_v_D); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":2428
 *         """
 *         t0GEN(b); t1GEN(c); t2GEN(D)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Qfb0(a.g, t0, t1, t2, prec))
 * 
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2429
 *         t0GEN(b); t1GEN(c); t2GEN(D)
 *         sig_on()
 *         return P.new_gen(Qfb0(a.g, t0, t1, t2, prec))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, Qfb0(__pyx_v_a->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_v_7example_t2, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("example.gen.Qfb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_165Ser(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7example_3gen_164Ser[] = "\n        Ser(x,v=x): Create a power series from x with main variable v and\n        return the result.\n\n        - If x is a scalar, this gives a constant power series with\n          precision given by the default series precision, as returned\n          by get_series_precision().\n\n        - If x is a polynomial, the precision is the greatest of\n          get_series_precision() and the degree of the polynomial.\n\n        - If x is a vector, the precision is similarly given, and the\n          coefficients of the vector are understood to be the\n          coefficients of the power series starting from the constant\n          term (i.e. the reverse of the function Pol).\n\n        .. warning::\n\n           This is *not* a substitution function. It will not\n           transform an object containing variables of higher priority\n           than v.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - PARI variable (default: x)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - PARI object of PARI type t_SER\n\n\n        EXAMPLES::\n\n            sage: pari(2).Ser()\n            2 + O(x^16)\n            sage: x = pari([1,2,3,4,5])\n            sage: x.Ser()\n            1 + 2*x + 3*x^2 + 4*x^3 + 5*x^4 + O(x^5)\n            sage: f = x.Ser('v'); print f\n            1 + 2*v + 3*v^2 + 4*v^3 + 5*v^4 + O(v^5)\n            sage: pari(1)/f\n            1 - 2*v + v^2 + O(v^5)\n            sage: pari('x^5').Ser(seriesprecision = 20)\n            x^5 + O(x^25)\n            sage: pari('1/x').Ser(seriesprecision = 1)\n            x^-1 + O(x^0)\n        ";
static PyObject *__pyx_pw_7example_3gen_165Ser(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_v = 0;
  long __pyx_v_seriesprecision;
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Ser (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,&__pyx_n_s__seriesprecision,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)__pyx_int_neg_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__seriesprecision);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Ser") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2432; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = values[0];
    if (values[1]) {
      __pyx_v_seriesprecision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_seriesprecision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2432; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    } else {
      __pyx_v_seriesprecision = ((long)16);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("Ser", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2432; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("example.gen.Ser", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7example_3gen_164Ser(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_v, __pyx_v_seriesprecision);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2432
 * 
 * 
 *     def Ser(gen x, v=-1, long seriesprecision = 16):             # <<<<<<<<<<<<<<
 *         """
 *         Ser(x,v=x): Create a power series from x with main variable v and
 */

static PyObject *__pyx_pf_7example_3gen_164Ser(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v, long __pyx_v_seriesprecision) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Ser", 0);

  /* "example.pyx":2485
 *             x^-1 + O(x^0)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtoser(x.g, P.get_var(v), seriesprecision))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2486
 *         """
 *         sig_on()
 *         return P.new_gen(gtoser(x.g, P.get_var(v), seriesprecision))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtoser(__pyx_v_x->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v), __pyx_v_seriesprecision))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Ser", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_167Set(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_166Set[] = "\n        Set(x): convert x into a set, i.e. a row vector of strings in\n        increasing lexicographic order.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a vector of strings in increasing\n           lexicographic order.\n\n\n        EXAMPLES::\n\n            sage: pari([1,5,2]).Set()\n            [\"1\", \"2\", \"5\"]\n            sage: pari([]).Set()     # the empty set\n            []\n            sage: pari([1,1,-1,-1,3,3]).Set()\n            [\"-1\", \"1\", \"3\"]\n            sage: pari(1).Set()\n            [\"1\"]\n            sage: pari('1/(x*y)').Set()\n            [\"1/(y*x)\"]\n            sage: pari('[\"bc\",\"ab\",\"bc\"]').Set()\n            [\"\"ab\"\", \"\"bc\"\"]\n        ";
static PyObject *__pyx_pw_7example_3gen_167Set(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Set (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_166Set(((struct __pyx_obj_7example_gen *)__pyx_v_x));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2489
 * 
 * 
 *     def Set(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Set(x): convert x into a set, i.e. a row vector of strings in
 */

static PyObject *__pyx_pf_7example_3gen_166Set(struct __pyx_obj_7example_gen *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Set", 0);

  /* "example.pyx":2522
 *             ["\"ab\"", "\"bc\""]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtoset(x.g))
 * 
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2523
 *         """
 *         sig_on()
 *         return P.new_gen(gtoset(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtoset(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Set", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_169Str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_168Str[] = "\n        Str(self): Return the print representation of self as a PARI\n        object.\n\n        INPUT:\n\n\n        -  ``self`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI gen of type t_STR, i.e., a PARI\n           string\n\n\n        EXAMPLES::\n\n            sage: pari([1,2,['abc',1]]).Str()\n            \"[1, 2, [abc, 1]]\"\n            sage: pari([1,1, 1.54]).Str()\n            \"[1, 1, 1.54000000000000]\"\n            sage: pari(1).Str()       # 1 is automatically converted to string rep\n            \"1\"\n            sage: x = pari('x')       # PARI variable \"x\"\n            sage: x.Str()             # is converted to string rep.\n            \"x\"\n            sage: x.Str().type()\n            't_STR'\n        ";
static PyObject *__pyx_pw_7example_3gen_169Str(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Str (wrapper)", 0);
  __pyx_r = __pyx_pf_7example_3gen_168Str(((struct __pyx_obj_7example_gen *)__pyx_v_self));
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "example.pyx":2526
 * 
 * 
 *     def Str(self):             # <<<<<<<<<<<<<<
 *         """
 *         Str(self): Return the print representation of self as a PARI
 */

static PyObject *__pyx_pf_7example_3gen_168Str(struct __pyx_obj_7example_gen *__pyx_v_self) {
  char *__pyx_v_c;
  struct __pyx_obj_7example_gen *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("Str", 0);

  /* "example.pyx":2559
 *         """
 *         cdef char* c
 *         sig_on()             # <<<<<<<<<<<<<<
 *         c = GENtostr(self.g)
 *         v = self.new_gen(strtoGENstr(c))
 */
  __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":2560
 *         cdef char* c
 *         sig_on()
 *         c = GENtostr(self.g)             # <<<<<<<<<<<<<<
 *         v = self.new_gen(strtoGENstr(c))
 *         pari_free(c)
 */
  __pyx_v_c = GENtostr(__pyx_v_self->g);

  /* "example.pyx":2561
 *         sig_on()
 *         c = GENtostr(self.g)
 *         v = self.new_gen(strtoGENstr(c))             # <<<<<<<<<<<<<<
 *         pari_free(c)
 *         return v
 */
  __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, strtoGENstr(__pyx_v_c))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_v = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "example.pyx":2562
 *         c = GENtostr(self.g)
 *         v = self.new_gen(strtoGENstr(c))
 *         pari_free(c)             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
  pari_free(__pyx_v_c);

  /* "example.pyx":2563
 *         v = self.new_gen(strtoGENstr(c))
 *         pari_free(c)
 *         return v             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_v));
  __pyx_r = ((PyObject *)__pyx_v_v);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("example.gen.Str", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_v);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7example_3gen_171Strchr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_7example_3gen_170Strchr[] = "\n        Strchr(x): converts x to a string, translating each integer into a\n        character (in ASCII).\n\n        .. note::\n\n           :meth:`.Vecsmall` is (essentially) the inverse to :meth:`.Strchr`.\n\n        INPUT:\n\n\n        -  ``x`` - PARI vector of integers\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - a PARI string\n\n\n        EXAMPLES::\n\n            sage: pari([65,66,123]).Strchr()\n            \"AB{\"\n            sage: pari('\"Sage\"').Vecsmall()   # pari('\"Sage\"') --> PARI t_STR\n            Vecsmall([83, 97, 103, 101])\n            sage: _.Strchr()\n            \"Sage\"\n            sage: pari([83, 97, 103, 101]).Strchr()\n            \"Sage\"\n        ";
  static PyObject *__pyx_pw_7example_3gen_171Strchr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strchr (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_170Strchr(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2566
 * 
 * 
 *     def Strchr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strchr(x): converts x to a string, translating each integer into a
 */

  static PyObject *__pyx_pf_7example_3gen_170Strchr(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strchr", 0);

    /* "example.pyx":2598
 *             "Sage"
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strchr(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2599
 *         """
 *         sig_on()
 *         return P.new_gen(Strchr(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def Strexpand(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, Strchr(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.Strchr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_173Strexpand(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_172Strexpand[] = "\n        Strexpand(x): Concatenate the entries of the vector x into a single\n        string, performing tilde expansion.\n\n        .. note::\n\n           I have no clue what the point of this function is. - William\n        ";
  static PyObject *__pyx_pw_7example_3gen_173Strexpand(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strexpand (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_172Strexpand(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2601
 *         return P.new_gen(Strchr(x.g))
 * 
 *     def Strexpand(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Strexpand(x): Concatenate the entries of the vector x into a single
 */

  static PyObject *__pyx_pf_7example_3gen_172Strexpand(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strexpand", 0);

    /* "example.pyx":2610
 *            I have no clue what the point of this function is. - William
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x must be of type t_VEC."
 *         sig_on()
 */
    __pyx_t_1 = (typ(__pyx_v_x->g) != t_VEC);
    if (__pyx_t_1) {

      /* "example.pyx":2611
 *         """
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x must be of type t_VEC."             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(Strexpand(x.g))
 */
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_39), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2611; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":2612
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x must be of type t_VEC."
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strexpand(x.g))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2613
 *             raise TypeError, "x must be of type t_VEC."
 *         sig_on()
 *         return P.new_gen(Strexpand(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, Strexpand(__pyx_v_x->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.Strexpand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_175Strtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_174Strtex[] = "\n        Strtex(x): Translates the vector x of PARI gens to TeX format and\n        returns the resulting concatenated strings as a PARI t_STR.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - PARI t_STR (string)\n\n\n        EXAMPLES::\n\n            sage: v=pari('x^2')\n            sage: v.Strtex()\n            \"x^2\"\n            sage: v=pari(['1/x^2','x'])\n            sage: v.Strtex()\n            \"\\\\frac{1}{x^2}x\"\n            sage: v=pari(['1 + 1/x + 1/(y+1)','x-1'])\n            sage: v.Strtex()\n            \"\\\\frac{ \\\\left(y\\n + 2\\\\right)  x\\n + \\\\left(y\\n + 1\\\\right) }{ \\\\left(y\\n + 1\\\\right)  x}x\\n - 1\"\n        ";
  static PyObject *__pyx_pw_7example_3gen_175Strtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Strtex (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_174Strtex(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2616
 * 
 * 
 *     def Strtex(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Strtex(x): Translates the vector x of PARI gens to TeX format and
 */

  static PyObject *__pyx_pf_7example_3gen_174Strtex(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Strtex", 0);
    __Pyx_INCREF((PyObject *)__pyx_v_x);

    /* "example.pyx":2645
 *             "\\frac{ \\left(y\n + 2\\right)  x\n + \\left(y\n + 1\\right) }{ \\left(y\n + 1\\right)  x}x\n - 1"
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             x = P.vector(1, [x])
 *         sig_on()
 */
    __pyx_t_1 = (typ(__pyx_v_x->g) != t_VEC);
    if (__pyx_t_1) {

      /* "example.pyx":2646
 *         """
 *         if typ(x.g) != t_VEC:
 *             x = P.vector(1, [x])             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(Strtex(x.g))
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_7example_P), __pyx_n_s__vector); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyList_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_t_3));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(((PyObject *)__pyx_v_x));
      __pyx_v_x = ((struct __pyx_obj_7example_gen *)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":2647
 *         if typ(x.g) != t_VEC:
 *             x = P.vector(1, [x])
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(Strtex(x.g))
 * 
 */
    __pyx_t_5 = _pari_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2648
 *             x = P.vector(1, [x])
 *         sig_on()
 *         return P.new_gen(Strtex(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def printtex(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, Strtex(__pyx_v_x->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.Strtex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_177printtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_177printtex(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("printtex (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_176printtex(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2650
 *         return P.new_gen(Strtex(x.g))
 * 
 *     def printtex(gen x):             # <<<<<<<<<<<<<<
 *         return x.Strtex()
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_176printtex(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("printtex", 0);

    /* "example.pyx":2651
 * 
 *     def printtex(gen x):
 *         return x.Strtex()             # <<<<<<<<<<<<<<
 * 
 *     def Vec(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_x), __pyx_n_s__Strtex); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.printtex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_179Vec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_178Vec[] = "\n        Transform the object `x` into a vector with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI vector (type ``t_VEC``)\n\n        EXAMPLES::\n\n            sage: pari(1).Vec()\n            [1]\n            sage: pari('x^3').Vec()\n            [1, 0, 0, 0]\n            sage: pari('x^3 + 3*x - 2').Vec()\n            [1, 0, 3, -2]\n            sage: pari([1,2,3]).Vec()\n            [1, 2, 3]\n            sage: pari('[1, 2; 3, 4]').Vec()\n            [[1, 3]~, [2, 4]~]\n            sage: pari('\"Sage\"').Vec()\n            [\"S\", \"a\", \"g\", \"e\"]\n            sage: pari('2*x^2 + 3*x^3 + O(x^5)').Vec()\n            [2, 3, 0]\n            sage: pari('2*x^-2 + 3*x^3 + O(x^5)').Vec()\n            [2, 0, 0, 0, 0, 3, 0]\n\n        Note the different term ordering for polynomials and series::\n\n            sage: pari('1 + x + 3*x^3 + O(x^5)').Vec()\n            [1, 1, 0, 3, 0]\n            sage: pari('1 + x + 3*x^3').Vec()\n            [3, 0, 1, 1]\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Vec(2)\n            [1, 2, 3, 4]\n            sage: pari([1,2,3,4]).Vec(-2)\n            [1, 2, 3, 4]\n            sage: pari([1,2,3,4]).Vec(6)\n            [1, 2, 3, 4, 0, 0]\n            sage: pari([1,2,3,4]).Vec(-6)\n            [0, 0, 1, 2, 3, 4]\n\n        See also :meth:`Col` (create a column vector) and :meth:`Vecrev`\n        (create a vector in reversed order).\n        ";
  static PyObject *__pyx_pw_7example_3gen_179Vec(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vec (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vec") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2653; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2653; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vec", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2653; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.Vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_178Vec(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2653
 *         return x.Strtex()
 * 
 *     def Vec(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

  static PyObject *__pyx_pf_7example_3gen_178Vec(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vec", 0);

    /* "example.pyx":2708
 *         (create a vector in reversed order).
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2709
 *         """
 *         sig_on()
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))             # <<<<<<<<<<<<<<
 * 
 *     def Vecrev(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_f_7example__Vec_append(gtovec(__pyx_v_x->g), gen_0, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2709; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.Vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_181Vecrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_180Vecrev[] = "\n        Transform the object `x` into a vector with minimal size `|n|`.\n        The order of the resulting vector is reversed compared to :meth:`Vec`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          prepend zeros; if `n < 0`, append zeros.\n\n        OUTPUT:\n\n        A PARI vector (type ``t_VEC``)\n\n        EXAMPLES::\n\n            sage: pari(1).Vecrev()\n            [1]\n            sage: pari('x^3').Vecrev()\n            [0, 0, 0, 1]\n            sage: pari('x^3 + 3*x - 2').Vecrev()\n            [-2, 3, 0, 1]\n            sage: pari([1, 2, 3]).Vecrev()\n            [3, 2, 1]\n            sage: pari('Col([1, 2, 3])').Vecrev()\n            [3, 2, 1]\n            sage: pari('[1, 2; 3, 4]').Vecrev()\n            [[2, 4]~, [1, 3]~]\n            sage: pari('\"Sage\"').Vecrev()\n            [\"e\", \"g\", \"a\", \"S\"]\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3,4]).Vecrev(2)\n            [4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(-2)\n            [4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(6)\n            [0, 0, 4, 3, 2, 1]\n            sage: pari([1,2,3,4]).Vecrev(-6)\n            [4, 3, 2, 1, 0, 0]\n        ";
  static PyObject *__pyx_pw_7example_3gen_181Vecrev(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vecrev (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vecrev") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2711; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2711; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vecrev", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2711; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.Vecrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_180Vecrev(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2711
 *         return P.new_gen(_Vec_append(gtovec(x.g), gen_0, n))
 * 
 *     def Vecrev(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a vector with minimal size `|n|`.
 */

  static PyObject *__pyx_pf_7example_3gen_180Vecrev(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vecrev", 0);

    /* "example.pyx":2755
 *             [4, 3, 2, 1, 0, 0]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2756
 *         """
 *         sig_on()
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))             # <<<<<<<<<<<<<<
 * 
 *     def Vecsmall(gen x, long n = 0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_f_7example__Vec_append(gtovecrev(__pyx_v_x->g), gen_0, (-__pyx_v_n)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.Vecrev", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_183Vecsmall(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_182Vecsmall[] = "\n        Transform the object `x` into a ``t_VECSMALL`` with minimal size `|n|`.\n\n        INPUT:\n\n        - ``x`` -- gen\n\n        - ``n`` -- Make the vector of minimal length `|n|`. If `n > 0`,\n          append zeros; if `n < 0`, prepend zeros.\n\n        OUTPUT:\n\n        A PARI vector of small integers (type ``t_VECSMALL``)\n\n        EXAMPLES::\n\n            sage: pari([1,2,3]).Vecsmall()\n            Vecsmall([1, 2, 3])\n            sage: pari('\"Sage\"').Vecsmall()\n            Vecsmall([83, 97, 103, 101])\n            sage: pari(1234).Vecsmall()\n            Vecsmall([1234])\n            sage: pari('x^2 + 2*x + 3').Vecsmall()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n\n        We demonstate the `n` argument::\n\n            sage: pari([1,2,3]).Vecsmall(2)\n            Vecsmall([1, 2, 3])\n            sage: pari([1,2,3]).Vecsmall(-2)\n            Vecsmall([1, 2, 3])\n            sage: pari([1,2,3]).Vecsmall(6)\n            Vecsmall([1, 2, 3, 0, 0, 0])\n            sage: pari([1,2,3]).Vecsmall(-6)\n            Vecsmall([0, 0, 0, 1, 2, 3])\n        ";
  static PyObject *__pyx_pw_7example_3gen_183Vecsmall(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("Vecsmall (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Vecsmall") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("Vecsmall", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2758; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.Vecsmall", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_182Vecsmall(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2758
 *         return P.new_gen(_Vec_append(gtovecrev(x.g), gen_0, -n))
 * 
 *     def Vecsmall(gen x, long n = 0):             # <<<<<<<<<<<<<<
 *         """
 *         Transform the object `x` into a ``t_VECSMALL`` with minimal size `|n|`.
 */

  static PyObject *__pyx_pf_7example_3gen_182Vecsmall(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("Vecsmall", 0);

    /* "example.pyx":2797
 *             Vecsmall([0, 0, 0, 1, 2, 3])
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2798
 *         """
 *         sig_on()
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))             # <<<<<<<<<<<<<<
 * 
 *     def binary(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_f_7example__Vec_append(gtovecsmall(__pyx_v_x->g), ((GEN)0), __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.Vecsmall", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_185binary(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_184binary[] = "\n        binary(x): gives the vector formed by the binary digits of abs(x),\n        where x is of type t_INT.\n\n        INPUT:\n\n\n        -  ``x`` - gen of type t_INT\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type t_VEC\n\n\n        EXAMPLES::\n\n            sage: pari(0).binary()\n            [0]\n            sage: pari(-5).binary()\n            [1, 0, 1]\n            sage: pari(5).binary()\n            [1, 0, 1]\n            sage: pari(2005).binary()\n            [1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1]\n\n        ::\n\n            sage: pari('\"2\"').binary()\n            Traceback (most recent call last):\n            ...\n            TypeError: x (=\"2\") must be of type t_INT, but is of type t_STR.\n        ";
  static PyObject *__pyx_pw_7example_3gen_185binary(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("binary (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_184binary(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2800
 *         return P.new_gen(_Vec_append(gtovecsmall(x.g), <GEN>0, n))
 * 
 *     def binary(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         binary(x): gives the vector formed by the binary digits of abs(x),
 */

  static PyObject *__pyx_pf_7example_3gen_184binary(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("binary", 0);

    /* "example.pyx":2835
 *             TypeError: x (="2") must be of type t_INT, but is of type t_STR.
 *         """
 *         if typ(x.g) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         sig_on()
 */
    __pyx_t_1 = (typ(__pyx_v_x->g) != t_INT);
    if (__pyx_t_1) {

      /* "example.pyx":2836
 *         """
 *         if typ(x.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(binaire(x.g))
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_x), __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_40), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":2837
 *         if typ(x.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(binaire(x.g))
 * 
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2838
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(x,x.type())
 *         sig_on()
 *         return P.new_gen(binaire(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def bitand(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, binaire(__pyx_v_x->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.binary", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_187bitand(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_186bitand[] = "\n        bitand(x,y): Bitwise and of two integers x and y. Negative numbers\n        behave as if modulo some large power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(8).bitand(4)\n            0\n            sage: pari(8).bitand(8)\n            8\n            sage: pari(6).binary()\n            [1, 1, 0]\n            sage: pari(7).binary()\n            [1, 1, 1]\n            sage: pari(6).bitand(7)\n            6\n            sage: pari(19).bitand(-1)\n            19\n            sage: pari(-1).bitand(-1)\n            -1\n        ";
  static PyObject *__pyx_pw_7example_3gen_187bitand(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitand (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_186bitand(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2840
 *         return P.new_gen(binaire(x.g))
 * 
 *     def bitand(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitand(x,y): Bitwise and of two integers x and y. Negative numbers
 */

  static PyObject *__pyx_pf_7example_3gen_186bitand(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitand", 0);

    /* "example.pyx":2876
 *             -1
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gbitand(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":2877
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitand(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2878
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gbitand(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gbitand(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bitand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_189bitneg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_188bitneg[] = "\n        bitneg(x,n=-1): Bitwise negation of the integer x truncated to n\n        bits. n=-1 (the default) represents an infinite sequence of the bit\n        1. Negative numbers behave as if modulo some large power of 2.\n\n        With n=-1, this function returns -n-1. With n = 0, it returns a\n        number a such that `a\\cong -n-1 \\pmod{2^n}`.\n\n        INPUT:\n\n\n        -  ``x`` - gen (t_INT)\n\n        -  ``n`` - long, default = -1\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(10).bitneg()\n            -11\n            sage: pari(1).bitneg()\n            -2\n            sage: pari(-2).bitneg()\n            1\n            sage: pari(-1).bitneg()\n            0\n            sage: pari(569).bitneg()\n            -570\n            sage: pari(569).bitneg(10)\n            454\n            sage: 454 % 2^10\n            454\n            sage: -570 % 2^10\n            454\n        ";
  static PyObject *__pyx_pw_7example_3gen_189bitneg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitneg (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bitneg") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2881; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2881; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bitneg", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2881; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bitneg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_188bitneg(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2881
 * 
 * 
 *     def bitneg(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         r"""
 *         bitneg(x,n=-1): Bitwise negation of the integer x truncated to n
 */

  static PyObject *__pyx_pf_7example_3gen_188bitneg(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitneg", 0);

    /* "example.pyx":2923
 *             454
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitneg(x.g,n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2924
 *         """
 *         sig_on()
 *         return P.new_gen(gbitneg(x.g,n))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gbitneg(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.bitneg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_191bitnegimply(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_190bitnegimply[] = "\n        bitnegimply(x,y): Bitwise negated imply of two integers x and y, in\n        other words, x BITAND BITNEG(y). Negative numbers behave as if\n        modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(14).bitnegimply(0)\n            14\n            sage: pari(8).bitnegimply(8)\n            0\n            sage: pari(8+4).bitnegimply(8)\n            4\n        ";
  static PyObject *__pyx_pw_7example_3gen_191bitnegimply(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitnegimply (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_190bitnegimply(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2927
 * 
 * 
 *     def bitnegimply(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitnegimply(x,y): Bitwise negated imply of two integers x and y, in
 */

  static PyObject *__pyx_pf_7example_3gen_190bitnegimply(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitnegimply", 0);

    /* "example.pyx":2956
 *             4
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gbitnegimply(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":2957
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitnegimply(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2958
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gbitnegimply(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gbitnegimply(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bitnegimply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_193bitor(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_192bitor[] = "\n        bitor(x,y): Bitwise or of two integers x and y. Negative numbers\n        behave as if modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(14).bitor(0)\n            14\n            sage: pari(8).bitor(4)\n            12\n            sage: pari(12).bitor(1)\n            13\n            sage: pari(13).bitor(1)\n            13\n        ";
  static PyObject *__pyx_pw_7example_3gen_193bitor(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitor (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_192bitor(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2961
 * 
 * 
 *     def bitor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitor(x,y): Bitwise or of two integers x and y. Negative numbers
 */

  static PyObject *__pyx_pf_7example_3gen_192bitor(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitor", 0);

    /* "example.pyx":2991
 *             13
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gbitor(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2991; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":2992
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitor(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2992; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":2993
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gbitor(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gbitor(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2993; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bitor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_195bittest(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_3gen_194bittest[] = "\n        bittest(x, long n): Returns bit number n (coefficient of\n        `2^n` in binary) of the integer x. Negative numbers behave\n        as if modulo a big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (pari integer)\n\n\n        OUTPUT:\n\n\n        -  ``bool`` - a Python bool\n\n\n        EXAMPLES::\n\n            sage: x = pari(6)\n            sage: x.bittest(0)\n            False\n            sage: x.bittest(1)\n            True\n            sage: x.bittest(2)\n            True\n            sage: x.bittest(3)\n            False\n            sage: pari(-3).bittest(0)\n            True\n            sage: pari(-3).bittest(1)\n            False\n            sage: [pari(-3).bittest(n) for n in range(10)]\n            [True, False, True, True, True, True, True, True, True, True]\n        ";
  static PyObject *__pyx_pw_7example_3gen_195bittest(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bittest (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2996; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bittest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_194bittest(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":2996
 * 
 * 
 *     def bittest(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         bittest(x, long n): Returns bit number n (coefficient of
 */

  static PyObject *__pyx_pf_7example_3gen_194bittest(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyBoolObject *__pyx_v_b = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bittest", 0);

    /* "example.pyx":3032
 *             [True, False, True, True, True, True, True, True, True, True]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         b = bool(bittest(x.g, n))
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3032; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3033
 *         """
 *         sig_on()
 *         b = bool(bittest(x.g, n))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return b
 */
    __pyx_t_2 = PyInt_FromLong(bittest(__pyx_v_x->g, __pyx_v_n)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_4bool_bool)), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_b = ((PyBoolObject *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":3034
 *         sig_on()
 *         b = bool(bittest(x.g, n))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return b
 * 
 */
    _pari_sig_off();

    /* "example.pyx":3035
 *         b = bool(bittest(x.g, n))
 *         sig_off()
 *         return b             # <<<<<<<<<<<<<<
 * 
 *     def bitxor(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_b));
    __pyx_r = ((PyObject *)__pyx_v_b);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.bittest", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_b);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_197bitxor(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_196bitxor[] = "\n        bitxor(x,y): Bitwise exclusive or of two integers x and y. Negative\n        numbers behave as if modulo big power of 2.\n\n        INPUT:\n\n\n        -  ``x`` - gen (of type t_INT)\n\n        -  ``y`` - coercible to gen (of type t_INT)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - of type type t_INT\n\n\n        EXAMPLES::\n\n            sage: pari(6).bitxor(4)\n            2\n            sage: pari(0).bitxor(4)\n            4\n            sage: pari(6).bitxor(0)\n            6\n        ";
  static PyObject *__pyx_pw_7example_3gen_197bitxor(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bitxor (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_196bitxor(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3037
 *         return b
 * 
 *     def bitxor(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         bitxor(x,y): Bitwise exclusive or of two integers x and y. Negative
 */

  static PyObject *__pyx_pf_7example_3gen_196bitxor(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bitxor", 0);

    /* "example.pyx":3065
 *             6
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gbitxor(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":3066
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gbitxor(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3066; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3067
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gbitxor(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gbitxor(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3067; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bitxor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_199ceil(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_198ceil[] = "\n        For real x: return the smallest integer = x. For rational\n        functions: the quotient of numerator by denominator. For lists:\n        apply componentwise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - depends on type of x\n\n\n        EXAMPLES::\n\n            sage: pari(1.4).ceil()\n            2\n            sage: pari(-1.4).ceil()\n            -1\n            sage: pari(3/4).ceil()\n            1\n            sage: pari(x).ceil()\n            x\n            sage: pari((x^2+x+1)/x).ceil()\n            x + 1\n\n        This may be unexpected: but it is correct, treating the argument as\n        a rational function in RR(x).\n\n        ::\n\n            sage: pari(x^2+5*x+2.5).ceil()\n            x^2 + 5*x + 2.50000000000000\n        ";
  static PyObject *__pyx_pw_7example_3gen_199ceil(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ceil (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_198ceil(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3070
 * 
 * 
 *     def ceil(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the smallest integer = x. For rational
 */

  static PyObject *__pyx_pf_7example_3gen_198ceil(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ceil", 0);

    /* "example.pyx":3109
 *             x^2 + 5*x + 2.50000000000000
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gceil(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3110
 *         """
 *         sig_on()
 *         return P.new_gen(gceil(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def centerlift(gen x, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gceil(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.ceil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_201centerlift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_200centerlift[] = "\n        centerlift(x,v): Centered lift of x. This function returns exactly\n        the same thing as lift, except if x is an integer mod.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - var (default: x)\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: x = pari(-2).Mod(5)\n            sage: x.centerlift()\n            -2\n            sage: x.lift()\n            3\n            sage: f = pari('x-1').Mod('x^2 + 1')\n            sage: f.centerlift()\n            x - 1\n            sage: f.lift()\n            x - 1\n            sage: f = pari('x-y').Mod('x^2+1')\n            sage: f\n            Mod(x - y, x^2 + 1)\n            sage: f.centerlift('x')\n            x - y\n            sage: f.centerlift('y')\n            Mod(x - y, x^2 + 1)\n        ";
  static PyObject *__pyx_pw_7example_3gen_201centerlift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("centerlift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "centerlift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("centerlift", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.centerlift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_200centerlift(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3112
 *         return P.new_gen(gceil(x.g))
 * 
 *     def centerlift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         centerlift(x,v): Centered lift of x. This function returns exactly
 */

  static PyObject *__pyx_pf_7example_3gen_200centerlift(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("centerlift", 0);

    /* "example.pyx":3147
 *             Mod(x - y, x^2 + 1)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(centerlift0(x.g, P.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3148
 *         """
 *         sig_on()
 *         return P.new_gen(centerlift0(x.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, centerlift0(__pyx_v_x->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.centerlift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_203component(PyObject *__pyx_v_x, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_3gen_202component[] = "\n        component(x, long n): Return n'th component of the internal\n        representation of x. This function is 1-based instead of 0-based.\n\n        .. note::\n\n           For vectors or matrices, it is simpler to use x[n-1]. For\n           list objects such as is output by nfinit, it is easier to\n           use member functions.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - C long (coercible to)\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari([0,1,2,3,4]).component(1)\n            0\n            sage: pari([0,1,2,3,4]).component(2)\n            1\n            sage: pari([0,1,2,3,4]).component(4)\n            3\n            sage: pari('x^3 + 2').component(1)\n            2\n            sage: pari('x^3 + 2').component(2)\n            0\n            sage: pari('x^3 + 2').component(4)\n            1\n\n        ::\n\n            sage: pari('x').component(0)\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n        ";
  static PyObject *__pyx_pw_7example_3gen_203component(PyObject *__pyx_v_x, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("component (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.component", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_202component(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3151
 * 
 * 
 *     def component(gen x, long n):             # <<<<<<<<<<<<<<
 *         """
 *         component(x, long n): Return n'th component of the internal
 */

  static PyObject *__pyx_pf_7example_3gen_202component(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("component", 0);

    /* "example.pyx":3194
 *             PariError:  (5)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(compo(x.g, n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3195
 *         """
 *         sig_on()
 *         return P.new_gen(compo(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def conj(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, compo(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.component", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_205conj(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_204conj[] = "\n        conj(x): Return the algebraic conjugate of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('x+1').conj()\n            x + 1\n            sage: pari('x+I').conj()\n            x - I\n            sage: pari('1/(2*x+3*I)').conj()\n            1/(2*x - 3*I)\n            sage: pari([1,2,'2-I','Mod(x,x^2+1)', 'Mod(x,x^2-2)']).conj()\n            [1, 2, 2 + I, Mod(-x, x^2 + 1), Mod(-x, x^2 - 2)]\n            sage: pari('Mod(x,x^2-2)').conj()\n            Mod(-x, x^2 - 2)\n            sage: pari('Mod(x,x^3-3)').conj()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
  static PyObject *__pyx_pw_7example_3gen_205conj(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("conj (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_204conj(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3197
 *         return P.new_gen(compo(x.g, n))
 * 
 *     def conj(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         conj(x): Return the algebraic conjugate of x.
 */

  static PyObject *__pyx_pf_7example_3gen_204conj(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("conj", 0);

    /* "example.pyx":3226
 *             PariError: incorrect type (11)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gconj(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3227
 *         """
 *         sig_on()
 *         return P.new_gen(gconj(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def conjvec(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gconj(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.conj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_207conjvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_206conjvec[] = "\n        conjvec(x): Returns the vector of all conjugates of the algebraic\n        number x. An algebraic number is a polynomial over Q modulo an\n        irreducible polynomial.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('Mod(1+x,x^2-2)').conjvec()\n            [-0.414213562373095, 2.41421356237310]~\n            sage: pari('Mod(x,x^3-3)').conjvec()\n            [1.44224957030741, -0.721124785153704 + 1.24902476648341*I, -0.721124785153704 - 1.24902476648341*I]~\n        ";
  static PyObject *__pyx_pw_7example_3gen_207conjvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("conjvec (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_206conjvec(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3229
 *         return P.new_gen(gconj(x.g))
 * 
 *     def conjvec(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         conjvec(x): Returns the vector of all conjugates of the algebraic
 */

  static PyObject *__pyx_pf_7example_3gen_206conjvec(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("conjvec", 0);

    /* "example.pyx":3250
 *             [1.44224957030741, -0.721124785153704 + 1.24902476648341*I, -0.721124785153704 - 1.24902476648341*I]~
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(conjvec(x.g, prec))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3251
 *         """
 *         sig_on()
 *         return P.new_gen(conjvec(x.g, prec))             # <<<<<<<<<<<<<<
 * 
 *     def denominator(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, conjvec(__pyx_v_x->g, __pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.conjvec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_209denominator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_208denominator[] = "\n        denominator(x): Return the denominator of x. When x is a vector,\n        this is the least common multiple of the denominators of the\n        components of x.\n\n        what about poly? INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('5/9').denominator()\n            9\n            sage: pari('(x+1)/(x-2)').denominator()\n            x - 2\n            sage: pari('2/3 + 5/8*x + 7/3*x^2 + 1/5*y').denominator()\n            1\n            sage: pari('2/3*x').denominator()\n            1\n            sage: pari('[2/3, 5/8, 7/3, 1/5]').denominator()\n            120\n        ";
  static PyObject *__pyx_pw_7example_3gen_209denominator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("denominator (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_208denominator(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3253
 *         return P.new_gen(conjvec(x.g, prec))
 * 
 *     def denominator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         denominator(x): Return the denominator of x. When x is a vector,
 */

  static PyObject *__pyx_pf_7example_3gen_208denominator(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("denominator", 0);

    /* "example.pyx":3280
 *             120
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(denom(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3281
 *         """
 *         sig_on()
 *         return P.new_gen(denom(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def floor(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, denom(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.denominator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_211floor(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_210floor[] = "\n        For real x: return the largest integer = x. For rational functions:\n        the quotient of numerator by denominator. For lists: apply\n        componentwise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari(5/9).floor()\n            0\n            sage: pari(11/9).floor()\n            1\n            sage: pari(1.17).floor()\n            1\n            sage: pari([1.5,2.3,4.99]).floor()\n            [1, 2, 4]\n            sage: pari([[1.1,2.2],[3.3,4.4]]).floor()\n            [[1, 2], [3, 4]]\n            sage: pari(x).floor()\n            x\n            sage: pari((x^2+x+1)/x).floor()\n            x + 1\n            sage: pari(x^2+5*x+2.5).floor()\n            x^2 + 5*x + 2.50000000000000\n\n        ::\n\n            sage: pari('\"hello world\"').floor()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
  static PyObject *__pyx_pw_7example_3gen_211floor(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("floor (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_210floor(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3283
 *         return P.new_gen(denom(x.g))
 * 
 *     def floor(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         For real x: return the largest integer = x. For rational functions:
 */

  static PyObject *__pyx_pf_7example_3gen_210floor(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("floor", 0);

    /* "example.pyx":3323
 *             PariError: incorrect type (11)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gfloor(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3324
 *         """
 *         sig_on()
 *         return P.new_gen(gfloor(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def frac(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gfloor(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.floor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_213frac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_212frac[] = "\n        frac(x): Return the fractional part of x, which is x - floor(x).\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari(1.75).frac()\n            0.750000000000000\n            sage: pari(sqrt(2)).frac()\n            0.414213562373095\n            sage: pari('sqrt(-2)').frac()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
  static PyObject *__pyx_pw_7example_3gen_213frac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("frac (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_212frac(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3326
 *         return P.new_gen(gfloor(x.g))
 * 
 *     def frac(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         frac(x): Return the fractional part of x, which is x - floor(x).
 */

  static PyObject *__pyx_pf_7example_3gen_212frac(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("frac", 0);

    /* "example.pyx":3349
 *             PariError: incorrect type (11)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gfrac(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3350
 *         """
 *         sig_on()
 *         return P.new_gen(gfrac(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def imag(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gfrac(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.frac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_215imag(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_214imag[] = "\n        imag(x): Return the imaginary part of x. This function also works\n        component-wise.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('1+2*I').imag()\n            2\n            sage: pari(sqrt(-2)).imag()\n            1.41421356237310\n            sage: pari('x+I').imag()\n            1\n            sage: pari('x+2*I').imag()\n            2\n            sage: pari('(1+I)*x^2+2*I').imag()\n            x^2 + 2\n            sage: pari('[1,2,3] + [4*I,5,6]').imag()\n            [4, 0, 0]\n        ";
  static PyObject *__pyx_pw_7example_3gen_215imag(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("imag (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_214imag(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3352
 *         return P.new_gen(gfrac(x.g))
 * 
 *     def imag(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         imag(x): Return the imaginary part of x. This function also works
 */

  static PyObject *__pyx_pf_7example_3gen_214imag(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("imag", 0);

    /* "example.pyx":3380
 *             [4, 0, 0]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gimag(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3381
 *         """
 *         sig_on()
 *         return P.new_gen(gimag(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def length(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gimag(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.imag", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_217length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_216length[] = "\n\n        ";
  static PyObject *__pyx_pw_7example_3gen_217length(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("length (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_216length(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3383
 *         return P.new_gen(gimag(x.g))
 * 
 *     def length(self):             # <<<<<<<<<<<<<<
 *         """
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_216length(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("length", 0);

    /* "example.pyx":3387
 * 
 *         """
 *         return glength(self.g)             # <<<<<<<<<<<<<<
 * 
 *     def lift(gen x, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(glength(__pyx_v_self->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.length", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_219lift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_218lift[] = "\n        lift(x,v): Returns the lift of an element of Z/nZ to Z or R[x]/(P)\n        to R[x] for a type R if v is omitted. If v is given, lift only\n        polymods with main variable v. If v does not occur in x, lift only\n        intmods.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``v`` - (optional) variable\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: x = pari(\"x\")\n            sage: a = x.Mod('x^3 + 17*x + 3')\n            sage: a\n            Mod(x, x^3 + 17*x + 3)\n            sage: b = a^4; b\n            Mod(-17*x^2 - 3*x, x^3 + 17*x + 3)\n            sage: b.lift()\n            -17*x^2 - 3*x\n\n        \077\077? more examples\n        ";
  static PyObject *__pyx_pw_7example_3gen_219lift(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lift", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_218lift(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3389
 *         return glength(self.g)
 * 
 *     def lift(gen x, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         lift(x,v): Returns the lift of an element of Z/nZ to Z or R[x]/(P)
 */

  static PyObject *__pyx_pf_7example_3gen_218lift(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lift", 0);

    /* "example.pyx":3419
 *         ??? more examples
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if v == -1:
 *             return P.new_gen(lift(x.g))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3420
 *         """
 *         sig_on()
 *         if v == -1:             # <<<<<<<<<<<<<<
 *             return P.new_gen(lift(x.g))
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 */
    __pyx_t_2 = PyObject_RichCompare(__pyx_v_v, __pyx_int_neg_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_3) {

      /* "example.pyx":3421
 *         sig_on()
 *         if v == -1:
 *             return P.new_gen(lift(x.g))             # <<<<<<<<<<<<<<
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, lift(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3422
 *         if v == -1:
 *             return P.new_gen(lift(x.g))
 *         return P.new_gen(lift0(x.g, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def numbpart(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, lift0(__pyx_v_x->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_221numbpart(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_220numbpart[] = "\n        numbpart(x): returns the number of partitions of x.\n\n        EXAMPLES::\n\n            sage: pari(20).numbpart()\n            627\n            sage: pari(100).numbpart()\n            190569292\n        ";
  static PyObject *__pyx_pw_7example_3gen_221numbpart(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numbpart (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_220numbpart(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3424
 *         return P.new_gen(lift0(x.g, P.get_var(v)))
 * 
 *     def numbpart(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numbpart(x): returns the number of partitions of x.
 */

  static PyObject *__pyx_pf_7example_3gen_220numbpart(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numbpart", 0);

    /* "example.pyx":3435
 *             190569292
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numbpart(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3436
 *         """
 *         sig_on()
 *         return P.new_gen(numbpart(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def numerator(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, numbpart(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.numbpart", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_223numerator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_222numerator[] = "\n        numerator(x): Returns the numerator of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_223numerator(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numerator (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_222numerator(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3438
 *         return P.new_gen(numbpart(x.g))
 * 
 *     def numerator(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         numerator(x): Returns the numerator of x.
 */

  static PyObject *__pyx_pf_7example_3gen_222numerator(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numerator", 0);

    /* "example.pyx":3452
 *         EXAMPLES:
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numer(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3453
 *         """
 *         sig_on()
 *         return P.new_gen(numer(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, numer(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.numerator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_225numtoperm(PyObject *__pyx_v_k, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_3gen_224numtoperm[] = "\n        numtoperm(k, n): Return the permutation number k (mod n!) of n\n        letters, where n is an integer.\n\n        INPUT:\n\n\n        -  ``k`` - gen, integer\n\n        -  ``n`` - int\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - vector (permutation of 1,...,n)\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_225numtoperm(PyObject *__pyx_v_k, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numtoperm (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3456; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.numtoperm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_224numtoperm(((struct __pyx_obj_7example_gen *)__pyx_v_k), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3456
 * 
 * 
 *     def numtoperm(gen k, long n):             # <<<<<<<<<<<<<<
 *         """
 *         numtoperm(k, n): Return the permutation number k (mod n!) of n
 */

  static PyObject *__pyx_pf_7example_3gen_224numtoperm(struct __pyx_obj_7example_gen *__pyx_v_k, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numtoperm", 0);

    /* "example.pyx":3477
 *         EXAMPLES:
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(numtoperm(n, k.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3478
 *         """
 *         sig_on()
 *         return P.new_gen(numtoperm(n, k.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, numtoperm(__pyx_v_n, __pyx_v_k->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.numtoperm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_227padicprec(PyObject *__pyx_v_x, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_226padicprec[] = "\n        padicprec(x,p): Return the absolute p-adic precision of the object\n        x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: int\n\n        EXAMPLES::\n\n            sage: K = Qp(11,5)\n            sage: x = K(11^-10 + 5*11^-7 + 11^-6)\n            sage: y = pari(x)\n            sage: y.padicprec(11)\n            -5\n            sage: y.padicprec(17)\n            Traceback (most recent call last):\n            ...\n            ValueError: not the same prime in padicprec\n        ";
  static PyObject *__pyx_pw_7example_3gen_227padicprec(PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicprec (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_226padicprec(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3481
 * 
 * 
 *     def padicprec(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         padicprec(x,p): Return the absolute p-adic precision of the object
 */

  static PyObject *__pyx_pf_7example_3gen_226padicprec(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_p) {
    struct __pyx_obj_7example_gen *__pyx_v__p = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicprec", 0);

    /* "example.pyx":3507
 *         """
 *         cdef gen _p
 *         _p = pari(p)             # <<<<<<<<<<<<<<
 *         if typ(_p.g) != t_INT:
 *             raise TypeError("p (=%s) must be of type t_INT, but is of type %s."%(
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_p);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_p);
    __Pyx_GIVEREF(__pyx_v_p);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v__p = ((struct __pyx_obj_7example_gen *)__pyx_t_3);
    __pyx_t_3 = 0;

    /* "example.pyx":3508
 *         cdef gen _p
 *         _p = pari(p)
 *         if typ(_p.g) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError("p (=%s) must be of type t_INT, but is of type %s."%(
 *                 _p, _p.type()))
 */
    __pyx_t_4 = (typ(__pyx_v__p->g) != t_INT);
    if (__pyx_t_4) {

      /* "example.pyx":3510
 *         if typ(_p.g) != t_INT:
 *             raise TypeError("p (=%s) must be of type t_INT, but is of type %s."%(
 *                 _p, _p.type()))             # <<<<<<<<<<<<<<
 *         if not gequal(gel(x.g, 2), _p.g):
 *             raise ValueError("not the same prime in padicprec")
 */
      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v__p), __pyx_n_s__type); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(((PyObject *)__pyx_v__p));
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v__p));
      __Pyx_GIVEREF(((PyObject *)__pyx_v__p));
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_41), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_2));
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
      __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3511
 *             raise TypeError("p (=%s) must be of type t_INT, but is of type %s."%(
 *                 _p, _p.type()))
 *         if not gequal(gel(x.g, 2), _p.g):             # <<<<<<<<<<<<<<
 *             raise ValueError("not the same prime in padicprec")
 *         return padicprec(x.g, _p.g)
 */
    __pyx_t_4 = (!gequal(gel(__pyx_v_x->g, 2), __pyx_v__p->g));
    if (__pyx_t_4) {

      /* "example.pyx":3512
 *                 _p, _p.type()))
 *         if not gequal(gel(x.g, 2), _p.g):
 *             raise ValueError("not the same prime in padicprec")             # <<<<<<<<<<<<<<
 *         return padicprec(x.g, _p.g)
 * 
 */
      __pyx_t_2 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_k_tuple_43), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_Raise(__pyx_t_2, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":3513
 *         if not gequal(gel(x.g, 2), _p.g):
 *             raise ValueError("not the same prime in padicprec")
 *         return padicprec(x.g, _p.g)             # <<<<<<<<<<<<<<
 * 
 *     def padicprime(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(padicprec(__pyx_v_x->g, __pyx_v__p->g)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.padicprec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v__p);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_229padicprime(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_228padicprime[] = "\n        The uniformizer of the p-adic ring this element lies in, as a t_INT.\n\n        INPUT:\n\n        - ``x`` - gen, of type t_PADIC\n\n        OUTPUT:\n\n        - ``p`` - gen, of type t_INT\n\n        EXAMPLES::\n\n            sage: K = Qp(11,5)\n            sage: x = K(11^-10 + 5*11^-7 + 11^-6)\n            sage: y = pari(x)\n            sage: y.padicprime()\n            11\n            sage: y.padicprime().type()\n            't_INT'\n        ";
  static PyObject *__pyx_pw_7example_3gen_229padicprime(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicprime (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_228padicprime(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3515
 *         return padicprec(x.g, _p.g)
 * 
 *     def padicprime(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         The uniformizer of the p-adic ring this element lies in, as a t_INT.
 */

  static PyObject *__pyx_pf_7example_3gen_228padicprime(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicprime", 0);

    /* "example.pyx":3537
 *             't_INT'
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gel(x.g, 2))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3538
 *         """
 *         sig_on()
 *         return P.new_gen(gel(x.g, 2))             # <<<<<<<<<<<<<<
 * 
 *     def permtonum(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gel(__pyx_v_x->g, 2))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.padicprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_231permtonum(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_230permtonum[] = "\n        permtonum(x): Return the ordinal (between 1 and n!) of permutation\n        vector x. \077\077? Huh \077\077? say more. what is a perm vector. 0 to n-1 or\n        1-n.\n\n        INPUT:\n\n\n        -  ``x`` - gen (vector of integers)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_231permtonum(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("permtonum (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_230permtonum(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3540
 *         return P.new_gen(gel(x.g, 2))
 * 
 *     def permtonum(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         permtonum(x): Return the ordinal (between 1 and n!) of permutation
 */

  static PyObject *__pyx_pf_7example_3gen_230permtonum(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("permtonum", 0);

    /* "example.pyx":3560
 *         EXAMPLES:
 *         """
 *         if typ(x.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         sig_on()
 */
    __pyx_t_1 = (typ(__pyx_v_x->g) != t_VEC);
    if (__pyx_t_1) {

      /* "example.pyx":3561
 *         """
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(permtonum(x.g))
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_x), __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_x));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_44), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3562
 *         if typ(x.g) != t_VEC:
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(permtonum(x.g))
 * 
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3563
 *             raise TypeError, "x (=%s) must be of type t_VEC, but is of type %s."%(x,x.type())
 *         sig_on()
 *         return P.new_gen(permtonum(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def precision(gen x, long n=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, permtonum(__pyx_v_x->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.permtonum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_233precision(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_232precision[] = "\n        precision(x,n): Change the precision of x to be n, where n is a\n        C-integer). If n is omitted, output the real precision of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - (optional) int\n\n\n        OUTPUT: nothing or gen if n is omitted\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_233precision(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("precision (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "precision") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("precision", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3565; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_232precision(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3565
 *         return P.new_gen(permtonum(x.g))
 * 
 *     def precision(gen x, long n=-1):             # <<<<<<<<<<<<<<
 *         """
 *         precision(x,n): Change the precision of x to be n, where n is a
 */

  static PyObject *__pyx_pf_7example_3gen_232precision(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("precision", 0);

    /* "example.pyx":3582
 *         EXAMPLES:
 *         """
 *         if n <= -1:             # <<<<<<<<<<<<<<
 *             return precision(x.g)
 *         sig_on()
 */
    __pyx_t_1 = (__pyx_v_n <= -1);
    if (__pyx_t_1) {

      /* "example.pyx":3583
 *         """
 *         if n <= -1:
 *             return precision(x.g)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(precision0(x.g, n))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = PyInt_FromLong(precision(__pyx_v_x->g)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3584
 *         if n <= -1:
 *             return precision(x.g)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(precision0(x.g, n))
 * 
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3585
 *             return precision(x.g)
 *         sig_on()
 *         return P.new_gen(precision0(x.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def random(gen N):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, precision0(__pyx_v_x->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_235random(PyObject *__pyx_v_N, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_234random[] = "\n        ``random(N=2^31)``: Return a pseudo-random integer\n        between 0 and `N-1`.\n\n        INPUT:\n\n\n        -``N`` - gen, integer\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_235random(PyObject *__pyx_v_N, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("random (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_234random(((struct __pyx_obj_7example_gen *)__pyx_v_N));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3587
 *         return P.new_gen(precision0(x.g, n))
 * 
 *     def random(gen N):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``random(N=2^31)``: Return a pseudo-random integer
 */

  static PyObject *__pyx_pf_7example_3gen_234random(struct __pyx_obj_7example_gen *__pyx_v_N) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("random", 0);

    /* "example.pyx":3606
 *         EXAMPLES:
 *         """
 *         if typ(N.g) != t_INT:             # <<<<<<<<<<<<<<
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         sig_on()
 */
    __pyx_t_1 = (typ(__pyx_v_N->g) != t_INT);
    if (__pyx_t_1) {

      /* "example.pyx":3607
 *         """
 *         if typ(N.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(genrand(N.g))
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_N), __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)__pyx_v_N));
      PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_N));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_N));
      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_40), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3608
 *         if typ(N.g) != t_INT:
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(genrand(N.g))
 * 
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3609
 *             raise TypeError, "x (=%s) must be of type t_INT, but is of type %s."%(N,N.type())
 *         sig_on()
 *         return P.new_gen(genrand(N.g))             # <<<<<<<<<<<<<<
 * 
 *     def real(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, genrand(__pyx_v_N->g))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.random", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_237real(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_236real[] = "\n        real(x): Return the real part of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_237real(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("real (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_236real(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3611
 *         return P.new_gen(genrand(N.g))
 * 
 *     def real(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         real(x): Return the real part of x.
 */

  static PyObject *__pyx_pf_7example_3gen_236real(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("real", 0);

    /* "example.pyx":3625
 *         EXAMPLES:
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(greal(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3626
 *         """
 *         sig_on()
 *         return P.new_gen(greal(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def round(gen x, estimate=False):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, greal(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.real", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_239round(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_238round[] = "\n        round(x,estimate=False): If x is a real number, returns x rounded\n        to the nearest integer (rounding up). If the optional argument\n        estimate is True, also returns the binary exponent e of the\n        difference between the original and the rounded value (the\n        \"fractional part\") (this is the integer ceiling of log_2(error)).\n\n        When x is a general PARI object, this function returns the result\n        of rounding every coefficient at every level of PARI object. Note\n        that this is different than what the truncate function does (see\n        the example below).\n\n        One use of round is to get exact results after a long approximate\n        computation, when theory tells you that the coefficients must be\n        integers.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``estimate`` - (optional) bool, False by default\n\n\n        OUTPUT:\n\n        - if estimate is False, return a single gen.\n\n        - if estimate is True, return rounded version of x and error\n          estimate in bits, both as gens.\n\n        EXAMPLES::\n\n            sage: pari('1.5').round()\n            2\n            sage: pari('1.5').round(True)\n            (2, -1)\n            sage: pari('1.5 + 2.1*I').round()\n            2 + 2*I\n            sage: pari('1.0001').round(True)\n            (1, -14)\n            sage: pari('(2.4*x^2 - 1.7)/x').round()\n            (2*x^2 - 2)/x\n            sage: pari('(2.4*x^2 - 1.7)/x').truncate()\n            2.40000000000000*x\n        ";
  static PyObject *__pyx_pw_7example_3gen_239round(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_estimate = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("round (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__estimate,0};
      PyObject* values[1] = {0};
      values[0] = __pyx_k_45;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__estimate);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "round") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3628; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_estimate = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("round", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3628; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.round", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_238round(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_estimate);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3628
 *         return P.new_gen(greal(x.g))
 * 
 *     def round(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         round(x,estimate=False): If x is a real number, returns x rounded
 */

  static PyObject *__pyx_pf_7example_3gen_238round(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_estimate) {
    long __pyx_v_e;
    struct __pyx_obj_7example_gen *__pyx_v_y = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("round", 0);

    /* "example.pyx":3678
 *         cdef long e
 *         cdef gen y
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if not estimate:
 *             return P.new_gen(ground(x.g))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3679
 *         cdef gen y
 *         sig_on()
 *         if not estimate:             # <<<<<<<<<<<<<<
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_estimate); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = (!__pyx_t_2);
    if (__pyx_t_3) {

      /* "example.pyx":3680
 *         sig_on()
 *         if not estimate:
 *             return P.new_gen(ground(x.g))             # <<<<<<<<<<<<<<
 *         y = P.new_gen(grndtoi(x.g, &e))
 *         return y, e
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ground(__pyx_v_x->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3681
 *         if not estimate:
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))             # <<<<<<<<<<<<<<
 *         return y, e
 * 
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, grndtoi(__pyx_v_x->g, (&__pyx_v_e)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_y = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "example.pyx":3682
 *             return P.new_gen(ground(x.g))
 *         y = P.new_gen(grndtoi(x.g, &e))
 *         return y, e             # <<<<<<<<<<<<<<
 * 
 *     def simplify(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyInt_FromLong(__pyx_v_e); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3682; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3682; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_y));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_r = ((PyObject *)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.round", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_y);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_241simplify(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_240simplify[] = "\n        simplify(x): Simplify the object x as much as possible, and return\n        the result.\n\n        A complex or quadratic number whose imaginary part is an exact 0\n        (i.e., not an approximate one such as O(3) or 0.E-28) is converted\n        to its real part, and a a polynomial of degree 0 is converted to\n        its constant term. Simplification occurs recursively.\n\n        This function is useful before using arithmetic functions, which\n        expect integer arguments:\n\n        EXAMPLES::\n\n            sage: y = pari('y')\n            sage: x = pari('9') + y - y\n            sage: x\n            9\n            sage: x.type()\n            't_POL'\n            sage: x.factor()\n            matrix(0,2)\n            sage: pari('9').factor()\n            Mat([3, 2])\n            sage: x.simplify()\n            9\n            sage: x.simplify().factor()\n            Mat([3, 2])\n            sage: x = pari('1.5 + 0*I')\n            sage: x.type()\n            't_REAL'\n            sage: x.simplify()\n            1.50000000000000\n            sage: y = x.simplify()\n            sage: y.type()\n            't_REAL'\n        ";
  static PyObject *__pyx_pw_7example_3gen_241simplify(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("simplify (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_240simplify(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3684
 *         return y, e
 * 
 *     def simplify(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         simplify(x): Simplify the object x as much as possible, and return
 */

  static PyObject *__pyx_pf_7example_3gen_240simplify(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("simplify", 0);

    /* "example.pyx":3722
 *             't_REAL'
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(simplify(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3722; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3723
 *         """
 *         sig_on()
 *         return P.new_gen(simplify(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def sizeword(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, simplify(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.simplify", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_243sizeword(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_242sizeword[] = "\n        Return the total number of machine words occupied by the\n        complete tree of the object x.  A machine word is 32 or\n        64 bits, depending on the computer.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT: int (a Python int)\n\n        EXAMPLES::\n\n            sage: pari('0').sizeword()\n            2\n            sage: pari('1').sizeword()\n            3\n            sage: pari('1000000').sizeword()\n            3\n            sage: pari('10^100').sizeword()\n            13      # 32-bit\n            8       # 64-bit\n            sage: pari(RDF(1.0)).sizeword()\n            4       # 32-bit\n            3       # 64-bit\n            sage: pari('x').sizeword()\n            9\n            sage: pari('x^20').sizeword()\n            66\n            sage: pari('[x, I]').sizeword()\n            20\n        ";
  static PyObject *__pyx_pw_7example_3gen_243sizeword(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizeword (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_242sizeword(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3725
 *         return P.new_gen(simplify(x.g))
 * 
 *     def sizeword(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of machine words occupied by the
 */

  static PyObject *__pyx_pf_7example_3gen_242sizeword(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizeword", 0);

    /* "example.pyx":3758
 *             20
 *         """
 *         return gsizeword(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def sizebyte(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(gsizeword(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3758; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.sizeword", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_245sizebyte(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_244sizebyte[] = "\n        Return the total number of bytes occupied by the complete tree\n        of the object x. Note that this number depends on whether the\n        computer is 32-bit or 64-bit.\n\n        INPUT:\n\n        -  ``x`` - gen\n\n        OUTPUT: int (a Python int)\n\n        EXAMPLE::\n\n            sage: pari('1').sizebyte()\n            12           # 32-bit\n            24           # 64-bit\n        ";
  static PyObject *__pyx_pw_7example_3gen_245sizebyte(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizebyte (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_244sizebyte(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3760
 *         return gsizeword(x.g)
 * 
 *     def sizebyte(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the total number of bytes occupied by the complete tree
 */

  static PyObject *__pyx_pf_7example_3gen_244sizebyte(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizebyte", 0);

    /* "example.pyx":3778
 *             24           # 64-bit
 *         """
 *         return gsizebyte(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def sizedigit(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(gsizebyte(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3778; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.sizebyte", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_247sizedigit(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_246sizedigit[] = "\n        sizedigit(x): Return a quick estimate for the maximal number of\n        decimal digits before the decimal point of any component of x.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT:\n\n\n        -  ``int`` - Python integer\n\n\n        EXAMPLES::\n\n            sage: x = pari('10^100')\n            sage: x.Str().length()\n            101\n            sage: x.sizedigit()\n            101\n\n        Note that digits after the decimal point are ignored.\n\n        ::\n\n            sage: x = pari('1.234')\n            sage: x\n            1.23400000000000\n            sage: x.sizedigit()\n            1\n\n        The estimate can be one too big::\n\n            sage: pari('7234.1').sizedigit()\n            4\n            sage: pari('9234.1').sizedigit()\n            5\n        ";
  static PyObject *__pyx_pw_7example_3gen_247sizedigit(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sizedigit (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_246sizedigit(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3780
 *         return gsizebyte(x.g)
 * 
 *     def sizedigit(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         sizedigit(x): Return a quick estimate for the maximal number of
 */

  static PyObject *__pyx_pf_7example_3gen_246sizedigit(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sizedigit", 0);

    /* "example.pyx":3822
 *             5
 *         """
 *         return sizedigit(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def truncate(gen x, estimate=False):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(sizedigit(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.sizedigit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_249truncate(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_248truncate[] = "\n        truncate(x,estimate=False): Return the truncation of x. If estimate\n        is True, also return the number of error bits.\n\n        When x is in the real numbers, this means that the part after the\n        decimal point is chopped away, e is the binary exponent of the\n        difference between the original and truncated value (the\n        \"fractional part\"). If x is a rational function, the result is the\n        integer part (Euclidean quotient of numerator by denominator) and\n        if requested the error estimate is 0.\n\n        When truncate is applied to a power series (in X), it transforms it\n        into a polynomial or a rational function with denominator a power\n        of X, by chopping away the `O(X^k)`. Similarly, when\n        applied to a p-adic number, it transforms it into an integer or a\n        rational number by chopping away the `O(p^k)`.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``estimate`` - (optional) bool, which is False by\n           default\n\n\n        OUTPUT:\n\n        - if estimate is False, return a single gen.\n\n        - if estimate is True, return rounded version of x and error\n          estimate in bits, both as gens.\n\n        EXAMPLES::\n\n            sage: pari('(x^2+1)/x').round()\n            (x^2 + 1)/x\n            sage: pari('(x^2+1)/x').truncate()\n            x\n            sage: pari('1.043').truncate()\n            1\n            sage: pari('1.043').truncate(True)\n            (1, -5)\n            sage: pari('1.6').truncate()\n            1\n            sage: pari('1.6').round()\n            2\n            sage: pari('1/3 + 2 + 3^2 + O(3^3)').truncate()\n            34/3\n            sage: pari('sin(x+O(x^10))').truncate()\n            1/362880*x^9 - 1/5040*x^7 + 1/120*x^5 - 1/6*x^3 + x\n            sage: pari('sin(x+O(x^10))').round()   # each coefficient has abs < 1\n            x + O(x^10)\n        ";
  static PyObject *__pyx_pw_7example_3gen_249truncate(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_estimate = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("truncate (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__estimate,0};
      PyObject* values[1] = {0};
      values[0] = __pyx_k_46;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__estimate);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "truncate") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3824; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_estimate = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("truncate", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3824; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.truncate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_248truncate(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_estimate);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3824
 *         return sizedigit(x.g)
 * 
 *     def truncate(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         truncate(x,estimate=False): Return the truncation of x. If estimate
 */

  static PyObject *__pyx_pf_7example_3gen_248truncate(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_estimate) {
    long __pyx_v_e;
    struct __pyx_obj_7example_gen *__pyx_v_y = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("truncate", 0);

    /* "example.pyx":3881
 *         cdef long e
 *         cdef gen y
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3882
 *         cdef gen y
 *         sig_on()
 *         if not estimate:             # <<<<<<<<<<<<<<
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_estimate); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = (!__pyx_t_2);
    if (__pyx_t_3) {

      /* "example.pyx":3883
 *         sig_on()
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))             # <<<<<<<<<<<<<<
 *         y = P.new_gen(gcvtoi(x.g, &e))
 *         return y, e
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtrunc(__pyx_v_x->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":3884
 *         if not estimate:
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))             # <<<<<<<<<<<<<<
 *         return y, e
 * 
 */
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gcvtoi(__pyx_v_x->g, (&__pyx_v_e)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_y = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "example.pyx":3885
 *             return P.new_gen(gtrunc(x.g))
 *         y = P.new_gen(gcvtoi(x.g, &e))
 *         return y, e             # <<<<<<<<<<<<<<
 * 
 *     def valuation(gen x, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyInt_FromLong(__pyx_v_e); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_INCREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_y));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_y));
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_r = ((PyObject *)__pyx_t_5);
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.truncate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_y);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_251valuation(PyObject *__pyx_v_x, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_250valuation[] = "\n        valuation(x,p): Return the valuation of x with respect to p.\n\n        The valuation is the highest exponent of p dividing x.\n\n        - If p is an integer, x must be an integer, an intmod whose\n          modulus is divisible by p, a rational number, a p-adic\n          number, or a polynomial or power series in which case the\n          valuation is the minimum of the valuations of the\n          coefficients.\n\n        - If p is a polynomial, x must be a polynomial or a rational\n          function. If p is a monomial then x may also be a power\n          series.\n\n        - If x is a vector, complex or quadratic number, then the\n          valuation is the minimum of the component valuations.\n\n        - If x = 0, the result is `2^31-1` on 32-bit machines or\n          `2^63-1` on 64-bit machines if x is an exact\n          object. If x is a p-adic number or power series, the result\n          is the exponent of the zero.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``p`` - coercible to gen\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - integer\n\n\n        EXAMPLES::\n\n            sage: pari(9).valuation(3)\n            2\n            sage: pari(9).valuation(9)\n            1\n            sage: x = pari(9).Mod(27); x.valuation(3)\n            2\n            sage: pari('5/3').valuation(3)\n            -1\n            sage: pari('9 + 3*x + 15*x^2').valuation(3)\n            1\n            sage: pari([9,3,15]).valuation(3)\n            1\n            sage: pari('9 + 3*x + 15*x^2 + O(x^5)').valuation(3)\n            1\n\n        ::\n\n            sage: pari('x^2*(x+1)^3').valuation(pari('x+1'))\n            3\n            sage: pari('x + O(x^5)').valuation('x')\n            1\n            sage: pari('2*x^2 + O(x^5)').valuation('x')\n            2\n\n        ::\n\n            sage: pari(0).valuation(3)\n            2147483647            # 32-bit\n            9223372036854775807   # 64-bit\n        ";
  static PyObject *__pyx_pw_7example_3gen_251valuation(PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("valuation (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_250valuation(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3887
 *         return y, e
 * 
 *     def valuation(gen x, p):             # <<<<<<<<<<<<<<
 *         """
 *         valuation(x,p): Return the valuation of x with respect to p.
 */

  static PyObject *__pyx_pf_7example_3gen_250valuation(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_p) {
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("valuation", 0);

    /* "example.pyx":3958
 *         """
 *         cdef long v
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         v = ggval(x.g, t0)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":3959
 *         cdef long v
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         v = ggval(x.g, t0)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":3960
 *         t0GEN(p)
 *         sig_on()
 *         v = ggval(x.g, t0)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return v
 */
    __pyx_v_v = ggval(__pyx_v_x->g, __pyx_v_7example_t0);

    /* "example.pyx":3961
 *         sig_on()
 *         v = ggval(x.g, t0)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    _pari_sig_off();

    /* "example.pyx":3962
 *         v = ggval(x.g, t0)
 *         sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def _valp(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.valuation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_253_valp(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_252_valp[] = "\n        Return the valuation of x where x is a p-adic number (t_PADIC)\n        or a laurent series (t_SER).  If x is a different type, this\n        will give a bogus number.\n\n        EXAMPLES::\n\n            sage: pari('1/x^2 + O(x^10)')._valp()\n            -2\n            sage: pari('O(x^10)')._valp()\n            10\n            sage: pari('(1145234796 + O(3^10))/771966234')._valp()\n            -2\n            sage: pari('O(2^10)')._valp()\n            10\n            sage: pari('x')._valp()   # random\n            -35184372088832\n        ";
  static PyObject *__pyx_pw_7example_3gen_253_valp(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("_valp (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_252_valp(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3964
 *         return v
 * 
 *     def _valp(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Return the valuation of x where x is a p-adic number (t_PADIC)
 */

  static PyObject *__pyx_pf_7example_3gen_252_valp(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_valp", 0);

    /* "example.pyx":3984
 *         """
 *         # This is a simple macro, so we don't need sig_on()
 *         return valp(x.g)             # <<<<<<<<<<<<<<
 * 
 *     def variable(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(valp(__pyx_v_x->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen._valp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_255variable(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_254variable[] = "\n        variable(x): Return the main variable of the object x, or p if x is\n        a p-adic number.\n\n        This function raises a TypeError exception on scalars, i.e., on\n        objects with no variable associated to them.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari('x^2 + x -2').variable()\n            x\n            sage: pari('1+2^3 + O(2^5)').variable()\n            2\n            sage: pari('x+y0').variable()\n            x\n            sage: pari('y0+z0').variable()\n            y0\n        ";
  static PyObject *__pyx_pw_7example_3gen_255variable(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("variable (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_254variable(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":3986
 *         return valp(x.g)
 * 
 *     def variable(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         variable(x): Return the main variable of the object x, or p if x is
 */

  static PyObject *__pyx_pf_7example_3gen_254variable(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("variable", 0);

    /* "example.pyx":4013
 *             y0
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gpolvar(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4013; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4014
 *         """
 *         sig_on()
 *         return P.new_gen(gpolvar(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gpolvar(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.variable", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_257abs(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_256abs[] = "\n        Returns the absolute value of x (its modulus, if x is complex).\n        Rational functions are not allowed. Contrary to most transcendental\n        functions, an exact argument is not converted to a real number\n        before applying abs and an exact result is returned if possible.\n\n        EXAMPLES::\n\n            sage: x = pari(\"-27.1\")\n            sage: x.abs()\n            27.1000000000000\n\n        If x is a polynomial, returns -x if the leading coefficient is real\n        and negative else returns x. For a power series, the constant\n        coefficient is considered instead.\n\n        EXAMPLES::\n\n            sage: pari('x-1.2*x^2').abs()\n            1.20000000000000*x^2 - x\n        ";
  static PyObject *__pyx_pw_7example_3gen_257abs(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("abs (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_256abs(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4023
 *     ###########################################
 * 
 *     def abs(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the absolute value of x (its modulus, if x is complex).
 */

  static PyObject *__pyx_pf_7example_3gen_256abs(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("abs", 0);

    /* "example.pyx":4045
 *             1.20000000000000*x^2 - x
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec parameter here has no effect
 *         return P.new_gen(gabs(x.g, prec))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4045; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4047
 *         sig_on()
 *         # the prec parameter here has no effect
 *         return P.new_gen(gabs(x.g, prec))             # <<<<<<<<<<<<<<
 * 
 *     def acos(gen x, long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gabs(__pyx_v_x->g, __pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.abs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_259acos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_258acos[] = "\n        The principal branch of `\\cos^{-1}(x)`, so that\n        `\\RR e(\\mathrm{acos}(x))` belongs to `[0,Pi]`. If `x`\n        is real and `|x| > 1`, then `\\mathrm{acos}(x)` is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).acos()\n            1.04719755119660\n            sage: pari(1/2).acos()\n            1.04719755119660\n            sage: pari(1.1).acos()\n            0.443568254385115*I\n            sage: C.<i> = ComplexField()\n            sage: pari(1.1+i).acos()\n            0.849343054245252 - 1.09770986682533*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_259acos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("acos (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "acos") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4049; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4049; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("acos", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4049; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.acos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_258acos(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4049
 *         return P.new_gen(gabs(x.g, prec))
 * 
 *     def acos(gen x, long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cos^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_258acos(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("acos", 0);

    /* "example.pyx":4072
 *             0.849343054245252 - 1.09770986682533*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gacos(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4073
 *         """
 *         sig_on()
 *         return P.new_gen(gacos(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def acosh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gacos(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.acos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_261acosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_260acosh[] = "\n        The principal branch of `\\cosh^{-1}(x)`, so that\n        `\\Im(\\mathrm{acosh}(x))` belongs to `[0,Pi]`. If\n        `x` is real and `x < 1`, then\n        `\\mathrm{acosh}(x)` is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).acosh()\n            1.31695789692482\n            sage: pari(0).acosh()\n            1.57079632679490*I\n            sage: C.<i> = ComplexField()\n            sage: pari(i).acosh()\n            0.881373587019543 + 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_261acosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("acosh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "acosh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4075; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("acosh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4075; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.acosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_260acosh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4075
 *         return P.new_gen(gacos(x.g, pbw(precision)))
 * 
 *     def acosh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\cosh^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_260acosh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("acosh", 0);

    /* "example.pyx":4097
 *             0.881373587019543 + 1.57079632679490*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gach(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4098
 *         """
 *         sig_on()
 *         return P.new_gen(gach(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def agm(gen x, y, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gach(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.acosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_263agm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_262agm[] = "\n        The arithmetic-geometric mean of x and y. In the case of complex or\n        negative numbers, the principal square root is always chosen.\n        p-adic or power series arguments are also allowed. Note that a\n        p-adic AGM exists only if x/y is congruent to 1 modulo p (modulo 16\n        for p=2). x and y cannot both be vectors or matrices.\n\n        If any of `x` or `y` is an exact argument, it is\n        first converted to a real or complex number using the optional\n        parameter precision (in bits). If the arguments are inexact (e.g.\n        real), the smallest of their two precisions is used in the\n        computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).agm(2)\n            2.00000000000000\n            sage: pari(0).agm(1)\n            0\n            sage: pari(1).agm(2)\n            1.45679103104691\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).agm(-3)\n            -0.964731722290876 + 1.15700282952632*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_263agm(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("agm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "agm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4100; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("agm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4100; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.agm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_262agm(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4100
 *         return P.new_gen(gach(x.g, pbw(precision)))
 * 
 *     def agm(gen x, y, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The arithmetic-geometric mean of x and y. In the case of complex or
 */

  static PyObject *__pyx_pf_7example_3gen_262agm(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("agm", 0);

    /* "example.pyx":4126
 *             -0.964731722290876 + 1.15700282952632*I
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(agm(x.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4127
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(agm(x.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4128
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(agm(x.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def arg(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, agm(__pyx_v_x->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.agm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_265arg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_264arg[] = "\n        arg(x): argument of x,such that `-\\pi < \\arg(x) \\leq \\pi`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).arg()\n            0.463647609000806\n        ";
  static PyObject *__pyx_pw_7example_3gen_265arg(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("arg (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "arg") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("arg", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4130; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.arg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_264arg(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4130
 *         return P.new_gen(agm(x.g, t0, pbw(precision)))
 * 
 *     def arg(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         arg(x): argument of x,such that `-\pi < \arg(x) \leq \pi`.
 */

  static PyObject *__pyx_pf_7example_3gen_264arg(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("arg", 0);

    /* "example.pyx":4145
 *             0.463647609000806
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(garg(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4146
 *         """
 *         sig_on()
 *         return P.new_gen(garg(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def asin(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, garg(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.arg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_267asin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_266asin[] = "\n        The principal branch of `\\sin^{-1}(x)`, so that\n        `\\RR e(\\mathrm{asin}(x))` belongs to `[-\\pi/2,\\pi/2]`. If\n        `x` is real and `|x| > 1` then `\\mathrm{asin}(x)`\n        is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(pari(0.5).sin()).asin()\n            0.500000000000000\n            sage: pari(2).asin()\n            1.57079632679490 - 1.31695789692482*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_267asin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("asin (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asin") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4148; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("asin", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4148; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.asin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_266asin(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4148
 *         return P.new_gen(garg(x.g, pbw(precision)))
 * 
 *     def asin(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sin^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_266asin(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("asin", 0);

    /* "example.pyx":4167
 *             1.57079632679490 - 1.31695789692482*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gasin(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4168
 *         """
 *         sig_on()
 *         return P.new_gen(gasin(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def asinh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gasin(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.asin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_269asinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_268asinh[] = "\n        The principal branch of `\\sinh^{-1}(x)`, so that\n        `\\Im(\\mathrm{asinh}(x))` belongs to `[-\\pi/2,\\pi/2]`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).asinh()\n            1.44363547517881\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).asinh()\n            1.52857091948100 + 0.427078586392476*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_269asinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("asinh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asinh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4170; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("asinh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4170; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.asinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_268asinh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4170
 *         return P.new_gen(gasin(x.g, pbw(precision)))
 * 
 *     def asinh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\sinh^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_268asinh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("asinh", 0);

    /* "example.pyx":4188
 *             1.52857091948100 + 0.427078586392476*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gash(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4189
 *         """
 *         sig_on()
 *         return P.new_gen(gash(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def atan(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gash(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.asinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_271atan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_270atan[] = "\n        The principal branch of `\\tan^{-1}(x)`, so that\n        `\\RR e(\\mathrm{atan}(x))` belongs to `]-\\pi/2, \\pi/2[`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).atan()\n            0.785398163397448\n            sage: C.<i> = ComplexField()\n            sage: pari(1.5+i).atan()\n            1.10714871779409 + 0.255412811882995*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_271atan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("atan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "atan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("atan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4191; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.atan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_270atan(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4191
 *         return P.new_gen(gash(x.g, pbw(precision)))
 * 
 *     def atan(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tan^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_270atan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("atan", 0);

    /* "example.pyx":4209
 *             1.10714871779409 + 0.255412811882995*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gatan(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4210
 *         """
 *         sig_on()
 *         return P.new_gen(gatan(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def atanh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gatan(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.atan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_273atanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_272atanh[] = "\n        The principal branch of `\\tanh^{-1}(x)`, so that\n        `\\Im(\\mathrm{atanh}(x))` belongs to `]-\\pi/2,\\pi/2]`. If\n        `x` is real and `|x| > 1` then `\\mathrm{atanh}(x)`\n        is complex.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).atanh()\n            0.E-19\n            sage: pari(2).atanh()\n            0.549306144334055 - 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_273atanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("atanh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "atanh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("atanh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4212; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.atanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_272atanh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4212
 *         return P.new_gen(gatan(x.g, pbw(precision)))
 * 
 *     def atanh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of `\tanh^{-1}(x)`, so that
 */

  static PyObject *__pyx_pf_7example_3gen_272atanh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("atanh", 0);

    /* "example.pyx":4231
 *             0.549306144334055 - 1.57079632679490*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gath(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4232
 *         """
 *         sig_on()
 *         return P.new_gen(gath(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bernfrac(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gath(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4232; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.atanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_275bernfrac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_274bernfrac[] = "\n        The Bernoulli number `B_x`, where `B_0 = 1`,\n        `B_1 = -1/2`, `B_2 = 1/6,\\ldots,` expressed as a\n        rational number. The argument `x` should be of type\n        integer.\n\n        EXAMPLES::\n\n            sage: pari(18).bernfrac()\n            43867/798\n            sage: [pari(n).bernfrac() for n in range(10)]\n            [1, -1/2, 1/6, 0, -1/30, 0, 1/42, 0, -1/30, 0]\n        ";
  static PyObject *__pyx_pw_7example_3gen_275bernfrac(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernfrac (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_274bernfrac(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4234
 *         return P.new_gen(gath(x.g, pbw(precision)))
 * 
 *     def bernfrac(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, where `B_0 = 1`,
 */

  static PyObject *__pyx_pf_7example_3gen_274bernfrac(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernfrac", 0);

    /* "example.pyx":4248
 *             [1, -1/2, 1/6, 0, -1/30, 0, 1/42, 0, -1/30, 0]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bernfrac(x))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4249
 *         """
 *         sig_on()
 *         return P.new_gen(bernfrac(x))             # <<<<<<<<<<<<<<
 * 
 *     def bernreal(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, bernfrac(__pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.bernfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_277bernreal(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_276bernreal[] = "\n        The Bernoulli number `B_x`, as for the function bernfrac,\n        but `B_x` is returned as a real number (with the current\n        precision).\n\n        EXAMPLES::\n\n            sage: pari(18).bernreal()\n            54.9711779448622\n        ";
  static PyObject *__pyx_pw_7example_3gen_277bernreal(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernreal (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_276bernreal(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4251
 *         return P.new_gen(bernfrac(x))
 * 
 *     def bernreal(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         The Bernoulli number `B_x`, as for the function bernfrac,
 */

  static PyObject *__pyx_pf_7example_3gen_276bernreal(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernreal", 0);

    /* "example.pyx":4262
 *             54.9711779448622
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the argument prec has no effect
 *         return P.new_gen(bernreal(x, prec))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4264
 *         sig_on()
 *         # the argument prec has no effect
 *         return P.new_gen(bernreal(x, prec))             # <<<<<<<<<<<<<<
 * 
 *     def bernvec(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, bernreal(__pyx_t_2, __pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.bernreal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_279bernvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_278bernvec[] = "\n        Creates a vector containing, as rational numbers, the Bernoulli\n        numbers `B_0, B_2,\\ldots, B_{2x}`. This routine is\n        obsolete. Use bernfrac instead each time you need a Bernoulli\n        number in exact form.\n\n        Note: this routine is implemented using repeated independent calls\n        to bernfrac, which is faster than the standard recursion in exact\n        arithmetic.\n\n        EXAMPLES::\n\n            sage: pari(8).bernvec()\n            [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]\n            sage: [pari(2*n).bernfrac() for n in range(9)]\n            [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]\n        ";
  static PyObject *__pyx_pw_7example_3gen_279bernvec(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bernvec (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_278bernvec(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4266
 *         return P.new_gen(bernreal(x, prec))
 * 
 *     def bernvec(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Creates a vector containing, as rational numbers, the Bernoulli
 */

  static PyObject *__pyx_pf_7example_3gen_278bernvec(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bernvec", 0);

    /* "example.pyx":4284
 *             [1, 1/6, -1/30, 1/42, -1/30, 5/66, -691/2730, 7/6, -3617/510]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(bernvec(x))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4285
 *         """
 *         sig_on()
 *         return P.new_gen(bernvec(x))             # <<<<<<<<<<<<<<
 * 
 *     def besselh1(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(((PyObject *)__pyx_v_x)); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, bernvec(__pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.bernvec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_281besselh1(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_280besselh1[] = "\n        The `H^1`-Bessel function of index `\\nu` and\n        argument `x`.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselh1(3)\n            0.486091260585891 - 0.160400393484924*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_281besselh1(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselh1 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselh1") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselh1", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besselh1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_280besselh1(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4287
 *         return P.new_gen(bernvec(x))
 * 
 *     def besselh1(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^1`-Bessel function of index `\nu` and
 */

  static PyObject *__pyx_pf_7example_3gen_280besselh1(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselh1", 0);

    /* "example.pyx":4303
 *             0.486091260585891 - 0.160400393484924*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(hbessel1(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4304
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hbessel1(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4305
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(hbessel1(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselh2(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, hbessel1(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besselh1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_283besselh2(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_282besselh2[] = "\n        The `H^2`-Bessel function of index `\\nu` and\n        argument `x`.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselh2(3)\n            0.486091260585891 + 0.160400393484924*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_283besselh2(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselh2 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselh2") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselh2", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4307; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besselh2", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_282besselh2(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4307
 *         return P.new_gen(hbessel1(nu.g, t0, pbw(precision)))
 * 
 *     def besselh2(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The `H^2`-Bessel function of index `\nu` and
 */

  static PyObject *__pyx_pf_7example_3gen_282besselh2(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselh2", 0);

    /* "example.pyx":4323
 *             0.486091260585891 + 0.160400393484924*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(hbessel2(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4324
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hbessel2(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4325
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(hbessel2(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselj(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, hbessel2(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besselh2", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_285besselj(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_284besselj[] = "\n        Bessel J function (Bessel function of the first kind), with index\n        `\\nu` and argument `x`. If `x` converts to\n        a power series, the initial factor\n        `(x/2)^{\\nu}/\\Gamma(\\nu+1)` is omitted (since it cannot be\n        represented in PARI when `\\nu` is not integral).\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besselj(3)\n            0.486091260585891\n        ";
  static PyObject *__pyx_pw_7example_3gen_285besselj(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselj (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselj") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselj", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4327; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besselj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_284besselj(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4327
 *         return P.new_gen(hbessel2(nu.g, t0, pbw(precision)))
 * 
 *     def besselj(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel J function (Bessel function of the first kind), with index
 */

  static PyObject *__pyx_pf_7example_3gen_284besselj(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselj", 0);

    /* "example.pyx":4346
 *             0.486091260585891
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(jbessel(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4347
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jbessel(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4348
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(jbessel(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseljh(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, jbessel(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besselj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_287besseljh(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_286besseljh[] = "\n        J-Bessel function of half integral index (Spherical Bessel\n        function of the first kind). More precisely, besseljh(n,x) computes\n        `J_{n+1/2}(x)` where n must an integer, and x is any\n        complex value. In the current implementation (PARI, version\n        2.2.11), this function is not very accurate when `x` is\n        small.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besseljh(3)\n            0.4127100324          # 32-bit\n            0.412710032209716     # 64-bit\n        ";
  static PyObject *__pyx_pw_7example_3gen_287besseljh(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseljh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseljh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseljh", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4350; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besseljh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_286besseljh(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4350
 *         return P.new_gen(jbessel(nu.g, t0, pbw(precision)))
 * 
 *     def besseljh(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         J-Bessel function of half integral index (Spherical Bessel
 */

  static PyObject *__pyx_pf_7example_3gen_286besseljh(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseljh", 0);

    /* "example.pyx":4371
 *             0.412710032209716     # 64-bit
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(jbesselh(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4372
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jbesselh(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4373
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(jbesselh(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseli(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, jbesselh(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besseljh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_289besseli(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_288besseli[] = "\n        Bessel I function (Bessel function of the second kind), with index\n        `\\nu` and argument `x`. If `x` converts to\n        a power series, the initial factor\n        `(x/2)^{\\nu}/\\Gamma(\\nu+1)` is omitted (since it cannot be\n        represented in PARI when `\\nu` is not integral).\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).besseli(3)\n            2.24521244092995\n            sage: C.<i> = ComplexField()\n            sage: pari(2).besseli(3+i)\n            1.12539407613913 + 2.08313822670661*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_289besseli(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseli (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseli") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4375; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseli", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4375; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besseli", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_288besseli(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4375
 *         return P.new_gen(jbesselh(nu.g, t0, pbw(precision)))
 * 
 *     def besseli(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Bessel I function (Bessel function of the second kind), with index
 */

  static PyObject *__pyx_pf_7example_3gen_288besseli(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseli", 0);

    /* "example.pyx":4397
 *             1.12539407613913 + 2.08313822670661*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(ibessel(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4398
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ibessel(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4399
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(ibessel(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besselk(gen nu, x, long flag=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ibessel(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besseli", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_291besselk(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_290besselk[] = "\n        nu.besselk(x, flag=0): K-Bessel function (modified Bessel function\n        of the second kind) of index nu, which can be complex, and argument\n        x.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        INPUT:\n\n\n        -  ``nu`` - a complex number\n\n        -  ``x`` - real number (positive or negative)\n\n        -  ``flag`` - default: 0 or 1: use hyperu (hyperu is\n           much slower for small x, and doesn't work for negative x).\n\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).besselk(3)\n            0.0455907718407551 + 0.0289192946582081*I\n\n        ::\n\n            sage: pari(2+i).besselk(-3)\n            -4.34870874986752 - 5.38744882697109*I\n\n        ::\n\n            sage: pari(2+i).besselk(300, flag=1)\n            3.74224603319728 E-132 + 2.49071062641525 E-134*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_291besselk(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    CYTHON_UNUSED long __pyx_v_flag;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besselk (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besselk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_precision = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besselk", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4401; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_290besselk(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4401
 *         return P.new_gen(ibessel(nu.g, t0, pbw(precision)))
 * 
 *     def besselk(gen nu, x, long flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besselk(x, flag=0): K-Bessel function (modified Bessel function
 */

  static PyObject *__pyx_pf_7example_3gen_290besselk(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besselk", 0);

    /* "example.pyx":4440
 *             3.74224603319728 E-132 + 2.49071062641525 E-134*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(kbessel(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4441
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(kbessel(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4442
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(kbessel(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def besseln(gen nu, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, kbessel(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_293besseln(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_292besseln[] = "\n        nu.besseln(x): Bessel N function (Spherical Bessel function of the\n        second kind) of index nu and argument x.\n\n        If `nu` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(2+i).besseln(3)\n            -0.280775566958244 - 0.486708533223726*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_293besseln(PyObject *__pyx_v_nu, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("besseln (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "besseln") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("besseln", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4444; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.besseln", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_292besseln(((struct __pyx_obj_7example_gen *)__pyx_v_nu), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4444
 *         return P.new_gen(kbessel(nu.g, t0, pbw(precision)))
 * 
 *     def besseln(gen nu, x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nu.besseln(x): Bessel N function (Spherical Bessel function of the
 */

  static PyObject *__pyx_pf_7example_3gen_292besseln(struct __pyx_obj_7example_gen *__pyx_v_nu, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("besseln", 0);

    /* "example.pyx":4461
 *             -0.280775566958244 - 0.486708533223726*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(nbessel(nu.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4462
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nbessel(nu.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4463
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(nbessel(nu.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cos(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, nbessel(__pyx_v_nu->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.besseln", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_295cos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_294cos[] = "\n        The cosine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1.5).cos()\n            0.0707372016677029\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).cos()\n            0.833730025131149 - 0.988897705762865*I\n            sage: pari('x+O(x^8)').cos()\n            1 - 1/2*x^2 + 1/24*x^4 - 1/720*x^6 + 1/40320*x^8 + O(x^9)\n        ";
  static PyObject *__pyx_pw_7example_3gen_295cos(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cos (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cos") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4465; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cos", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4465; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.cos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_294cos(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4465
 *         return P.new_gen(nbessel(nu.g, t0, pbw(precision)))
 * 
 *     def cos(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cosine function.
 */

  static PyObject *__pyx_pf_7example_3gen_294cos(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cos", 0);

    /* "example.pyx":4484
 *             1 - 1/2*x^2 + 1/24*x^4 - 1/720*x^6 + 1/40320*x^8 + O(x^9)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcos(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4485
 *         """
 *         sig_on()
 *         return P.new_gen(gcos(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cosh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gcos(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.cos", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_297cosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_296cosh[] = "\n        The hyperbolic cosine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1.5).cosh()\n            2.35240961524325\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).cosh()\n            0.833730025131149 + 0.988897705762865*I\n            sage: pari('x+O(x^8)').cosh()\n            1 + 1/2*x^2 + 1/24*x^4 + 1/720*x^6 + O(x^8)\n        ";
  static PyObject *__pyx_pw_7example_3gen_297cosh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cosh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cosh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4487; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cosh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4487; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.cosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_296cosh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4487
 *         return P.new_gen(gcos(x.g, pbw(precision)))
 * 
 *     def cosh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic cosine function.
 */

  static PyObject *__pyx_pf_7example_3gen_296cosh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cosh", 0);

    /* "example.pyx":4506
 *             1 + 1/2*x^2 + 1/24*x^4 + 1/720*x^6 + O(x^8)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gch(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4507
 *         """
 *         sig_on()
 *         return P.new_gen(gch(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def cotan(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gch(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.cosh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_299cotan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_298cotan[] = "\n        The cotangent of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(5).cotan()\n            -0.295812915532746\n\n        Computing the cotangent of `\\pi` doesn't raise an error,\n        but instead just returns a very large (positive or negative)\n        number.\n\n        ::\n\n            sage: x = RR(pi)\n            sage: pari(x).cotan()         # random\n            -8.17674825 E15\n        ";
  static PyObject *__pyx_pw_7example_3gen_299cotan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("cotan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cotan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4509; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("cotan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4509; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.cotan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_298cotan(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4509
 *         return P.new_gen(gch(x.g, pbw(precision)))
 * 
 *     def cotan(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The cotangent of x.
 */

  static PyObject *__pyx_pf_7example_3gen_298cotan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("cotan", 0);

    /* "example.pyx":4533
 *             -8.17674825 E15
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gcotan(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4534
 *         """
 *         sig_on()
 *         return P.new_gen(gcotan(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def dilog(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gcotan(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.cotan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_301dilog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_300dilog[] = "\n        The principal branch of the dilogarithm of `x`, i.e. the\n        analytic continuation of the power series\n        `\\log_2(x) = \\sum_{n>=1} x^n/n^2`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).dilog()\n            1.64493406684823\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).dilog()\n            0.616850275068085 + 1.46036211675312*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_301dilog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("dilog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dilog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4536; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("dilog", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4536; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.dilog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_300dilog(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4536
 *         return P.new_gen(gcotan(x.g, pbw(precision)))
 * 
 *     def dilog(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         The principal branch of the dilogarithm of `x`, i.e. the
 */

  static PyObject *__pyx_pf_7example_3gen_300dilog(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("dilog", 0);

    /* "example.pyx":4555
 *             0.616850275068085 + 1.46036211675312*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(dilog(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4556
 *         """
 *         sig_on()
 *         return P.new_gen(dilog(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def eint1(gen x, long n=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, dilog(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.dilog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_303eint1(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_302eint1[] = "\n        x.eint1(n): exponential integral E1(x):\n\n        .. math::\n\n                         \\int_{x}^{\\infty} \\frac{e^{-t}}{t} dt\n\n\n        If n is present, output the vector [eint1(x), eint1(2\\*x), ...,\n        eint1(n\\*x)]. This is faster than repeatedly calling eint1(i\\*x).\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        REFERENCE:\n\n        - See page 262, Prop 5.6.12, of Cohen's book \"A Course in\n          Computational Algebraic Number Theory\".\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_303eint1(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eint1 (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eint1") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)0);
      }
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("eint1", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4558; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.eint1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_302eint1(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4558
 *         return P.new_gen(dilog(x.g, pbw(precision)))
 * 
 *     def eint1(gen x, long n=0, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eint1(n): exponential integral E1(x):
 */

  static PyObject *__pyx_pf_7example_3gen_302eint1(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_n, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eint1", 0);

    /* "example.pyx":4582
 *         EXAMPLES:
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if n <= 0:
 *             return P.new_gen(eint1(x.g, pbw(precision)))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4583
 *         """
 *         sig_on()
 *         if n <= 0:             # <<<<<<<<<<<<<<
 *             return P.new_gen(eint1(x.g, pbw(precision)))
 *         else:
 */
    __pyx_t_2 = (__pyx_v_n <= 0);
    if (__pyx_t_2) {

      /* "example.pyx":4584
 *         sig_on()
 *         if n <= 0:
 *             return P.new_gen(eint1(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(veceint1(x.g, stoi(n), pbw(precision)))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_precision);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
      __Pyx_GIVEREF(__pyx_v_precision);
      __pyx_t_5 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, eint1(__pyx_v_x->g, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":4586
 *             return P.new_gen(eint1(x.g, pbw(precision)))
 *         else:
 *             return P.new_gen(veceint1(x.g, stoi(n), pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def erfc(gen x, precision=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_precision);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
      __Pyx_GIVEREF(__pyx_v_precision);
      __pyx_t_3 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, veceint1(__pyx_v_x->g, stoi(__pyx_v_n), __pyx_t_6))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.eint1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_305erfc(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_304erfc[] = "\n        Return the complementary error function:\n\n        .. math::\n\n            (2/\\sqrt{\\pi}) \\int_{x}^{\\infty} e^{-t^2} dt.\n\n\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).erfc()\n            0.157299207050285\n        ";
  static PyObject *__pyx_pw_7example_3gen_305erfc(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("erfc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "erfc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4588; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("erfc", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4588; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.erfc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_304erfc(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4588
 *             return P.new_gen(veceint1(x.g, stoi(n), pbw(precision)))
 * 
 *     def erfc(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the complementary error function:
 */

  static PyObject *__pyx_pf_7example_3gen_304erfc(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("erfc", 0);

    /* "example.pyx":4608
 *             0.157299207050285
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gerfc(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4608; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4609
 *         """
 *         sig_on()
 *         return P.new_gen(gerfc(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def eta(gen x, flag=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gerfc(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.erfc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_307eta(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_306eta[] = "\n        x.eta(flag=0): if flag=0, `\\eta` function without the\n        `q^{1/24}`; otherwise `\\eta` of the complex number\n        `x` in the upper half plane intelligently computed using\n        `\\mathrm{SL}(2,\\ZZ)` transformations.\n\n        DETAILS: This functions computes the following. If the input\n        `x` is a complex number with positive imaginary part, the\n        result is `\\prod_{n=1}^{\\infty} (q-1^n)`, where\n        `q=e^{2 i \\pi x}`. If `x` is a power series\n        (or can be converted to a power series) with positive valuation,\n        the result is `\\prod_{n=1}^{\\infty} (1-x^n)`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(i).eta()\n            0.998129069925959\n        ";
  static PyObject *__pyx_pw_7example_3gen_307eta(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4611; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("eta", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4611; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.eta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_306eta(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4611
 *         return P.new_gen(gerfc(x.g, pbw(precision)))
 * 
 *     def eta(gen x, flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.eta(flag=0): if flag=0, `\eta` function without the
 */

  static PyObject *__pyx_pf_7example_3gen_306eta(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eta", 0);

    /* "example.pyx":4636
 *             0.998129069925959
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, pbw(precision)))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4637
 *         """
 *         sig_on()
 *         if flag == 1:             # <<<<<<<<<<<<<<
 *             return P.new_gen(trueeta(x.g, pbw(precision)))
 *         return P.new_gen(eta(x.g, pbw(precision)))
 */
    __pyx_t_2 = PyObject_RichCompare(__pyx_v_flag, __pyx_int_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_3) {

      /* "example.pyx":4638
 *         sig_on()
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(eta(x.g, pbw(precision)))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_precision);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
      __Pyx_GIVEREF(__pyx_v_precision);
      __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, trueeta(__pyx_v_x->g, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":4639
 *         if flag == 1:
 *             return P.new_gen(trueeta(x.g, pbw(precision)))
 *         return P.new_gen(eta(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def exp(gen self, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_2 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, eta(__pyx_v_x->g, __pyx_t_6))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.eta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_309exp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_308exp[] = "\n        x.exp(): exponential of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).exp()\n            1.00000000000000\n            sage: pari(1).exp()\n            2.71828182845905\n            sage: pari('x+O(x^8)').exp()\n            1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + 1/720*x^6 + 1/5040*x^7 + O(x^8)\n        ";
  static PyObject *__pyx_pw_7example_3gen_309exp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("exp (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "exp") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("exp", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4641; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.exp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_308exp(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4641
 *         return P.new_gen(eta(x.g, pbw(precision)))
 * 
 *     def exp(gen self, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.exp(): exponential of x.
 */

  static PyObject *__pyx_pf_7example_3gen_308exp(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("exp", 0);

    /* "example.pyx":4659
 *             1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + 1/720*x^6 + 1/5040*x^7 + O(x^8)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gexp(self.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4660
 *         """
 *         sig_on()
 *         return P.new_gen(gexp(self.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def gamma(gen s, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gexp(__pyx_v_self->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.exp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_311gamma(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_310gamma[] = "\n        s.gamma(precision): Gamma function at s.\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).gamma()\n            1.00000000000000\n            sage: pari(5).gamma()\n            24.0000000000000\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).gamma()\n            0.498015668118356 - 0.154949828301811*I\n\n        TESTS::\n\n            sage: pari(-1).gamma()\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n        ";
  static PyObject *__pyx_pw_7example_3gen_311gamma(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4662; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_310gamma(((struct __pyx_obj_7example_gen *)__pyx_v_s), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4662
 *         return P.new_gen(gexp(self.g, pbw(precision)))
 * 
 *     def gamma(gen s, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gamma(precision): Gamma function at s.
 */

  static PyObject *__pyx_pf_7example_3gen_310gamma(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gamma", 0);

    /* "example.pyx":4688
 *             PariError:  (5)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ggamma(s.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4689
 *         """
 *         sig_on()
 *         return P.new_gen(ggamma(s.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def gammah(gen s, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ggamma(__pyx_v_s->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_313gammah(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_312gammah[] = "\n        s.gammah(): Gamma function evaluated at the argument x+1/2.\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).gammah()\n            1.32934038817914\n            sage: pari(5).gammah()\n            52.3427777845535\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).gammah()\n            0.575315188063452 + 0.0882106775440939*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_313gammah(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gammah (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gammah") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4691; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gammah", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4691; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.gammah", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_312gammah(((struct __pyx_obj_7example_gen *)__pyx_v_s), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4691
 *         return P.new_gen(ggamma(s.g, pbw(precision)))
 * 
 *     def gammah(gen s, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         s.gammah(): Gamma function evaluated at the argument x+1/2.
 */

  static PyObject *__pyx_pf_7example_3gen_312gammah(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gammah", 0);

    /* "example.pyx":4710
 *             0.575315188063452 + 0.0882106775440939*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ggamd(s.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4711
 *         """
 *         sig_on()
 *         return P.new_gen(ggamd(s.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def hyperu(gen a, b, x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ggamd(__pyx_v_s->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.gammah", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_315hyperu(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_314hyperu[] = "\n        a.hyperu(b,x): U-confluent hypergeometric function.\n\n        If `a`, `b`, or `x` is an exact argument,\n        it is first converted to a real or complex number using the\n        optional parameter precision (in bits). If the arguments are\n        inexact (e.g. real), the smallest of their precisions is used in\n        the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).hyperu(2,3)\n            0.333333333333333\n        ";
  static PyObject *__pyx_pw_7example_3gen_315hyperu(PyObject *__pyx_v_a, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("hyperu (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__b,&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("hyperu", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hyperu") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      __pyx_v_x = values[1];
      __pyx_v_precision = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("hyperu", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4713; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.hyperu", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_314hyperu(((struct __pyx_obj_7example_gen *)__pyx_v_a), __pyx_v_b, __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4713
 *         return P.new_gen(ggamd(s.g, pbw(precision)))
 * 
 *     def hyperu(gen a, b, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         a.hyperu(b,x): U-confluent hypergeometric function.
 */

  static PyObject *__pyx_pf_7example_3gen_314hyperu(struct __pyx_obj_7example_gen *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("hyperu", 0);

    /* "example.pyx":4728
 *             0.333333333333333
 *         """
 *         t0GEN(b)             # <<<<<<<<<<<<<<
 *         t1GEN(x)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4729
 *         """
 *         t0GEN(b)
 *         t1GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(hyperu(a.g, t0, t1, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4730
 *         t0GEN(b)
 *         t1GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(hyperu(a.g, t0, t1, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4731
 *         t1GEN(x)
 *         sig_on()
 *         return P.new_gen(hyperu(a.g, t0, t1, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def incgam(gen s, x, y=None, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, hyperu(__pyx_v_a->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.hyperu", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_317incgam(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_316incgam[] = "\n        s.incgam(x, y, precision): incomplete gamma function. y is optional\n        and is the precomputed value of gamma(s).\n\n        If `s` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `s` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).incgam(3-i)\n            -0.0458297859919946 + 0.0433696818726677*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_317incgam(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("incgam (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};

      /* "example.pyx":4733
 *         return P.new_gen(hyperu(a.g, t0, t1, pbw(precision)))
 * 
 *     def incgam(gen s, x, y=None, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgam(x, y, precision): incomplete gamma function. y is optional
 */
      values[1] = ((PyObject *)Py_None);
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "incgam") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4733; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      __pyx_v_precision = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("incgam", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4733; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.incgam", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_316incgam(((struct __pyx_obj_7example_gen *)__pyx_v_s), __pyx_v_x, __pyx_v_y, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_316incgam(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("incgam", 0);

    /* "example.pyx":4749
 *             -0.0458297859919946 + 0.0433696818726677*I
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         if y is None:
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4750
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if y is None:
 *             return P.new_gen(incgam(s.g, t0, pbw(precision)))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4751
 *         t0GEN(x)
 *         sig_on()
 *         if y is None:             # <<<<<<<<<<<<<<
 *             return P.new_gen(incgam(s.g, t0, pbw(precision)))
 *         else:
 */
    __pyx_t_3 = (__pyx_v_y == Py_None);
    if (__pyx_t_3) {

      /* "example.pyx":4752
 *         sig_on()
 *         if y is None:
 *             return P.new_gen(incgam(s.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 *         else:
 *             t1GEN(y)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_precision);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
      __Pyx_GIVEREF(__pyx_v_precision);
      __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, incgam(__pyx_v_s->g, __pyx_v_7example_t0, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":4754
 *             return P.new_gen(incgam(s.g, t0, pbw(precision)))
 *         else:
 *             t1GEN(y)             # <<<<<<<<<<<<<<
 *             return P.new_gen(incgam0(s.g, t0, t1, pbw(precision)))
 * 
 */
      __pyx_t_5 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "example.pyx":4755
 *         else:
 *             t1GEN(y)
 *             return P.new_gen(incgam0(s.g, t0, t1, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def incgamc(gen s, x, precision=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_INCREF(__pyx_v_precision);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
      __Pyx_GIVEREF(__pyx_v_precision);
      __pyx_t_1 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, incgam0(__pyx_v_s->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_t_6))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.incgam", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_319incgamc(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_318incgamc[] = "\n        s.incgamc(x): complementary incomplete gamma function.\n\n        The arguments `x` and `s` are complex numbers such\n        that `s` is not a pole of `\\Gamma` and\n        `|x|/(|s|+1)` is not much larger than `1`\n        (otherwise, the convergence is very slow). The function returns the\n        value of the integral\n        `\\int_{0}^{x} e^{-t} t^{s-1} dt.`\n\n        If `s` or `x` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).incgamc(2)\n            0.864664716763387\n        ";
  static PyObject *__pyx_pw_7example_3gen_319incgamc(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("incgamc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "incgamc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4757; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("incgamc", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4757; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.incgamc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_318incgamc(((struct __pyx_obj_7example_gen *)__pyx_v_s), __pyx_v_x, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4757
 *             return P.new_gen(incgam0(s.g, t0, t1, pbw(precision)))
 * 
 *     def incgamc(gen s, x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         s.incgamc(x): complementary incomplete gamma function.
 */

  static PyObject *__pyx_pf_7example_3gen_318incgamc(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("incgamc", 0);

    /* "example.pyx":4779
 *             0.864664716763387
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(incgamc(s.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":4780
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(incgamc(s.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4781
 *         t0GEN(x)
 *         sig_on()
 *         return P.new_gen(incgamc(s.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def log(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, incgamc(__pyx_v_s->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.incgamc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_321log(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_320log[] = "\n        x.log(): natural logarithm of x.\n\n        This function returns the principal branch of the natural logarithm\n        of `x`, i.e., the branch such that\n        `\\Im(\\log(x)) \\in ]-\\pi, \\pi].` The result is\n        complex (with imaginary part equal to `\\pi`) if\n        `x\\in \\RR` and `x<0`. In general, the algorithm uses\n        the formula\n\n        .. math::\n\n                         \\log(x) \\simeq \\frac{\\pi}{2{\\rm agm}(1,4/s)} - m\\log(2),\n\n\n        if `s=x 2^m` is large enough. (The result is exact to\n        `B` bits provided that `s>2^{B/2}`.) At low\n        accuracies, this function computes `\\log` using the series\n        expansion near `1`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        Note that `p`-adic arguments can also be given as input,\n        with the convention that `\\log(p)=0`. Hence, in particular,\n        `\\exp(\\log(x))/x` is not in general equal to `1`\n        but instead to a `(p-1)`-st root of unity (or\n        `\\pm 1` if `p=2`) times a power of `p`.\n\n        EXAMPLES::\n\n            sage: pari(5).log()\n            1.60943791243410\n            sage: C.<i> = ComplexField()\n            sage: pari(i).log()\n            0.E-19 + 1.57079632679490*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_321log(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("log (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "log") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4783; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("log", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4783; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.log", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_320log(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4783
 *         return P.new_gen(incgamc(s.g, t0, pbw(precision)))
 * 
 *     def log(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.log(): natural logarithm of x.
 */

  static PyObject *__pyx_pf_7example_3gen_320log(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("log", 0);

    /* "example.pyx":4823
 *             0.E-19 + 1.57079632679490*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(glog(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4824
 *         """
 *         sig_on()
 *         return P.new_gen(glog(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def lngamma(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, glog(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.log", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_323lngamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_322lngamma[] = "\n        This method is deprecated, please use :meth:`.log_gamma` instead.\n\n        See the :meth:`.log_gamma` method for documentation and examples.\n\n        EXAMPLES::\n\n            sage: pari(100).lngamma()\n            doctest:...: DeprecationWarning: The method lngamma() is deprecated. Use log_gamma() instead.\n            See http://trac.sagemath.org/6992 for details.\n            359.134205369575\n        ";
  static PyObject *__pyx_pw_7example_3gen_323lngamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lngamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lngamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lngamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4826; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.lngamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_322lngamma(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4826
 *         return P.new_gen(glog(x.g, pbw(precision)))
 * 
 *     def lngamma(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         This method is deprecated, please use :meth:`.log_gamma` instead.
 */

  static PyObject *__pyx_pf_7example_3gen_322lngamma(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lngamma", 0);

    /* "example.pyx":4841
 *         #from sage.misc.superseded  deprecation
 *         #deprecation(6992, "The method lngamma() is deprecated. Use log_gamma() instead.")
 *         return x.log_gamma(precision)             # <<<<<<<<<<<<<<
 * 
 *     def log_gamma(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_x), __pyx_n_s__log_gamma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.lngamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_325log_gamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_324log_gamma[] = "\n        Logarithm of the gamma function of x.\n\n        This function returns the principal branch of the logarithm of the\n        gamma function of `x`. The function\n        `\\log(\\Gamma(x))` is analytic on the complex plane with\n        non-positive integers removed. This function can have much larger\n        inputs than `\\Gamma` itself.\n\n        The `p`-adic analogue of this function is unfortunately not\n        implemented.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(100).log_gamma()\n            359.134205369575\n        ";
  static PyObject *__pyx_pw_7example_3gen_325log_gamma(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("log_gamma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "log_gamma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("log_gamma", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4843; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.log_gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_324log_gamma(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4843
 *         return x.log_gamma(precision)
 * 
 *     def log_gamma(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Logarithm of the gamma function of x.
 */

  static PyObject *__pyx_pf_7example_3gen_324log_gamma(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("log_gamma", 0);

    /* "example.pyx":4866
 *             359.134205369575
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(glngamma(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4866; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4867
 *         """
 *         sig_on()
 *         return P.new_gen(glngamma(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def polylog(gen x, long m, flag=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, glngamma(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.log_gamma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_327polylog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_326polylog[] = "\n        x.polylog(m,flag=0): m-th polylogarithm of x. flag is optional, and\n        can be 0: default, 1: D_m -modified m-th polylog of x, 2:\n        D_m-modified m-th polylog of x, 3: P_m-modified m-th polylog of\n        x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        TODO: Add more explanation, copied from the PARI manual.\n\n        EXAMPLES::\n\n            sage: pari(10).polylog(3)\n            5.64181141475134 - 8.32820207698027*I\n            sage: pari(10).polylog(3,0)\n            5.64181141475134 - 8.32820207698027*I\n            sage: pari(10).polylog(3,1)\n            0.523778453502411\n            sage: pari(10).polylog(3,2)\n            -0.400459056163451\n        ";
  static PyObject *__pyx_pw_7example_3gen_327polylog(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_m;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polylog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__m,&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__m)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polylog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_m = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_m == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_flag = values[1];
      __pyx_v_precision = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polylog", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4869; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polylog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_326polylog(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_m, __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4869
 *         return P.new_gen(glngamma(x.g, pbw(precision)))
 * 
 *     def polylog(gen x, long m, flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.polylog(m,flag=0): m-th polylogarithm of x. flag is optional, and
 */

  static PyObject *__pyx_pf_7example_3gen_326polylog(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_m, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polylog", 0);

    /* "example.pyx":4894
 *             -0.400459056163451
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(polylog0(m, x.g, flag, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4895
 *         """
 *         sig_on()
 *         return P.new_gen(polylog0(m, x.g, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def psi(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_5 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, polylog0(__pyx_v_m, __pyx_v_x->g, __pyx_t_2, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.polylog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_329psi(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_328psi[] = "\n        x.psi(): psi-function at x.\n\n        Return the `\\psi`-function of `x`, i.e., the\n        logarithmic derivative `\\Gamma'(x)/\\Gamma(x)`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).psi()\n            -0.577215664901533\n        ";
  static PyObject *__pyx_pw_7example_3gen_329psi(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("psi (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "psi") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4897; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("psi", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4897; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.psi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_328psi(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4897
 *         return P.new_gen(polylog0(m, x.g, flag, pbw(precision)))
 * 
 *     def psi(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.psi(): psi-function at x.
 */

  static PyObject *__pyx_pf_7example_3gen_328psi(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("psi", 0);

    /* "example.pyx":4914
 *             -0.577215664901533
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gpsi(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4915
 *         """
 *         sig_on()
 *         return P.new_gen(gpsi(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sin(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gpsi(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.psi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_331sin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_330sin[] = "\n        x.sin(): The sine of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).sin()\n            0.841470984807897\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).sin()\n            1.29845758141598 + 0.634963914784736*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_331sin(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sin (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sin") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4917; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sin", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4917; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.sin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_330sin(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4917
 *         return P.new_gen(gpsi(x.g, pbw(precision)))
 * 
 *     def sin(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sin(): The sine of x.
 */

  static PyObject *__pyx_pf_7example_3gen_330sin(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sin", 0);

    /* "example.pyx":4934
 *             1.29845758141598 + 0.634963914784736*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsin(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4935
 *         """
 *         sig_on()
 *         return P.new_gen(gsin(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sinh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsin(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4935; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.sin", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_333sinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_332sinh[] = "\n        The hyperbolic sine function.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0).sinh()\n            0.E-19\n            sage: C.<i> = ComplexField()\n            sage: pari(1+i).sinh()\n            0.634963914784736 + 1.29845758141598*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_333sinh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sinh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sinh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4937; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sinh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4937; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.sinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_332sinh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4937
 *         return P.new_gen(gsin(x.g, pbw(precision)))
 * 
 *     def sinh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         The hyperbolic sine function.
 */

  static PyObject *__pyx_pf_7example_3gen_332sinh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sinh", 0);

    /* "example.pyx":4954
 *             0.634963914784736 + 1.29845758141598*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsh(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4955
 *         """
 *         sig_on()
 *         return P.new_gen(gsh(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sqr(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsh(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.sinh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_335sqr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_334sqr[] = "\n        x.sqr(): square of x. Faster than, and most of the time (but not\n        always - see the examples) identical to x\\*x.\n\n        EXAMPLES::\n\n            sage: pari(2).sqr()\n            4\n\n        For `2`-adic numbers, x.sqr() may not be identical to x\\*x\n        (squaring a `2`-adic number increases its precision)::\n\n            sage: pari(\"1+O(2^5)\").sqr()\n            1 + O(2^6)\n            sage: pari(\"1+O(2^5)\")*pari(\"1+O(2^5)\")\n            1 + O(2^5)\n\n        However::\n\n            sage: x = pari(\"1+O(2^5)\"); x*x\n            1 + O(2^6)\n        ";
  static PyObject *__pyx_pw_7example_3gen_335sqr(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqr (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_334sqr(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4957
 *         return P.new_gen(gsh(x.g, pbw(precision)))
 * 
 *     def sqr(gen x):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqr(): square of x. Faster than, and most of the time (but not
 */

  static PyObject *__pyx_pf_7example_3gen_334sqr(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqr", 0);

    /* "example.pyx":4980
 *             1 + O(2^6)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsqr(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4980; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4981
 *         """
 *         sig_on()
 *         return P.new_gen(gsqr(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsqr(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4981; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.sqr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_337sqrt(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_336sqrt[] = "\n        x.sqrt(precision): The square root of x.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).sqrt()\n            1.41421356237310\n        ";
  static PyObject *__pyx_pw_7example_3gen_337sqrt(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqrt (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqrt") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4984; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sqrt", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4984; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.sqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_336sqrt(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":4984
 * 
 * 
 *     def sqrt(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.sqrt(precision): The square root of x.
 */

  static PyObject *__pyx_pf_7example_3gen_336sqrt(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqrt", 0);

    /* "example.pyx":4998
 *             1.41421356237310
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsqrt(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":4999
 *         """
 *         sig_on()
 *         return P.new_gen(gsqrt(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def sqrtn(gen x, n, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsqrt(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.sqrt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_339sqrtn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_338sqrtn[] = "\n        x.sqrtn(n): return the principal branch of the n-th root of x,\n        i.e., the one such that\n        `\\arg(\\sqrt(x)) \\in ]-\\pi/n, \\pi/n]`. Also returns a second\n        argument which is a suitable root of unity allowing one to recover\n        all the other roots. If it was not possible to find such a number,\n        then this second return value is 0. If the argument is present and\n        no square root exists, return 0 instead of raising an error.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        .. note::\n\n           intmods (modulo a prime) and `p`-adic numbers are\n           allowed as arguments.\n\n        INPUT:\n\n\n        -  ``x`` - gen\n\n        -  ``n`` - integer\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - principal n-th root of x\n\n        -  ``gen`` - root of unity z that gives the other\n           roots\n\n\n        EXAMPLES::\n\n            sage: s, z = pari(2).sqrtn(5)\n            sage: z\n            0.309016994374947 + 0.951056516295154*I\n            sage: s\n            1.14869835499704\n            sage: s^5\n            2.00000000000000\n            sage: z^5\n            1.00000000000000 + 5.42101086 E-19*I        # 32-bit\n            1.00000000000000 + 5.96311194867027 E-19*I  # 64-bit\n            sage: (s*z)^5\n            2.00000000000000 + 1.409462824 E-18*I       # 32-bit\n            2.00000000000000 + 9.21571846612679 E-19*I  # 64-bit\n        ";
  static PyObject *__pyx_pw_7example_3gen_339sqrtn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_n = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sqrtn (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sqrtn") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5001; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("sqrtn", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5001; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.sqrtn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_338sqrtn(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_n, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5001
 *         return P.new_gen(gsqrt(x.g, pbw(precision)))
 * 
 *     def sqrtn(gen x, n, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.sqrtn(n): return the principal branch of the n-th root of x,
 */

  static PyObject *__pyx_pf_7example_3gen_338sqrtn(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_n, PyObject *__pyx_v_precision) {
    GEN __pyx_v_zetan;
    struct __pyx_obj_7example_gen *__pyx_v_ans = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sqrtn", 0);

    /* "example.pyx":5056
 *         # TODO: ???  lots of good examples in the PARI docs ???
 *         cdef GEN zetan
 *         t0GEN(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0, &zetan, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5056; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5057
 *         cdef GEN zetan
 *         t0GEN(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0, &zetan, pbw(precision)))
 *         return ans, P.new_gen(zetan)
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5057; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5058
 *         t0GEN(n)
 *         sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0, &zetan, pbw(precision)))             # <<<<<<<<<<<<<<
 *         return ans, P.new_gen(zetan)
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, gsqrtn(__pyx_v_x->g, __pyx_v_7example_t0, (&__pyx_v_zetan), __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_v_ans = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
    __pyx_t_4 = 0;

    /* "example.pyx":5059
 *         sig_on()
 *         ans = P.new_gen_noclear(gsqrtn(x.g, t0, &zetan, pbw(precision)))
 *         return ans, P.new_gen(zetan)             # <<<<<<<<<<<<<<
 * 
 *     def tan(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_zetan)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5059; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5059; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(((PyObject *)__pyx_v_ans));
    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_ans));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_ans));
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_r = ((PyObject *)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.sqrtn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_ans);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_341tan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_340tan[] = "\n        x.tan() - tangent of x\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(2).tan()\n            -2.18503986326152\n            sage: C.<i> = ComplexField()\n            sage: pari(i).tan()\n            0.E-19 + 0.761594155955765*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_341tan(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("tan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5061; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("tan", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5061; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.tan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_340tan(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5061
 *         return ans, P.new_gen(zetan)
 * 
 *     def tan(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tan() - tangent of x
 */

  static PyObject *__pyx_pf_7example_3gen_340tan(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("tan", 0);

    /* "example.pyx":5078
 *             0.E-19 + 0.761594155955765*I
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gtan(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5079
 *         """
 *         sig_on()
 *         return P.new_gen(gtan(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def tanh(gen x, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gtan(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.tan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_343tanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_342tanh[] = "\n        x.tanh() - hyperbolic tangent of x\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(1).tanh()\n            0.761594155955765\n            sage: C.<i> = ComplexField()\n            sage: z = pari(i); z\n            0.E-19 + 1.00000000000000*I\n            sage: result = z.tanh()\n            sage: result.real() <= 1e-18\n            True\n            sage: result.imag()\n            1.55740772465490\n        ";
  static PyObject *__pyx_pw_7example_3gen_343tanh(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("tanh (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tanh") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5081; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("tanh", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5081; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.tanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_342tanh(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5081
 *         return P.new_gen(gtan(x.g, pbw(precision)))
 * 
 *     def tanh(gen x, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.tanh() - hyperbolic tangent of x
 */

  static PyObject *__pyx_pf_7example_3gen_342tanh(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("tanh", 0);

    /* "example.pyx":5103
 *             1.55740772465490
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gth(x.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5104
 *         """
 *         sig_on()
 *         return P.new_gen(gth(x.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def teichmuller(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gth(__pyx_v_x->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.tanh", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_345teichmuller(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_344teichmuller[] = "\n        teichmuller(x): teichmuller character of p-adic number x.\n\n        This is the unique `(p-1)`-st root of unity congruent to\n        `x/p^{v_p(x)}` modulo `p`.\n\n        EXAMPLES::\n\n            sage: pari('2+O(7^5)').teichmuller()\n            2 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)\n        ";
  static PyObject *__pyx_pw_7example_3gen_345teichmuller(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("teichmuller (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_344teichmuller(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5106
 *         return P.new_gen(gth(x.g, pbw(precision)))
 * 
 *     def teichmuller(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         teichmuller(x): teichmuller character of p-adic number x.
 */

  static PyObject *__pyx_pf_7example_3gen_344teichmuller(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("teichmuller", 0);

    /* "example.pyx":5118
 *             2 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(teich(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5119
 *         """
 *         sig_on()
 *         return P.new_gen(teich(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def theta(gen q, z, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, teich(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.teichmuller", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_347theta(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_346theta[] = "\n        q.theta(z): Jacobi sine theta-function.\n\n        If `q` or `z` is an exact argument, it is first\n        converted to a real or complex number using the optional parameter\n        precision (in bits). If the arguments are inexact (e.g. real), the\n        smallest of their precisions is used in the computation, and the\n        parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).theta(2)\n            1.63202590295260\n        ";
  static PyObject *__pyx_pw_7example_3gen_347theta(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("theta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "theta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5121; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("theta", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5121; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.theta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_346theta(((struct __pyx_obj_7example_gen *)__pyx_v_q), __pyx_v_z, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5121
 *         return P.new_gen(teich(x.g))
 * 
 *     def theta(gen q, z, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.theta(z): Jacobi sine theta-function.
 */

  static PyObject *__pyx_pf_7example_3gen_346theta(struct __pyx_obj_7example_gen *__pyx_v_q, PyObject *__pyx_v_z, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("theta", 0);

    /* "example.pyx":5136
 *             1.63202590295260
 *         """
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(theta(q.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5137
 *         """
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(theta(q.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5138
 *         t0GEN(z)
 *         sig_on()
 *         return P.new_gen(theta(q.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def thetanullk(gen q, long k, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, theta(__pyx_v_q->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.theta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_349thetanullk(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_348thetanullk[] = "\n        q.thetanullk(k): return the k-th derivative at z=0 of theta(q,z).\n\n        If `q` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `q` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        EXAMPLES::\n\n            sage: pari(0.5).thetanullk(1)\n            0.548978532560341\n        ";
  static PyObject *__pyx_pw_7example_3gen_349thetanullk(PyObject *__pyx_v_q, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_k;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thetanullk (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thetanullk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5140; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_k = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5140; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thetanullk", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5140; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.thetanullk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_348thetanullk(((struct __pyx_obj_7example_gen *)__pyx_v_q), __pyx_v_k, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5140
 *         return P.new_gen(theta(q.g, t0, pbw(precision)))
 * 
 *     def thetanullk(gen q, long k, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         q.thetanullk(k): return the k-th derivative at z=0 of theta(q,z).
 */

  static PyObject *__pyx_pf_7example_3gen_348thetanullk(struct __pyx_obj_7example_gen *__pyx_v_q, long __pyx_v_k, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thetanullk", 0);

    /* "example.pyx":5154
 *             0.548978532560341
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(thetanullk(q.g, k, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5155
 *         """
 *         sig_on()
 *         return P.new_gen(thetanullk(q.g, k, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def weber(gen x, flag=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, thetanullk(__pyx_v_q->g, __pyx_v_k, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.thetanullk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_351weber(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_350weber[] = "\n        x.weber(flag=0): One of Weber's f functions of x. flag is optional,\n        and can be 0: default, function\n        f(x)=exp(-i\\*Pi/24)\\*eta((x+1)/2)/eta(x) such that\n        `j=(f^{24}-16)^3/f^{24}`, 1: function f1(x)=eta(x/2)/eta(x)\n        such that `j=(f1^24+16)^3/f2^{24}`, 2: function\n        f2(x)=sqrt(2)\\*eta(2\\*x)/eta(x) such that\n        `j=(f2^{24}+16)^3/f2^{24}`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        TODO: Add further explanation from PARI manual.\n\n        EXAMPLES::\n\n            sage: C.<i> = ComplexField()\n            sage: pari(i).weber()\n            1.18920711500272 + 0.E-19*I                 # 32-bit\n            1.18920711500272 + 2.71050543121376 E-20*I  # 64-bit\n            sage: pari(i).weber(1)\n            1.09050773266526 + 0.E-19*I\n            sage: pari(i).weber(2)\n            1.09050773266526\n        ";
  static PyObject *__pyx_pw_7example_3gen_351weber(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("weber (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "weber") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("weber", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.weber", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_350weber(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5157
 *         return P.new_gen(thetanullk(q.g, k, pbw(precision)))
 * 
 *     def weber(gen x, flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         x.weber(flag=0): One of Weber's f functions of x. flag is optional,
 */

  static PyObject *__pyx_pf_7example_3gen_350weber(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("weber", 0);

    /* "example.pyx":5185
 *             1.09050773266526
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(weber0(x.g, flag, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5186
 *         """
 *         sig_on()
 *         return P.new_gen(weber0(x.g, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def zeta(gen s, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_5 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, weber0(__pyx_v_x->g, __pyx_t_2, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.weber", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_353zeta(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_352zeta[] = "\n        zeta(s): zeta function at s with s a complex or a p-adic number.\n\n        If `s` is a complex number, this is the Riemann zeta\n        function `\\zeta(s)=\\sum_{n\\geq 1} n^{-s}`, computed either\n        using the Euler-Maclaurin summation formula (if `s` is not\n        an integer), or using Bernoulli numbers (if `s` is a\n        negative integer or an even nonnegative integer), or using modular\n        forms (if `s` is an odd nonnegative integer).\n\n        If `s` is a `p`-adic number, this is the\n        Kubota-Leopoldt zeta function, i.e. the unique continuous\n        `p`-adic function on the `p`-adic integers that\n        interpolates the values of `(1-p^{-k})\\zeta(k)` at negative\n        integers `k` such that `k\\equiv 1\\pmod{p-1}` if\n        `p` is odd, and at odd `k` if `p=2`.\n\n        If `x` is an exact argument, it is first converted to a\n        real or complex number using the optional parameter precision (in\n        bits). If `x` is inexact (e.g. real), its own precision is\n        used in the computation, and the parameter precision is ignored.\n\n        INPUT:\n\n\n        -  ``s`` - gen (real, complex, or p-adic number)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - value of zeta at s.\n\n\n        EXAMPLES::\n\n            sage: pari(2).zeta()\n            1.64493406684823\n            sage: x = RR(pi)^2/6\n            sage: pari(x)\n            1.64493406684823\n            sage: pari(3).zeta()\n            1.20205690315959\n            sage: pari('1+5*7+2*7^2+O(7^3)').zeta()\n            4*7^-2 + 5*7^-1 + O(7^0)\n        ";
  static PyObject *__pyx_pw_7example_3gen_353zeta(PyObject *__pyx_v_s, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("zeta (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "zeta") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5188; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("zeta", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5188; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.zeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_352zeta(((struct __pyx_obj_7example_gen *)__pyx_v_s), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5188
 *         return P.new_gen(weber0(x.g, flag, pbw(precision)))
 * 
 *     def zeta(gen s, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         zeta(s): zeta function at s with s a complex or a p-adic number.
 */

  static PyObject *__pyx_pf_7example_3gen_352zeta(struct __pyx_obj_7example_gen *__pyx_v_s, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("zeta", 0);

    /* "example.pyx":5235
 *             4*7^-2 + 5*7^-1 + O(7^0)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gzeta(s.g, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5236
 *         """
 *         sig_on()
 *         return P.new_gen(gzeta(s.g, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gzeta(__pyx_v_s->g, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.zeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_355bezout(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_355bezout(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bezout (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_354bezout(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5242
 *     ###########################################
 * 
 *     def bezout(gen x, y):             # <<<<<<<<<<<<<<
 *         cdef gen u, v, g
 *         cdef GEN U, V, G
 */

  static PyObject *__pyx_pf_7example_3gen_354bezout(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    struct __pyx_obj_7example_gen *__pyx_v_u = 0;
    struct __pyx_obj_7example_gen *__pyx_v_v = 0;
    struct __pyx_obj_7example_gen *__pyx_v_g = 0;
    GEN __pyx_v_U;
    GEN __pyx_v_V;
    GEN __pyx_v_G;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bezout", 0);

    /* "example.pyx":5245
 *         cdef gen u, v, g
 *         cdef GEN U, V, G
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         G = gbezout(x.g, t0, &U, &V)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5246
 *         cdef GEN U, V, G
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         G = gbezout(x.g, t0, &U, &V)
 *         g = P.new_gen_noclear(G)
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5247
 *         t0GEN(y)
 *         sig_on()
 *         G = gbezout(x.g, t0, &U, &V)             # <<<<<<<<<<<<<<
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)
 */
    __pyx_v_G = gbezout(__pyx_v_x->g, __pyx_v_7example_t0, (&__pyx_v_U), (&__pyx_v_V));

    /* "example.pyx":5248
 *         sig_on()
 *         G = gbezout(x.g, t0, &U, &V)
 *         g = P.new_gen_noclear(G)             # <<<<<<<<<<<<<<
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, __pyx_v_G)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_g = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":5249
 *         G = gbezout(x.g, t0, &U, &V)
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)             # <<<<<<<<<<<<<<
 *         v = P.new_gen(V)
 *         return g, u, v
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, __pyx_v_U)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_u = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":5250
 *         g = P.new_gen_noclear(G)
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)             # <<<<<<<<<<<<<<
 *         return g, u, v
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_V)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_v = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":5251
 *         u = P.new_gen_noclear(U)
 *         v = P.new_gen(V)
 *         return g, u, v             # <<<<<<<<<<<<<<
 * 
 *     def binomial(gen x, long k):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_v_g));
    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_g));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_g));
    __Pyx_INCREF(((PyObject *)__pyx_v_u));
    PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_u));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_u));
    __Pyx_INCREF(((PyObject *)__pyx_v_v));
    PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_v));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_v));
    __pyx_r = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bezout", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_u);
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XDECREF((PyObject *)__pyx_v_g);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_357binomial(PyObject *__pyx_v_x, PyObject *__pyx_arg_k); /*proto*/
  static char __pyx_doc_7example_3gen_356binomial[] = "\n        binomial(x, k): return the binomial coefficient \"x choose k\".\n\n        INPUT:\n\n\n        -  ``x`` - any PARI object (gen)\n\n        -  ``k`` - integer\n\n\n        EXAMPLES::\n\n            sage: pari(6).binomial(2)\n            15\n            sage: pari('x+1').binomial(3)\n            1/6*x^3 - 1/6*x\n            sage: pari('2+x+O(x^2)').binomial(3)\n            1/3*x + O(x^2)\n        ";
  static PyObject *__pyx_pw_7example_3gen_357binomial(PyObject *__pyx_v_x, PyObject *__pyx_arg_k) {
    long __pyx_v_k;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("binomial (wrapper)", 0);
    assert(__pyx_arg_k); {
      __pyx_v_k = __Pyx_PyInt_AsLong(__pyx_arg_k); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5253; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.binomial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_356binomial(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((long)__pyx_v_k));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5253
 *         return g, u, v
 * 
 *     def binomial(gen x, long k):             # <<<<<<<<<<<<<<
 *         """
 *         binomial(x, k): return the binomial coefficient "x choose k".
 */

  static PyObject *__pyx_pf_7example_3gen_356binomial(struct __pyx_obj_7example_gen *__pyx_v_x, long __pyx_v_k) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("binomial", 0);

    /* "example.pyx":5274
 *             1/3*x + O(x^2)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(binomial(x.g, k))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5275
 *         """
 *         sig_on()
 *         return P.new_gen(binomial(x.g, k))             # <<<<<<<<<<<<<<
 * 
 *     def contfrac(gen x, b=0, long lmax=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, binomial(__pyx_v_x->g, __pyx_v_k))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.binomial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_359contfrac(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_358contfrac[] = "\n        contfrac(x,b,lmax): continued fraction expansion of x (x rational,\n        real or rational function). b and lmax are both optional, where b\n        is the vector of numerators of the continued fraction, and lmax is\n        a bound for the number of terms in the continued fraction\n        expansion.\n        ";
  static PyObject *__pyx_pw_7example_3gen_359contfrac(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_b = 0;
    long __pyx_v_lmax;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("contfrac (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__b,&__pyx_n_s__lmax,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__lmax);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contfrac") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5277; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      if (values[1]) {
        __pyx_v_lmax = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_lmax == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5277; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_lmax = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("contfrac", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5277; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.contfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_358contfrac(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_b, __pyx_v_lmax);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5277
 *         return P.new_gen(binomial(x.g, k))
 * 
 *     def contfrac(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfrac(x,b,lmax): continued fraction expansion of x (x rational,
 */

  static PyObject *__pyx_pf_7example_3gen_358contfrac(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_b, long __pyx_v_lmax) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("contfrac", 0);

    /* "example.pyx":5285
 *         expansion.
 *         """
 *         t0GEN(b)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(contfrac0(x.g, t0, lmax))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5286
 *         """
 *         t0GEN(b)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(contfrac0(x.g, t0, lmax))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5287
 *         t0GEN(b)
 *         sig_on()
 *         return P.new_gen(contfrac0(x.g, t0, lmax))             # <<<<<<<<<<<<<<
 * 
 *     def contfracpnqn(gen x, b=0, long lmax=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, contfrac0(__pyx_v_x->g, __pyx_v_7example_t0, __pyx_v_lmax))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.contfrac", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_361contfracpnqn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_360contfracpnqn[] = "\n        contfracpnqn(x): [p_n,p_n-1; q_n,q_n-1] corresponding to the\n        continued fraction x.\n        ";
  static PyObject *__pyx_pw_7example_3gen_361contfracpnqn(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    CYTHON_UNUSED PyObject *__pyx_v_b = 0;
    CYTHON_UNUSED long __pyx_v_lmax;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("contfracpnqn (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__b,&__pyx_n_s__lmax,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__lmax);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contfracpnqn") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_b = values[0];
      if (values[1]) {
        __pyx_v_lmax = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_lmax == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_lmax = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("contfracpnqn", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5289; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.contfracpnqn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_360contfracpnqn(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_b, __pyx_v_lmax);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5289
 *         return P.new_gen(contfrac0(x.g, t0, lmax))
 * 
 *     def contfracpnqn(gen x, b=0, long lmax=0):             # <<<<<<<<<<<<<<
 *         """
 *         contfracpnqn(x): [p_n,p_n-1; q_n,q_n-1] corresponding to the
 */

  static PyObject *__pyx_pf_7example_3gen_360contfracpnqn(struct __pyx_obj_7example_gen *__pyx_v_x, CYTHON_UNUSED PyObject *__pyx_v_b, CYTHON_UNUSED long __pyx_v_lmax) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("contfracpnqn", 0);

    /* "example.pyx":5294
 *         continued fraction x.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(pnqn(x.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5295
 *         """
 *         sig_on()
 *         return P.new_gen(pnqn(x.g))             # <<<<<<<<<<<<<<
 * 
 *     def fibonacci(gen x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, pnqn(__pyx_v_x->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.contfracpnqn", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_363fibonacci(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_362fibonacci[] = "\n        Return the Fibonacci number of index x.\n\n        EXAMPLES::\n\n            sage: pari(18).fibonacci()\n            2584\n            sage: [pari(n).fibonacci() for n in range(10)]\n            [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]\n        ";
  static PyObject *__pyx_pw_7example_3gen_363fibonacci(PyObject *__pyx_v_x, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("fibonacci (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_362fibonacci(((struct __pyx_obj_7example_gen *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5297
 *         return P.new_gen(pnqn(x.g))
 * 
 *     def fibonacci(gen x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the Fibonacci number of index x.
 */

  static PyObject *__pyx_pf_7example_3gen_362fibonacci(struct __pyx_obj_7example_gen *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("fibonacci", 0);

    /* "example.pyx":5308
 *             [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(fibo(long(x)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5309
 *         """
 *         sig_on()
 *         return P.new_gen(fibo(long(x)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(((PyObject *)__pyx_v_x));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_x));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_x));
    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyLong_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, fibo(__pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.fibonacci", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_365gcd(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_364gcd[] = "\n        gcd(x,y,flag=0): greatest common divisor of x and y. flag is\n        optional, and can be 0: default, 1: use the modular gcd algorithm\n        (x and y must be polynomials), 2 use the subresultant algorithm (x\n        and y must be polynomials)\n        ";
  static PyObject *__pyx_pw_7example_3gen_365gcd(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    CYTHON_UNUSED long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("gcd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gcd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("gcd", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5312; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.gcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_364gcd(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5312
 * 
 * 
 *     def gcd(gen x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         gcd(x,y,flag=0): greatest common divisor of x and y. flag is
 */

  static PyObject *__pyx_pf_7example_3gen_364gcd(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, CYTHON_UNUSED long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("gcd", 0);

    /* "example.pyx":5319
 *         and y must be polynomials)
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(ggcd0(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5320
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ggcd0(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5321
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(ggcd0(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def issquare(gen x, find_root=False):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ggcd0(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.gcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_367issquare(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_366issquare[] = "\n        issquare(x,n): true(1) if x is a square, false(0) if not. If\n        find_root is given, also returns the exact square root if it was\n        computed.\n        ";
  static PyObject *__pyx_pw_7example_3gen_367issquare(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_find_root = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("issquare (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__find_root,0};
      PyObject* values[1] = {0};
      values[0] = __pyx_k_47;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__find_root);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "issquare") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5323; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_find_root = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("issquare", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5323; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.issquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_366issquare(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_find_root);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5323
 *         return P.new_gen(ggcd0(x.g, t0))
 * 
 *     def issquare(gen x, find_root=False):             # <<<<<<<<<<<<<<
 *         """
 *         issquare(x,n): true(1) if x is a square, false(0) if not. If
 */

  static PyObject *__pyx_pf_7example_3gen_366issquare(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_find_root) {
    GEN __pyx_v_G;
    GEN __pyx_v_t;
    PyBoolObject *__pyx_v_v = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("issquare", 0);

    /* "example.pyx":5331
 *         cdef GEN G, t
 *         cdef gen g
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if find_root:
 *             t = gissquareall(x.g, &G)
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5332
 *         cdef gen g
 *         sig_on()
 *         if find_root:             # <<<<<<<<<<<<<<
 *             t = gissquareall(x.g, &G)
 *             v = bool(P.new_gen_noclear(t))
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_find_root); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "example.pyx":5333
 *         sig_on()
 *         if find_root:
 *             t = gissquareall(x.g, &G)             # <<<<<<<<<<<<<<
 *             v = bool(P.new_gen_noclear(t))
 *             if v:
 */
      __pyx_v_t = gissquareall(__pyx_v_x->g, (&__pyx_v_G));

      /* "example.pyx":5334
 *         if find_root:
 *             t = gissquareall(x.g, &G)
 *             v = bool(P.new_gen_noclear(t))             # <<<<<<<<<<<<<<
 *             if v:
 *                 return v, P.new_gen(G)
 */
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, __pyx_v_t)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_4bool_bool)), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_v_v = ((PyBoolObject *)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "example.pyx":5335
 *             t = gissquareall(x.g, &G)
 *             v = bool(P.new_gen_noclear(t))
 *             if v:             # <<<<<<<<<<<<<<
 *                 return v, P.new_gen(G)
 *             else:
 */
      __pyx_t_2 = __Pyx_PyObject_IsTrue(((PyObject *)__pyx_v_v)); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__pyx_t_2) {

        /* "example.pyx":5336
 *             v = bool(P.new_gen_noclear(t))
 *             if v:
 *                 return v, P.new_gen(G)             # <<<<<<<<<<<<<<
 *             else:
 *                 sig_off()
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_G)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_INCREF(((PyObject *)__pyx_v_v));
        PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_v));
        __Pyx_GIVEREF(((PyObject *)__pyx_v_v));
        PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
        __Pyx_GIVEREF(__pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_r = ((PyObject *)__pyx_t_4);
        __pyx_t_4 = 0;
        goto __pyx_L0;
        goto __pyx_L4;
      }
      /*else*/ {

        /* "example.pyx":5338
 *                 return v, P.new_gen(G)
 *             else:
 *                 sig_off()             # <<<<<<<<<<<<<<
 *                 return v, None
 *         else:
 */
        _pari_sig_off();

        /* "example.pyx":5339
 *             else:
 *                 sig_off()
 *                 return v, None             # <<<<<<<<<<<<<<
 *         else:
 *             return P.new_gen(gissquare(x.g))
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_INCREF(((PyObject *)__pyx_v_v));
        PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_v));
        __Pyx_GIVEREF(((PyObject *)__pyx_v_v));
        __Pyx_INCREF(Py_None);
        PyTuple_SET_ITEM(__pyx_t_4, 1, Py_None);
        __Pyx_GIVEREF(Py_None);
        __pyx_r = ((PyObject *)__pyx_t_4);
        __pyx_t_4 = 0;
        goto __pyx_L0;
      }
      __pyx_L4:;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":5341
 *                 return v, None
 *         else:
 *             return P.new_gen(gissquare(x.g))             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gissquare(__pyx_v_x->g))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.issquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_369issquarefree(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_368issquarefree[] = "\n        EXAMPLES::\n\n            sage: pari(10).issquarefree()\n            True\n            sage: pari(20).issquarefree()\n            False\n        ";
  static PyObject *__pyx_pw_7example_3gen_369issquarefree(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("issquarefree (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_368issquarefree(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5344
 * 
 * 
 *     def issquarefree(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_3gen_368issquarefree(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyBoolObject *__pyx_v_t = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("issquarefree", 0);

    /* "example.pyx":5353
 *             False
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t = bool(issquarefree(self.g))
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5354
 *         """
 *         sig_on()
 *         t = bool(issquarefree(self.g))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return t
 */
    __pyx_t_2 = PyInt_FromLong(issquarefree(__pyx_v_self->g)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_4bool_bool)), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_t = ((PyBoolObject *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":5355
 *         sig_on()
 *         t = bool(issquarefree(self.g))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return t
 * 
 */
    _pari_sig_off();

    /* "example.pyx":5356
 *         t = bool(issquarefree(self.g))
 *         sig_off()
 *         return t             # <<<<<<<<<<<<<<
 * 
 *     def lcm(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_t));
    __pyx_r = ((PyObject *)__pyx_v_t);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.issquarefree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_371lcm(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_370lcm[] = "\n        Return the least common multiple of x and y. EXAMPLES::\n\n            sage: pari(10).lcm(15)\n            30\n        ";
  static PyObject *__pyx_pw_7example_3gen_371lcm(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lcm (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_370lcm(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5358
 *         return t
 * 
 *     def lcm(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Return the least common multiple of x and y. EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_3gen_370lcm(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lcm", 0);

    /* "example.pyx":5365
 *             30
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(glcm(x.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5366
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(glcm(x.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5367
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(glcm(x.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def numdiv(gen n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, glcm(__pyx_v_x->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.lcm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_373numdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_372numdiv[] = "\n        Return the number of divisors of the integer n.\n\n        EXAMPLES::\n\n            sage: pari(10).numdiv()\n            4\n        ";
  static PyObject *__pyx_pw_7example_3gen_373numdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("numdiv (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_372numdiv(((struct __pyx_obj_7example_gen *)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5369
 *         return P.new_gen(glcm(x.g, t0))
 * 
 *     def numdiv(gen n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of divisors of the integer n.
 */

  static PyObject *__pyx_pf_7example_3gen_372numdiv(struct __pyx_obj_7example_gen *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("numdiv", 0);

    /* "example.pyx":5378
 *             4
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gnumbdiv(n.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5379
 *         """
 *         sig_on()
 *         return P.new_gen(gnumbdiv(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def phi(gen n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gnumbdiv(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.numdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_375phi(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_374phi[] = "\n        Return the Euler phi function of n. EXAMPLES::\n\n            sage: pari(10).phi()\n            4\n        ";
  static PyObject *__pyx_pw_7example_3gen_375phi(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("phi (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_374phi(((struct __pyx_obj_7example_gen *)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5381
 *         return P.new_gen(gnumbdiv(n.g))
 * 
 *     def phi(gen n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the Euler phi function of n. EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_3gen_374phi(struct __pyx_obj_7example_gen *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("phi", 0);

    /* "example.pyx":5388
 *             4
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(geulerphi(n.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5389
 *         """
 *         sig_on()
 *         return P.new_gen(geulerphi(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def primepi(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, geulerphi(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.phi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_377primepi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_376primepi[] = "\n        Return the number of primes less than or equal to self.\n\n        EXAMPLES::\n\n            sage: pari(7).primepi()\n            4\n            sage: pari(100).primepi()\n            25\n            sage: pari(1000).primepi()\n            168\n            sage: pari(100000).primepi()\n            9592\n            sage: pari(0).primepi()\n            0\n            sage: pari(-15).primepi()\n            0\n            sage: pari(500509).primepi()\n            41581\n        ";
  static PyObject *__pyx_pw_7example_3gen_377primepi(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("primepi (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_376primepi(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5391
 *         return P.new_gen(geulerphi(n.g))
 * 
 *     def primepi(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of primes less than or equal to self.
 */

  static PyObject *__pyx_pf_7example_3gen_376primepi(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("primepi", 0);

    /* "example.pyx":5413
 *         """
 *         global num_primes
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if self > num_primes:
 *             P.init_primes(self + 10)
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5413; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5414
 *         global num_primes
 *         sig_on()
 *         if self > num_primes:             # <<<<<<<<<<<<<<
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:
 */
    __pyx_t_2 = PyLong_FromUnsignedLong(__pyx_v_7example_num_primes); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_RichCompare(((PyObject *)__pyx_v_self), __pyx_t_2, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_4) {

      /* "example.pyx":5415
 *         sig_on()
 *         if self > num_primes:
 *             P.init_primes(self + 10)             # <<<<<<<<<<<<<<
 *         if signe(self.g) != 1:
 *             sig_off()
 */
      __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_7example_P), __pyx_n_s__init_primes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_2 = PyNumber_Add(((PyObject *)__pyx_v_self), __pyx_int_10); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":5416
 *         if self > num_primes:
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:             # <<<<<<<<<<<<<<
 *             sig_off()
 *             return P.PARI_ZERO
 */
    __pyx_t_4 = (signe(__pyx_v_self->g) != 1);
    if (__pyx_t_4) {

      /* "example.pyx":5417
 *             P.init_primes(self + 10)
 *         if signe(self.g) != 1:
 *             sig_off()             # <<<<<<<<<<<<<<
 *             return P.PARI_ZERO
 *         return P.new_gen(primepi(self.g))
 */
      _pari_sig_off();

      /* "example.pyx":5418
 *         if signe(self.g) != 1:
 *             sig_off()
 *             return P.PARI_ZERO             # <<<<<<<<<<<<<<
 *         return P.new_gen(primepi(self.g))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_7example_P->PARI_ZERO));
      __pyx_r = ((PyObject *)__pyx_v_7example_P->PARI_ZERO);
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":5419
 *             sig_off()
 *             return P.PARI_ZERO
 *         return P.new_gen(primepi(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def sumdiv(gen n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, primepi(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.primepi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_379sumdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_378sumdiv[] = "\n        Return the sum of the divisors of `n`.\n\n        EXAMPLES::\n\n            sage: pari(10).sumdiv()\n            18\n        ";
  static PyObject *__pyx_pw_7example_3gen_379sumdiv(PyObject *__pyx_v_n, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sumdiv (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_378sumdiv(((struct __pyx_obj_7example_gen *)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5421
 *         return P.new_gen(primepi(self.g))
 * 
 *     def sumdiv(gen n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the divisors of `n`.
 */

  static PyObject *__pyx_pf_7example_3gen_378sumdiv(struct __pyx_obj_7example_gen *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sumdiv", 0);

    /* "example.pyx":5430
 *             18
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sumdiv(n.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5431
 *         """
 *         sig_on()
 *         return P.new_gen(sumdiv(n.g))             # <<<<<<<<<<<<<<
 * 
 *     def sumdivk(gen n, long k):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, sumdiv(__pyx_v_n->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.sumdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_381sumdivk(PyObject *__pyx_v_n, PyObject *__pyx_arg_k); /*proto*/
  static char __pyx_doc_7example_3gen_380sumdivk[] = "\n        Return the sum of the k-th powers of the divisors of n.\n\n        EXAMPLES::\n\n            sage: pari(10).sumdivk(2)\n            130\n        ";
  static PyObject *__pyx_pw_7example_3gen_381sumdivk(PyObject *__pyx_v_n, PyObject *__pyx_arg_k) {
    long __pyx_v_k;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("sumdivk (wrapper)", 0);
    assert(__pyx_arg_k); {
      __pyx_v_k = __Pyx_PyInt_AsLong(__pyx_arg_k); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5433; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.sumdivk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_380sumdivk(((struct __pyx_obj_7example_gen *)__pyx_v_n), ((long)__pyx_v_k));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5433
 *         return P.new_gen(sumdiv(n.g))
 * 
 *     def sumdivk(gen n, long k):             # <<<<<<<<<<<<<<
 *         """
 *         Return the sum of the k-th powers of the divisors of n.
 */

  static PyObject *__pyx_pf_7example_3gen_380sumdivk(struct __pyx_obj_7example_gen *__pyx_v_n, long __pyx_v_k) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sumdivk", 0);

    /* "example.pyx":5442
 *             130
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(sumdivk(n.g, k))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5443
 *         """
 *         sig_on()
 *         return P.new_gen(sumdivk(n.g, k))             # <<<<<<<<<<<<<<
 * 
 *     def xgcd(gen x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, sumdivk(__pyx_v_n->g, __pyx_v_k))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5443; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.sumdivk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_383xgcd(PyObject *__pyx_v_x, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_382xgcd[] = "\n        Returns u,v,d such that d=gcd(x,y) and u\\*x+v\\*y=d.\n\n        EXAMPLES::\n\n            sage: pari(10).xgcd(15)\n            (5, -1, 1)\n        ";
  static PyObject *__pyx_pw_7example_3gen_383xgcd(PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("xgcd (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_382xgcd(((struct __pyx_obj_7example_gen *)__pyx_v_x), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5445
 *         return P.new_gen(sumdivk(n.g, k))
 * 
 *     def xgcd(gen x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Returns u,v,d such that d=gcd(x,y) and u\*x+v\*y=d.
 */

  static PyObject *__pyx_pf_7example_3gen_382xgcd(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("xgcd", 0);

    /* "example.pyx":5454
 *             (5, -1, 1)
 *         """
 *         return x.bezout(y)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_x), __pyx_n_s__bezout); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_y);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_y);
    __Pyx_GIVEREF(__pyx_v_y);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.xgcd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_385ellinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_384ellinit[] = "\n        Return the Pari elliptic curve object with Weierstrass coefficients\n        given by self, a list with 5 elements.\n\n        INPUT:\n\n\n        -  ``self`` - a list of 5 coefficients\n\n        -  ``flag (optional, default: 0)`` - if 0, ask for a\n           Pari ell structure with 19 components; if 1, ask for a Pari sell\n           structure with only the first 13 components\n\n        -  ``precision (optional, default: 0)`` - the real\n           precision to be used in the computation of the components of the\n           Pari (s)ell structure; if 0, use the default 53 bits.\n\n           .. note::\n\n              the parameter precision in :meth:`.ellinit` controls not only\n              the real precision of the resulting (s)ell structure,\n              but also the precision of most subsequent computations\n              with this elliptic curve.  You should therefore set it\n              from the start to the value you require.\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - either a Pari ell structure with 19\n           components (if flag=0), or a Pari sell structure with 13 components\n           (if flag=1)\n\n\n        EXAMPLES: An elliptic curve with integer coefficients::\n\n            sage: e = pari([0,1,0,1,0]).ellinit(); e\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3, [0.E-28, -0.500000000000000 - 0.866025403784439*I, -0.500000000000000 + 0.866025403784439*I]~, 3.37150070962519, -1.68575035481260 - 2.15651564749964*I, 1.37451455785745 - 1.084202173 E-19*I,      -0.687257278928726 + 0.984434956803824*I, 7.27069403586288] # 32-bit\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3, [0.E-38, -0.500000000000000 - 0.866025403784439*I, -0.500000000000000 + 0.866025403784439*I]~, 3.37150070962519, -1.68575035481260 - 2.15651564749964*I, 1.37451455785745 - 5.42101086242752 E-19*I, -0.687257278928726 + 0.984434956803824*I, 7.27069403586288] # 64-bit\n\n        Its inexact components have the default precision"" of 53 bits::\n\n            sage: RR(e[14])\n            3.37150070962519\n\n        We can compute this to higher precision::\n\n            sage: R = RealField(150)\n            sage: e = pari([0,1,0,1,0]).ellinit(precision=150)\n            sage: R(e[14])\n            3.3715007096251920857424073155981539790016018\n\n        Using flag=1 returns a short elliptic curve Pari object::\n\n            sage: pari([0,1,0,1,0]).ellinit(flag=1)\n            [0, 1, 0, 1, 0, 4, 2, 0, -1, -32, 224, -48, 2048/3]\n\n        The coefficients can be any ring elements that convert to Pari::\n\n            sage: pari([0,1/2,0,-3/4,0]).ellinit(flag=1)\n            [0, 1/2, 0, -3/4, 0, 2, -3/2, 0, -9/16, 40, -116, 117/4, 256000/117]\n            sage: pari([0,0.5,0,-0.75,0]).ellinit(flag=1)\n            [0, 0.500000000000000, 0, -0.750000000000000, 0, 2.00000000000000, -1.50000000000000, 0, -0.562500000000000, 40.0000000000000, -116.000000000000, 29.2500000000000, 2188.03418803419]\n            sage: pari([0,I,0,1,0]).ellinit(flag=1)\n            [0, I, 0, 1, 0, 4*I, 2, 0, -1, -64, 352*I, -80, 16384/5]\n            sage: pari([0,x,0,2*x,1]).ellinit(flag=1)\n            [0, x, 0, 2*x, 1, 4*x, 4*x, 4, -4*x^2 + 4*x, 16*x^2 - 96*x, -64*x^3 + 576*x^2 - 864, 64*x^4 - 576*x^3 + 576*x^2 - 432, (256*x^6 - 4608*x^5 + 27648*x^4 - 55296*x^3)/(4*x^4 - 36*x^3 + 36*x^2 - 27)]\n        ";
  static PyObject *__pyx_pw_7example_3gen_385ellinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    int __pyx_v_flag;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_flag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((int)0);
      }
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5461; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_384ellinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5461
 *     ##################################################
 * 
 *     def ellinit(self, int flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the Pari elliptic curve object with Weierstrass coefficients
 */

  static PyObject *__pyx_pf_7example_3gen_384ellinit(struct __pyx_obj_7example_gen *__pyx_v_self, int __pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellinit", 0);

    /* "example.pyx":5530
 *             [0, x, 0, 2*x, 1, 4*x, 4*x, 4, -4*x^2 + 4*x, 16*x^2 - 96*x, -64*x^3 + 576*x^2 - 864, 64*x^4 - 576*x^3 + 576*x^2 - 432, (256*x^6 - 4608*x^5 + 27648*x^4 - 55296*x^3)/(4*x^4 - 36*x^3 + 36*x^2 - 27)]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(ellinit0(self.g, flag, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5531
 *         """
 *         sig_on()
 *         return P.new_gen(ellinit0(self.g, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellglobalred(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, ellinit0(__pyx_v_self->g, __pyx_v_flag, __pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.ellinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_387ellglobalred(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_386ellglobalred[] = "\n        e.ellglobalred(): return information related to the global minimal\n        model of the elliptic curve e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve (returned by ellinit)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the (arithmetic) conductor of e\n\n        -  ``gen`` - a vector giving the coordinate change over\n           Q from e to its minimal integral model (see also ellminimalmodel)\n\n        -  ``gen`` - the product of the local Tamagawa numbers\n           of e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, 5, 2, -1, 1]).ellinit()\n            sage: e.ellglobalred()\n            [20144, [1, -2, 0, -1], 1]\n            sage: e = pari(EllipticCurve('17a').a_invariants()).ellinit()\n            sage: e.ellglobalred()\n            [17, [1, 0, 0, 0], 4]\n        ";
  static PyObject *__pyx_pw_7example_3gen_387ellglobalred(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellglobalred (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_386ellglobalred(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5533
 *         return P.new_gen(ellinit0(self.g, flag, pbw(precision)))
 * 
 *     def ellglobalred(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellglobalred(): return information related to the global minimal
 */

  static PyObject *__pyx_pf_7example_3gen_386ellglobalred(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellglobalred", 0);

    /* "example.pyx":5565
 *             [17, [1, 0, 0, 0], 4]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellglobalred(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5566
 *         """
 *         sig_on()
 *         return self.new_gen(ellglobalred(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def elladd(self, z0, z1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellglobalred(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.ellglobalred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_389elladd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_388elladd[] = "\n        e.elladd(z0, z1): return the sum of the points z0 and z1 on this\n        elliptic curve.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve E\n\n        -  ``z0`` - point on E\n\n        -  ``z1`` - point on E\n\n\n        OUTPUT: point on E\n\n        EXAMPLES: First we create an elliptic curve::\n\n            sage: e = pari([0, 1, 1, -2, 0]).ellinit()\n            sage: str(e)[:65]   # first part of output\n            '[0, 1, 1, -2, 0, 4, -4, 1, -3, 112, -856, 389, 1404928/389, [0.90'\n\n        Next we add two points on the elliptic curve. Notice that the\n        Python lists are automatically converted to PARI objects so you\n        don't have to do that explicitly in your code.\n\n        ::\n\n            sage: e.elladd([1,0], [-1,1])\n            [-3/4, -15/8]\n        ";
  static PyObject *__pyx_pw_7example_3gen_389elladd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elladd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z0,&__pyx_n_s__z1,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("elladd", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5568; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elladd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5568; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elladd", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5568; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.elladd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_388elladd(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5568
 *         return self.new_gen(ellglobalred(self.g))
 * 
 *     def elladd(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.elladd(z0, z1): return the sum of the points z0 and z1 on this
 */

  static PyObject *__pyx_pf_7example_3gen_388elladd(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elladd", 0);

    /* "example.pyx":5600
 *             [-3/4, -15/8]
 *         """
 *         t0GEN(z0); t1GEN(z1)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(addell(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_z1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5601
 *         """
 *         t0GEN(z0); t1GEN(z1)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(addell(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5602
 *         t0GEN(z0); t1GEN(z1)
 *         sig_on()
 *         return self.new_gen(addell(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def ellak(self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, addell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.elladd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_391ellak(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static char __pyx_doc_7example_3gen_390ellak[] = "\n        e.ellak(n): Returns the coefficient `a_n` of the\n        `L`-function of the elliptic curve e, i.e. the\n        `n`-th Fourier coefficient of the weight 2 newform\n        associated to e (according to Shimura-Taniyama).\n\n            The curve `e` *must* be a medium or long vector of the type\n            given by ellinit. For this function to work for every n and not\n            just those prime to the conductor, e must be a minimal Weierstrass\n            equation. If this is not the case, use the function ellminimalmodel\n            first before using ellak (or you will get INCORRECT RESULTS!)\n\n\n        INPUT:\n\n\n        -  ``e`` - a PARI elliptic curve.\n\n        -  ``n`` - integer.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellak(6)\n            2\n            sage: e.ellak(2005)\n            2\n            sage: e.ellak(-1)\n            0\n            sage: e.ellak(0)\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_391ellak(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellak (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_390ellak(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5604
 *         return self.new_gen(addell(self.g, t0, t1))
 * 
 *     def ellak(self, n):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellak(n): Returns the coefficient `a_n` of the
 */

  static PyObject *__pyx_pf_7example_3gen_390ellak(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellak", 0);

    /* "example.pyx":5638
 *             0
 *         """
 *         t0GEN(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(akell(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5639
 *         """
 *         t0GEN(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(akell(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5640
 *         t0GEN(n)
 *         sig_on()
 *         return self.new_gen(akell(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, akell(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellak", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_393ellan(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_392ellan[] = "\n        Return the first `n` Fourier coefficients of the modular\n        form attached to this elliptic curve. See ellak for more details.\n\n        INPUT:\n\n\n        -  ``n`` - a long integer\n\n        -  ``python_ints`` - bool (default is False); if True,\n           return a list of Python ints instead of a PARI gen wrapper.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellan(3)\n            [1, -2, -1]\n            sage: e.ellan(20)\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2, 1, -2, 4, 4, -1, -4, -2, 4, 0, 2]\n            sage: e.ellan(-1)\n            []\n            sage: v = e.ellan(10, python_ints=True); v\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2]\n            sage: type(v)\n            <type 'list'>\n            sage: type(v[0])\n            <type 'int'>\n        ";
  static PyObject *__pyx_pw_7example_3gen_393ellan(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_python_ints = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellan (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__python_ints,0};
      PyObject* values[2] = {0,0};
      values[1] = __pyx_k_48;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__python_ints);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellan") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_python_ints = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellan", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5643; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_392ellan(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_python_ints);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5643
 * 
 * 
 *     def ellan(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         """
 *         Return the first `n` Fourier coefficients of the modular
 */

  static PyObject *__pyx_pf_7example_3gen_392ellan(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints) {
    GEN __pyx_v_g;
    PyObject *__pyx_v_v = NULL;
    PyObject *__pyx_v_i = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    Py_ssize_t __pyx_t_6;
    PyObject *(*__pyx_t_7)(PyObject *);
    Py_ssize_t __pyx_t_8;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellan", 0);

    /* "example.pyx":5673
 *             <type 'int'>
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef GEN g
 *         if python_ints:
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5675
 *         sig_on()
 *         cdef GEN g
 *         if python_ints:             # <<<<<<<<<<<<<<
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_python_ints); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "example.pyx":5676
 *         cdef GEN g
 *         if python_ints:
 *             g = anell(self.g, n)             # <<<<<<<<<<<<<<
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()
 */
      __pyx_v_g = anell(__pyx_v_self->g, __pyx_v_n);

      /* "example.pyx":5677
 *         if python_ints:
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]             # <<<<<<<<<<<<<<
 *             (<PariInstance>pari).clear_stack()
 *             return v
 */
      __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyInt_FromLong(glength(__pyx_v_g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      if (PyList_CheckExact(__pyx_t_4) || PyTuple_CheckExact(__pyx_t_4)) {
        __pyx_t_5 = __pyx_t_4; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
        __pyx_t_7 = NULL;
      } else {
        __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext;
      }
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (!__pyx_t_7 && PyList_CheckExact(__pyx_t_5)) {
          if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        } else if (!__pyx_t_7 && PyTuple_CheckExact(__pyx_t_5)) {
          if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_4); __pyx_t_6++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_4 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        } else {
          __pyx_t_4 = __pyx_t_7(__pyx_t_5);
          if (unlikely(!__pyx_t_4)) {
            if (PyErr_Occurred()) {
              if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_4);
        }
        __Pyx_XDECREF(__pyx_v_i);
        __pyx_v_i = __pyx_t_4;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Add(__pyx_v_i, __pyx_int_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = PyInt_FromLong(gtolong(((GEN)(__pyx_v_g[__pyx_t_8])))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        if (unlikely(__Pyx_PyList_Append(__pyx_t_3, (PyObject*)__pyx_t_4))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = ((PyObject *)__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_v_v = ((PyObject*)__pyx_t_5);
      __pyx_t_5 = 0;

      /* "example.pyx":5678
 *             g = anell(self.g, n)
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()             # <<<<<<<<<<<<<<
 *             return v
 *         else:
 */
      __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      ((struct __pyx_vtabstruct_7example_PariInstance *)((struct __pyx_obj_7example_PariInstance *)__pyx_t_5)->__pyx_vtab)->clear_stack(((struct __pyx_obj_7example_PariInstance *)__pyx_t_5));
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "example.pyx":5679
 *             v = [gtolong(<GEN> g[i+1]) for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()
 *             return v             # <<<<<<<<<<<<<<
 *         else:
 *             return self.new_gen(anell(self.g, n))
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_v));
      __pyx_r = ((PyObject *)__pyx_v_v);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":5681
 *             return v
 *         else:
 *             return self.new_gen(anell(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def ellanalyticrank(self, long precision = 0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, anell(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_r = __pyx_t_5;
      __pyx_t_5 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.ellan", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_v);
    __Pyx_XDECREF(__pyx_v_i);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_395ellanalyticrank(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_394ellanalyticrank[] = "\n        Returns a 2-component vector with the order of vanishing at\n        `s = 1` of the L-function of the elliptic curve and the value\n        of the first non-zero derivative.\n\n        EXAMPLE::\n\n            sage: E = EllipticCurve('389a1')\n            sage: pari(E).ellanalyticrank()\n            [2, 1.51863300057685]\n        ";
  static PyObject *__pyx_pw_7example_3gen_395ellanalyticrank(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellanalyticrank (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellanalyticrank") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5683; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5683; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellanalyticrank", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5683; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellanalyticrank", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_394ellanalyticrank(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5683
 *             return self.new_gen(anell(self.g, n))
 * 
 *     def ellanalyticrank(self, long precision = 0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a 2-component vector with the order of vanishing at
 */

  static PyObject *__pyx_pf_7example_3gen_394ellanalyticrank(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellanalyticrank", 0);

    /* "example.pyx":5695
 *             [2, 1.51863300057685]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellanalyticrank(self.g, <GEN>0, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5696
 *         """
 *         sig_on()
 *         return self.new_gen(ellanalyticrank(self.g, <GEN>0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellap(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellanalyticrank(__pyx_v_self->g, ((GEN)0), __pyx_t_5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.ellanalyticrank", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_397ellap(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_396ellap[] = "\n        e.ellap(p): Returns the prime-indexed coefficient `a_p` of the\n        `L`-function of the elliptic curve `e`, i.e. the `p`-th Fourier\n        coefficient of the newform attached to e.\n\n        The computation uses the Shanks--Mestre method, or the SEA\n        algorithm.\n\n        .. WARNING::\n\n            For this function to work for every n and not just those prime\n            to the conductor, e must be a minimal Weierstrass equation.\n            If this is not the case, use the function ellminimalmodel first\n            before using ellap (or you will get INCORRECT RESULTS!)\n\n\n        INPUT:\n\n\n        -  ``e`` - a PARI elliptic curve.\n\n        -  ``p`` - prime integer\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.ellap(2)\n            -2\n            sage: e.ellap(2003)\n            4\n            sage: e.ellak(-1)\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_397ellap(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellap (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_396ellap(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5698
 *         return self.new_gen(ellanalyticrank(self.g, <GEN>0, pbw(precision)))
 * 
 *     def ellap(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellap(p): Returns the prime-indexed coefficient `a_p` of the
 */

  static PyObject *__pyx_pf_7example_3gen_396ellap(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellap", 0);

    /* "example.pyx":5733
 *             0
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(ellap(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5734
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellap(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5735
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(ellap(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellap(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellap", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_399ellaplist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_398ellaplist[] = "\n        e.ellaplist(n): Returns a PARI list of all the prime-indexed\n        coefficients `a_p` (up to n) of the `L`-function\n        of the elliptic curve `e`, i.e. the Fourier coefficients of\n        the newform attached to `e`.\n\n        INPUT:\n\n\n        -  ``n`` - a long integer\n\n        -  ``python_ints`` - bool (default is False); if True,\n           return a list of Python ints instead of a PARI gen wrapper.\n\n\n            The curve e must be a medium or long vector of the type given by\n            ellinit. For this function to work for every n and not just those\n            prime to the conductor, e must be a minimal Weierstrass equation.\n            If this is not the case, use the function ellminimalmodel first\n            before using ellaplist (or you will get INCORRECT RESULTS!)\n\n\n        INPUT:\n\n\n        -  ``e`` - a PARI elliptic curve.\n\n        -  ``n`` - an integer\n\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: v = e.ellaplist(10); v\n            [-2, -1, 1, -2]\n            sage: type(v)\n            <type 'sage.libs.pari.gen.gen'>\n            sage: v.type()\n            't_VEC'\n            sage: e.ellan(10)\n            [1, -2, -1, 2, 1, 2, -2, 0, -2, -2]\n            sage: v = e.ellaplist(10, python_ints=True); v\n            [-2, -1, 1, -2]\n            sage: type(v)\n            <type 'list'>\n            sage: type(v[0])\n            <type 'int'>\n        ";
  static PyObject *__pyx_pw_7example_3gen_399ellaplist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_python_ints = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellaplist (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__python_ints,0};
      PyObject* values[2] = {0,0};
      values[1] = __pyx_k_49;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__python_ints);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellaplist") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5738; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5738; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_python_ints = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellaplist", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5738; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellaplist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_398ellaplist(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_python_ints);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5738
 * 
 * 
 *     def ellaplist(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellaplist(n): Returns a PARI list of all the prime-indexed
 */

  static PyObject *__pyx_pf_7example_3gen_398ellaplist(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_python_ints) {
    GEN __pyx_v_g;
    long __pyx_v_i;
    PyObject *__pyx_v_v = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    long __pyx_t_7;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellaplist", 0);

    /* "example.pyx":5788
 *         """
 *         # 1. make a table of primes up to n.
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if n < 2:
 *             return self.new_gen(zerovec(0))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5788; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5789
 *         # 1. make a table of primes up to n.
 *         sig_on()
 *         if n < 2:             # <<<<<<<<<<<<<<
 *             return self.new_gen(zerovec(0))
 *         cdef GEN g
 */
    __pyx_t_2 = (__pyx_v_n < 2);
    if (__pyx_t_2) {

      /* "example.pyx":5790
 *         sig_on()
 *         if n < 2:
 *             return self.new_gen(zerovec(0))             # <<<<<<<<<<<<<<
 *         cdef GEN g
 *         pari.init_primes(n+1)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, zerovec(0))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":5792
 *             return self.new_gen(zerovec(0))
 *         cdef GEN g
 *         pari.init_primes(n+1)             # <<<<<<<<<<<<<<
 *         t0GEN(n)
 *         g = primes(gtolong(primepi(t0)))
 */
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__init_primes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyInt_FromLong((__pyx_v_n + 1)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "example.pyx":5793
 *         cdef GEN g
 *         pari.init_primes(n+1)
 *         t0GEN(n)             # <<<<<<<<<<<<<<
 *         g = primes(gtolong(primepi(t0)))
 * 
 */
    __pyx_t_3 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __pyx_f_7example_t0GEN(__pyx_t_3); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

    /* "example.pyx":5794
 *         pari.init_primes(n+1)
 *         t0GEN(n)
 *         g = primes(gtolong(primepi(t0)))             # <<<<<<<<<<<<<<
 * 
 *         # 2. Replace each prime in the table by ellap of it.
 */
    __pyx_v_g = primes(gtolong(primepi(__pyx_v_7example_t0)));

    /* "example.pyx":5799
 *         cdef long i
 * 
 *         if python_ints:             # <<<<<<<<<<<<<<
 *             v = [gtolong(ellap(self.g, <GEN> g[i+1])) \
 *                         for i in range(glength(g))]
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_python_ints); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "example.pyx":5800
 * 
 *         if python_ints:
 *             v = [gtolong(ellap(self.g, <GEN> g[i+1])) \             # <<<<<<<<<<<<<<
 *                         for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()
 */
      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);

      /* "example.pyx":5801
 *         if python_ints:
 *             v = [gtolong(ellap(self.g, <GEN> g[i+1])) \
 *                         for i in range(glength(g))]             # <<<<<<<<<<<<<<
 *             (<PariInstance>pari).clear_stack()
 *             return v
 */
      __pyx_t_6 = glength(__pyx_v_g);
      for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
        __pyx_v_i = __pyx_t_7;

        /* "example.pyx":5800
 * 
 *         if python_ints:
 *             v = [gtolong(ellap(self.g, <GEN> g[i+1])) \             # <<<<<<<<<<<<<<
 *                         for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()
 */
        __pyx_t_3 = PyInt_FromLong(gtolong(ellap(__pyx_v_self->g, ((GEN)(__pyx_v_g[(__pyx_v_i + 1)]))))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_3);
        if (unlikely(__Pyx_PyList_Append(__pyx_t_5, (PyObject*)__pyx_t_3))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = ((PyObject *)__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_v_v = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;

      /* "example.pyx":5802
 *             v = [gtolong(ellap(self.g, <GEN> g[i+1])) \
 *                         for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()             # <<<<<<<<<<<<<<
 *             return v
 *         else:
 */
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      ((struct __pyx_vtabstruct_7example_PariInstance *)((struct __pyx_obj_7example_PariInstance *)__pyx_t_3)->__pyx_vtab)->clear_stack(((struct __pyx_obj_7example_PariInstance *)__pyx_t_3));
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "example.pyx":5803
 *                         for i in range(glength(g))]
 *             (<PariInstance>pari).clear_stack()
 *             return v             # <<<<<<<<<<<<<<
 *         else:
 *             for i from 0 <= i < glength(g):
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_v));
      __pyx_r = ((PyObject *)__pyx_v_v);
      goto __pyx_L0;
      goto __pyx_L4;
    }
    /*else*/ {

      /* "example.pyx":5805
 *             return v
 *         else:
 *             for i from 0 <= i < glength(g):             # <<<<<<<<<<<<<<
 *                 g[i+1] = <long> ellap(self.g, <GEN> g[i+1])
 *             return self.new_gen(g)
 */
      __pyx_t_6 = glength(__pyx_v_g);
      for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_6; __pyx_v_i++) {

        /* "example.pyx":5806
 *         else:
 *             for i from 0 <= i < glength(g):
 *                 g[i+1] = <long> ellap(self.g, <GEN> g[i+1])             # <<<<<<<<<<<<<<
 *             return self.new_gen(g)
 * 
 */
        (__pyx_v_g[(__pyx_v_i + 1)]) = ((long)ellap(__pyx_v_self->g, ((GEN)(__pyx_v_g[(__pyx_v_i + 1)]))));
      }

      /* "example.pyx":5807
 *             for i from 0 <= i < glength(g):
 *                 g[i+1] = <long> ellap(self.g, <GEN> g[i+1])
 *             return self.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_g)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    __pyx_L4:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.ellaplist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_v);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_401ellbil(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_400ellbil[] = "\n        e.ellbil(z0, z1): return the value of the canonical bilinear form\n        on z0 and z1.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve (assumed integral given by a\n           minimal model, as returned by ellminimalmodel)\n\n        -  ``z0, z1`` - rational points on e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellbil([1, 0], [-1, 1])\n            0.418188984498861\n        ";
  static PyObject *__pyx_pw_7example_3gen_401ellbil(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellbil (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z0,&__pyx_n_s__z1,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellbil", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5810; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellbil") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5810; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellbil", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5810; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellbil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_400ellbil(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5810
 * 
 * 
 *     def ellbil(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellbil(z0, z1): return the value of the canonical bilinear form
 */

  static PyObject *__pyx_pf_7example_3gen_400ellbil(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellbil", 0);

    /* "example.pyx":5830
 *             0.418188984498861
 *         """
 *         t0GEN(z0); t1GEN(z1)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the prec argument has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_z1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5831
 *         """
 *         t0GEN(z0); t1GEN(z1)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(bilhell(self.g, t0, t1, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5833
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(bilhell(self.g, t0, t1, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellchangecurve(self, ch):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bilhell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellbil", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_403ellchangecurve(PyObject *__pyx_v_self, PyObject *__pyx_v_ch); /*proto*/
  static char __pyx_doc_7example_3gen_402ellchangecurve[] = "\n        e.ellchangecurve(ch): return the new model (equation) for the\n        elliptic curve e given by the change of coordinates ch.\n\n        The change of coordinates is specified by a vector ch=[u,r,s,t]; if\n        `x'` and `y'` are the new coordinates, then\n        `x = u^2 x' + r` and `y = u^3 y' + su^2 x' + t`.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``ch`` - change of coordinates vector with 4\n           entries\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,2,3,4,5]).ellinit()\n            sage: e.ellglobalred()\n            [10351, [1, -1, 0, -1], 1]\n            sage: f = e.ellchangecurve([1,-1,0,-1])\n            sage: f[:5]\n            [1, -1, 0, 4, 3]\n        ";
  static PyObject *__pyx_pw_7example_3gen_403ellchangecurve(PyObject *__pyx_v_self, PyObject *__pyx_v_ch) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellchangecurve (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_402ellchangecurve(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_ch));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5835
 *         return self.new_gen(bilhell(self.g, t0, t1, prec))
 * 
 *     def ellchangecurve(self, ch):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellchangecurve(ch): return the new model (equation) for the
 */

  static PyObject *__pyx_pf_7example_3gen_402ellchangecurve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_ch) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellchangecurve", 0);

    /* "example.pyx":5862
 *             [1, -1, 0, 4, 3]
 *         """
 *         t0GEN(ch)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(ellchangecurve(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_ch); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5862; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5863
 *         """
 *         t0GEN(ch)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellchangecurve(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5863; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5864
 *         t0GEN(ch)
 *         sig_on()
 *         return self.new_gen(ellchangecurve(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def elleta(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellchangecurve(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellchangecurve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_405elleta(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_404elleta[] = "\n        e.elleta(): return the vector [eta1,eta2] of quasi-periods\n        associated with the period lattice e.omega() of the elliptic curve\n        e.\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,-82,0]).ellinit()\n            sage: e.elleta()\n            [3.60546360143265, 3.60546360143265*I]\n            sage: w1,w2 = e.omega()\n            sage: eta1, eta2 = e.elleta()\n            sage: w1*eta2-w2*eta1\n            6.28318530717959*I\n            sage: w1*eta2-w2*eta1 == pari(2*pi*I)\n            True\n        ";
  static PyObject *__pyx_pw_7example_3gen_405elleta(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elleta (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_404elleta(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5866
 *         return self.new_gen(ellchangecurve(self.g, t0))
 * 
 *     def elleta(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.elleta(): return the vector [eta1,eta2] of quasi-periods
 */

  static PyObject *__pyx_pf_7example_3gen_404elleta(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elleta", 0);

    /* "example.pyx":5884
 *             True
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(elleta(self.g, prec))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5886
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(elleta(self.g, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellheight(self, a, flag=2, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, elleta(__pyx_v_self->g, __pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.elleta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_407ellheight(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_406ellheight[] = "\n        e.ellheight(a, flag=2): return the global Neron-Tate height of the\n        point a on the elliptic curve e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`,\n           assumed to be in a standard minimal integral model (as given by\n           ellminimalmodel)\n\n        -  ``a`` - rational point on e\n\n        -  ``flag (optional)`` - specifies which algorithm to\n           be used for computing the archimedean local height:\n\n           -  ``0`` - uses sigma- and theta-functions and a trick\n               due to J. Silverman\n\n           -  ``1`` - uses Tate's `4^n` algorithm\n\n           -  ``2`` - uses Mestre's AGM algorithm (this is the\n              default, being faster than the other two)\n\n        -  ``precision (optional)`` - the precision of the\n           result, in bits.\n\n\n        Note that in order to achieve the desired precision, the\n        elliptic curve must have been created using ellinit with the\n        desired precision.\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellheight([1,0])\n            0.476711659343740\n            sage: e.ellheight([1,0], flag=0)\n            0.476711659343740\n            sage: e.ellheight([1,0], flag=1)\n            0.476711659343740\n        ";
  static PyObject *__pyx_pw_7example_3gen_407ellheight(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellheight (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__a,&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)__pyx_int_2);
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellheight") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      __pyx_v_flag = values[1];
      __pyx_v_precision = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellheight", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5888; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellheight", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_406ellheight(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5888
 *         return self.new_gen(elleta(self.g, prec))
 * 
 *     def ellheight(self, a, flag=2, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheight(a, flag=2): return the global Neron-Tate height of the
 */

  static PyObject *__pyx_pf_7example_3gen_406ellheight(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellheight", 0);

    /* "example.pyx":5931
 *             0.476711659343740
 *         """
 *         t0GEN(a)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(ellheight0(self.g, t0, flag, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5931; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5932
 *         """
 *         t0GEN(a)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellheight0(self.g, t0, flag, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5933
 *         t0GEN(a)
 *         sig_on()
 *         return self.new_gen(ellheight0(self.g, t0, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellheightmatrix(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_5 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellheight0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.ellheight", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_409ellheightmatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_408ellheightmatrix[] = "\n        e.ellheightmatrix(x): return the height matrix for the vector x of\n        points on the elliptic curve e.\n\n        In other words, it returns the Gram matrix of x with respect to the\n        height bilinear form on e (see ellbil).\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`,\n           assumed to be in a standard minimal integral model (as given by\n           ellminimalmodel)\n\n        -  ``x`` - vector of rational points on e\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit().ellminimalmodel()[0]\n            sage: e.ellheightmatrix([[1,0], [-1,1]])\n            [0.476711659343740, 0.418188984498861; 0.418188984498861, 0.686667083305587]\n        ";
  static PyObject *__pyx_pw_7example_3gen_409ellheightmatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellheightmatrix (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_408ellheightmatrix(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5935
 *         return self.new_gen(ellheight0(self.g, t0, flag, pbw(precision)))
 * 
 *     def ellheightmatrix(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellheightmatrix(x): return the height matrix for the vector x of
 */

  static PyObject *__pyx_pf_7example_3gen_408ellheightmatrix(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellheightmatrix", 0);

    /* "example.pyx":5959
 *             [0.476711659343740, 0.418188984498861; 0.418188984498861, 0.686667083305587]
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the argument prec has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5960
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the argument prec has no effect
 *         return self.new_gen(mathell(self.g, t0, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5962
 *         sig_on()
 *         # the argument prec has no effect
 *         return self.new_gen(mathell(self.g, t0, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellisoncurve(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, mathell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellheightmatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_411ellisoncurve(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_410ellisoncurve[] = "\n        e.ellisoncurve(x): return True if the point x is on the elliptic\n        curve e, False otherwise.\n\n        If the point or the curve have inexact coefficients, an attempt is\n        made to take this into account.\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.ellisoncurve([1,0])\n            True\n            sage: e.ellisoncurve([1,1])\n            False\n            sage: e.ellisoncurve([1,0.00000000000000001])\n            False\n            sage: e.ellisoncurve([1,0.000000000000000001])\n            True\n            sage: e.ellisoncurve([0])\n            True\n        ";
  static PyObject *__pyx_pw_7example_3gen_411ellisoncurve(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellisoncurve (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_410ellisoncurve(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5964
 *         return self.new_gen(mathell(self.g, t0, prec))
 * 
 *     def ellisoncurve(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellisoncurve(x): return True if the point x is on the elliptic
 */

  static PyObject *__pyx_pf_7example_3gen_410ellisoncurve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyBoolObject *__pyx_v_t = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellisoncurve", 0);

    /* "example.pyx":5986
 *             True
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         t = bool(oncurve(self.g, t0) == 1)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":5987
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         t = bool(oncurve(self.g, t0) == 1)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":5988
 *         t0GEN(x)
 *         sig_on()
 *         t = bool(oncurve(self.g, t0) == 1)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return t
 */
    __pyx_t_1 = __Pyx_PyBool_FromLong((oncurve(__pyx_v_self->g, __pyx_v_7example_t0) == 1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_4bool_bool)), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_t = ((PyBoolObject *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":5989
 *         sig_on()
 *         t = bool(oncurve(self.g, t0) == 1)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return t
 * 
 */
    _pari_sig_off();

    /* "example.pyx":5990
 *         t = bool(oncurve(self.g, t0) == 1)
 *         sig_off()
 *         return t             # <<<<<<<<<<<<<<
 * 
 *     def elllocalred(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_t));
    __pyx_r = ((PyObject *)__pyx_v_t);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.ellisoncurve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_t);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_413elllocalred(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_412elllocalred[] = "\n        e.elllocalred(p): computes the data of local reduction at the prime\n        p on the elliptic curve e\n\n        For more details on local reduction and Kodaira types, see IV.8 and\n        IV.9 in J. Silverman's book \"Advanced topics in the arithmetic of\n        elliptic curves\".\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve with coefficients in `\\ZZ`\n\n        -  ``p`` - prime number\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the exponent of p in the arithmetic\n           conductor of e\n\n        -  ``gen`` - the Kodaira type of e at p, encoded as an\n           integer:\n\n        -  ``1`` - type `I_0`: good reduction,\n           nonsingular curve of genus 1\n\n        -  ``2`` - type `II`: rational curve with a\n           cusp\n\n        -  ``3`` - type `III`: two nonsingular rational\n           curves intersecting tangentially at one point\n\n        -  ``4`` - type `IV`: three nonsingular\n           rational curves intersecting at one point\n\n        -  ``5`` - type `I_1`: rational curve with a\n           node\n\n        -  ``6 or larger`` - think of it as `4+v`, then\n           it is type `I_v`: `v` nonsingular rational curves\n           arranged as a `v`-gon\n\n        -  ``-1`` - type `I_0^*`: nonsingular rational\n           curve of multiplicity two with four nonsingular rational curves of\n           multiplicity one attached\n\n        -  ``-2`` - type `II^*`: nine nonsingular\n           rational curves in a special configuration\n\n        -  ``-3`` - type `III^*`: eight nonsingular\n           rational curves in a special configuration\n\n        -  ``-4`` - type `IV^*`: seven nonsingular\n           rational curves in a special configuration\n\n        -  ``-5 or smaller`` - think of it as `-4-v`,\n           then it is type `I_v^*`: chain of `v+1`\n           nonsingular rational curves of multiplicity two, with two\n           nonsingular rational curves of multiplicity one attached at either\n           en""d\n\n        -  ``gen`` - a vector with 4 components, giving the\n           coordinate changes done during the local reduction; if the first\n           component is 1, then the equation for e was already minimal at p\n\n        -  ``gen`` - the local Tamagawa number `c_p`\n\n\n        EXAMPLES:\n\n        Type `I_0`::\n\n            sage: e = pari([0,0,0,0,1]).ellinit()\n            sage: e.elllocalred(7)\n            [0, 1, [1, 0, 0, 0], 1]\n\n        Type `II`::\n\n            sage: e = pari(EllipticCurve('27a3').a_invariants()).ellinit()\n            sage: e.elllocalred(3)\n            [3, 2, [1, -1, 0, 1], 1]\n\n        Type `III`::\n\n            sage: e = pari(EllipticCurve('24a4').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, 3, [1, 1, 0, 1], 2]\n\n        Type `IV`::\n\n            sage: e = pari(EllipticCurve('20a2').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [2, 4, [1, 1, 0, 1], 3]\n\n        Type `I_1`::\n\n            sage: e = pari(EllipticCurve('11a2').a_invariants()).ellinit()\n            sage: e.elllocalred(11)\n            [1, 5, [1, 0, 0, 0], 1]\n\n        Type `I_2`::\n\n            sage: e = pari(EllipticCurve('14a4').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [1, 6, [1, 0, 0, 0], 2]\n\n        Type `I_6`::\n\n            sage: e = pari(EllipticCurve('14a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [1, 10, [1, 0, 0, 0], 2]\n\n        Type `I_0^*`::\n\n            sage: e = pari(EllipticCurve('32a3').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [5, -1, [1, 1, 1, 0], 1]\n\n        Type `II^*`::\n\n            sage: e = pari(EllipticCurve('24a5').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, -2, [1, 2, 1, 4], 1]\n\n        Type `III^*`::\n\n            sage: e = pari(EllipticCurve('24a2').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n     ""       [3, -3, [1, 2, 1, 4], 2]\n\n        Type `IV^*`::\n\n            sage: e = pari(EllipticCurve('20a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [2, -4, [1, 0, 1, 2], 3]\n\n        Type `I_1^*`::\n\n            sage: e = pari(EllipticCurve('24a1').a_invariants()).ellinit()\n            sage: e.elllocalred(2)\n            [3, -5, [1, 0, 1, 2], 4]\n\n        Type `I_6^*`::\n\n            sage: e = pari(EllipticCurve('90c2').a_invariants()).ellinit()\n            sage: e.elllocalred(3)\n            [2, -10, [1, 96, 1, 316], 4]\n        ";
  static PyObject *__pyx_pw_7example_3gen_413elllocalred(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elllocalred (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_412elllocalred(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":5992
 *         return t
 * 
 *     def elllocalred(self, p):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.elllocalred(p): computes the data of local reduction at the prime
 */

  static PyObject *__pyx_pf_7example_3gen_412elllocalred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elllocalred", 0);

    /* "example.pyx":6143
 *             [2, -10, [1, 96, 1, 316], 4]
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(elllocalred(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6144
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(elllocalred(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6145
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(elllocalred(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def elllseries(self, s, A=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, elllocalred(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.elllocalred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_415elllseries(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_414elllseries[] = "\n        e.elllseries(s, A=1): return the value of the `L`-series of\n        the elliptic curve e at the complex number s.\n\n        This uses an `O(N^{1/2})` algorithm in the conductor N of\n        e, so it is impractical for large conductors (say greater than\n        `10^{12}`).\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve defined over `\\QQ`\n\n        -  ``s`` - complex number\n\n        -  ``A (optional)`` - cutoff point for the integral,\n           which must be chosen close to 1 for best speed.\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.elllseries(2.1)\n            0.402838047956645\n            sage: e.elllseries(1)   # random, close to 0\n            1.822829333527862 E-19\n            sage: e.elllseries(-2)\n            0\n\n        The following example differs for the last digit on 32 vs. 64 bit\n        systems\n\n        ::\n\n            sage: e.elllseries(2.1, A=1.1)\n            0.402838047956645\n        ";
  static PyObject *__pyx_pw_7example_3gen_415elllseries(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    PyObject *__pyx_v_A = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elllseries (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__s,&__pyx_n_s__A,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__s)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__A);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elllseries") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6147; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_s = values[0];
      __pyx_v_A = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elllseries", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6147; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.elllseries", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_414elllseries(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_s, __pyx_v_A);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6147
 *         return self.new_gen(elllocalred(self.g, t0))
 * 
 *     def elllseries(self, s, A=1):             # <<<<<<<<<<<<<<
 *         """
 *         e.elllseries(s, A=1): return the value of the `L`-series of
 */

  static PyObject *__pyx_pf_7example_3gen_414elllseries(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_A) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elllseries", 0);

    /* "example.pyx":6185
 *             0.402838047956645
 *         """
 *         t0GEN(s); t1GEN(A)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the argument prec has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_s); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_A); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6186
 *         """
 *         t0GEN(s); t1GEN(A)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the argument prec has no effect
 *         return self.new_gen(elllseries(self.g, t0, t1, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6186; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6188
 *         sig_on()
 *         # the argument prec has no effect
 *         return self.new_gen(elllseries(self.g, t0, t1, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellminimalmodel(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, elllseries(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.elllseries", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_417ellminimalmodel(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_416ellminimalmodel[] = "\n        ellminimalmodel(e): return the standard minimal integral model of\n        the rational elliptic curve e and the corresponding change of\n        variables. INPUT:\n\n\n        -  ``e`` - gen (that defines an elliptic curve)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - minimal model\n\n        -  ``gen`` - change of coordinates\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,2,3,4,5]).ellinit()\n            sage: F, ch = e.ellminimalmodel()\n            sage: F[:5]\n            [1, -1, 0, 4, 3]\n            sage: ch\n            [1, -1, 0, -1]\n            sage: e.ellchangecurve(ch)[:5]\n            [1, -1, 0, 4, 3]\n        ";
  static PyObject *__pyx_pw_7example_3gen_417ellminimalmodel(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellminimalmodel (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_416ellminimalmodel(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6190
 *         return self.new_gen(elllseries(self.g, t0, t1, prec))
 * 
 *     def ellminimalmodel(self):             # <<<<<<<<<<<<<<
 *         """
 *         ellminimalmodel(e): return the standard minimal integral model of
 */

  static PyObject *__pyx_pf_7example_3gen_416ellminimalmodel(struct __pyx_obj_7example_gen *__pyx_v_self) {
    GEN __pyx_v_x;
    GEN __pyx_v_y;
    struct __pyx_obj_7example_gen *__pyx_v_model = 0;
    struct __pyx_obj_7example_gen *__pyx_v_change = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellminimalmodel", 0);

    /* "example.pyx":6222
 *         cdef gen model, change
 *         cdef pari_sp t
 *         sig_on()             # <<<<<<<<<<<<<<
 *         x = ellminimalmodel(self.g, &y)
 *         change = self.new_gen_noclear(y)
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6223
 *         cdef pari_sp t
 *         sig_on()
 *         x = ellminimalmodel(self.g, &y)             # <<<<<<<<<<<<<<
 *         change = self.new_gen_noclear(y)
 *         model = self.new_gen(x)
 */
    __pyx_v_x = ellminimalmodel(__pyx_v_self->g, (&__pyx_v_y));

    /* "example.pyx":6224
 *         sig_on()
 *         x = ellminimalmodel(self.g, &y)
 *         change = self.new_gen_noclear(y)             # <<<<<<<<<<<<<<
 *         model = self.new_gen(x)
 *         return model, change
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen_noclear(__pyx_v_self, __pyx_v_y)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_change = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":6225
 *         x = ellminimalmodel(self.g, &y)
 *         change = self.new_gen_noclear(y)
 *         model = self.new_gen(x)             # <<<<<<<<<<<<<<
 *         return model, change
 * 
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_x)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_model = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":6226
 *         change = self.new_gen_noclear(y)
 *         model = self.new_gen(x)
 *         return model, change             # <<<<<<<<<<<<<<
 * 
 *     def ellorder(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(((PyObject *)__pyx_v_model));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_model));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_model));
    __Pyx_INCREF(((PyObject *)__pyx_v_change));
    PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_change));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_change));
    __pyx_r = ((PyObject *)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.ellminimalmodel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_model);
    __Pyx_XDECREF((PyObject *)__pyx_v_change);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_419ellorder(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_418ellorder[] = "\n        e.ellorder(x): return the order of the point x on the elliptic\n        curve e (return 0 if x is not a torsion point)\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve defined over `\\QQ`\n\n        -  ``x`` - point on e\n\n\n        EXAMPLES::\n\n            sage: e = pari(EllipticCurve('65a1').a_invariants()).ellinit()\n\n        A point of order two::\n\n            sage: e.ellorder([0,0])\n            2\n\n        And a point of infinite order::\n\n            sage: e.ellorder([1,0])\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_419ellorder(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellorder (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_418ellorder(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6228
 *         return model, change
 * 
 *     def ellorder(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellorder(x): return the order of the point x on the elliptic
 */

  static PyObject *__pyx_pf_7example_3gen_418ellorder(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellorder", 0);

    /* "example.pyx":6255
 *             0
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(orderell(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6256
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(orderell(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6257
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(orderell(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def ellordinate(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, orderell(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellorder", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_421ellordinate(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_420ellordinate[] = "\n        e.ellordinate(x): return the `y`-coordinates of the points\n        on the elliptic curve e having x as `x`-coordinate.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``x`` - x-coordinate (can be a complex or p-adic\n           number, or a more complicated object like a power series)\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: e.ellordinate(0)\n            [0, -1]\n            sage: C.<i> = ComplexField()\n            sage: e.ellordinate(i)\n            [0.582203589721741 - 1.38606082464177*I, -1.58220358972174 + 1.38606082464177*I]\n            sage: e.ellordinate(1+3*5^1+O(5^3))\n            [4*5 + 5^2 + O(5^3), 4 + 3*5^2 + O(5^3)]\n            sage: e.ellordinate('z+2*z^2+O(z^4)')\n            [-2*z - 7*z^2 - 23*z^3 + O(z^4), -1 + 2*z + 7*z^2 + 23*z^3 + O(z^4)]\n        ";
  static PyObject *__pyx_pw_7example_3gen_421ellordinate(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellordinate (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_420ellordinate(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6259
 *         return self.new_gen(orderell(self.g, t0))
 * 
 *     def ellordinate(self, x):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellordinate(x): return the `y`-coordinates of the points
 */

  static PyObject *__pyx_pf_7example_3gen_420ellordinate(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellordinate", 0);

    /* "example.pyx":6286
 *             [-2*z - 7*z^2 - 23*z^3 + O(z^4), -1 + 2*z + 7*z^2 + 23*z^3 + O(z^4)]
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the prec argument has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6287
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(ellordinate(self.g, t0, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6289
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(ellordinate(self.g, t0, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellpointtoz(self, P, long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellordinate(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellordinate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_423ellpointtoz(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_422ellpointtoz[] = "\n        e.ellpointtoz(P): return the complex number (in the fundamental\n        parallelogram) corresponding to the point P on the elliptic curve\n        e, under the complex uniformization of e given by the Weierstrass\n        p-function.\n\n        The complex number z returned by this function lies in the\n        parallelogram formed by the real and complex periods of e, as given\n        by e.omega().\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: e.ellpointtoz([0,0])\n            1.85407467730137\n\n        The point at infinity is sent to the complex number 0::\n\n            sage: e.ellpointtoz([0])\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_423ellpointtoz(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_P = 0;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellpointtoz (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__P,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__P)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellpointtoz") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6291; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_P = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6291; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellpointtoz", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6291; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellpointtoz", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_422ellpointtoz(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_P, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6291
 *         return self.new_gen(ellordinate(self.g, t0, prec))
 * 
 *     def ellpointtoz(self, P, long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpointtoz(P): return the complex number (in the fundamental
 */

  static PyObject *__pyx_pf_7example_3gen_422ellpointtoz(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_P, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellpointtoz", 0);

    /* "example.pyx":6313
 *             0
 *         """
 *         t0GEN(P)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(zell(self.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_P); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6314
 *         """
 *         t0GEN(P)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(zell(self.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6315
 *         t0GEN(P)
 *         sig_on()
 *         return self.new_gen(zell(self.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def ellpow(self, z, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, zell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.ellpointtoz", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_425ellpow(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_424ellpow[] = "\n        e.ellpow(z, n): return `n` times the point `z` on the elliptic\n        curve `e`.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - point on `e`\n\n        -  ``n`` - integer, or a complex quadratic integer of complex\n           multiplication for `e`. Complex multiplication currently\n           only works if `e` is defined over `Q`.\n\n\n        EXAMPLES: We consider a curve with CM by `Z[i]`::\n\n            sage: e = pari([0,0,0,3,0]).ellinit()\n            sage: p = [1,2]  # Point of infinite order\n\n        Multiplication by two::\n\n            sage: e.ellpow([0,0], 2)\n            [0]\n            sage: e.ellpow(p, 2)\n            [1/4, -7/8]\n\n        Complex multiplication::\n\n            sage: q = e.ellpow(p, 1+I); q\n            [-2*I, 1 + I]\n            sage: e.ellpow(q, 1-I)\n            [1/4, -7/8]\n\n        TESTS::\n\n            sage: for D in [-7, -8, -11, -12, -16, -19, -27, -28]:  # long time (1s)\n            ...       hcpol = hilbert_class_polynomial(D)\n            ...       j = hcpol.roots(multiplicities=False)[0]\n            ...       t = (1728-j)/(27*j)\n            ...       E = EllipticCurve([4*t,16*t^2])\n            ...       P = E.point([0, 4*t])\n            ...       assert(E.j_invariant() == j)\n            ...       #\n            ...       # Compute some CM number and its minimal polynomial\n            ...       #\n            ...       cm = pari('cm = (3*quadgen(%s)+2)'%D)\n            ...       cm_minpoly = pari('minpoly(cm)')\n            ...       #\n            ...       # Evaluate cm_minpoly(cm)(P), which should be zero\n            ...       #\n            ...       e = pari(E)  # Convert E to PARI\n            ...       P2 = e.ellpow(P, cm_minpoly[2]*cm + cm_minpoly[1])\n            ...       P0 = e.elladd(e.ellpow(P, cm_minpoly[0]), e.ellpow(P2, cm))\n            ...       assert(P0 == E(0))\n        ";
  static PyObject *__pyx_pw_7example_3gen_425ellpow(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_v_n = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellpow (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z,&__pyx_n_s__n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellpow", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6317; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellpow") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6317; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z = values[0];
      __pyx_v_n = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellpow", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6317; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellpow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_424ellpow(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6317
 *         return self.new_gen(zell(self.g, t0, pbw(precision)))
 * 
 *     def ellpow(self, z, n):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellpow(z, n): return `n` times the point `z` on the elliptic
 */

  static PyObject *__pyx_pf_7example_3gen_424ellpow(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellpow", 0);

    /* "example.pyx":6375
 *             ...       assert(P0 == E(0))
 *         """
 *         t0GEN(z); t1GEN(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(powell(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6376
 *         """
 *         t0GEN(z); t1GEN(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(powell(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6377
 *         t0GEN(z); t1GEN(n)
 *         sig_on()
 *         return self.new_gen(powell(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def ellrootno(self, p=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, powell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellpow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_427ellrootno(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_426ellrootno[] = "\n        e.ellrootno(p): return the (local or global) root number of the\n        `L`-series of the elliptic curve e\n\n        If p is a prime number, the local root number at p is returned. If\n        p is 1, the global root number is returned. Note that the global\n        root number is the sign of the functional equation of the\n        `L`-series, and therefore conjecturally equal to the parity\n        of the rank of e.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`\n\n        -  ``p (default = 1)`` - 1 or a prime number\n\n\n        OUTPUT: 1 or -1\n\n        EXAMPLES: Here is a curve of rank 3::\n\n            sage: e = pari([0,0,0,-82,0]).ellinit()\n            sage: e.ellrootno()\n            -1\n            sage: e.ellrootno(2)\n            1\n            sage: e.ellrootno(1009)\n            1\n        ";
  static PyObject *__pyx_pw_7example_3gen_427ellrootno(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellrootno (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellrootno") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6379; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellrootno", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6379; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellrootno", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_426ellrootno(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6379
 *         return self.new_gen(powell(self.g, t0, t1))
 * 
 *     def ellrootno(self, p=1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellrootno(p): return the (local or global) root number of the
 */

  static PyObject *__pyx_pf_7example_3gen_426ellrootno(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    long __pyx_v_rootno;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellrootno", 0);

    /* "example.pyx":6411
 *         """
 *         cdef long rootno
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         rootno =  ellrootno(self.g, t0)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6412
 *         cdef long rootno
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         rootno =  ellrootno(self.g, t0)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6413
 *         t0GEN(p)
 *         sig_on()
 *         rootno =  ellrootno(self.g, t0)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return rootno
 */
    __pyx_v_rootno = ellrootno(__pyx_v_self->g, __pyx_v_7example_t0);

    /* "example.pyx":6414
 *         sig_on()
 *         rootno =  ellrootno(self.g, t0)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return rootno
 * 
 */
    _pari_sig_off();

    /* "example.pyx":6415
 *         rootno =  ellrootno(self.g, t0)
 *         sig_off()
 *         return rootno             # <<<<<<<<<<<<<<
 * 
 *     def ellsigma(self, z, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_rootno); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6415; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellrootno", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_429ellsigma(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_428ellsigma[] = "\n        e.ellsigma(z, flag=0): return the value at the complex point z of\n        the Weierstrass `\\sigma` function associated to the\n        elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: C.<i> = ComplexField()\n            sage: e.ellsigma(2+i)\n            1.43490215804166 + 1.80307856719256*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_429ellsigma(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellsigma (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellsigma") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6417; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      __pyx_v_flag = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellsigma", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6417; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellsigma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_428ellsigma(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6417
 *         return rootno
 * 
 *     def ellsigma(self, z, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsigma(z, flag=0): return the value at the complex point z of
 */

  static PyObject *__pyx_pf_7example_3gen_428ellsigma(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellsigma", 0);

    /* "example.pyx":6430
 *             1.43490215804166 + 1.80307856719256*I
 *         """
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the prec argument has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6431
 *         """
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(ellsigma(self.g, t0, flag, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6433
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(ellsigma(self.g, t0, flag, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellsub(self, z0, z1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellsigma(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3, __pyx_t_4))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellsigma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_431ellsub(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_430ellsub[] = "\n        e.ellsub(z0, z1): return z0-z1 on this elliptic curve.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve E\n\n        -  ``z0`` - point on E\n\n        -  ``z1`` - point on E\n\n\n        OUTPUT: point on E\n\n        EXAMPLES::\n\n            sage: e = pari([0, 1, 1, -2, 0]).ellinit()\n            sage: e.ellsub([1,0], [-1,1])\n            [0, 0]\n        ";
  static PyObject *__pyx_pw_7example_3gen_431ellsub(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z0 = 0;
    PyObject *__pyx_v_z1 = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellsub (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z0,&__pyx_n_s__z1,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z0)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z1)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ellsub", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellsub") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_z0 = values[0];
      __pyx_v_z1 = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellsub", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6435; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellsub", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_430ellsub(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z0, __pyx_v_z1);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6435
 *         return self.new_gen(ellsigma(self.g, t0, flag, prec))
 * 
 *     def ellsub(self, z0, z1):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellsub(z0, z1): return z0-z1 on this elliptic curve.
 */

  static PyObject *__pyx_pf_7example_3gen_430ellsub(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z0, PyObject *__pyx_v_z1) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellsub", 0);

    /* "example.pyx":6457
 *             [0, 0]
 *         """
 *         t0GEN(z0); t1GEN(z1)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(subell(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_z1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6457; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6458
 *         """
 *         t0GEN(z0); t1GEN(z1)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(subell(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6458; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6459
 *         t0GEN(z0); t1GEN(z1)
 *         sig_on()
 *         return self.new_gen(subell(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def elltaniyama(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, subell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellsub", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_433elltaniyama(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_433elltaniyama(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elltaniyama (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_432elltaniyama(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6461
 *         return self.new_gen(subell(self.g, t0, t1))
 * 
 *     def elltaniyama(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(taniyama(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_432elltaniyama(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elltaniyama", 0);

    /* "example.pyx":6462
 * 
 *     def elltaniyama(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(taniyama(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6462; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6463
 *     def elltaniyama(self):
 *         sig_on()
 *         return self.new_gen(taniyama(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def elltors(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, taniyama(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.elltaniyama", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_435elltors(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_434elltors[] = "\n        e.elltors(flag = 0): return information about the torsion subgroup\n        of the elliptic curve e\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve over `\\QQ`\n\n        -  ``flag (optional)`` - specify which algorithm to\n           use:\n\n        -  ``0 (default)`` - use Doud's algorithm: bound\n           torsion by computing the cardinality of e(GF(p)) for small primes\n           of good reduction, then look for torsion points using Weierstrass\n           parametrization and Mazur's classification\n\n        -  ``1`` - use algorithm given by the Nagell-Lutz\n           theorem (this is much slower)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - the order of the torsion subgroup, a.k.a.\n           the number of points of finite order\n\n        -  ``gen`` - vector giving the structure of the torsion\n           subgroup as a product of cyclic groups, sorted in non-increasing\n           order\n\n        -  ``gen`` - vector giving points on e generating these\n           cyclic groups\n\n\n        EXAMPLES::\n\n            sage: e = pari([1,0,1,-19,26]).ellinit()\n            sage: e.elltors()\n            [12, [6, 2], [[-2, 8], [3, -2]]]\n        ";
  static PyObject *__pyx_pw_7example_3gen_435elltors(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elltors (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elltors") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6465; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elltors", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6465; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.elltors", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_434elltors(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6465
 *         return self.new_gen(taniyama(self.g))
 * 
 *     def elltors(self, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         e.elltors(flag = 0): return information about the torsion subgroup
 */

  static PyObject *__pyx_pf_7example_3gen_434elltors(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elltors", 0);

    /* "example.pyx":6507
 *             [12, [6, 2], [[-2, 8], [3, -2]]]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(elltors0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6508
 *         """
 *         sig_on()
 *         return self.new_gen(elltors0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def ellzeta(self, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, elltors0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.elltors", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_437ellzeta(PyObject *__pyx_v_self, PyObject *__pyx_v_z); /*proto*/
  static char __pyx_doc_7example_3gen_436ellzeta[] = "\n        e.ellzeta(z): return the value at the complex point z of the\n        Weierstrass `\\zeta` function associated with the elliptic\n        curve e.\n\n        .. note::\n\n           This function has infinitely many poles (one of which is at\n           z=0); attempting to evaluate it too close to one of the\n           poles will result in a PariError.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - complex number\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: e.ellzeta(1)\n            1.06479841295883 + 0.E-19*I                # 32-bit\n            1.06479841295883 + 5.42101086242752 E-20*I # 64-bit\n            sage: C.<i> = ComplexField()\n            sage: e.ellzeta(i-1)\n            -0.350122658523049 - 0.350122658523049*I\n        ";
  static PyObject *__pyx_pw_7example_3gen_437ellzeta(PyObject *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellzeta (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_436ellzeta(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_z));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6510
 *         return self.new_gen(elltors0(self.g, flag))
 * 
 *     def ellzeta(self, z):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellzeta(z): return the value at the complex point z of the
 */

  static PyObject *__pyx_pf_7example_3gen_436ellzeta(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellzeta", 0);

    /* "example.pyx":6540
 *             -0.350122658523049 - 0.350122658523049*I
 *         """
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the prec argument has no effect
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6540; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6541
 *         """
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(ellzeta(self.g, t0, prec))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6541; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6543
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(ellzeta(self.g, t0, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellztopoint(self, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellzeta(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellzeta", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_439ellztopoint(PyObject *__pyx_v_self, PyObject *__pyx_v_z); /*proto*/
  static char __pyx_doc_7example_3gen_438ellztopoint[] = "\n        e.ellztopoint(z): return the point on the elliptic curve e\n        corresponding to the complex number z, under the usual complex\n        uniformization of e by the Weierstrass p-function.\n\n        INPUT:\n\n\n        -  ``e`` - elliptic curve\n\n        -  ``z`` - complex number\n\n\n        OUTPUT point on e\n\n        EXAMPLES::\n\n            sage: e = pari([0,0,0,1,0]).ellinit()\n            sage: C.<i> = ComplexField()\n            sage: e.ellztopoint(1+i)\n            [0.E-19 - 1.02152286795670*I, -0.149072813701096 - 0.149072813701096*I] # 32-bit\n            [...  - 1.02152286795670*I, -0.149072813701096 - 0.149072813701096*I] # 64-bit\n\n        Complex numbers belonging to the period lattice of e are of course\n        sent to the point at infinity on e::\n\n            sage: e.ellztopoint(0)\n            [0]\n        ";
  static PyObject *__pyx_pw_7example_3gen_439ellztopoint(PyObject *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellztopoint (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_438ellztopoint(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_z));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6545
 *         return self.new_gen(ellzeta(self.g, t0, prec))
 * 
 *     def ellztopoint(self, z):             # <<<<<<<<<<<<<<
 *         """
 *         e.ellztopoint(z): return the point on the elliptic curve e
 */

  static PyObject *__pyx_pf_7example_3gen_438ellztopoint(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_v_dprec = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    int __pyx_t_7;
    PyObject *__pyx_t_8 = NULL;
    long __pyx_t_9;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellztopoint", 0);

    /* "example.pyx":6575
 *             [0]
 *         """
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         try:
 *             dprec = prec_words_to_dec(z.precision())
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6576
 *         """
 *         t0GEN(z)
 *         try:             # <<<<<<<<<<<<<<
 *             dprec = prec_words_to_dec(z.precision())
 *         except AttributeError:
 */
    {
      __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
      __Pyx_XGOTREF(__pyx_t_2);
      __Pyx_XGOTREF(__pyx_t_3);
      __Pyx_XGOTREF(__pyx_t_4);
      /*try:*/ {

        /* "example.pyx":6577
 *         t0GEN(z)
 *         try:
 *             dprec = prec_words_to_dec(z.precision())             # <<<<<<<<<<<<<<
 *         except AttributeError:
 *             dprec = prec
 */
        __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_words_to_dec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_5 = PyObject_GetAttr(__pyx_v_z, __pyx_n_s__precision); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6577; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_v_dprec = __pyx_t_6;
        __pyx_t_6 = 0;
      }
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L10_try_end;
      __pyx_L3_error:;
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "example.pyx":6578
 *         try:
 *             dprec = prec_words_to_dec(z.precision())
 *         except AttributeError:             # <<<<<<<<<<<<<<
 *             dprec = prec
 *         sig_on()
 */
      __pyx_t_7 = PyErr_ExceptionMatches(__pyx_builtin_AttributeError);
      if (__pyx_t_7) {
        __Pyx_AddTraceback("example.gen.ellztopoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_5, &__pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6578; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_GOTREF(__pyx_t_1);

        /* "example.pyx":6579
 *             dprec = prec_words_to_dec(z.precision())
 *         except AttributeError:
 *             dprec = prec             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # the prec argument has no effect
 */
        __pyx_t_8 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6579; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_XDECREF(__pyx_v_dprec);
        __pyx_v_dprec = __pyx_t_8;
        __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L4_exception_handled;
      }
      __pyx_L5_except_error:;
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_XGIVEREF(__pyx_t_4);
      __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      goto __pyx_L1_error;
      __pyx_L4_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_XGIVEREF(__pyx_t_4);
      __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      __pyx_L10_try_end:;
    }

    /* "example.pyx":6580
 *         except AttributeError:
 *             dprec = prec
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the prec argument has no effect
 *         return self.new_gen(pointell(self.g, t0, dprec))
 */
    __pyx_t_7 = _pari_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6582
 *         sig_on()
 *         # the prec argument has no effect
 *         return self.new_gen(pointell(self.g, t0, dprec))             # <<<<<<<<<<<<<<
 * 
 *     def omega(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_9 = __Pyx_PyInt_AsLong(__pyx_v_dprec); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, pointell(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_9))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_AddTraceback("example.gen.ellztopoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_dprec);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_441omega(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_440omega[] = "\n        e.omega(): return basis for the period lattice of the elliptic\n        curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.omega()\n            [1.26920930427955, -0.634604652139777 - 1.45881661693850*I]\n        ";
  static PyObject *__pyx_pw_7example_3gen_441omega(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("omega (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_440omega(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6584
 *         return self.new_gen(pointell(self.g, t0, dprec))
 * 
 *     def omega(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.omega(): return basis for the period lattice of the elliptic
 */

  static PyObject *__pyx_pf_7example_3gen_440omega(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("omega", 0);

    /* "example.pyx":6595
 *             [1.26920930427955, -0.634604652139777 - 1.45881661693850*I]
 *         """
 *         return self[14:16]             # <<<<<<<<<<<<<<
 * 
 *     def disc(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_PySequence_GetSlice(((PyObject *)__pyx_v_self), 14, 16); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_443disc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_442disc[] = "\n        e.disc(): return the discriminant of the elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.disc()\n            -161051\n            sage: _.factor()\n            [-1, 1; 11, 5]\n        ";
  static PyObject *__pyx_pw_7example_3gen_443disc(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("disc (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_442disc(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6597
 *         return self[14:16]
 * 
 *     def disc(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.disc(): return the discriminant of the elliptic curve e.
 */

  static PyObject *__pyx_pf_7example_3gen_442disc(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("disc", 0);

    /* "example.pyx":6609
 *             [-1, 1; 11, 5]
 *         """
 *         return self[11]             # <<<<<<<<<<<<<<
 * 
 *     def j(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 11, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.disc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_445j(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_444j[] = "\n        e.j(): return the j-invariant of the elliptic curve e.\n\n        EXAMPLES::\n\n            sage: e = pari([0, -1, 1, -10, -20]).ellinit()\n            sage: e.j()\n            -122023936/161051\n            sage: _.factor()\n            [-1, 1; 2, 12; 11, -5; 31, 3]\n        ";
  static PyObject *__pyx_pw_7example_3gen_445j(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("j (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_444j(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6611
 *         return self[11]
 * 
 *     def j(self):             # <<<<<<<<<<<<<<
 *         """
 *         e.j(): return the j-invariant of the elliptic curve e.
 */

  static PyObject *__pyx_pf_7example_3gen_444j(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("j", 0);

    /* "example.pyx":6623
 *             [-1, 1; 2, 12; 11, -5; 31, 3]
 *         """
 *         return self[12]             # <<<<<<<<<<<<<<
 * 
 *     def ellj(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 12, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.j", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_447ellj(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_447ellj(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellj (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_446ellj(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6625
 *         return self[12]
 * 
 *     def ellj(self):             # <<<<<<<<<<<<<<
 *         try:
 *             dprec = prec_words_to_dec(self.precision())
 */

  static PyObject *__pyx_pf_7example_3gen_446ellj(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_v_dprec = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    int __pyx_t_7;
    PyObject *__pyx_t_8 = NULL;
    long __pyx_t_9;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellj", 0);

    /* "example.pyx":6626
 * 
 *     def ellj(self):
 *         try:             # <<<<<<<<<<<<<<
 *             dprec = prec_words_to_dec(self.precision())
 *         except AttributeError:
 */
    {
      __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
      __Pyx_XGOTREF(__pyx_t_1);
      __Pyx_XGOTREF(__pyx_t_2);
      __Pyx_XGOTREF(__pyx_t_3);
      /*try:*/ {

        /* "example.pyx":6627
 *     def ellj(self):
 *         try:
 *             dprec = prec_words_to_dec(self.precision())             # <<<<<<<<<<<<<<
 *         except AttributeError:
 *             dprec = prec
 */
        __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_words_to_dec); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__precision); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6627; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __pyx_v_dprec = __pyx_t_6;
        __pyx_t_6 = 0;
      }
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L10_try_end;
      __pyx_L3_error:;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;

      /* "example.pyx":6628
 *         try:
 *             dprec = prec_words_to_dec(self.precision())
 *         except AttributeError:             # <<<<<<<<<<<<<<
 *             dprec = prec
 *         sig_on()
 */
      __pyx_t_7 = PyErr_ExceptionMatches(__pyx_builtin_AttributeError);
      if (__pyx_t_7) {
        __Pyx_AddTraceback("example.gen.ellj", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (__Pyx_GetException(&__pyx_t_6, &__pyx_t_5, &__pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6628; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_GOTREF(__pyx_t_4);

        /* "example.pyx":6629
 *             dprec = prec_words_to_dec(self.precision())
 *         except AttributeError:
 *             dprec = prec             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(jell(self.g, dprec))
 */
        __pyx_t_8 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6629; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_XDECREF(__pyx_v_dprec);
        __pyx_v_dprec = __pyx_t_8;
        __pyx_t_8 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L4_exception_handled;
      }
      __pyx_L5_except_error:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      goto __pyx_L1_error;
      __pyx_L4_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      __pyx_L10_try_end:;
    }

    /* "example.pyx":6630
 *         except AttributeError:
 *             dprec = prec
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(jell(self.g, dprec))
 * 
 */
    __pyx_t_7 = _pari_sig_on(); if (unlikely(__pyx_t_7 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6631
 *             dprec = prec
 *         sig_on()
 *         return P.new_gen(jell(self.g, dprec))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_9 = __Pyx_PyInt_AsLong(__pyx_v_dprec); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, jell(__pyx_v_self->g, __pyx_t_9))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6631; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_AddTraceback("example.gen.ellj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_dprec);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_449bnfcertify(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_448bnfcertify[] = "\n        ``bnf`` being as output by ``bnfinit``, checks whether the result is\n        correct, i.e. whether the calculation of the contents of ``self``\n        are correct without assuming the Generalized Riemann Hypothesis.\n        If it is correct, the answer is 1. If not, the program may output\n        some error message or loop indefinitely.\n\n        For more information about PARI and the Generalized Riemann\n        Hypothesis, see [PariUsers], page 120.\n\n        REFERENCES:\n\n        .. [PariUsers] User's Guide to PARI/GP,\n           http://pari.math.u-bordeaux.fr/pub/pari/manuals/2.4.2/users.pdf\n        ";
  static PyObject *__pyx_pw_7example_3gen_449bnfcertify(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfcertify (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_448bnfcertify(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6637
 *     # 6: Functions related to NUMBER FIELDS
 *     ###########################################
 *     def bnfcertify(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         ``bnf`` being as output by ``bnfinit``, checks whether the result is
 */

  static PyObject *__pyx_pf_7example_3gen_448bnfcertify(struct __pyx_obj_7example_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfcertify", 0);

    /* "example.pyx":6654
 *         """
 *         cdef long n
 *         sig_on()             # <<<<<<<<<<<<<<
 *         n = bnfcertify(self.g)
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6654; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6655
 *         cdef long n
 *         sig_on()
 *         n = bnfcertify(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = bnfcertify(__pyx_v_self->g);

    /* "example.pyx":6656
 *         sig_on()
 *         n = bnfcertify(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":6657
 *         n = bnfcertify(self.g)
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def bnfinit(self, long flag=0, tech=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6657; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.bnfcertify", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_451bnfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_451bnfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_tech = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__tech,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":6659
 *         return n
 * 
 *     def bnfinit(self, long flag=0, tech=None):             # <<<<<<<<<<<<<<
 *         if tech is None:
 *             sig_on()
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__tech);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_tech = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6659; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_450bnfinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_tech);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_450bnfinit(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_tech) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfinit", 0);

    /* "example.pyx":6660
 * 
 *     def bnfinit(self, long flag=0, tech=None):
 *         if tech is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, <GEN>0, prec))
 */
    __pyx_t_1 = (__pyx_v_tech == Py_None);
    if (__pyx_t_1) {

      /* "example.pyx":6661
 *     def bnfinit(self, long flag=0, tech=None):
 *         if tech is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(bnfinit0(self.g, flag, <GEN>0, prec))
 *         else:
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6662
 *         if tech is None:
 *             sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, <GEN>0, prec))             # <<<<<<<<<<<<<<
 *         else:
 *             t0GEN(tech)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, bnfinit0(__pyx_v_self->g, __pyx_v_flag, ((GEN)0), __pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":6664
 *             return P.new_gen(bnfinit0(self.g, flag, <GEN>0, prec))
 *         else:
 *             t0GEN(tech)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, t0, prec))
 */
      __pyx_t_3 = __pyx_f_7example_t0GEN(__pyx_v_tech); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "example.pyx":6665
 *         else:
 *             t0GEN(tech)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(bnfinit0(self.g, flag, t0, prec))
 * 
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6666
 *             t0GEN(tech)
 *             sig_on()
 *             return P.new_gen(bnfinit0(self.g, flag, t0, prec))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisintnorm(self, x):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, bnfinit0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_7example_t0, __pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.bnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_453bnfisintnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_453bnfisintnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisintnorm (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_452bnfisintnorm(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6668
 *             return P.new_gen(bnfinit0(self.g, flag, t0, prec))
 * 
 *     def bnfisintnorm(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_452bnfisintnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisintnorm", 0);

    /* "example.pyx":6669
 * 
 *     def bnfisintnorm(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(bnfisintnorm(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6670
 *     def bnfisintnorm(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnfisintnorm(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6671
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(bnfisintnorm(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisnorm(self, x, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnfisintnorm(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6671; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bnfisintnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_455bnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_455bnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisnorm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfisnorm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6673; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6673; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfisnorm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6673; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_454bnfisnorm(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6673
 *         return self.new_gen(bnfisintnorm(self.g, t0))
 * 
 *     def bnfisnorm(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_454bnfisnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisnorm", 0);

    /* "example.pyx":6674
 * 
 *     def bnfisnorm(self, x, long flag=0):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(bnfisnorm(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6675
 *     def bnfisnorm(self, x, long flag=0):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnfisnorm(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6676
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(bnfisnorm(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisprincipal(self, x, long flag=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnfisnorm(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_457bnfisprincipal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_457bnfisprincipal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisprincipal (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfisprincipal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfisprincipal", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bnfisprincipal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_456bnfisprincipal(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6678
 *         return self.new_gen(bnfisnorm(self.g, t0, flag))
 * 
 *     def bnfisprincipal(self, x, long flag=1):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_456bnfisprincipal(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisprincipal", 0);

    /* "example.pyx":6679
 * 
 *     def bnfisprincipal(self, x, long flag=1):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(bnfisprincipal0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6680
 *     def bnfisprincipal(self, x, long flag=1):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnfisprincipal0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6681
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(bnfisprincipal0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def bnfnarrow(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnfisprincipal0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6681; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bnfisprincipal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_459bnfnarrow(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_459bnfnarrow(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfnarrow (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_458bnfnarrow(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6683
 *         return self.new_gen(bnfisprincipal0(self.g, t0, flag))
 * 
 *     def bnfnarrow(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(buchnarrow(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_458bnfnarrow(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfnarrow", 0);

    /* "example.pyx":6684
 * 
 *     def bnfnarrow(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(buchnarrow(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6685
 *     def bnfnarrow(self):
 *         sig_on()
 *         return self.new_gen(buchnarrow(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfsunit(bnf, S, long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, buchnarrow(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6685; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.bnfnarrow", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_461bnfsunit(PyObject *__pyx_v_bnf, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_461bnfsunit(PyObject *__pyx_v_bnf, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_S = 0;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfsunit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__S,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__S)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "bnfsunit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_S = values[0];
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("bnfsunit", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6687; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.bnfsunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_460bnfsunit(((struct __pyx_obj_7example_gen *)__pyx_v_bnf), __pyx_v_S, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6687
 *         return self.new_gen(buchnarrow(self.g))
 * 
 *     def bnfsunit(bnf, S, long precision=0):             # <<<<<<<<<<<<<<
 *         t0GEN(S)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_460bnfsunit(struct __pyx_obj_7example_gen *__pyx_v_bnf, PyObject *__pyx_v_S, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfsunit", 0);

    /* "example.pyx":6688
 * 
 *     def bnfsunit(bnf, S, long precision=0):
 *         t0GEN(S)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return bnf.new_gen(bnfsunit(bnf.g, t0, pbw(precision)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_S); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6688; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6689
 *     def bnfsunit(bnf, S, long precision=0):
 *         t0GEN(S)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return bnf.new_gen(bnfsunit(bnf.g, t0, pbw(precision)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6690
 *         t0GEN(S)
 *         sig_on()
 *         return bnf.new_gen(bnfsunit(bnf.g, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def bnfunit(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_bnf->__pyx_vtab)->new_gen(__pyx_v_bnf, bnfsunit(__pyx_v_bnf->g, __pyx_v_7example_t0, __pyx_t_5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.bnfsunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_463bnfunit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_463bnfunit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfunit (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_462bnfunit(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6692
 *         return bnf.new_gen(bnfsunit(bnf.g, t0, pbw(precision)))
 * 
 *     def bnfunit(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(bnf_get_fu(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_462bnfunit(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfunit", 0);

    /* "example.pyx":6693
 * 
 *     def bnfunit(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnf_get_fu(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6694
 *     def bnfunit(self):
 *         sig_on()
 *         return self.new_gen(bnf_get_fu(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def bnfisunit(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnf_get_fu(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.bnfunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_465bnfisunit(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_465bnfisunit(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("bnfisunit (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_464bnfisunit(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6696
 *         return self.new_gen(bnf_get_fu(self.g))
 * 
 *     def bnfisunit(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_464bnfisunit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("bnfisunit", 0);

    /* "example.pyx":6697
 * 
 *     def bnfisunit(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(bnfisunit(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6698
 *     def bnfisunit(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(bnfisunit(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6699
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(bnfisunit(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def dirzetak(self, n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, bnfisunit(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.bnfisunit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_467dirzetak(PyObject *__pyx_v_self, PyObject *__pyx_v_n); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_467dirzetak(PyObject *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("dirzetak (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_466dirzetak(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6701
 *         return self.new_gen(bnfisunit(self.g, t0))
 * 
 *     def dirzetak(self, n):             # <<<<<<<<<<<<<<
 *         t0GEN(n)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_466dirzetak(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("dirzetak", 0);

    /* "example.pyx":6702
 * 
 *     def dirzetak(self, n):
 *         t0GEN(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(dirzetak(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6703
 *     def dirzetak(self, n):
 *         t0GEN(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(dirzetak(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6704
 *         t0GEN(n)
 *         sig_on()
 *         return self.new_gen(dirzetak(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def galoisapply(self, aut, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, dirzetak(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.dirzetak", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_469galoisapply(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_469galoisapply(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_aut = 0;
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisapply (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__aut,&__pyx_n_s__x,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__aut)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("galoisapply", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6706; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisapply") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6706; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_aut = values[0];
      __pyx_v_x = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisapply", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6706; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.galoisapply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_468galoisapply(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_aut, __pyx_v_x);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6706
 *         return self.new_gen(dirzetak(self.g, t0))
 * 
 *     def galoisapply(self, aut, x):             # <<<<<<<<<<<<<<
 *         t0GEN(aut)
 *         t1GEN(x)
 */

  static PyObject *__pyx_pf_7example_3gen_468galoisapply(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_aut, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisapply", 0);

    /* "example.pyx":6707
 * 
 *     def galoisapply(self, aut, x):
 *         t0GEN(aut)             # <<<<<<<<<<<<<<
 *         t1GEN(x)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_aut); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6708
 *     def galoisapply(self, aut, x):
 *         t0GEN(aut)
 *         t1GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(galoisapply(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6709
 *         t0GEN(aut)
 *         t1GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(galoisapply(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6709; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6710
 *         t1GEN(x)
 *         sig_on()
 *         return self.new_gen(galoisapply(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def galoisinit(self, den=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoisapply(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.galoisapply", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_471galoisinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_470galoisinit[] = "\n        galoisinit(K{,den}): calculate Galois group of number field K; see PARI manual\n        for meaning of den\n        ";
  static PyObject *__pyx_pw_7example_3gen_471galoisinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_den = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__den,0};
      PyObject* values[1] = {0};

      /* "example.pyx":6712
 *         return self.new_gen(galoisapply(self.g, t0, t1))
 * 
 *     def galoisinit(self, den=None):             # <<<<<<<<<<<<<<
 *         """
 *         galoisinit(K{,den}): calculate Galois group of number field K; see PARI manual
 */
      values[0] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__den);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_den = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisinit", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6712; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.galoisinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_470galoisinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_den);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_470galoisinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_den) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisinit", 0);

    /* "example.pyx":6717
 *         for meaning of den
 *         """
 *         if den is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(galoisinit(self.g, NULL))
 */
    __pyx_t_1 = (__pyx_v_den == Py_None);
    if (__pyx_t_1) {

      /* "example.pyx":6718
 *         """
 *         if den is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(galoisinit(self.g, NULL))
 *         else:
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6718; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6719
 *         if den is None:
 *             sig_on()
 *             return self.new_gen(galoisinit(self.g, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0GEN(den)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoisinit(__pyx_v_self->g, NULL))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6719; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":6721
 *             return self.new_gen(galoisinit(self.g, NULL))
 *         else:
 *             t0GEN(den)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(galoisinit(self.g, t0))
 */
      __pyx_t_3 = __pyx_f_7example_t0GEN(__pyx_v_den); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6721; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

      /* "example.pyx":6722
 *         else:
 *             t0GEN(den)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(galoisinit(self.g, t0))
 * 
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6722; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6723
 *             t0GEN(den)
 *             sig_on()
 *             return self.new_gen(galoisinit(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def galoispermtopol(self, perm):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoisinit(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.galoisinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_473galoispermtopol(PyObject *__pyx_v_self, PyObject *__pyx_v_perm); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_473galoispermtopol(PyObject *__pyx_v_self, PyObject *__pyx_v_perm) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoispermtopol (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_472galoispermtopol(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_perm));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6725
 *             return self.new_gen(galoisinit(self.g, t0))
 * 
 *     def galoispermtopol(self, perm):             # <<<<<<<<<<<<<<
 *         t0GEN(perm)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_472galoispermtopol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_perm) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoispermtopol", 0);

    /* "example.pyx":6726
 * 
 *     def galoispermtopol(self, perm):
 *         t0GEN(perm)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(galoispermtopol(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_perm); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6727
 *     def galoispermtopol(self, perm):
 *         t0GEN(perm)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(galoispermtopol(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6728
 *         t0GEN(perm)
 *         sig_on()
 *         return self.new_gen(galoispermtopol(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoispermtopol(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.galoispermtopol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_475galoisfixedfield(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_475galoisfixedfield(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_perm = 0;
    long __pyx_v_flag;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("galoisfixedfield (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__perm,&__pyx_n_s__flag,&__pyx_n_s__v,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__perm)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "galoisfixedfield") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6730; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_perm = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6730; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_v = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("galoisfixedfield", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6730; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.galoisfixedfield", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_474galoisfixedfield(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_perm, __pyx_v_flag, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6730
 *         return self.new_gen(galoispermtopol(self.g, t0))
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):             # <<<<<<<<<<<<<<
 *         t0GEN(perm);
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_474galoisfixedfield(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_perm, long __pyx_v_flag, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("galoisfixedfield", 0);

    /* "example.pyx":6731
 * 
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 *         t0GEN(perm);             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(galoisfixedfield(self.g, t0, flag, P.get_var(v)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_perm); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6732
 *     def galoisfixedfield(self, perm, long flag=0, v=-1):
 *         t0GEN(perm);
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(galoisfixedfield(self.g, t0, flag, P.get_var(v)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6733
 *         t0GEN(perm);
 *         sig_on()
 *         return self.new_gen(galoisfixedfield(self.g, t0, flag, P.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def idealred(self, I, vdir=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoisfixedfield(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.galoisfixedfield", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_477idealred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_477idealred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_I = 0;
    PyObject *__pyx_v_vdir = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealred (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__I,&__pyx_n_s__vdir,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__I)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__vdir);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealred") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_I = values[0];
      __pyx_v_vdir = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealred", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6735; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_476idealred(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_I, __pyx_v_vdir);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6735
 *         return self.new_gen(galoisfixedfield(self.g, t0, flag, P.get_var(v)))
 * 
 *     def idealred(self, I, vdir=0):             # <<<<<<<<<<<<<<
 *         t0GEN(I); t1GEN(vdir)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_476idealred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_I, PyObject *__pyx_v_vdir) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    GEN __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealred", 0);

    /* "example.pyx":6736
 * 
 *     def idealred(self, I, vdir=0):
 *         t0GEN(I); t1GEN(vdir)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealred0(self.g, t0, t1 if vdir else NULL))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_I); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_vdir); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6737
 *     def idealred(self, I, vdir=0):
 *         t0GEN(I); t1GEN(vdir)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealred0(self.g, t0, t1 if vdir else NULL))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6738
 *         t0GEN(I); t1GEN(vdir)
 *         sig_on()
 *         return self.new_gen(idealred0(self.g, t0, t1 if vdir else NULL))             # <<<<<<<<<<<<<<
 * 
 *     def idealadd(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_vdir); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_4) {
      __pyx_t_3 = __pyx_v_7example_t1;
    } else {
      __pyx_t_3 = NULL;
    }
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealred0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_479idealadd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_479idealadd(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealadd (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealadd", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealadd") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealadd", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6740; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealadd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_478idealadd(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6740
 *         return self.new_gen(idealred0(self.g, t0, t1 if vdir else NULL))
 * 
 *     def idealadd(self, x, y):             # <<<<<<<<<<<<<<
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_478idealadd(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealadd", 0);

    /* "example.pyx":6741
 * 
 *     def idealadd(self, x, y):
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealadd(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6742
 *     def idealadd(self, x, y):
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealadd(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6743
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         return self.new_gen(idealadd(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealaddtoone(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealadd(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealadd", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_481idealaddtoone(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_481idealaddtoone(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealaddtoone (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealaddtoone", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealaddtoone") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealaddtoone", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6745; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealaddtoone", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_480idealaddtoone(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6745
 *         return self.new_gen(idealadd(self.g, t0, t1))
 * 
 *     def idealaddtoone(self, x, y):             # <<<<<<<<<<<<<<
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_480idealaddtoone(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealaddtoone", 0);

    /* "example.pyx":6746
 * 
 *     def idealaddtoone(self, x, y):
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealaddtoone0(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6747
 *     def idealaddtoone(self, x, y):
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealaddtoone0(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6748
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         return self.new_gen(idealaddtoone0(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealappr(self, x, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealaddtoone0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealaddtoone", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_483idealappr(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_483idealappr(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    CYTHON_UNUSED long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealappr (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealappr") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealappr", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6750; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_482idealappr(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6750
 *         return self.new_gen(idealaddtoone0(self.g, t0, t1))
 * 
 *     def idealappr(self, x, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_482idealappr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, CYTHON_UNUSED long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealappr", 0);

    /* "example.pyx":6751
 * 
 *     def idealappr(self, x, long flag=0):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealappr(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6752
 *     def idealappr(self, x, long flag=0):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealappr(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6753
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(idealappr(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def idealcoprime(self, x, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealappr(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_485idealcoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_484idealcoprime[] = "\n        Given two integral ideals x and y of a pari number field self,\n        return an element a of the field (expressed in the integral\n        basis of self) such that a*x is an integral ideal coprime to\n        y.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: x = pari('[1, -1, 2]~')\n            sage: y = pari('[1, -1, 3]~')\n            sage: nf.idealcoprime(x, y)\n            [1, 0, 0]~\n\n            sage: y = pari('[2, -2, 4]~')\n            sage: nf.idealcoprime(x, y)\n            [5/43, 9/43, -1/43]~\n        ";
  static PyObject *__pyx_pw_7example_3gen_485idealcoprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealcoprime (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealcoprime", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealcoprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealcoprime", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6755; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealcoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_484idealcoprime(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6755
 *         return self.new_gen(idealappr(self.g, t0))
 * 
 *     def idealcoprime(self, x, y):             # <<<<<<<<<<<<<<
 *         """
 *         Given two integral ideals x and y of a pari number field self,
 */

  static PyObject *__pyx_pf_7example_3gen_484idealcoprime(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealcoprime", 0);

    /* "example.pyx":6775
 *             [5/43, 9/43, -1/43]~
 *         """
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealcoprime(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6775; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6776
 *         """
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealcoprime(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6777
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         return self.new_gen(idealcoprime(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealdiv(self, x, y, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealcoprime(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6777; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealcoprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_487idealdiv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_487idealdiv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealdiv (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealdiv", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6779; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealdiv") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6779; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6779; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealdiv", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6779; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_486idealdiv(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6779
 *         return self.new_gen(idealcoprime(self.g, t0, t1))
 * 
 *     def idealdiv(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_486idealdiv(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealdiv", 0);

    /* "example.pyx":6780
 * 
 *     def idealdiv(self, x, y, long flag=0):
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealdiv0(self.g, t0, t1, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6781
 *     def idealdiv(self, x, y, long flag=0):
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealdiv0(self.g, t0, t1, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6782
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         return self.new_gen(idealdiv0(self.g, t0, t1, flag))             # <<<<<<<<<<<<<<
 * 
 *     def idealfactor(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealdiv0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealdiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_489idealfactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_489idealfactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealfactor (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_488idealfactor(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6784
 *         return self.new_gen(idealdiv0(self.g, t0, t1, flag))
 * 
 *     def idealfactor(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_488idealfactor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealfactor", 0);

    /* "example.pyx":6785
 * 
 *     def idealfactor(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealfactor(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6786
 *     def idealfactor(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealfactor(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6787
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(idealfactor(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def idealhnf(self, a, b=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealfactor(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealfactor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_491idealhnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_491idealhnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealhnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__a,&__pyx_n_s__b,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":6789
 *         return self.new_gen(idealfactor(self.g, t0))
 * 
 *     def idealhnf(self, a, b=None):             # <<<<<<<<<<<<<<
 *         t0GEN(a)
 *         if b is None:
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealhnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealhnf", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6789; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_490idealhnf(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_490idealhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealhnf", 0);

    /* "example.pyx":6790
 * 
 *     def idealhnf(self, a, b=None):
 *         t0GEN(a)             # <<<<<<<<<<<<<<
 *         if b is None:
 *             sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6791
 *     def idealhnf(self, a, b=None):
 *         t0GEN(a)
 *         if b is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(idealhnf(self.g, t0))
 */
    __pyx_t_2 = (__pyx_v_b == Py_None);
    if (__pyx_t_2) {

      /* "example.pyx":6792
 *         t0GEN(a)
 *         if b is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(idealhnf(self.g, t0))
 *         else:
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6793
 *         if b is None:
 *             sig_on()
 *             return self.new_gen(idealhnf(self.g, t0))             # <<<<<<<<<<<<<<
 *         else:
 *             t1GEN(b)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealhnf(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":6795
 *             return self.new_gen(idealhnf(self.g, t0))
 *         else:
 *             t1GEN(b)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(idealhnf0(self.g, t0, t1))
 */
      __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "example.pyx":6796
 *         else:
 *             t1GEN(b)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(idealhnf0(self.g, t0, t1))
 * 
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6797
 *             t1GEN(b)
 *             sig_on()
 *             return self.new_gen(idealhnf0(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealintersection(self, x, y):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealhnf0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_493idealintersection(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_493idealintersection(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealintersection (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealintersection", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealintersection") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealintersection", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6799; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealintersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_492idealintersection(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6799
 *             return self.new_gen(idealhnf0(self.g, t0, t1))
 * 
 *     def idealintersection(self, x, y):             # <<<<<<<<<<<<<<
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_492idealintersection(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealintersection", 0);

    /* "example.pyx":6800
 * 
 *     def idealintersection(self, x, y):
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealintersect(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6801
 *     def idealintersection(self, x, y):
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealintersect(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6802
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         return self.new_gen(idealintersect(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def ideallist(self, long bound, long flag = 4):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealintersect(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealintersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_495ideallist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_494ideallist[] = "\n        Vector of vectors `L` of all idealstar of all ideals of `norm <= bound`.\n\n        The binary digits of flag mean:\n\n         - 1: give generators;\n         - 2: add units;\n         - 4: (default) give only the ideals and not the bid.\n\n        EXAMPLES::\n\n            sage: R.<x> = PolynomialRing(QQ)\n            sage: K.<a> = NumberField(x^2 + 1)\n            sage: L = K.pari_nf().ideallist(100)\n\n        Now we have our list `L`. Entry `L[n-1]` contains all ideals of\n        norm `n`::\n\n            sage: L[0]   # One ideal of norm 1.\n            [[1, 0; 0, 1]]\n            sage: L[64]  # 4 ideals of norm 65.\n            [[65, 8; 0, 1], [65, 47; 0, 1], [65, 18; 0, 1], [65, 57; 0, 1]]\n        ";
  static PyObject *__pyx_pw_7example_3gen_495ideallist(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_bound;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ideallist (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__bound,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__bound)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ideallist") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_bound = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_bound == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)4);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ideallist", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6804; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ideallist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_494ideallist(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_bound, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6804
 *         return self.new_gen(idealintersect(self.g, t0, t1))
 * 
 *     def ideallist(self, long bound, long flag = 4):             # <<<<<<<<<<<<<<
 *         """
 *         Vector of vectors `L` of all idealstar of all ideals of `norm <= bound`.
 */

  static PyObject *__pyx_pf_7example_3gen_494ideallist(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_bound, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ideallist", 0);

    /* "example.pyx":6828
 *             [[65, 8; 0, 1], [65, 47; 0, 1], [65, 18; 0, 1], [65, 57; 0, 1]]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ideallist0(self.g, bound, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6829
 *         """
 *         sig_on()
 *         return self.new_gen(ideallist0(self.g, bound, flag))             # <<<<<<<<<<<<<<
 * 
 *     def ideallog(self, x, bid):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ideallist0(__pyx_v_self->g, __pyx_v_bound, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.ideallist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_497ideallog(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_496ideallog[] = "\n        Return the discrete logarithm of the unit x in (ring of integers)/bid.\n\n        INPUT:\n\n        - ``self`` - a pari number field\n\n        - ``bid``  - a big ideal structure (corresponding to an ideal I\n          of self) output by idealstar\n\n        - ``x``  - an element of self with valuation zero at all\n          primes dividing I\n\n        OUTPUT:\n\n        - the discrete logarithm of x on the generators given in bid[2]\n\n        EXAMPLE::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: I = pari('[1, -1, 2]~')\n            sage: bid = nf.idealstar(I)\n            sage: x = pari('5')\n            sage: nf.ideallog(x, bid)\n            [25]~\n        ";
  static PyObject *__pyx_pw_7example_3gen_497ideallog(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_bid = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ideallog (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__bid,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__bid)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("ideallog", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6831; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ideallog") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6831; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_bid = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ideallog", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6831; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ideallog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_496ideallog(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_bid);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6831
 *         return self.new_gen(ideallist0(self.g, bound, flag))
 * 
 *     def ideallog(self, x, bid):             # <<<<<<<<<<<<<<
 *         """
 *         Return the discrete logarithm of the unit x in (ring of integers)/bid.
 */

  static PyObject *__pyx_pf_7example_3gen_496ideallog(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_bid) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ideallog", 0);

    /* "example.pyx":6859
 *             [25]~
 *         """
 *         t0GEN(x); t1GEN(bid)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(ideallog(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_bid); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6860
 *         """
 *         t0GEN(x); t1GEN(bid)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ideallog(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6861
 *         t0GEN(x); t1GEN(bid)
 *         sig_on()
 *         return self.new_gen(ideallog(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealmul(self, x, y, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ideallog(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ideallog", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_499idealmul(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_499idealmul(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_y = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealmul (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__y,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealmul", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6863; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealmul") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6863; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_y = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6863; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealmul", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6863; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_498idealmul(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_y, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6863
 *         return self.new_gen(ideallog(self.g, t0, t1))
 * 
 *     def idealmul(self, x, y, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_498idealmul(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealmul", 0);

    /* "example.pyx":6864
 * 
 *     def idealmul(self, x, y, long flag=0):
 *         t0GEN(x); t1GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         if flag == 0:
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6865
 *     def idealmul(self, x, y, long flag=0):
 *         t0GEN(x); t1GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if flag == 0:
 *             return self.new_gen(idealmul(self.g, t0, t1))
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6866
 *         t0GEN(x); t1GEN(y)
 *         sig_on()
 *         if flag == 0:             # <<<<<<<<<<<<<<
 *             return self.new_gen(idealmul(self.g, t0, t1))
 *         else:
 */
    __pyx_t_3 = (__pyx_v_flag == 0);
    if (__pyx_t_3) {

      /* "example.pyx":6867
 *         sig_on()
 *         if flag == 0:
 *             return self.new_gen(idealmul(self.g, t0, t1))             # <<<<<<<<<<<<<<
 *         else:
 *             return self.new_gen(idealmulred(self.g, t0, t1))
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealmul(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6867; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":6869
 *             return self.new_gen(idealmul(self.g, t0, t1))
 *         else:
 *             return self.new_gen(idealmulred(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealnorm(self, x):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealmulred(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6869; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealmul", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_501idealnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_501idealnorm(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealnorm (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_500idealnorm(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6871
 *             return self.new_gen(idealmulred(self.g, t0, t1))
 * 
 *     def idealnorm(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_500idealnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealnorm", 0);

    /* "example.pyx":6872
 * 
 *     def idealnorm(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealnorm(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6872; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6873
 *     def idealnorm(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealnorm(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6874
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(idealnorm(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def idealprimedec(nf, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealnorm(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_503idealprimedec(PyObject *__pyx_v_nf, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_502idealprimedec[] = "\n        Prime ideal decomposition of the prime number `p` in the number\n        field `nf` as a vector of 5 component vectors `[p,a,e,f,b]`\n        representing the prime ideals `p O_K + a O_K`, `e` ,`f` as usual,\n        `a` as vector of components on the integral basis, `b` Lenstra's\n        constant.\n\n        EXAMPLES::\n\n            sage: K.<i> = QuadraticField(-1)\n            sage: F = pari(K).idealprimedec(5); F\n            [[5, [-2, 1]~, 1, 1, [2, 1]~], [5, [2, 1]~, 1, 1, [-2, 1]~]]\n            sage: F[0].pr_get_p()\n            5\n        ";
  static PyObject *__pyx_pw_7example_3gen_503idealprimedec(PyObject *__pyx_v_nf, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealprimedec (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_502idealprimedec(((struct __pyx_obj_7example_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6876
 *         return self.new_gen(idealnorm(self.g, t0))
 * 
 *     def idealprimedec(nf, p):             # <<<<<<<<<<<<<<
 *         """
 *         Prime ideal decomposition of the prime number `p` in the number
 */

  static PyObject *__pyx_pf_7example_3gen_502idealprimedec(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealprimedec", 0);

    /* "example.pyx":6892
 *             5
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return nf.new_gen(idealprimedec(nf.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6892; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6893
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return nf.new_gen(idealprimedec(nf.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6894
 *         t0GEN(p)
 *         sig_on()
 *         return nf.new_gen(idealprimedec(nf.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def idealstar(self, I, long flag=1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_nf->__pyx_vtab)->new_gen(__pyx_v_nf, idealprimedec(__pyx_v_nf->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealprimedec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_505idealstar(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_504idealstar[] = "\n        Return the big ideal (bid) structure of modulus I.\n\n        INPUT:\n\n        - ``self`` - a pari number field\n\n        - ``I`` -- an ideal of self, or a row vector whose first\n          component is an ideal and whose second component\n          is a row vector of r_1 0 or 1.\n\n        - ``flag`` - determines the amount of computation and the shape\n          of the output:\n\n          - ``1`` (default): return a bid structure without\n            generators\n\n          - ``2``: return a bid structure with generators (slower)\n\n          - ``0`` (deprecated): only outputs units of (ring of integers/I)\n            as an abelian group, i.e as a 3-component\n            vector [h,d,g]: h is the order, d is the vector\n            of SNF cyclic components and g the corresponding\n            generators. This flag is deprecated: it is in\n            fact slightly faster to compute a true bid\n            structure, which contains much more information.\n\n        EXAMPLE::\n\n            sage: F = NumberField(x^3-2, 'alpha')\n            sage: nf = F._pari_()\n            sage: I = pari('[1, -1, 2]~')\n            sage: nf.idealstar(I)\n            [[[43, 9, 5; 0, 1, 0; 0, 0, 1], [0]], [42, [42]], Mat([[43, [9, 1, 0]~, 1, 1, [-5, -9, 1]~], 1]), [[[[42], [[3, 0, 0]~], [[3, 0, 0]~], [Vecsmall([])], 1]], [[], [], []]], Mat(1)]\n        ";
  static PyObject *__pyx_pw_7example_3gen_505idealstar(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_I = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealstar (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__I,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__I)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealstar") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6896; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_I = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6896; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealstar", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6896; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_504idealstar(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_I, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6896
 *         return nf.new_gen(idealprimedec(nf.g, t0))
 * 
 *     def idealstar(self, I, long flag=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the big ideal (bid) structure of modulus I.
 */

  static PyObject *__pyx_pf_7example_3gen_504idealstar(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_I, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealstar", 0);

    /* "example.pyx":6932
 *             [[[43, 9, 5; 0, 1, 0; 0, 0, 1], [0]], [42, [42]], Mat([[43, [9, 1, 0]~, 1, 1, [-5, -9, 1]~], 1]), [[[[42], [[3, 0, 0]~], [[3, 0, 0]~], [Vecsmall([])], 1]], [[], [], []]], Mat(1)]
 *         """
 *         t0GEN(I)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(idealstar0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_I); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6933
 *         """
 *         t0GEN(I)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(idealstar0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6933; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6934
 *         t0GEN(I)
 *         sig_on()
 *         return self.new_gen(idealstar0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def idealtwoelt(self, x, a=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealstar0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_507idealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_507idealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealtwoelt (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__a,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":6936
 *         return self.new_gen(idealstar0(self.g, t0, flag))
 * 
 *     def idealtwoelt(self, x, a=None):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         if a is None:
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealtwoelt") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6936; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_x = values[0];
      __pyx_v_a = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealtwoelt", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6936; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_506idealtwoelt(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_a);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_506idealtwoelt(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealtwoelt", 0);

    /* "example.pyx":6937
 * 
 *     def idealtwoelt(self, x, a=None):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         if a is None:
 *             sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6938
 *     def idealtwoelt(self, x, a=None):
 *         t0GEN(x)
 *         if a is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(idealtwoelt0(self.g, t0, NULL))
 */
    __pyx_t_2 = (__pyx_v_a == Py_None);
    if (__pyx_t_2) {

      /* "example.pyx":6939
 *         t0GEN(x)
 *         if a is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(idealtwoelt0(self.g, t0, NULL))
 *         else:
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6940
 *         if a is None:
 *             sig_on()
 *             return self.new_gen(idealtwoelt0(self.g, t0, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t1GEN(a)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealtwoelt0(__pyx_v_self->g, __pyx_v_7example_t0, NULL))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":6942
 *             return self.new_gen(idealtwoelt0(self.g, t0, NULL))
 *         else:
 *             t1GEN(a)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(idealtwoelt0(self.g, t0, t1))
 */
      __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6942; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "example.pyx":6943
 *         else:
 *             t1GEN(a)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(idealtwoelt0(self.g, t0, t1))
 * 
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6943; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":6944
 *             t1GEN(a)
 *             sig_on()
 *             return self.new_gen(idealtwoelt0(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def idealval(self, x, p):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, idealtwoelt0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6944; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_509idealval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_509idealval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("idealval (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("idealval", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6946; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "idealval") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6946; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("idealval", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6946; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.idealval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_508idealval(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6946
 *             return self.new_gen(idealtwoelt0(self.g, t0, t1))
 * 
 *     def idealval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef long v
 *         t0GEN(x); t1GEN(p)
 */

  static PyObject *__pyx_pf_7example_3gen_508idealval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("idealval", 0);

    /* "example.pyx":6948
 *     def idealval(self, x, p):
 *         cdef long v
 *         t0GEN(x); t1GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         v = idealval(self.g, t0, t1)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6948; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6949
 *         cdef long v
 *         t0GEN(x); t1GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         v = idealval(self.g, t0, t1)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6950
 *         t0GEN(x); t1GEN(p)
 *         sig_on()
 *         v = idealval(self.g, t0, t1)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return v
 */
    __pyx_v_v = idealval(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1);

    /* "example.pyx":6951
 *         sig_on()
 *         v = idealval(self.g, t0, t1)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    _pari_sig_off();

    /* "example.pyx":6952
 *         v = idealval(self.g, t0, t1)
 *         sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def elementval(self, x, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.idealval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_511elementval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_511elementval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elementval (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("elementval", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6954; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elementval") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6954; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elementval", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6954; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.elementval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_510elementval(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6954
 *         return v
 * 
 *     def elementval(self, x, p):             # <<<<<<<<<<<<<<
 *         cdef long v
 *         t0GEN(x); t1GEN(p)
 */

  static PyObject *__pyx_pf_7example_3gen_510elementval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_p) {
    long __pyx_v_v;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elementval", 0);

    /* "example.pyx":6956
 *     def elementval(self, x, p):
 *         cdef long v
 *         t0GEN(x); t1GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         v = nfval(self.g, t0, t1)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":6957
 *         cdef long v
 *         t0GEN(x); t1GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         v = nfval(self.g, t0, t1)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6958
 *         t0GEN(x); t1GEN(p)
 *         sig_on()
 *         v = nfval(self.g, t0, t1)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return v
 */
    __pyx_v_v = nfval(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1);

    /* "example.pyx":6959
 *         sig_on()
 *         v = nfval(self.g, t0, t1)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    _pari_sig_off();

    /* "example.pyx":6960
 *         v = nfval(self.g, t0, t1)
 *         sig_off()
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def modreverse(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.elementval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_513modreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_512modreverse[] = "\n        modreverse(x): reverse polymod of the polymod x, if it exists.\n\n        EXAMPLES:\n        ";
  static PyObject *__pyx_pw_7example_3gen_513modreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("modreverse (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_512modreverse(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6962
 *         return v
 * 
 *     def modreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         modreverse(x): reverse polymod of the polymod x, if it exists.
 */

  static PyObject *__pyx_pf_7example_3gen_512modreverse(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("modreverse", 0);

    /* "example.pyx":6968
 *         EXAMPLES:
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(modreverse(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":6969
 *         """
 *         sig_on()
 *         return self.new_gen(modreverse(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasis(self, long flag=0, fa=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, modreverse(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.modreverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_515nfbasis(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_514nfbasis[] = "\n        nfbasis(x, flag, fa): integral basis of the field QQ[a], where ``a`` is\n        a root of the polynomial x.\n\n        Binary digits of ``flag`` mean:\n\n         - 1: assume that no square of a prime>primelimit divides the\n              discriminant of ``x``.\n         - 2: use round 2 algorithm instead of round 4.\n\n        If present, ``fa`` provides the matrix of a partial factorization of\n        the discriminant of ``x``, useful if one wants only an order maximal at\n        certain primes only.\n\n        EXAMPLES::\n\n            sage: pari('x^3 - 17').nfbasis()\n            [1, x, 1/3*x^2 - 1/3*x + 1/3]\n\n        We test ``flag`` = 1, noting it gives a wrong result when the\n        discriminant (-4 * `p`^2 * `q` in the example below) has a big square\n        factor::\n\n            sage: p = next_prime(10^10); q = next_prime(p)\n            sage: x = polygen(QQ); f = x^2 + p^2*q\n            sage: pari(f).nfbasis(1)   # Wrong result\n            [1, x]\n            sage: pari(f).nfbasis()    # Correct result\n            [1, 1/10000000019*x]\n            sage: pari(f).nfbasis(fa = \"[2,2; %s,2]\"%p)    # Correct result and faster\n            [1, 1/10000000019*x]\n\n        TESTS:\n\n        ``flag`` = 2 should give the same result::\n\n            sage: pari('x^3 - 17').nfbasis(flag = 2)\n            [1, x, 1/3*x^2 - 1/3*x + 1/3]\n        ";
  static PyObject *__pyx_pw_7example_3gen_515nfbasis(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_fa = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasis (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__fa,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfbasis") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6971; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6971; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfbasis", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6971; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfbasis", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_514nfbasis(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":6971
 *         return self.new_gen(modreverse(self.g))
 * 
 *     def nfbasis(self, long flag=0, fa=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis(x, flag, fa): integral basis of the field QQ[a], where ``a`` is
 */

  static PyObject *__pyx_pf_7example_3gen_514nfbasis(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasis", 0);

    /* "example.pyx":7012
 *         """
 *         global t0
 *         t0GEN(fa)             # <<<<<<<<<<<<<<
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_fa); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7012; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7013
 *         global t0
 *         t0GEN(fa)
 *         if typ(t0) != t_MAT:             # <<<<<<<<<<<<<<
 *             t0 = <GEN>0
 *         sig_on()
 */
    __pyx_t_2 = (typ(__pyx_v_7example_t0) != t_MAT);
    if (__pyx_t_2) {

      /* "example.pyx":7014
 *         t0GEN(fa)
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nfbasis0(self.g, flag, t0))
 */
      __pyx_v_7example_t0 = ((GEN)0);
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":7015
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfbasis0(self.g, flag, t0))
 * 
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7016
 *             t0 = <GEN>0
 *         sig_on()
 *         return self.new_gen(nfbasis0(self.g, flag, t0))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasis_d(self, long flag=0, fa=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfbasis0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfbasis", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_517nfbasis_d(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_516nfbasis_d[] = "\n        nfbasis_d(x): Return a basis of the number field defined over QQ\n        by x and its discriminant.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: F._pari_()[0].nfbasis_d()\n            ([1, y, y^2], -108)\n\n        ::\n\n            sage: G = NumberField(x^5-11,'beta')\n            sage: G._pari_()[0].nfbasis_d()\n            ([1, y, y^2, y^3, y^4], 45753125)\n\n        ::\n\n            sage: pari([-2,0,0,1]).Polrev().nfbasis_d()\n            ([1, x, x^2], -108)\n        ";
  static PyObject *__pyx_pw_7example_3gen_517nfbasis_d(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_fa = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasis_d (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__fa,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfbasis_d") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfbasis_d", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7018; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfbasis_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_516nfbasis_d(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7018
 *         return self.new_gen(nfbasis0(self.g, flag, t0))
 * 
 *     def nfbasis_d(self, long flag=0, fa=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfbasis_d(x): Return a basis of the number field defined over QQ
 */

  static PyObject *__pyx_pf_7example_3gen_516nfbasis_d(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_fa) {
    GEN __pyx_v_disc;
    struct __pyx_obj_7example_gen *__pyx_v_B = NULL;
    struct __pyx_obj_7example_gen *__pyx_v_D = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasis_d", 0);

    /* "example.pyx":7042
 *         global t0
 *         cdef GEN disc
 *         t0GEN(fa)             # <<<<<<<<<<<<<<
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_fa); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7043
 *         cdef GEN disc
 *         t0GEN(fa)
 *         if typ(t0) != t_MAT:             # <<<<<<<<<<<<<<
 *             t0 = <GEN>0
 *         sig_on()
 */
    __pyx_t_2 = (typ(__pyx_v_7example_t0) != t_MAT);
    if (__pyx_t_2) {

      /* "example.pyx":7044
 *         t0GEN(fa)
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0             # <<<<<<<<<<<<<<
 *         sig_on()
 *         B = self.new_gen_noclear(nfbasis(self.g, &disc, flag, t0))
 */
      __pyx_v_7example_t0 = ((GEN)0);
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":7045
 *         if typ(t0) != t_MAT:
 *             t0 = <GEN>0
 *         sig_on()             # <<<<<<<<<<<<<<
 *         B = self.new_gen_noclear(nfbasis(self.g, &disc, flag, t0))
 *         D = self.new_gen(disc);
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7045; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7046
 *             t0 = <GEN>0
 *         sig_on()
 *         B = self.new_gen_noclear(nfbasis(self.g, &disc, flag, t0))             # <<<<<<<<<<<<<<
 *         D = self.new_gen(disc);
 *         return B,D
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen_noclear(__pyx_v_self, nfbasis(__pyx_v_self->g, (&__pyx_v_disc), __pyx_v_flag, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_B = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":7047
 *         sig_on()
 *         B = self.new_gen_noclear(nfbasis(self.g, &disc, flag, t0))
 *         D = self.new_gen(disc);             # <<<<<<<<<<<<<<
 *         return B,D
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_disc)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_D = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":7048
 *         B = self.new_gen_noclear(nfbasis(self.g, &disc, flag, t0))
 *         D = self.new_gen(disc);
 *         return B,D             # <<<<<<<<<<<<<<
 * 
 *     def nfbasistoalg(nf, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7048; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_v_B));
    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_B));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_B));
    __Pyx_INCREF(((PyObject *)__pyx_v_D));
    PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_D));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_D));
    __pyx_r = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfbasis_d", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_B);
    __Pyx_XDECREF((PyObject *)__pyx_v_D);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_519nfbasistoalg(PyObject *__pyx_v_nf, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_518nfbasistoalg[] = "\n        Transforms the column vector ``x`` on the integral basis into an\n        algebraic number.\n\n        INPUT:\n\n         - ``nf`` -- a number field\n         - ``x`` -- a column of rational numbers of length equal to the\n           degree of ``nf`` or a single rational number\n\n        OUTPUT:\n\n         - A POLMOD representing the element of ``nf`` whose coordinates\n           are ``x`` in the Z-basis of ``nf``.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^3 - 17)\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.getattr('zk')\n            [1, 1/3*y^2 - 1/3*y + 1/3, y]\n            sage: Kpari.nfbasistoalg(42)\n            Mod(42, y^3 - 17)\n            sage: Kpari.nfbasistoalg(\"[3/2, -5, 0]~\")\n            Mod(-5/3*y^2 + 5/3*y - 1/6, y^3 - 17)\n            sage: Kpari.getattr('zk') * pari(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n        ";
  static PyObject *__pyx_pw_7example_3gen_519nfbasistoalg(PyObject *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasistoalg (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_518nfbasistoalg(((struct __pyx_obj_7example_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7050
 *         return B,D
 * 
 *     def nfbasistoalg(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into an
 */

  static PyObject *__pyx_pf_7example_3gen_518nfbasistoalg(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasistoalg", 0);

    /* "example.pyx":7080
 *             -5/3*y^2 + 5/3*y - 1/6
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return nf.new_gen(basistoalg(nf.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7081
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return nf.new_gen(basistoalg(nf.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7082
 *         t0GEN(x)
 *         sig_on()
 *         return nf.new_gen(basistoalg(nf.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def nfbasistoalg_lift(nf, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_nf->__pyx_vtab)->new_gen(__pyx_v_nf, basistoalg(__pyx_v_nf->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfbasistoalg", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_521nfbasistoalg_lift(PyObject *__pyx_v_nf, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_520nfbasistoalg_lift[] = "\n        Transforms the column vector ``x`` on the integral basis into a\n        polynomial representing the algebraic number.\n\n        INPUT:\n\n         - ``nf`` -- a number field\n         - ``x`` -- a column of rational numbers of length equal to the\n           degree of ``nf`` or a single rational number\n\n        OUTPUT:\n\n         - ``nf.nfbasistoalg(x).lift()``\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^3 - 17)\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.getattr('zk')\n            [1, 1/3*y^2 - 1/3*y + 1/3, y]\n            sage: Kpari.nfbasistoalg_lift(42)\n            42\n            sage: Kpari.nfbasistoalg_lift(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n            sage: Kpari.getattr('zk') * pari(\"[3/2, -5, 0]~\")\n            -5/3*y^2 + 5/3*y - 1/6\n        ";
  static PyObject *__pyx_pw_7example_3gen_521nfbasistoalg_lift(PyObject *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfbasistoalg_lift (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_520nfbasistoalg_lift(((struct __pyx_obj_7example_gen *)__pyx_v_nf), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7084
 *         return nf.new_gen(basistoalg(nf.g, t0))
 * 
 *     def nfbasistoalg_lift(nf, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         Transforms the column vector ``x`` on the integral basis into a
 */

  static PyObject *__pyx_pf_7example_3gen_520nfbasistoalg_lift(struct __pyx_obj_7example_gen *__pyx_v_nf, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfbasistoalg_lift", 0);

    /* "example.pyx":7113
 *             -5/3*y^2 + 5/3*y - 1/6
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return nf.new_gen(gel(basistoalg(nf.g, t0), 2))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7114
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return nf.new_gen(gel(basistoalg(nf.g, t0), 2))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7115
 *         t0GEN(x)
 *         sig_on()
 *         return nf.new_gen(gel(basistoalg(nf.g, t0), 2))             # <<<<<<<<<<<<<<
 * 
 *     def nfdisc(self, long flag=0, p=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_nf->__pyx_vtab)->new_gen(__pyx_v_nf, gel(basistoalg(__pyx_v_nf->g, __pyx_v_7example_t0), 2))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfbasistoalg_lift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_523nfdisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_522nfdisc[] = "\n        nfdisc(x): Return the discriminant of the number field defined over\n        QQ by x.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: F._pari_()[0].nfdisc()\n            -108\n\n        ::\n\n            sage: G = NumberField(x^5-11,'beta')\n            sage: G._pari_()[0].nfdisc()\n            45753125\n\n        ::\n\n            sage: f = x^3-2\n            sage: f._pari_()\n            x^3 - 2\n            sage: f._pari_().nfdisc()\n            -108\n        ";
  static PyObject *__pyx_pw_7example_3gen_523nfdisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfdisc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__p,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfdisc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfdisc", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7117; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_522nfdisc(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7117
 *         return nf.new_gen(gel(basistoalg(nf.g, t0), 2))
 * 
 *     def nfdisc(self, long flag=0, p=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfdisc(x): Return the discriminant of the number field defined over
 */

  static PyObject *__pyx_pf_7example_3gen_522nfdisc(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_p) {
    struct __pyx_obj_7example_gen *__pyx_v__p = 0;
    GEN __pyx_v_g;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    GEN __pyx_t_3;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfdisc", 0);

    /* "example.pyx":7144
 *         cdef gen _p
 *         cdef GEN g
 *         if p != 0:             # <<<<<<<<<<<<<<
 *             _p = self.pari(p)
 *             g = _p.g
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_p, __pyx_int_0, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_2) {

      /* "example.pyx":7145
 *         cdef GEN g
 *         if p != 0:
 *             _p = self.pari(p)             # <<<<<<<<<<<<<<
 *             g = _p.g
 *         else:
 */
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->pari(__pyx_v_self, __pyx_v_p)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_v__p = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
      __pyx_t_1 = 0;

      /* "example.pyx":7146
 *         if p != 0:
 *             _p = self.pari(p)
 *             g = _p.g             # <<<<<<<<<<<<<<
 *         else:
 *             g = <GEN>NULL
 */
      __pyx_t_3 = __pyx_v__p->g;
      __pyx_v_g = __pyx_t_3;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":7148
 *             g = _p.g
 *         else:
 *             g = <GEN>NULL             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nfdisc0(self.g, flag, g))
 */
      __pyx_v_g = ((GEN)NULL);
    }
    __pyx_L3:;

    /* "example.pyx":7149
 *         else:
 *             g = <GEN>NULL
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfdisc0(self.g, flag, g))
 * 
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7150
 *             g = <GEN>NULL
 *         sig_on()
 *         return self.new_gen(nfdisc0(self.g, flag, g))             # <<<<<<<<<<<<<<
 * 
 *     def nfeltreduce(self, x, I):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfdisc0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_g))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v__p);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_525nfeltreduce(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_524nfeltreduce[] = "\n        Given an ideal I in Hermite normal form and an element x of the pari\n        number field self, finds an element r in self such that x-r belongs\n        to the ideal and r is small.\n\n        EXAMPLES::\n\n            sage: k.<a> = NumberField(x^2 + 5)\n            sage: I = k.ideal(a)\n            sage: kp = pari(k)\n            sage: kp.nfeltreduce(12, I.pari_hnf())\n            [2, 0]~\n            sage: 12 - k(kp.nfeltreduce(12, I.pari_hnf())) in I\n            True\n        ";
  static PyObject *__pyx_pw_7example_3gen_525nfeltreduce(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_v_I = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfeltreduce (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,&__pyx_n_s__I,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__I)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("nfeltreduce", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7152; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfeltreduce") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7152; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_x = values[0];
      __pyx_v_I = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfeltreduce", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7152; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfeltreduce", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_524nfeltreduce(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x, __pyx_v_I);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7152
 *         return self.new_gen(nfdisc0(self.g, flag, g))
 * 
 *     def nfeltreduce(self, x, I):             # <<<<<<<<<<<<<<
 *         """
 *         Given an ideal I in Hermite normal form and an element x of the pari
 */

  static PyObject *__pyx_pf_7example_3gen_524nfeltreduce(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x, PyObject *__pyx_v_I) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfeltreduce", 0);

    /* "example.pyx":7168
 *             True
 *         """
 *         t0GEN(x); t1GEN(I)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nfreduce(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_I); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7168; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7169
 *         """
 *         t0GEN(x); t1GEN(I)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfreduce(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7170
 *         t0GEN(x); t1GEN(I)
 *         sig_on()
 *         return self.new_gen(nfreduce(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def nffactor(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfreduce(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfeltreduce", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_527nffactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_527nffactor(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nffactor (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_526nffactor(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7172
 *         return self.new_gen(nfreduce(self.g, t0, t1))
 * 
 *     def nffactor(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_526nffactor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nffactor", 0);

    /* "example.pyx":7173
 * 
 *     def nffactor(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nffactor(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7174
 *     def nffactor(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nffactor(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7175
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(nffactor(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def nfgenerator(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nffactor(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nffactor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_529nfgenerator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_529nfgenerator(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfgenerator (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_528nfgenerator(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7177
 *         return self.new_gen(nffactor(self.g, t0))
 * 
 *     def nfgenerator(self):             # <<<<<<<<<<<<<<
 *         f = self[0]
 *         x = f.variable()
 */

  static PyObject *__pyx_pf_7example_3gen_528nfgenerator(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_v_f = NULL;
    PyObject *__pyx_v_x = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfgenerator", 0);

    /* "example.pyx":7178
 * 
 *     def nfgenerator(self):
 *         f = self[0]             # <<<<<<<<<<<<<<
 *         x = f.variable()
 *         return x.Mod(f)
 */
    __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_self), 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_f = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "example.pyx":7179
 *     def nfgenerator(self):
 *         f = self[0]
 *         x = f.variable()             # <<<<<<<<<<<<<<
 *         return x.Mod(f)
 * 
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_f, __pyx_n_s__variable); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_x = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "example.pyx":7180
 *         f = self[0]
 *         x = f.variable()
 *         return x.Mod(f)             # <<<<<<<<<<<<<<
 * 
 *     def nfhilbert(self, a, b, p = None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_x, __pyx_n_s__Mod); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_f);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_f);
    __Pyx_GIVEREF(__pyx_v_f);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.nfgenerator", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_f);
    __Pyx_XDECREF(__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_531nfhilbert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_530nfhilbert[] = "\n        nfhilbert(nf,a,b,{p}): if p is omitted, global Hilbert symbol (a,b)\n        in nf, that is 1 if X^2-aY^2-bZ^2 has a non-trivial solution (X,Y,Z)\n        in nf, -1 otherwise. Otherwise compute the local symbol modulo the\n        prime ideal p.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<t> = NumberField(x^3 - x + 1)\n            sage: pari(K).nfhilbert(t, t+2)  # not tested, known bug #11868\n            -1\n            sage: pari(K).nfhilbert(pari(t), pari(t+2))\n            -1\n            sage: P = K.ideal(t^2 + t - 2)   # Prime ideal above 5\n            sage: pari(K).nfhilbert(pari(t), pari(t+2), P.pari_prime())\n            -1\n            sage: P = K.ideal(t^2 + 3*t - 1) # Prime ideal above 23, ramified\n            sage: pari(K).nfhilbert(pari(t), pari(t+2), P.pari_prime())\n            1\n        ";
  static PyObject *__pyx_pw_7example_3gen_531nfhilbert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfhilbert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__a,&__pyx_n_s__b,&__pyx_n_s__p,0};
      PyObject* values[3] = {0,0,0};

      /* "example.pyx":7182
 *         return x.Mod(f)
 * 
 *     def nfhilbert(self, a, b, p = None):             # <<<<<<<<<<<<<<
 *         """
 *         nfhilbert(nf,a,b,{p}): if p is omitted, global Hilbert symbol (a,b)
 */
      values[2] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("nfhilbert", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfhilbert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
      __pyx_v_p = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfhilbert", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7182; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_530nfhilbert(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b, __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_530nfhilbert(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_p) {
    long __pyx_v_r;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfhilbert", 0);

    /* "example.pyx":7205
 *         """
 *         cdef long r
 *         t0GEN(a)             # <<<<<<<<<<<<<<
 *         t1GEN(b)
 *         if p:
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7206
 *         cdef long r
 *         t0GEN(a)
 *         t1GEN(b)             # <<<<<<<<<<<<<<
 *         if p:
 *             t2GEN(p)
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7207
 *         t0GEN(a)
 *         t1GEN(b)
 *         if p:             # <<<<<<<<<<<<<<
 *             t2GEN(p)
 *             sig_on()
 */
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_p); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (__pyx_t_2) {

      /* "example.pyx":7208
 *         t1GEN(b)
 *         if p:
 *             t2GEN(p)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             r = nfhilbert0(self.g, t0, t1, t2)
 */
      __pyx_t_1 = __pyx_f_7example_t2GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "example.pyx":7209
 *         if p:
 *             t2GEN(p)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             r = nfhilbert0(self.g, t0, t1, t2)
 *         else:
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7210
 *             t2GEN(p)
 *             sig_on()
 *             r = nfhilbert0(self.g, t0, t1, t2)             # <<<<<<<<<<<<<<
 *         else:
 *             sig_on()
 */
      __pyx_v_r = nfhilbert0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_v_7example_t2);
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":7212
 *             r = nfhilbert0(self.g, t0, t1, t2)
 *         else:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             r = nfhilbert(self.g, t0, t1)
 *         P.clear_stack()
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7213
 *         else:
 *             sig_on()
 *             r = nfhilbert(self.g, t0, t1)             # <<<<<<<<<<<<<<
 *         P.clear_stack()
 *         return r
 */
      __pyx_v_r = nfhilbert(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1);
    }
    __pyx_L3:;

    /* "example.pyx":7214
 *             sig_on()
 *             r = nfhilbert(self.g, t0, t1)
 *         P.clear_stack()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
    ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->clear_stack(__pyx_v_7example_P);

    /* "example.pyx":7215
 *             r = nfhilbert(self.g, t0, t1)
 *         P.clear_stack()
 *         return r             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_r); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_533nfhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_532nfhnf[] = "\n        nfhnf(nf,x) : given a pseudo-matrix (A, I) or an integral pseudo-matrix (A,I,J), finds a\n        pseudo-basis in Hermite normal form of the module it generates.\n\n        A pseudo-matrix is a 2-component row vector (A, I) where A is a relative m x n matrix and\n        I an ideal list of length n. An integral pseudo-matrix is a 3-component row vector (A, I, J).\n\n        .. NOTE::\n\n            The definition of a pseudo-basis ([Cohen]_):\n            Let M be a finitely generated, torsion-free R-module, and set V = KM.  If `\\mathfrak{a}_i` are\n            fractional ideals of R and `w_i` are elements of V, we say that\n            `(w_i, \\mathfrak{a}_k)_{1 \\leq i \\leq k}`\n            is a pseudo-basis of M if\n            `M = \\mathfrak{a}_1 w_1 \\oplus \\cdots \\oplus \\mathfrak{a}_k w_k.`\n\n        REFERENCES:\n\n        .. [Cohen] Cohen, \"Advanced Topics in Computational Number Theory\"\n\n        EXAMPLES::\n\n            sage: F.<a> = NumberField(x^2-x-1)\n            sage: Fp = pari(F)\n            sage: A = matrix(F,[[1,2,a,3],[3,0,a+2,0],[0,0,a,2],[3+a,a,0,1]])\n            sage: I = [F.ideal(-2*a+1),F.ideal(7), F.ideal(3),F.ideal(1)]\n            sage: Fp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [-969/5, -1/15]~, [15, -2]~, [-1938, -3]~; 0, 1, 0, 0; 0, 0, 1, 0;\n            0, 0, 0, 1], [[3997, 1911; 0, 7], [15, 6; 0, 3], [1, 0; 0, 1], [1, 0; 0,\n            1]]]\n            sage: K.<b> = NumberField(x^3-2)\n            sage: Kp = pari(K)\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b^2,b,57],[0,2,1,b^2-3],[2,0,0,b]])\n            sage: I = [K.ideal(2),K.ideal(3+b^2),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, -225, 72, -31; 0, 1, [0, -1, 0]~, [0, 0, -1/2]~; 0, 0, 1, [0, 0,\n            -1/2]~; 0, 0, 0, 1], [[1116, 756, 612; 0, 18, 0; 0, 0, 18], [2, 0, 0; 0,\n            2, 0; 0, 0, 2], [1, 0, 0; 0, 1, 0; 0, 0, 1], [2, 0, 0; 0, 1, 0; 0, 0,\n            1]]]""\n\n        An example where the ring of integers of the number field is not a PID::\n\n            sage: K.<b> = NumberField(x^2+5)\n            sage: Kp = pari(K)\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b^2,b,57],[0,2,1,b^2-3],[2,0,0,b]])\n            sage: I = [K.ideal(2),K.ideal(3+b^2),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [15, 6]~, [0, -54]~, [113, 72]~; 0, 1, [-4, -1]~, [0, -1]~; 0, 0,\n            1, 0; 0, 0, 0, 1], [[360, 180; 0, 180], [6, 4; 0, 2], [1, 0; 0, 1], [1,\n            0; 0, 1]]]\n            sage: A = matrix(K,[[1,0,0,5*b],[1,2*b,b,57],[0,2,1,b-3],[2,0,b,b]])\n            sage: I = [K.ideal(2).factor()[0][0],K.ideal(3+b),K.ideal(1),K.ideal(1)]\n            sage: Kp.nfhnf([pari(A),[pari(P) for P in I]])\n            [[1, [7605, 4]~, [5610, 5]~, [7913, -6]~; 0, 1, 0, -1; 0, 0, 1, 0; 0, 0,\n            0, 1], [[19320, 13720; 0, 56], [2, 1; 0, 1], [1, 0; 0, 1], [1, 0; 0,\n            1]]]\n\n        AUTHORS:\n\n        - Aly Deines (2012-09-19)\n        ";
  static PyObject *__pyx_pw_7example_3gen_533nfhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfhnf (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_532nfhnf(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7218
 * 
 * 
 *     def nfhnf(self,x):             # <<<<<<<<<<<<<<
 *         """
 *         nfhnf(nf,x) : given a pseudo-matrix (A, I) or an integral pseudo-matrix (A,I,J), finds a
 */

  static PyObject *__pyx_pf_7example_3gen_532nfhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfhnf", 0);

    /* "example.pyx":7280
 *         - Aly Deines (2012-09-19)
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nfhnf(self.g,t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7281
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfhnf(self.g,t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7282
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(nfhnf(self.g,t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfhnf(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_535nfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_534nfinit[] = "\n        nfinit(pol, {flag=0}): ``pol`` being a nonconstant irreducible\n        polynomial, gives a vector containing all the data necessary for PARI\n        to compute in this number field.\n\n        ``flag`` is optional and can be set to:\n         - 0: default\n         - 1: do not compute different\n         - 2: first use polred to find a simpler polynomial\n         - 3: outputs a two-element vector [nf,Mod(a,P)], where nf is as in 2\n              and Mod(a,P) is a polmod equal to Mod(x,pol) and P=nf.pol\n\n        EXAMPLES::\n\n            sage: pari('x^3 - 17').nfinit()\n            [x^3 - 17, [1, 1], -867, 3, [[1, 1.68006..., 2.57128...; 1, -0.340034... + 2.65083...*I, -1.28564... - 2.22679...*I], [1, 1.68006..., 2.57128...; 1, 2.31080..., -3.51243...; 1, -2.99087..., 0.941154...], [1, 2, 3; 1, 2, -4; 1, -3, 1], [3, 1, 0; 1, -11, 17; 0, 17, 0], [51, 0, 16; 0, 17, 3; 0, 0, 1], [17, 0, -1; 0, 0, 3; -1, 3, 2], [51, [-17, 6, -1; 0, -18, 3; 1, 0, -16]]], [2.57128..., -1.28564... - 2.22679...*I], [1, 1/3*x^2 - 1/3*x + 1/3, x], [1, 0, -1; 0, 0, 3; 0, 1, 1], [1, 0, 0, 0, -4, 6, 0, 6, -1; 0, 1, 0, 1, 1, -1, 0, -1, 3; 0, 0, 1, 0, 2, 0, 1, 0, 1]]\n\n        TESTS:\n\n        This example only works after increasing precision::\n\n            sage: pari('x^2 + 10^100 + 1').nfinit(precision=64)\n            Traceback (most recent call last):\n            ...\n            PariError: precision too low (10)\n            sage: pari('x^2 + 10^100 + 1').nfinit()\n            [...]\n\n        Throw a PARI error which is not precer::\n\n            sage: pari('1.0').nfinit()\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
  static PyObject *__pyx_pw_7example_3gen_535nfinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      if (values[1]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfinit", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7287; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_534nfinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7287
 * 
 * 
 *     def nfinit(self, long flag=0, long precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         nfinit(pol, {flag=0}): ``pol`` being a nonconstant irreducible
 */

  static PyObject *__pyx_pf_7example_3gen_534nfinit(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, long __pyx_v_precision) {
    PyObject *__pyx_v_err = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    int __pyx_t_8;
    PyObject *__pyx_t_9 = NULL;
    PyObject *__pyx_t_10 = NULL;
    int __pyx_t_11;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfinit", 0);

    /* "example.pyx":7325
 * 
 *         # If explicit precision is given, use only that
 *         if precision:             # <<<<<<<<<<<<<<
 *             return self._nfinit_with_prec(flag, precision)
 * 
 */
    if (__pyx_v_precision) {

      /* "example.pyx":7326
 *         # If explicit precision is given, use only that
 *         if precision:
 *             return self._nfinit_with_prec(flag, precision)             # <<<<<<<<<<<<<<
 * 
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s___nfinit_with_prec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_2 = PyInt_FromLong(__pyx_v_flag); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
      __Pyx_GIVEREF(__pyx_t_2);
      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":7329
 * 
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 *         precision = 64             # <<<<<<<<<<<<<<
 *         while True:
 *             try:
 */
    __pyx_v_precision = 64;

    /* "example.pyx":7330
 *         # Otherwise, start with 64 bits of precision and increase as needed:
 *         precision = 64
 *         while True:             # <<<<<<<<<<<<<<
 *             try:
 *                 return self._nfinit_with_prec(flag, precision)
 */
    while (1) {
      if (!1) break;

      /* "example.pyx":7331
 *         precision = 64
 *         while True:
 *             try:             # <<<<<<<<<<<<<<
 *                 return self._nfinit_with_prec(flag, precision)
 *             except PariError, err:
 */
      {
        __Pyx_ExceptionSave(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
        __Pyx_XGOTREF(__pyx_t_5);
        __Pyx_XGOTREF(__pyx_t_6);
        __Pyx_XGOTREF(__pyx_t_7);
        /*try:*/ {

          /* "example.pyx":7332
 *         while True:
 *             try:
 *                 return self._nfinit_with_prec(flag, precision)             # <<<<<<<<<<<<<<
 *             except PariError, err:
 *                 if err.errnum() == precer:
 */
          __Pyx_XDECREF(__pyx_r);
          __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s___nfinit_with_prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7332; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_3);
          __pyx_t_4 = PyInt_FromLong(__pyx_v_flag); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7332; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_1 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7332; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_1);
          __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7332; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_2);
          PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
          __Pyx_GIVEREF(__pyx_t_4);
          PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
          __Pyx_GIVEREF(__pyx_t_1);
          __pyx_t_4 = 0;
          __pyx_t_1 = 0;
          __pyx_t_1 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7332; __pyx_clineno = __LINE__; goto __pyx_L6_error;}
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
          __pyx_r = __pyx_t_1;
          __pyx_t_1 = 0;
          goto __pyx_L10_try_return;
        }
        __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
        goto __pyx_L13_try_end;
        __pyx_L10_try_return:;
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        goto __pyx_L0;
        __pyx_L6_error:;
        __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;

        /* "example.pyx":7333
 *             try:
 *                 return self._nfinit_with_prec(flag, precision)
 *             except PariError, err:             # <<<<<<<<<<<<<<
 *                 if err.errnum() == precer:
 *                     precision *= 2
 */
        __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__PariError); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7333; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_8 = PyErr_ExceptionMatches(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_8) {
          __Pyx_AddTraceback("example.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7333; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_1);
          __Pyx_GOTREF(__pyx_t_2);
          __Pyx_GOTREF(__pyx_t_3);
          __Pyx_INCREF(__pyx_t_2);
          __Pyx_XDECREF(__pyx_v_err);
          __pyx_v_err = __pyx_t_2;

          /* "example.pyx":7334
 *                 return self._nfinit_with_prec(flag, precision)
 *             except PariError, err:
 *                 if err.errnum() == precer:             # <<<<<<<<<<<<<<
 *                     precision *= 2
 *                 else:
 */
          __pyx_t_4 = PyObject_GetAttr(__pyx_v_err, __pyx_n_s__errnum); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7334; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_9 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7334; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_9);
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_4 = PyInt_FromLong(precer); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7334; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_GOTREF(__pyx_t_4);
          __pyx_t_10 = PyObject_RichCompare(__pyx_t_9, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7334; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
          __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_11 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7334; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
          if (__pyx_t_11) {

            /* "example.pyx":7335
 *             except PariError, err:
 *                 if err.errnum() == precer:
 *                     precision *= 2             # <<<<<<<<<<<<<<
 *                 else:
 *                     raise err
 */
            __pyx_v_precision = (__pyx_v_precision * 2);
            goto __pyx_L16;
          }
          /*else*/ {

            /* "example.pyx":7337
 *                     precision *= 2
 *                 else:
 *                     raise err             # <<<<<<<<<<<<<<
 * 
 *     # NOTE: because of the way sig_on() and Cython exceptions work, this
 */
            __Pyx_Raise(__pyx_v_err, 0, 0, 0);
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7337; __pyx_clineno = __LINE__; goto __pyx_L8_except_error;}
          }
          __pyx_L16:;
          __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
          __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
          __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
          goto __pyx_L7_exception_handled;
        }
        __pyx_L8_except_error:;
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        goto __pyx_L1_error;
        __pyx_L7_exception_handled:;
        __Pyx_XGIVEREF(__pyx_t_5);
        __Pyx_XGIVEREF(__pyx_t_6);
        __Pyx_XGIVEREF(__pyx_t_7);
        __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
        __pyx_L13_try_end:;
      }
    }

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_9);
    __Pyx_XDECREF(__pyx_t_10);
    __Pyx_AddTraceback("example.gen.nfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_err);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_537_nfinit_with_prec(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_536_nfinit_with_prec[] = "\n        See ``self.nfinit()``.\n        ";
  static PyObject *__pyx_pw_7example_3gen_537_nfinit_with_prec(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("_nfinit_with_prec (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("_nfinit_with_prec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_nfinit_with_prec") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_precision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("_nfinit_with_prec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7342; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen._nfinit_with_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_536_nfinit_with_prec(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7342
 *     # function MUST NOT be folded into nfinit() above. It has to be a
 *     # seperate function.
 *     def _nfinit_with_prec(self, long flag, long precision):             # <<<<<<<<<<<<<<
 *         """
 *         See ``self.nfinit()``.
 */

  static PyObject *__pyx_pf_7example_3gen_536_nfinit_with_prec(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_nfinit_with_prec", 0);

    /* "example.pyx":7346
 *         See ``self.nfinit()``.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfinit0(self.g, flag, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7347
 *         """
 *         sig_on()
 *         return P.new_gen(nfinit0(self.g, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def nfisisom(self, gen other):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, nfinit0(__pyx_v_self->g, __pyx_v_flag, __pyx_t_5))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen._nfinit_with_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_539nfisisom(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
  static char __pyx_doc_7example_3gen_538nfisisom[] = "\n        nfisisom(x, y): Determine if the number fields defined by x and y\n        are isomorphic. According to the PARI documentation, this is much\n        faster if at least one of x or y is a number field. If they are\n        isomorphic, it returns an embedding for the generators. If not,\n        returns 0.\n\n        EXAMPLES::\n\n            sage: F = NumberField(x^3-2,'alpha')\n            sage: G = NumberField(x^3-2,'beta')\n            sage: F._pari_().nfisisom(G._pari_())\n            [y]\n\n        ::\n\n            sage: GG = NumberField(x^3-4,'gamma')\n            sage: F._pari_().nfisisom(GG._pari_())\n            [1/2*y^2]\n\n        ::\n\n            sage: F._pari_().nfisisom(GG.pari_nf())\n            [1/2*y^2]\n\n        ::\n\n            sage: F.pari_nf().nfisisom(GG._pari_()[0])\n            [y^2]\n\n        ::\n\n            sage: H = NumberField(x^2-2,'alpha')\n            sage: F._pari_().nfisisom(H._pari_())\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_539nfisisom(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfisisom (wrapper)", 0);
    if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_7example_gen, 1, "other", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_r = __pyx_pf_7example_3gen_538nfisisom(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((struct __pyx_obj_7example_gen *)__pyx_v_other));
    goto __pyx_L0;
    __pyx_L1_error:;
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7349
 *         return P.new_gen(nfinit0(self.g, flag, pbw(precision)))
 * 
 *     def nfisisom(self, gen other):             # <<<<<<<<<<<<<<
 *         """
 *         nfisisom(x, y): Determine if the number fields defined by x and y
 */

  static PyObject *__pyx_pf_7example_3gen_538nfisisom(struct __pyx_obj_7example_gen *__pyx_v_self, struct __pyx_obj_7example_gen *__pyx_v_other) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfisisom", 0);

    /* "example.pyx":7386
 *             0
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(nfisisom(self.g, other.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7387
 *         """
 *         sig_on()
 *         return P.new_gen(nfisisom(self.g, other.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfrootsof1(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, nfisisom(__pyx_v_self->g, __pyx_v_other->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.nfisisom", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_541nfrootsof1(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_540nfrootsof1[] = "\n        nf.nfrootsof1()\n\n        number of roots of unity and primitive root of unity in the number\n        field nf.\n\n        EXAMPLES::\n\n            sage: nf = pari('x^2 + 1').nfinit()\n            sage: nf.nfrootsof1()\n            [4, -x]\n        ";
  static PyObject *__pyx_pw_7example_3gen_541nfrootsof1(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfrootsof1 (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_540nfrootsof1(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7389
 *         return P.new_gen(nfisisom(self.g, other.g))
 * 
 *     def nfrootsof1(self):             # <<<<<<<<<<<<<<
 *         """
 *         nf.nfrootsof1()
 */

  static PyObject *__pyx_pf_7example_3gen_540nfrootsof1(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfrootsof1", 0);

    /* "example.pyx":7402
 *             [4, -x]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rootsof1(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7403
 *         """
 *         sig_on()
 *         return P.new_gen(rootsof1(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nfsubfields(self, long d=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, rootsof1(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.nfrootsof1", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_543nfsubfields(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_542nfsubfields[] = "\n        Find all subfields of degree d of number field nf (all subfields if\n        d is null or omitted). Result is a vector of subfields, each being\n        given by [g,h], where g is an absolute equation and h expresses one\n        of the roots of g in terms of the root x of the polynomial defining\n        nf.\n\n        INPUT:\n\n\n        -  ``self`` - nf number field\n\n        -  ``d`` - C long integer\n        ";
  static PyObject *__pyx_pw_7example_3gen_543nfsubfields(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_d;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfsubfields (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__d,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__d);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfsubfields") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_d = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_d == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_d = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfsubfields", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7405; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfsubfields", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_542nfsubfields(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_d);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7405
 *         return P.new_gen(rootsof1(self.g))
 * 
 *     def nfsubfields(self, long d=0):             # <<<<<<<<<<<<<<
 *         """
 *         Find all subfields of degree d of number field nf (all subfields if
 */

  static PyObject *__pyx_pf_7example_3gen_542nfsubfields(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_d) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfsubfields", 0);

    /* "example.pyx":7420
 *         -  ``d`` - C long integer
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfsubfields(self.g, d))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7420; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7421
 *         """
 *         sig_on()
 *         return self.new_gen(nfsubfields(self.g, d))             # <<<<<<<<<<<<<<
 * 
 *     def rnfcharpoly(self, T, a, v='x'):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfsubfields(__pyx_v_self->g, __pyx_v_d))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.nfsubfields", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_545rnfcharpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_545rnfcharpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_T = 0;
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfcharpoly (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__T,&__pyx_n_s__a,&__pyx_n_s__v,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_n_s__x);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__T)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("rnfcharpoly", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7423; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfcharpoly") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7423; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_T = values[0];
      __pyx_v_a = values[1];
      __pyx_v_v = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfcharpoly", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7423; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.rnfcharpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_544rnfcharpoly(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_T, __pyx_v_a, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7423
 *         return self.new_gen(nfsubfields(self.g, d))
 * 
 *     def rnfcharpoly(self, T, a, v='x'):             # <<<<<<<<<<<<<<
 *         t0GEN(T); t1GEN(a); t2GEN(v)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_544rnfcharpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_T, PyObject *__pyx_v_a, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfcharpoly", 0);

    /* "example.pyx":7424
 * 
 *     def rnfcharpoly(self, T, a, v='x'):
 *         t0GEN(T); t1GEN(a); t2GEN(v)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfcharpoly(self.g, t0, t1, gvar(t2)))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_T); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_f_7example_t2GEN(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7425
 *     def rnfcharpoly(self, T, a, v='x'):
 *         t0GEN(T); t1GEN(a); t2GEN(v)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfcharpoly(self.g, t0, t1, gvar(t2)))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7426
 *         t0GEN(T); t1GEN(a); t2GEN(v)
 *         sig_on()
 *         return self.new_gen(rnfcharpoly(self.g, t0, t1, gvar(t2)))             # <<<<<<<<<<<<<<
 * 
 *     def rnfdisc(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfcharpoly(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, gvar(__pyx_v_7example_t2)))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfcharpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_547rnfdisc(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_547rnfdisc(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfdisc (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_546rnfdisc(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7428
 *         return self.new_gen(rnfcharpoly(self.g, t0, t1, gvar(t2)))
 * 
 *     def rnfdisc(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_546rnfdisc(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfdisc", 0);

    /* "example.pyx":7429
 * 
 *     def rnfdisc(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfdiscf(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7430
 *     def rnfdisc(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfdiscf(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7431
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfdiscf(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfeltabstorel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfdiscf(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfdisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_549rnfeltabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_549rnfeltabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfeltabstorel (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_548rnfeltabstorel(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7433
 *         return self.new_gen(rnfdiscf(self.g, t0))
 * 
 *     def rnfeltabstorel(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_548rnfeltabstorel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfeltabstorel", 0);

    /* "example.pyx":7434
 * 
 *     def rnfeltabstorel(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfelementabstorel(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7435
 *     def rnfeltabstorel(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfelementabstorel(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7436
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfelementabstorel(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfeltreltoabs(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfelementabstorel(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfeltabstorel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_551rnfeltreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_551rnfeltreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfeltreltoabs (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_550rnfeltreltoabs(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7438
 *         return self.new_gen(rnfelementabstorel(self.g, t0))
 * 
 *     def rnfeltreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_550rnfeltreltoabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfeltreltoabs", 0);

    /* "example.pyx":7439
 * 
 *     def rnfeltreltoabs(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfelementreltoabs(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7440
 *     def rnfeltreltoabs(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfelementreltoabs(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7441
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfelementreltoabs(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfequation(self, poly, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfelementreltoabs(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfeltreltoabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_553rnfequation(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_553rnfequation(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_poly = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfequation (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__poly,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__poly)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfequation") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7443; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_poly = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7443; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfequation", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7443; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.rnfequation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_552rnfequation(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_poly, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7443
 *         return self.new_gen(rnfelementreltoabs(self.g, t0))
 * 
 *     def rnfequation(self, poly, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(poly)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_552rnfequation(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfequation", 0);

    /* "example.pyx":7444
 * 
 *     def rnfequation(self, poly, long flag=0):
 *         t0GEN(poly)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfequation0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_poly); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7444; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7445
 *     def rnfequation(self, poly, long flag=0):
 *         t0GEN(poly)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfequation0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7446
 *         t0GEN(poly)
 *         sig_on()
 *         return self.new_gen(rnfequation0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealabstorel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfequation0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7446; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfequation", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_555rnfidealabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_555rnfidealabstorel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealabstorel (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_554rnfidealabstorel(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7448
 *         return self.new_gen(rnfequation0(self.g, t0, flag))
 * 
 *     def rnfidealabstorel(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_554rnfidealabstorel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealabstorel", 0);

    /* "example.pyx":7449
 * 
 *     def rnfidealabstorel(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealabstorel(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7450
 *     def rnfidealabstorel(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealabstorel(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7451
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealabstorel(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealdown(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealabstorel(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7451; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealabstorel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_557rnfidealdown(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static char __pyx_doc_7example_3gen_556rnfidealdown[] = "\n        rnfidealdown(rnf,x): finds the intersection of the ideal x with the base field.\n\n        EXAMPLES:\n            sage: x = ZZ['xx1'].0; pari(x)\n            xx1\n            sage: y = ZZ['yy1'].0; pari(y)\n            yy1\n            sage: nf = pari(y^2 - 6*y + 24).nfinit()\n            sage: rnf = nf.rnfinit(x^2 - pari(y))\n\n        This is the relative HNF of the inert ideal (2) in rnf:\n\n            sage: P = pari('[[[1, 0]~, [0, 0]~; [0, 0]~, [1, 0]~], [[2, 0; 0, 2], [2, 0; 0, 1/2]]]')\n\n        And this is the HNF of the inert ideal (2) in nf:\n\n            sage: rnf.rnfidealdown(P)\n            [2, 0; 0, 2]\n        ";
  static PyObject *__pyx_pw_7example_3gen_557rnfidealdown(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealdown (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_556rnfidealdown(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7453
 *         return self.new_gen(rnfidealabstorel(self.g, t0))
 * 
 *     def rnfidealdown(self, x):             # <<<<<<<<<<<<<<
 *         r"""
 *         rnfidealdown(rnf,x): finds the intersection of the ideal x with the base field.
 */

  static PyObject *__pyx_pf_7example_3gen_556rnfidealdown(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealdown", 0);

    /* "example.pyx":7474
 *             [2, 0; 0, 2]
 *         """
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealdown(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7475
 *         """
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealdown(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7476
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealdown(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealhnf(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealdown(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealdown", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_559rnfidealhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_559rnfidealhnf(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealhnf (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_558rnfidealhnf(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7478
 *         return self.new_gen(rnfidealdown(self.g, t0))
 * 
 *     def rnfidealhnf(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_558rnfidealhnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealhnf", 0);

    /* "example.pyx":7479
 * 
 *     def rnfidealhnf(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealhermite(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7480
 *     def rnfidealhnf(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealhermite(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7481
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealhermite(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealnormrel(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealhermite(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7481; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealhnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_561rnfidealnormrel(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_561rnfidealnormrel(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealnormrel (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_560rnfidealnormrel(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7483
 *         return self.new_gen(rnfidealhermite(self.g, t0))
 * 
 *     def rnfidealnormrel(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_560rnfidealnormrel(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealnormrel", 0);

    /* "example.pyx":7484
 * 
 *     def rnfidealnormrel(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealnormrel(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7484; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7485
 *     def rnfidealnormrel(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealnormrel(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7486
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealnormrel(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealreltoabs(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealnormrel(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealnormrel", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_563rnfidealreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_563rnfidealreltoabs(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealreltoabs (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_562rnfidealreltoabs(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7488
 *         return self.new_gen(rnfidealnormrel(self.g, t0))
 * 
 *     def rnfidealreltoabs(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_562rnfidealreltoabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealreltoabs", 0);

    /* "example.pyx":7489
 * 
 *     def rnfidealreltoabs(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealreltoabs(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7490
 *     def rnfidealreltoabs(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealreltoabs(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7491
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealreltoabs(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfidealtwoelt(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealreltoabs(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealreltoabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_565rnfidealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_565rnfidealtwoelt(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfidealtwoelt (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_564rnfidealtwoelt(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7493
 *         return self.new_gen(rnfidealreltoabs(self.g, t0))
 * 
 *     def rnfidealtwoelt(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_564rnfidealtwoelt(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfidealtwoelt", 0);

    /* "example.pyx":7494
 * 
 *     def rnfidealtwoelt(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfidealtwoelement(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7494; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7495
 *     def rnfidealtwoelt(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfidealtwoelement(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7496
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(rnfidealtwoelement(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfinit(self, poly):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfidealtwoelement(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7496; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfidealtwoelt", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_567rnfinit(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static char __pyx_doc_7example_3gen_566rnfinit[] = "\n        EXAMPLES: We construct a relative number field.\n\n        ::\n\n            sage: f = pari('y^3+y+1')\n            sage: K = f.nfinit()\n            sage: x = pari('x'); y = pari('y')\n            sage: g = x^5 - x^2 + y\n            sage: L = K.rnfinit(g)\n        ";
  static PyObject *__pyx_pw_7example_3gen_567rnfinit(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfinit (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_566rnfinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7498
 *         return self.new_gen(rnfidealtwoelement(self.g, t0))
 * 
 *     def rnfinit(self, poly):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES: We construct a relative number field.
 */

  static PyObject *__pyx_pf_7example_3gen_566rnfinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfinit", 0);

    /* "example.pyx":7510
 *             sage: L = K.rnfinit(g)
 *         """
 *         t0GEN(poly)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(rnfinit(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_poly); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7511
 *         """
 *         t0GEN(poly)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(rnfinit(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7512
 *         t0GEN(poly)
 *         sig_on()
 *         return P.new_gen(rnfinit(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def rnfisfree(self, poly):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, rnfinit(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_569rnfisfree(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_569rnfisfree(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisfree (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_568rnfisfree(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7514
 *         return P.new_gen(rnfinit(self.g, t0))
 * 
 *     def rnfisfree(self, poly):             # <<<<<<<<<<<<<<
 *         t0GEN(poly)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_568rnfisfree(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    long __pyx_v_r;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisfree", 0);

    /* "example.pyx":7515
 * 
 *     def rnfisfree(self, poly):
 *         t0GEN(poly)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         r = rnfisfree(self.g, t0)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_poly); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7516
 *     def rnfisfree(self, poly):
 *         t0GEN(poly)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         r = rnfisfree(self.g, t0)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7517
 *         t0GEN(poly)
 *         sig_on()
 *         r = rnfisfree(self.g, t0)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return r
 */
    __pyx_v_r = rnfisfree(__pyx_v_self->g, __pyx_v_7example_t0);

    /* "example.pyx":7518
 *         sig_on()
 *         r = rnfisfree(self.g, t0)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return r
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7519
 *         r = rnfisfree(self.g, t0)
 *         sig_off()
 *         return r             # <<<<<<<<<<<<<<
 * 
 *     def quadhilbert(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_r); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfisfree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_571quadhilbert(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_570quadhilbert[] = "\n        Returns a polynomial over `\\QQ` whose roots generate the\n        Hilbert class field of the quadratic field of discriminant\n        ``self`` (which must be fundamental).\n\n        EXAMPLES::\n\n            sage: pari(-23).quadhilbert()\n            x^3 - x^2 + 1\n            sage: pari(145).quadhilbert()\n            x^4 - x^3 - 3*x^2 + x + 1\n            sage: pari(-12).quadhilbert()   # Not fundamental\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n        ";
  static PyObject *__pyx_pw_7example_3gen_571quadhilbert(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("quadhilbert (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_570quadhilbert(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7521
 *         return r
 * 
 *     def quadhilbert(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Returns a polynomial over `\QQ` whose roots generate the
 */

  static PyObject *__pyx_pf_7example_3gen_570quadhilbert(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("quadhilbert", 0);

    /* "example.pyx":7538
 *             PariError:  (5)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # Precision argument is only used for real quadratic extensions
 *         # and will be automatically increased by PARI if needed.
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7541
 *         # Precision argument is only used for real quadratic extensions
 *         # and will be automatically increased by PARI if needed.
 *         return P.new_gen(quadhilbert(self.g, DEFAULTPREC))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, quadhilbert(__pyx_v_self->g, DEFAULTPREC))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7541; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.quadhilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_573reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_572reverse[] = "\n        Return the polynomial obtained by reversing the coefficients of\n        this polynomial.\n        ";
  static PyObject *__pyx_pw_7example_3gen_573reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("reverse (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_572reverse(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7547
 *     # 7: POLYNOMIALS and power series
 *     ##################################################
 *     def reverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the polynomial obtained by reversing the coefficients of
 */

  static PyObject *__pyx_pf_7example_3gen_572reverse(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("reverse", 0);

    /* "example.pyx":7552
 *         this polynomial.
 *         """
 *         return self.Vec().Polrev()             # <<<<<<<<<<<<<<
 * 
 *     def content(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__Vec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__Polrev); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.reverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_575content(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_574content[] = "\n        Greatest common divisor of all the components of ``self``.\n\n        EXAMPLES::\n\n            sage: R.<x> = PolynomialRing(ZZ)\n            sage: pari(2*x^2 + 2).content()\n            2\n            sage: pari(\"4*x^3 - 2*x/3 + 2/5\").content()\n            2/15\n        ";
  static PyObject *__pyx_pw_7example_3gen_575content(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("content (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_574content(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7554
 *         return self.Vec().Polrev()
 * 
 *     def content(self):             # <<<<<<<<<<<<<<
 *         """
 *         Greatest common divisor of all the components of ``self``.
 */

  static PyObject *__pyx_pf_7example_3gen_574content(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("content", 0);

    /* "example.pyx":7566
 *             2/15
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(content(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7567
 *         """
 *         sig_on()
 *         return self.new_gen(content(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def deriv(self, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, content(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7567; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.content", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_577deriv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_577deriv(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("deriv (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "deriv") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("deriv", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.deriv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_576deriv(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7569
 *         return self.new_gen(content(self.g))
 * 
 *     def deriv(self, v=-1):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(deriv(self.g, self.get_var(v)))
 */

  static PyObject *__pyx_pf_7example_3gen_576deriv(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("deriv", 0);

    /* "example.pyx":7570
 * 
 *     def deriv(self, v=-1):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(deriv(self.g, self.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7571
 *     def deriv(self, v=-1):
 *         sig_on()
 *         return self.new_gen(deriv(self.g, self.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def eval(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, deriv(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.deriv", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_579eval(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_579eval(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("eval (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_578eval(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7573
 *         return self.new_gen(deriv(self.g, self.get_var(v)))
 * 
 *     def eval(self, x):             # <<<<<<<<<<<<<<
 *         t0GEN(x)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_578eval(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("eval", 0);

    /* "example.pyx":7574
 * 
 *     def eval(self, x):
 *         t0GEN(x)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(poleval(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7575
 *     def eval(self, x):
 *         t0GEN(x)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(poleval(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7576
 *         t0GEN(x)
 *         sig_on()
 *         return self.new_gen(poleval(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def __call__(self, x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, poleval(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.eval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_581__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_581__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__call__ (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__x,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      }
      __pyx_v_x = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("__call__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_580__call__(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_x);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7578
 *         return self.new_gen(poleval(self.g, t0))
 * 
 *     def __call__(self, x):             # <<<<<<<<<<<<<<
 *         return self.eval(x)
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_580__call__(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__call__", 0);

    /* "example.pyx":7579
 * 
 *     def __call__(self, x):
 *         return self.eval(x)             # <<<<<<<<<<<<<<
 * 
 *     def factornf(self, t):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__eval); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_583factornf(PyObject *__pyx_v_self, PyObject *__pyx_v_t); /*proto*/
  static char __pyx_doc_7example_3gen_582factornf[] = "\n        Factorization of the polynomial ``self`` over the number field\n        defined by the polynomial ``t``.  This does not require that `t`\n        is integral, nor that the discriminant of the number field can be\n        factored.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K.<a> = NumberField(x^2 - 1/8)\n            sage: pari(x^2 - 2).factornf(K.pari_polynomial(\"a\"))\n            [x + Mod(-4*a, 8*a^2 - 1), 1; x + Mod(4*a, 8*a^2 - 1), 1]\n        ";
  static PyObject *__pyx_pw_7example_3gen_583factornf(PyObject *__pyx_v_self, PyObject *__pyx_v_t) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factornf (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_582factornf(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_t));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7581
 *         return self.eval(x)
 * 
 *     def factornf(self, t):             # <<<<<<<<<<<<<<
 *         """
 *         Factorization of the polynomial ``self`` over the number field
 */

  static PyObject *__pyx_pf_7example_3gen_582factornf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_t) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factornf", 0);

    /* "example.pyx":7595
 *             [x + Mod(-4*a, 8*a^2 - 1), 1; x + Mod(4*a, 8*a^2 - 1), 1]
 *         """
 *         t0GEN(t)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polfnf(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_t); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7596
 *         """
 *         t0GEN(t)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polfnf(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7597
 *         t0GEN(t)
 *         sig_on()
 *         return self.new_gen(polfnf(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def factorpadic(self, p, long r=20, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polfnf(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.factornf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_585factorpadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_584factorpadic[] = "\n        self.factorpadic(p,r=20,flag=0): p-adic factorization of the\n        polynomial x to precision r. flag is optional and may be set to 0\n        (use round 4) or 1 (use Buchmann-Lenstra)\n        ";
  static PyObject *__pyx_pw_7example_3gen_585factorpadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    long __pyx_v_r;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factorpadic (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,&__pyx_n_s__r,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__r);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factorpadic") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      if (values[1]) {
        __pyx_v_r = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_r == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_r = ((long)20);
      }
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factorpadic", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7599; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.factorpadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_584factorpadic(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7599
 *         return self.new_gen(polfnf(self.g, t0))
 * 
 *     def factorpadic(self, p, long r=20, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         self.factorpadic(p,r=20,flag=0): p-adic factorization of the
 */

  static PyObject *__pyx_pf_7example_3gen_584factorpadic(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_r, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factorpadic", 0);

    /* "example.pyx":7605
 *         (use round 4) or 1 (use Buchmann-Lenstra)
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(factorpadic0(self.g, t0, r, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7605; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7606
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(factorpadic0(self.g, t0, r, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7607
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(factorpadic0(self.g, t0, r, flag))             # <<<<<<<<<<<<<<
 * 
 *     def factormod(self, p, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, factorpadic0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_r, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7607; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.factorpadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_587factormod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_586factormod[] = "\n        x.factormod(p,flag=0): factorization mod p of the polynomial x\n        using Berlekamp. flag is optional, and can be 0: default or 1:\n        simple factormod, same except that only the degrees of the\n        irreducible factors are given.\n        ";
  static PyObject *__pyx_pw_7example_3gen_587factormod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factormod (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factormod") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factormod", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7609; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.factormod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_586factormod(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7609
 *         return self.new_gen(factorpadic0(self.g, t0, r, flag))
 * 
 *     def factormod(self, p, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.factormod(p,flag=0): factorization mod p of the polynomial x
 */

  static PyObject *__pyx_pf_7example_3gen_586factormod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factormod", 0);

    /* "example.pyx":7616
 *         irreducible factors are given.
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(factormod0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7617
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(factormod0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7618
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(factormod0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def intformal(self, y=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, factormod0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.factormod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_589intformal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_588intformal[] = "\n        x.intformal(y): formal integration of x with respect to the main\n        variable of y, or to the main variable of x if y is omitted\n        ";
  static PyObject *__pyx_pw_7example_3gen_589intformal(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("intformal (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intformal") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7620; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("intformal", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7620; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.intformal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_588intformal(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_y);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7620
 *         return self.new_gen(factormod0(self.g, t0, flag))
 * 
 *     def intformal(self, y=-1):             # <<<<<<<<<<<<<<
 *         """
 *         x.intformal(y): formal integration of x with respect to the main
 */

  static PyObject *__pyx_pf_7example_3gen_588intformal(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("intformal", 0);

    /* "example.pyx":7625
 *         variable of y, or to the main variable of x if y is omitted
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(integ(self.g, self.get_var(y)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7626
 *         """
 *         sig_on()
 *         return self.new_gen(integ(self.g, self.get_var(y)))             # <<<<<<<<<<<<<<
 * 
 *     def padicappr(self, a):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, integ(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_y)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.intformal", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_591padicappr(PyObject *__pyx_v_self, PyObject *__pyx_v_a); /*proto*/
  static char __pyx_doc_7example_3gen_590padicappr[] = "\n        x.padicappr(a): p-adic roots of the polynomial x congruent to a mod\n        p\n        ";
  static PyObject *__pyx_pw_7example_3gen_591padicappr(PyObject *__pyx_v_self, PyObject *__pyx_v_a) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("padicappr (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_590padicappr(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_a));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7628
 *         return self.new_gen(integ(self.g, self.get_var(y)))
 * 
 *     def padicappr(self, a):             # <<<<<<<<<<<<<<
 *         """
 *         x.padicappr(a): p-adic roots of the polynomial x congruent to a mod
 */

  static PyObject *__pyx_pf_7example_3gen_590padicappr(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("padicappr", 0);

    /* "example.pyx":7633
 *         p
 *         """
 *         t0GEN(a)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(padicappr(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7634
 *         """
 *         t0GEN(a)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(padicappr(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7635
 *         t0GEN(a)
 *         sig_on()
 *         return self.new_gen(padicappr(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def newtonpoly(self, p):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, padicappr(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7635; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.padicappr", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_593newtonpoly(PyObject *__pyx_v_self, PyObject *__pyx_v_p); /*proto*/
  static char __pyx_doc_7example_3gen_592newtonpoly[] = "\n        x.newtonpoly(p): Newton polygon of polynomial x with respect to the\n        prime p.\n\n        EXAMPLES::\n\n            sage: x = pari('y^8+6*y^6-27*y^5+1/9*y^2-y+1')\n            sage: x.newtonpoly(3)\n            [1, 1, -1/3, -1/3, -1/3, -1/3, -1/3, -1/3]\n        ";
  static PyObject *__pyx_pw_7example_3gen_593newtonpoly(PyObject *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("newtonpoly (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_592newtonpoly(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_p));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7637
 *         return self.new_gen(padicappr(self.g, t0))
 * 
 *     def newtonpoly(self, p):             # <<<<<<<<<<<<<<
 *         """
 *         x.newtonpoly(p): Newton polygon of polynomial x with respect to the
 */

  static PyObject *__pyx_pf_7example_3gen_592newtonpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("newtonpoly", 0);

    /* "example.pyx":7648
 *             [1, 1, -1/3, -1/3, -1/3, -1/3, -1/3, -1/3]
 *         """
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(newtonpoly(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7649
 *         """
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(newtonpoly(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7649; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7650
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(newtonpoly(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def polcoeff(self, long n, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, newtonpoly(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7650; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.newtonpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_595polcoeff(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_594polcoeff[] = "\n        EXAMPLES::\n\n            sage: f = pari(\"x^2 + y^3 + x*y\")\n            sage: f\n            x^2 + y*x + y^3\n            sage: f.polcoeff(1)\n            y\n            sage: f.polcoeff(3)\n            0\n            sage: f.polcoeff(3, \"y\")\n            1\n            sage: f.polcoeff(1, \"y\")\n            x\n        ";
  static PyObject *__pyx_pw_7example_3gen_595polcoeff(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcoeff (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__var,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcoeff") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_var = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcoeff", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polcoeff", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_594polcoeff(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_n, __pyx_v_var);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7652
 *         return self.new_gen(newtonpoly(self.g, t0))
 * 
 *     def polcoeff(self, long n, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_3gen_594polcoeff(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcoeff", 0);

    /* "example.pyx":7668
 *             x
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polcoeff0(self.g, n, self.get_var(var)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7668; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7669
 *         """
 *         sig_on()
 *         return self.new_gen(polcoeff0(self.g, n, self.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def polcompositum(self, pol2, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polcoeff0(__pyx_v_self->g, __pyx_v_n, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_var)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.polcoeff", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_597polcompositum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_597polcompositum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_pol2 = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcompositum (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__pol2,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__pol2)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcompositum") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7671; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_pol2 = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7671; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcompositum", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7671; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polcompositum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_596polcompositum(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_pol2, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7671
 *         return self.new_gen(polcoeff0(self.g, n, self.get_var(var)))
 * 
 *     def polcompositum(self, pol2, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(pol2)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_596polcompositum(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_pol2, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcompositum", 0);

    /* "example.pyx":7672
 * 
 *     def polcompositum(self, pol2, long flag=0):
 *         t0GEN(pol2)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polcompositum0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_pol2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7672; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7673
 *     def polcompositum(self, pol2, long flag=0):
 *         t0GEN(pol2)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polcompositum0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7674
 *         t0GEN(pol2)
 *         sig_on()
 *         return self.new_gen(polcompositum0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def poldegree(self, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polcompositum0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7674; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polcompositum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_599poldegree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_598poldegree[] = "\n        f.poldegree(var=x): Return the degree of this polynomial.\n        ";
  static PyObject *__pyx_pw_7example_3gen_599poldegree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldegree (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__var,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "poldegree") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7676; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("poldegree", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7676; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.poldegree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_598poldegree(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_var);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7676
 *         return self.new_gen(polcompositum0(self.g, t0, flag))
 * 
 *     def poldegree(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         f.poldegree(var=x): Return the degree of this polynomial.
 */

  static PyObject *__pyx_pf_7example_3gen_598poldegree(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldegree", 0);

    /* "example.pyx":7680
 *         f.poldegree(var=x): Return the degree of this polynomial.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         n = poldegree(self.g, self.get_var(var))
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7681
 *         """
 *         sig_on()
 *         n = poldegree(self.g, self.get_var(var))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = poldegree(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_var));

    /* "example.pyx":7682
 *         sig_on()
 *         n = poldegree(self.g, self.get_var(var))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7683
 *         n = poldegree(self.g, self.get_var(var))
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def poldisc(self, var=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7683; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.poldegree", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_601poldisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_600poldisc[] = "\n        f.poldist(var=x): Return the discriminant of this polynomial.\n        ";
  static PyObject *__pyx_pw_7example_3gen_601poldisc(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldisc (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__var,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "poldisc") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7685; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("poldisc", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7685; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.poldisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_600poldisc(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_var);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7685
 *         return n
 * 
 *     def poldisc(self, var=-1):             # <<<<<<<<<<<<<<
 *         """
 *         f.poldist(var=x): Return the discriminant of this polynomial.
 */

  static PyObject *__pyx_pf_7example_3gen_600poldisc(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldisc", 0);

    /* "example.pyx":7689
 *         f.poldist(var=x): Return the discriminant of this polynomial.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(poldisc0(self.g, self.get_var(var)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7690
 *         """
 *         sig_on()
 *         return self.new_gen(poldisc0(self.g, self.get_var(var)))             # <<<<<<<<<<<<<<
 * 
 *     def poldiscreduced(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, poldisc0(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_var)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.poldisc", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_603poldiscreduced(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_603poldiscreduced(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poldiscreduced (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_602poldiscreduced(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7692
 *         return self.new_gen(poldisc0(self.g, self.get_var(var)))
 * 
 *     def poldiscreduced(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(reduceddiscsmith(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_602poldiscreduced(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poldiscreduced", 0);

    /* "example.pyx":7693
 * 
 *     def poldiscreduced(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(reduceddiscsmith(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7694
 *     def poldiscreduced(self):
 *         sig_on()
 *         return self.new_gen(reduceddiscsmith(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def polgalois(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, reduceddiscsmith(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.poldiscreduced", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_605polgalois(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_604polgalois[] = "\n        f.polgalois(): Galois group of the polynomial f\n        ";
  static PyObject *__pyx_pw_7example_3gen_605polgalois(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polgalois (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_604polgalois(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7696
 *         return self.new_gen(reduceddiscsmith(self.g))
 * 
 *     def polgalois(self):             # <<<<<<<<<<<<<<
 *         """
 *         f.polgalois(): Galois group of the polynomial f
 */

  static PyObject *__pyx_pf_7example_3gen_604polgalois(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polgalois", 0);

    /* "example.pyx":7700
 *         f.polgalois(): Galois group of the polynomial f
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polgalois(self.g, prec))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7701
 *         """
 *         sig_on()
 *         return self.new_gen(polgalois(self.g, prec))             # <<<<<<<<<<<<<<
 * 
 *     def nfgaloisconj(self, long flag=0, denom=None, long precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polgalois(__pyx_v_self->g, __pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.polgalois", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_607nfgaloisconj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_606nfgaloisconj[] = "\n        Edited from the pari documentation:\n\n        nfgaloisconj(nf): list of conjugates of a root of the\n        polynomial x=nf.pol in the same number field.\n\n        Uses a combination of Allombert's algorithm and nfroots.\n\n        EXAMPLES::\n\n            sage: x = QQ['x'].0; nf = pari(x^2 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [-x, x]~\n            sage: nf = pari(x^3 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [x]~\n            sage: nf = pari(x^4 + 2).nfinit()\n            sage: nf.nfgaloisconj()\n            [-x, x]~\n        ";
  static PyObject *__pyx_pw_7example_3gen_607nfgaloisconj(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_v_denom = 0;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfgaloisconj (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__denom,&__pyx_n_s__precision,0};
      PyObject* values[3] = {0,0,0};

      /* "example.pyx":7703
 *         return self.new_gen(polgalois(self.g, prec))
 * 
 *     def nfgaloisconj(self, long flag=0, denom=None, long precision=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         Edited from the pari documentation:
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__denom);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nfgaloisconj") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7703; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7703; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
      __pyx_v_denom = values[1];
      if (values[2]) {
        __pyx_v_precision = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7703; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_precision = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nfgaloisconj", 0, 0, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7703; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nfgaloisconj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_606nfgaloisconj(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_denom, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_606nfgaloisconj(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag, PyObject *__pyx_v_denom, long __pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfgaloisconj", 0);

    /* "example.pyx":7725
 *         """
 *         global t0
 *         if denom is not None:             # <<<<<<<<<<<<<<
 *             t0GEN(denom)
 *         else:
 */
    __pyx_t_1 = (__pyx_v_denom != Py_None);
    if (__pyx_t_1) {

      /* "example.pyx":7726
 *         global t0
 *         if denom is not None:
 *             t0GEN(denom)             # <<<<<<<<<<<<<<
 *         else:
 *             t0 = NULL
 */
      __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_denom); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7726; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":7728
 *             t0GEN(denom)
 *         else:
 *             t0 = NULL             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(galoisconj0(self.g, flag, t0, pbw(precision)))
 */
      __pyx_v_7example_t0 = NULL;
    }
    __pyx_L3:;

    /* "example.pyx":7729
 *         else:
 *             t0 = NULL
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(galoisconj0(self.g, flag, t0, pbw(precision)))
 * 
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7730
 *             t0 = NULL
 *         sig_on()
 *         return self.new_gen(galoisconj0(self.g, flag, t0, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def nfroots(self, poly):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, galoisconj0(__pyx_v_self->g, __pyx_v_flag, __pyx_v_7example_t0, __pyx_t_6))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.nfgaloisconj", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_609nfroots(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
  static char __pyx_doc_7example_3gen_608nfroots[] = "\n        Return the roots of `poly` in the number field self without\n        multiplicity.\n\n        EXAMPLES::\n\n            sage: y = QQ['yy'].0; _ = pari(y) # pari has variable ordering rules\n            sage: x = QQ['zz'].0; nf = pari(x^2 + 2).nfinit()\n            sage: nf.nfroots(y^2 + 2)\n            [Mod(-zz, zz^2 + 2), Mod(zz, zz^2 + 2)]\n            sage: nf = pari(x^3 + 2).nfinit()\n            sage: nf.nfroots(y^3 + 2)\n            [Mod(zz, zz^3 + 2)]\n            sage: nf = pari(x^4 + 2).nfinit()\n            sage: nf.nfroots(y^4 + 2)\n            [Mod(-zz, zz^4 + 2), Mod(zz, zz^4 + 2)]\n        ";
  static PyObject *__pyx_pw_7example_3gen_609nfroots(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nfroots (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_608nfroots(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_poly));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7732
 *         return self.new_gen(galoisconj0(self.g, flag, t0, pbw(precision)))
 * 
 *     def nfroots(self, poly):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the roots of `poly` in the number field self without
 */

  static PyObject *__pyx_pf_7example_3gen_608nfroots(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_poly) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nfroots", 0);

    /* "example.pyx":7750
 *             [Mod(-zz, zz^4 + 2), Mod(zz, zz^4 + 2)]
 *         """
 *         t0GEN(poly)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(nfroots(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_poly); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7751
 *         """
 *         t0GEN(poly)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(nfroots(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7751; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7752
 *         t0GEN(poly)
 *         sig_on()
 *         return self.new_gen(nfroots(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def polhensellift(self, y, p, long e):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, nfroots(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.nfroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_611polhensellift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_610polhensellift[] = "\n        self.polhensellift(y, p, e): lift the factorization y of self\n        modulo p to a factorization modulo `p^e` using Hensel lift.\n        The factors in y must be pairwise relatively prime modulo p.\n        ";
  static PyObject *__pyx_pw_7example_3gen_611polhensellift(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_p = 0;
    long __pyx_v_e;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polhensellift (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__p,&__pyx_n_s__e,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7754; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (likely((values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__e)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7754; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polhensellift") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7754; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      }
      __pyx_v_y = values[0];
      __pyx_v_p = values[1];
      __pyx_v_e = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_e == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7754; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polhensellift", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7754; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polhensellift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_610polhensellift(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_p, __pyx_v_e);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7754
 *         return self.new_gen(nfroots(self.g, t0))
 * 
 *     def polhensellift(self, y, p, long e):             # <<<<<<<<<<<<<<
 *         """
 *         self.polhensellift(y, p, e): lift the factorization y of self
 */

  static PyObject *__pyx_pf_7example_3gen_610polhensellift(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_p, long __pyx_v_e) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polhensellift", 0);

    /* "example.pyx":7760
 *         The factors in y must be pairwise relatively prime modulo p.
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         t1GEN(p)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7761
 *         """
 *         t0GEN(y)
 *         t1GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polhensellift(self.g, t0, t1, e))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7762
 *         t0GEN(y)
 *         t1GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polhensellift(self.g, t0, t1, e))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7763
 *         t1GEN(p)
 *         sig_on()
 *         return self.new_gen(polhensellift(self.g, t0, t1, e))             # <<<<<<<<<<<<<<
 * 
 *     def polisirreducible(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polhensellift(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_v_e))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7763; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polhensellift", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_613polisirreducible(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_612polisirreducible[] = "\n        f.polisirreducible(): Returns True if f is an irreducible\n        non-constant polynomial, or False if f is reducible or constant.\n        ";
  static PyObject *__pyx_pw_7example_3gen_613polisirreducible(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polisirreducible (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_612polisirreducible(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7765
 *         return self.new_gen(polhensellift(self.g, t0, t1, e))
 * 
 *     def polisirreducible(self):             # <<<<<<<<<<<<<<
 *         """
 *         f.polisirreducible(): Returns True if f is an irreducible
 */

  static PyObject *__pyx_pf_7example_3gen_612polisirreducible(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polisirreducible", 0);

    /* "example.pyx":7770
 *         non-constant polynomial, or False if f is reducible or constant.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return bool(self.new_gen(gisirreducible(self.g)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7770; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7771
 *         """
 *         sig_on()
 *         return bool(self.new_gen(gisirreducible(self.g)))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gisirreducible(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7cpython_4bool_bool)), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.polisirreducible", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_615pollead(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_614pollead[] = "\n        self.pollead(v): leading coefficient of polynomial or series self,\n        or self itself if self is a scalar. Error otherwise. With respect\n        to the main variable of self if v is omitted, with respect to the\n        variable v otherwise\n        ";
  static PyObject *__pyx_pw_7example_3gen_615pollead(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("pollead (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pollead") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7774; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("pollead", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7774; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.pollead", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_614pollead(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7774
 * 
 * 
 *     def pollead(self, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         self.pollead(v): leading coefficient of polynomial or series self,
 */

  static PyObject *__pyx_pf_7example_3gen_614pollead(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pollead", 0);

    /* "example.pyx":7781
 *         variable v otherwise
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(pollead(self.g, self.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7782
 *         """
 *         sig_on()
 *         return self.new_gen(pollead(self.g, self.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def polrecip(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, pollead(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.pollead", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_617polrecip(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_617polrecip(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrecip (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_616polrecip(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7784
 *         return self.new_gen(pollead(self.g, self.get_var(v)))
 * 
 *     def polrecip(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polrecip(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_616polrecip(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrecip", 0);

    /* "example.pyx":7785
 * 
 *     def polrecip(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polrecip(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7786
 *     def polrecip(self):
 *         sig_on()
 *         return self.new_gen(polrecip(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def polred(self, flag=0, fa=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polrecip(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.polrecip", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_619polred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_619polred(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_fa = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polred (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__fa,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);

      /* "example.pyx":7788
 *         return self.new_gen(polrecip(self.g))
 * 
 *     def polred(self, flag=0, fa=None):             # <<<<<<<<<<<<<<
 *         if fa is None:
 *             sig_on()
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__fa);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polred") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7788; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
      __pyx_v_fa = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polred", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7788; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_618polred(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_fa);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_618polred(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag, PyObject *__pyx_v_fa) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    long __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polred", 0);

    /* "example.pyx":7789
 * 
 *     def polred(self, flag=0, fa=None):
 *         if fa is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(polred0(self.g, flag, NULL))
 */
    __pyx_t_1 = (__pyx_v_fa == Py_None);
    if (__pyx_t_1) {

      /* "example.pyx":7790
 *     def polred(self, flag=0, fa=None):
 *         if fa is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(polred0(self.g, flag, NULL))
 *         else:
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7791
 *         if fa is None:
 *             sig_on()
 *             return self.new_gen(polred0(self.g, flag, NULL))             # <<<<<<<<<<<<<<
 *         else:
 *             t0GEN(fa)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polred0(__pyx_v_self->g, __pyx_t_3, NULL))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7791; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":7793
 *             return self.new_gen(polred0(self.g, flag, NULL))
 *         else:
 *             t0GEN(fa)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(polred0(self.g, flag, t0))
 */
      __pyx_t_4 = __pyx_f_7example_t0GEN(__pyx_v_fa); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

      /* "example.pyx":7794
 *         else:
 *             t0GEN(fa)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(polred0(self.g, flag, t0))
 * 
 */
      __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7795
 *             t0GEN(fa)
 *             sig_on()
 *             return self.new_gen(polred0(self.g, flag, t0))             # <<<<<<<<<<<<<<
 * 
 *     def polredabs(self, flag=0):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polred0(__pyx_v_self->g, __pyx_t_3, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.polred", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_621polredabs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_621polredabs(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polredabs (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polredabs") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7797; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polredabs", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7797; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polredabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_620polredabs(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7797
 *             return self.new_gen(polred0(self.g, flag, t0))
 * 
 *     def polredabs(self, flag=0):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polredabs0(self.g, flag))
 */

  static PyObject *__pyx_pf_7example_3gen_620polredabs(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polredabs", 0);

    /* "example.pyx":7798
 * 
 *     def polredabs(self, flag=0):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polredabs0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7799
 *     def polredabs(self, flag=0):
 *         sig_on()
 *         return self.new_gen(polredabs0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *         #def polredbest(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polredabs0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.polredabs", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_623polresultant(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_623polresultant(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polresultant (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__var,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      values[2] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polresultant") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7805; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      __pyx_v_var = values[1];
      __pyx_v_flag = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polresultant", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7805; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polresultant", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_622polresultant(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_var, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7805
 *         #return self.new_gen(polred(self.g, flag,))
 * 
 *     def polresultant(self, y, var=-1, flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_622polresultant(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_var, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polresultant", 0);

    /* "example.pyx":7806
 * 
 *     def polresultant(self, y, var=-1, flag=0):
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polresultant0(self.g, t0, self.get_var(var), flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7807
 *     def polresultant(self, y, var=-1, flag=0):
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polresultant0(self.g, t0, self.get_var(var), flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7808
 *         t0GEN(y)
 *         sig_on()
 *         return self.new_gen(polresultant0(self.g, t0, self.get_var(var), flag))             # <<<<<<<<<<<<<<
 * 
 *     def polroots(self, flag=0, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polresultant0(__pyx_v_self->g, __pyx_v_7example_t0, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_var), __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polresultant", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_625polroots(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_624polroots[] = "\n        polroots(x,flag=0): complex roots of the polynomial x. flag is\n        optional, and can be 0: default, uses Schonhage's method modified\n        by Gourdon, or 1: uses a modified Newton method.\n        ";
  static PyObject *__pyx_pw_7example_3gen_625polroots(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polroots (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polroots") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polroots", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7810; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_624polroots(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7810
 *         return self.new_gen(polresultant0(self.g, t0, self.get_var(var), flag))
 * 
 *     def polroots(self, flag=0, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         polroots(x,flag=0): complex roots of the polynomial x. flag is
 */

  static PyObject *__pyx_pf_7example_3gen_624polroots(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    long __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polroots", 0);

    /* "example.pyx":7816
 *         by Gourdon, or 1: uses a modified Newton method.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(roots0(self.g, flag, pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7817
 *         """
 *         sig_on()
 *         return self.new_gen(roots0(self.g, flag, pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def polrootsmod(self, p, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_5 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_6 = __Pyx_PyInt_AsLong(__pyx_t_5); if (unlikely((__pyx_t_6 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, roots0(__pyx_v_self->g, __pyx_t_2, __pyx_t_6))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.polroots", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_627polrootsmod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_627polrootsmod(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootsmod (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootsmod") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7819; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      __pyx_v_flag = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootsmod", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7819; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polrootsmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_626polrootsmod(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7819
 *         return self.new_gen(roots0(self.g, flag, pbw(precision)))
 * 
 *     def polrootsmod(self, p, flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(p)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_626polrootsmod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootsmod", 0);

    /* "example.pyx":7820
 * 
 *     def polrootsmod(self, p, flag=0):
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rootmod0(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7821
 *     def polrootsmod(self, p, flag=0):
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rootmod0(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7822
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(rootmod0(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def polrootspadic(self, p, r=20):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rootmod0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polrootsmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_629polrootspadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_629polrootspadic(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_v_r = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootspadic (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,&__pyx_n_s__r,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_20);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__r);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootspadic") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7824; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      __pyx_v_r = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootspadic", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7824; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polrootspadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_628polrootspadic(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7824
 *         return self.new_gen(rootmod0(self.g, t0, flag))
 * 
 *     def polrootspadic(self, p, r=20):             # <<<<<<<<<<<<<<
 *         t0GEN(p)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_628polrootspadic(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootspadic", 0);

    /* "example.pyx":7825
 * 
 *     def polrootspadic(self, p, r=20):
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rootpadic(self.g, t0, r))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7826
 *     def polrootspadic(self, p, r=20):
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rootpadic(self.g, t0, r))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7827
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(rootpadic(self.g, t0, r))             # <<<<<<<<<<<<<<
 * 
 *     def polrootspadicfast(self, p, r=20):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_r); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rootpadic(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polrootspadic", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_631polrootspadicfast(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_631polrootspadicfast(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_v_r = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polrootspadicfast (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__p,&__pyx_n_s__r,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_20);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__r);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polrootspadicfast") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7829; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_p = values[0];
      __pyx_v_r = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polrootspadicfast", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7829; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polrootspadicfast", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_630polrootspadicfast(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_p, __pyx_v_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7829
 *         return self.new_gen(rootpadic(self.g, t0, r))
 * 
 *     def polrootspadicfast(self, p, r=20):             # <<<<<<<<<<<<<<
 *         t0GEN(p)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_630polrootspadicfast(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_p, PyObject *__pyx_v_r) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polrootspadicfast", 0);

    /* "example.pyx":7830
 * 
 *     def polrootspadicfast(self, p, r=20):
 *         t0GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rootpadicfast(self.g, t0, r))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7831
 *     def polrootspadicfast(self, p, r=20):
 *         t0GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rootpadicfast(self.g, t0, r))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7832
 *         t0GEN(p)
 *         sig_on()
 *         return self.new_gen(rootpadicfast(self.g, t0, r))             # <<<<<<<<<<<<<<
 * 
 *     def polsturm(self, a, b):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_v_r); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rootpadicfast(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_t_3))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polrootspadicfast", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_633polsturm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_633polsturm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_a = 0;
    PyObject *__pyx_v_b = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsturm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__a,&__pyx_n_s__b,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__a)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__b)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polsturm", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polsturm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_a = values[0];
      __pyx_v_b = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polsturm", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7834; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polsturm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_632polsturm(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_a, __pyx_v_b);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7834
 *         return self.new_gen(rootpadicfast(self.g, t0, r))
 * 
 *     def polsturm(self, a, b):             # <<<<<<<<<<<<<<
 *         t0GEN(a)
 *         t1GEN(b)
 */

  static PyObject *__pyx_pf_7example_3gen_632polsturm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsturm", 0);

    /* "example.pyx":7835
 * 
 *     def polsturm(self, a, b):
 *         t0GEN(a)             # <<<<<<<<<<<<<<
 *         t1GEN(b)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_a); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7836
 *     def polsturm(self, a, b):
 *         t0GEN(a)
 *         t1GEN(b)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         n = sturmpart(self.g, t0, t1)
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_b); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7837
 *         t0GEN(a)
 *         t1GEN(b)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         n = sturmpart(self.g, t0, t1)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7838
 *         t1GEN(b)
 *         sig_on()
 *         n = sturmpart(self.g, t0, t1)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = sturmpart(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1);

    /* "example.pyx":7839
 *         sig_on()
 *         n = sturmpart(self.g, t0, t1)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7840
 *         n = sturmpart(self.g, t0, t1)
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def polsturm_full(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polsturm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_635polsturm_full(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_635polsturm_full(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsturm_full (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_634polsturm_full(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7842
 *         return n
 * 
 *     def polsturm_full(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         n = sturmpart(self.g, NULL, NULL)
 */

  static PyObject *__pyx_pf_7example_3gen_634polsturm_full(struct __pyx_obj_7example_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsturm_full", 0);

    /* "example.pyx":7843
 * 
 *     def polsturm_full(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         n = sturmpart(self.g, NULL, NULL)
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7843; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7844
 *     def polsturm_full(self):
 *         sig_on()
 *         n = sturmpart(self.g, NULL, NULL)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = sturmpart(__pyx_v_self->g, NULL, NULL);

    /* "example.pyx":7845
 *         sig_on()
 *         n = sturmpart(self.g, NULL, NULL)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7846
 *         n = sturmpart(self.g, NULL, NULL)
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def polsylvestermatrix(self, g):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.polsturm_full", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_637polsylvestermatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_g); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_637polsylvestermatrix(PyObject *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsylvestermatrix (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_636polsylvestermatrix(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_g));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7848
 *         return n
 * 
 *     def polsylvestermatrix(self, g):             # <<<<<<<<<<<<<<
 *         t0GEN(g)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_636polsylvestermatrix(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsylvestermatrix", 0);

    /* "example.pyx":7849
 * 
 *     def polsylvestermatrix(self, g):
 *         t0GEN(g)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(sylvestermatrix(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_g); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7850
 *     def polsylvestermatrix(self, g):
 *         t0GEN(g)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(sylvestermatrix(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7850; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7851
 *         t0GEN(g)
 *         sig_on()
 *         return self.new_gen(sylvestermatrix(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def polsym(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, sylvestermatrix(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.polsylvestermatrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_639polsym(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_639polsym(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsym (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7853; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polsym", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_638polsym(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7853
 *         return self.new_gen(sylvestermatrix(self.g, t0))
 * 
 *     def polsym(self, long n):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polsym(self.g, n))
 */

  static PyObject *__pyx_pf_7example_3gen_638polsym(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsym", 0);

    /* "example.pyx":7854
 * 
 *     def polsym(self, long n):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polsym(self.g, n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7854; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7855
 *     def polsym(self, long n):
 *         sig_on()
 *         return self.new_gen(polsym(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def serconvol(self, g):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polsym(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.polsym", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_641serconvol(PyObject *__pyx_v_self, PyObject *__pyx_v_g); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_641serconvol(PyObject *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serconvol (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_640serconvol(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_g));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7857
 *         return self.new_gen(polsym(self.g, n))
 * 
 *     def serconvol(self, g):             # <<<<<<<<<<<<<<
 *         t0GEN(g)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_640serconvol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_g) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serconvol", 0);

    /* "example.pyx":7858
 * 
 *     def serconvol(self, g):
 *         t0GEN(g)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(convol(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_g); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7858; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7859
 *     def serconvol(self, g):
 *         t0GEN(g)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(convol(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7860
 *         t0GEN(g)
 *         sig_on()
 *         return self.new_gen(convol(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def serlaplace(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, convol(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7860; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.serconvol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_643serlaplace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_643serlaplace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serlaplace (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_642serlaplace(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7862
 *         return self.new_gen(convol(self.g, t0))
 * 
 *     def serlaplace(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(laplace(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_642serlaplace(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serlaplace", 0);

    /* "example.pyx":7863
 * 
 *     def serlaplace(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(laplace(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7863; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7864
 *     def serlaplace(self):
 *         sig_on()
 *         return self.new_gen(laplace(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def serreverse(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, laplace(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.serlaplace", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_645serreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_644serreverse[] = "\n        serreverse(f): reversion of the power series f.\n\n        If f(t) is a series in t with valuation 1, find the series g(t)\n        such that g(f(t)) = t.\n\n        EXAMPLES::\n\n            sage: f = pari('x+x^2+x^3+O(x^4)'); f\n            x + x^2 + x^3 + O(x^4)\n            sage: g = f.serreverse(); g\n            x - x^2 + x^3 + O(x^4)\n            sage: f.subst('x',g)\n            x + O(x^4)\n            sage: g.subst('x',f)\n            x + O(x^4)\n        ";
  static PyObject *__pyx_pw_7example_3gen_645serreverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("serreverse (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_644serreverse(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7866
 *         return self.new_gen(laplace(self.g))
 * 
 *     def serreverse(self):             # <<<<<<<<<<<<<<
 *         """
 *         serreverse(f): reversion of the power series f.
 */

  static PyObject *__pyx_pf_7example_3gen_644serreverse(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("serreverse", 0);

    /* "example.pyx":7884
 *             x + O(x^4)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(recip(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7884; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7885
 *         """
 *         sig_on()
 *         return self.new_gen(recip(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def thueinit(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, recip(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.serreverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_647thueinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_647thueinit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thueinit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thueinit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7887; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thueinit", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7887; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.thueinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_646thueinit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7887
 *         return self.new_gen(recip(self.g))
 * 
 *     def thueinit(self, flag=0):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(thueinit(self.g, flag, prec))
 */

  static PyObject *__pyx_pf_7example_3gen_646thueinit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thueinit", 0);

    /* "example.pyx":7888
 * 
 *     def thueinit(self, flag=0):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(thueinit(self.g, flag, prec))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7889
 *     def thueinit(self, flag=0):
 *         sig_on()
 *         return self.new_gen(thueinit(self.g, flag, prec))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, thueinit(__pyx_v_self->g, __pyx_t_2, __pyx_t_4))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.thueinit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_649rnfisnorminit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_649rnfisnorminit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_polrel = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisnorminit (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__polrel,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__polrel)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfisnorminit") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7892; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_polrel = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7892; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)2);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfisnorminit", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7892; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.rnfisnorminit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_648rnfisnorminit(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_polrel, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7892
 * 
 * 
 *     def rnfisnorminit(self, polrel, long flag=2):             # <<<<<<<<<<<<<<
 *         t0GEN(polrel)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_648rnfisnorminit(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_polrel, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisnorminit", 0);

    /* "example.pyx":7893
 * 
 *     def rnfisnorminit(self, polrel, long flag=2):
 *         t0GEN(polrel)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfisnorminit(self.g, t0, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_polrel); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7894
 *     def rnfisnorminit(self, polrel, long flag=2):
 *         t0GEN(polrel)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfisnorminit(self.g, t0, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7894; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7895
 *         t0GEN(polrel)
 *         sig_on()
 *         return self.new_gen(rnfisnorminit(self.g, t0, flag))             # <<<<<<<<<<<<<<
 * 
 *     def rnfisnorm(self, T, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfisnorminit(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7895; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfisnorminit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_651rnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_651rnfisnorm(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_T = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("rnfisnorm (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__T,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__T)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rnfisnorm") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7897; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_T = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7897; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("rnfisnorm", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7897; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.rnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_650rnfisnorm(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_T, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7897
 *         return self.new_gen(rnfisnorminit(self.g, t0, flag))
 * 
 *     def rnfisnorm(self, T, long flag=0):             # <<<<<<<<<<<<<<
 *         t0GEN(T)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_650rnfisnorm(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_T, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("rnfisnorm", 0);

    /* "example.pyx":7898
 * 
 *     def rnfisnorm(self, T, long flag=0):
 *         t0GEN(T)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(rnfisnorm(t0, self.g, flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_T); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7899
 *     def rnfisnorm(self, T, long flag=0):
 *         t0GEN(T)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(rnfisnorm(t0, self.g, flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7900
 *         t0GEN(T)
 *         sig_on()
 *         return self.new_gen(rnfisnorm(t0, self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     ###########################################
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, rnfisnorm(__pyx_v_7example_t0, __pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.rnfisnorm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_653vecextract(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_652vecextract[] = "\n        self.vecextract(y,z): extraction of the components of the matrix or\n        vector x according to y and z. If z is omitted, y designates\n        columns, otherwise y corresponds to rows and z to columns. y and z\n        can be vectors (of indices), strings (indicating ranges as\n        in\"1..10\") or masks (integers whose binary representation indicates\n        the indices to extract, from left to right 1, 2, 4, 8, etc.)\n\n        .. note::\n\n           This function uses the PARI row and column indexing, so the\n           first row or column is indexed by 1 instead of 0.\n        ";
  static PyObject *__pyx_pw_7example_3gen_653vecextract(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("vecextract (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__z,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":7906
 *     ###########################################
 * 
 *     def vecextract(self, y, z=None):             # <<<<<<<<<<<<<<
 *         r"""
 *         self.vecextract(y,z): extraction of the components of the matrix or
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vecextract") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_y = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("vecextract", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7906; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.vecextract", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_652vecextract(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_z);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_3gen_652vecextract(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("vecextract", 0);

    /* "example.pyx":7920
 *            first row or column is indexed by 1 instead of 0.
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         if z is None:
 *             sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":7921
 *         """
 *         t0GEN(y)
 *         if z is None:             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return P.new_gen(shallowextract(self.g, t0))
 */
    __pyx_t_2 = (__pyx_v_z == Py_None);
    if (__pyx_t_2) {

      /* "example.pyx":7922
 *         t0GEN(y)
 *         if z is None:
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(shallowextract(self.g, t0))
 *         else:
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7923
 *         if z is None:
 *             sig_on()
 *             return P.new_gen(shallowextract(self.g, t0))             # <<<<<<<<<<<<<<
 *         else:
 *             t1GEN(z)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, shallowextract(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":7925
 *             return P.new_gen(shallowextract(self.g, t0))
 *         else:
 *             t1GEN(z)             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return P.new_gen(extract0(self.g, t0, t1))
 */
      __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7925; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

      /* "example.pyx":7926
 *         else:
 *             t1GEN(z)
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return P.new_gen(extract0(self.g, t0, t1))
 * 
 */
      __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7926; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":7927
 *             t1GEN(z)
 *             sig_on()
 *             return P.new_gen(extract0(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def ncols(self):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, extract0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_r = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.vecextract", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_655ncols(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_654ncols[] = "\n        Return the number of columns of self.\n\n        EXAMPLES::\n\n            sage: pari('matrix(19,8)').ncols()\n            8\n        ";
  static PyObject *__pyx_pw_7example_3gen_655ncols(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ncols (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_654ncols(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7929
 *             return P.new_gen(extract0(self.g, t0, t1))
 * 
 *     def ncols(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of columns of self.
 */

  static PyObject *__pyx_pf_7example_3gen_654ncols(struct __pyx_obj_7example_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ncols", 0);

    /* "example.pyx":7939
 *         """
 *         cdef long n
 *         sig_on()             # <<<<<<<<<<<<<<
 *         n = glength(self.g)
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7940
 *         cdef long n
 *         sig_on()
 *         n = glength(self.g)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = glength(__pyx_v_self->g);

    /* "example.pyx":7941
 *         sig_on()
 *         n = glength(self.g)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7942
 *         n = glength(self.g)
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def nrows(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7942; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.ncols", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_657nrows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_656nrows[] = "\n        Return the number of rows of self.\n\n        EXAMPLES::\n\n            sage: pari('matrix(19,8)').nrows()\n            19\n        ";
  static PyObject *__pyx_pw_7example_3gen_657nrows(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nrows (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_656nrows(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7944
 *         return n
 * 
 *     def nrows(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of rows of self.
 */

  static PyObject *__pyx_pf_7example_3gen_656nrows(struct __pyx_obj_7example_gen *__pyx_v_self) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nrows", 0);

    /* "example.pyx":7954
 *         """
 *         cdef long n
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # if this matrix has no columns
 *         # then it has no rows.
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7957
 *         # if this matrix has no columns
 *         # then it has no rows.
 *         if self.ncols() == 0:             # <<<<<<<<<<<<<<
 *             sig_off()
 *             return 0
 */
    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__ncols); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_RichCompare(__pyx_t_3, __pyx_int_0, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_4) {

      /* "example.pyx":7958
 *         # then it has no rows.
 *         if self.ncols() == 0:
 *             sig_off()             # <<<<<<<<<<<<<<
 *             return 0
 *         n = glength(<GEN>(self.g[1]))
 */
      _pari_sig_off();

      /* "example.pyx":7959
 *         if self.ncols() == 0:
 *             sig_off()
 *             return 0             # <<<<<<<<<<<<<<
 *         n = glength(<GEN>(self.g[1]))
 *         sig_off()
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_int_0);
      __pyx_r = __pyx_int_0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":7960
 *             sig_off()
 *             return 0
 *         n = glength(<GEN>(self.g[1]))             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return n
 */
    __pyx_v_n = glength(((GEN)(__pyx_v_self->g[1])));

    /* "example.pyx":7961
 *             return 0
 *         n = glength(<GEN>(self.g[1]))
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return n
 * 
 */
    _pari_sig_off();

    /* "example.pyx":7962
 *         n = glength(<GEN>(self.g[1]))
 *         sig_off()
 *         return n             # <<<<<<<<<<<<<<
 * 
 *     def mattranspose(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7962; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.nrows", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_659mattranspose(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_658mattranspose[] = "\n        Transpose of the matrix self.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').mattranspose()\n            [1, 4, 7; 2, 5, 8; 3, 6, 9]\n        ";
  static PyObject *__pyx_pw_7example_3gen_659mattranspose(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mattranspose (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_658mattranspose(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7964
 *         return n
 * 
 *     def mattranspose(self):             # <<<<<<<<<<<<<<
 *         """
 *         Transpose of the matrix self.
 */

  static PyObject *__pyx_pf_7example_3gen_658mattranspose(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mattranspose", 0);

    /* "example.pyx":7973
 *             [1, 4, 7; 2, 5, 8; 3, 6, 9]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(gtrans(self.g)).Mat()
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7974
 *         """
 *         sig_on()
 *         return self.new_gen(gtrans(self.g)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def matadjoint(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gtrans(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__Mat); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.mattranspose", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_661matadjoint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_660matadjoint[] = "\n        matadjoint(x): adjoint matrix of x.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').matadjoint()\n            [-3, 6, -3; 6, -12, 6; -3, 6, -3]\n            sage: pari('[a,b,c; d,e,f; g,h,i]').matadjoint()\n            [(i*e - h*f), (-i*b + h*c), (f*b - e*c); (-i*d + g*f), i*a - g*c, -f*a + d*c; (h*d - g*e), -h*a + g*b, e*a - d*b]\n        ";
  static PyObject *__pyx_pw_7example_3gen_661matadjoint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matadjoint (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_660matadjoint(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7976
 *         return self.new_gen(gtrans(self.g)).Mat()
 * 
 *     def matadjoint(self):             # <<<<<<<<<<<<<<
 *         """
 *         matadjoint(x): adjoint matrix of x.
 */

  static PyObject *__pyx_pf_7example_3gen_660matadjoint(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matadjoint", 0);

    /* "example.pyx":7987
 *             [(i*e - h*f), (-i*b + h*c), (f*b - e*c); (-i*d + g*f), i*a - g*c, -f*a + d*c; (h*d - g*e), -h*a + g*b, e*a - d*b]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(adj(self.g)).Mat()
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7987; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":7988
 *         """
 *         sig_on()
 *         return self.new_gen(adj(self.g)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def qflll(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, adj(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__Mat); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7988; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.matadjoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_663qflll(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_662qflll[] = "\n        qflll(x,flag=0): LLL reduction of the vectors forming the matrix x\n        (gives the unimodular transformation matrix). The columns of x must\n        be linearly independent, unless specified otherwise below. flag is\n        optional, and can be 0: default, 1: assumes x is integral, columns\n        may be dependent, 2: assumes x is integral, returns a partially\n        reduced basis, 4: assumes x is integral, returns [K,I] where K is\n        the integer kernel of x and I the LLL reduced image, 5: same as 4\n        but x may have polynomial coefficients, 8: same as 0 but x may have\n        polynomial coefficients.\n        ";
  static PyObject *__pyx_pw_7example_3gen_663qflll(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qflll (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qflll") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qflll", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7990; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.qflll", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_662qflll(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":7990
 *         return self.new_gen(adj(self.g)).Mat()
 * 
 *     def qflll(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflll(x,flag=0): LLL reduction of the vectors forming the matrix x
 */

  static PyObject *__pyx_pf_7example_3gen_662qflll(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qflll", 0);

    /* "example.pyx":8002
 *         polynomial coefficients.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(qflll0(self.g,flag)).Mat()
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8002; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8003
 *         """
 *         sig_on()
 *         return self.new_gen(qflll0(self.g,flag)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def qflllgram(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, qflll0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__Mat); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8003; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.qflll", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_665qflllgram(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_664qflllgram[] = "\n        qflllgram(x,flag=0): LLL reduction of the lattice whose gram matrix\n        is x (gives the unimodular transformation matrix). flag is optional\n        and can be 0: default,1: lllgramint algorithm for integer matrices,\n        4: lllgramkerim giving the kernel and the LLL reduced image, 5:\n        lllgramkerimgen same when the matrix has polynomial coefficients,\n        8: lllgramgen, same as qflllgram when the coefficients are\n        polynomials.\n        ";
  static PyObject *__pyx_pw_7example_3gen_665qflllgram(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qflllgram (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qflllgram") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8005; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8005; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qflllgram", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8005; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.qflllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_664qflllgram(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8005
 *         return self.new_gen(qflll0(self.g,flag)).Mat()
 * 
 *     def qflllgram(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qflllgram(x,flag=0): LLL reduction of the lattice whose gram matrix
 */

  static PyObject *__pyx_pf_7example_3gen_664qflllgram(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qflllgram", 0);

    /* "example.pyx":8015
 *         polynomials.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(qflllgram0(self.g,flag)).Mat()
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8015; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8016
 *         """
 *         sig_on()
 *         return self.new_gen(qflllgram0(self.g,flag)).Mat()             # <<<<<<<<<<<<<<
 * 
 *     def lllgram(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, qflllgram0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__Mat); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.qflllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_667lllgram(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_667lllgram(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lllgram (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_666lllgram(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8018
 *         return self.new_gen(qflllgram0(self.g,flag)).Mat()
 * 
 *     def lllgram(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(0)
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_666lllgram(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lllgram", 0);

    /* "example.pyx":8019
 * 
 *     def lllgram(self):
 *         return self.qflllgram(0)             # <<<<<<<<<<<<<<
 * 
 *     def lllgramint(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__qflllgram); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_k_tuple_50), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.lllgram", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_669lllgramint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_669lllgramint(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lllgramint (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_668lllgramint(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8021
 *         return self.qflllgram(0)
 * 
 *     def lllgramint(self):             # <<<<<<<<<<<<<<
 *         return self.qflllgram(1)
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_668lllgramint(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lllgramint", 0);

    /* "example.pyx":8022
 * 
 *     def lllgramint(self):
 *         return self.qflllgram(1)             # <<<<<<<<<<<<<<
 * 
 *     def qfminim(self, B, max, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__qflllgram); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_k_tuple_51), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.lllgramint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_671qfminim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_670qfminim[] = "\n        qfminim(x,bound,maxnum,flag=0): number of vectors of square norm =\n        bound, maximum norm and list of vectors for the integral and\n        definite quadratic form x; minimal non-zero vectors if bound=0.\n        flag is optional, and can be 0: default; 1: returns the first\n        minimal vector found (ignore maxnum); 2: as 0 but uses a more\n        robust, slower implementation, valid for non integral quadratic\n        forms.\n        ";
  static PyObject *__pyx_pw_7example_3gen_671qfminim(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_B = 0;
    PyObject *__pyx_v_max = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qfminim (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__B,&__pyx_n_s__max,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__B)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__max)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("qfminim", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qfminim") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_B = values[0];
      __pyx_v_max = values[1];
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qfminim", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8024; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.qfminim", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_670qfminim(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_B, __pyx_v_max, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8024
 *         return self.qflllgram(1)
 * 
 *     def qfminim(self, B, max, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qfminim(x,bound,maxnum,flag=0): number of vectors of square norm =
 */

  static PyObject *__pyx_pf_7example_3gen_670qfminim(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B, PyObject *__pyx_v_max, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qfminim", 0);

    /* "example.pyx":8034
 *         forms.
 *         """
 *         t0GEN(B)             # <<<<<<<<<<<<<<
 *         t1GEN(max)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_B); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8034; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8035
 *         """
 *         t0GEN(B)
 *         t1GEN(max)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(qfminim0(self.g,t0,t1,flag,precdl))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_max); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8035; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8036
 *         t0GEN(B)
 *         t1GEN(max)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(qfminim0(self.g,t0,t1,flag,precdl))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8036; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8037
 *         t1GEN(max)
 *         sig_on()
 *         return self.new_gen(qfminim0(self.g,t0,t1,flag,precdl))             # <<<<<<<<<<<<<<
 * 
 *     def qfrep(self, B, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, qfminim0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, __pyx_v_flag, precdl))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8037; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.qfminim", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_673qfrep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_672qfrep[] = "\n        qfrep(x,B,flag=0): vector of (half) the number of vectors of norms\n        from 1 to B for the integral and definite quadratic form x. Binary\n        digits of flag mean 1: count vectors of even norm from 1 to 2B, 2:\n        return a t_VECSMALL instead of a t_VEC.\n        ";
  static PyObject *__pyx_pw_7example_3gen_673qfrep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_B = 0;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("qfrep (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__B,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__B)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "qfrep") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_B = values[0];
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("qfrep", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8039; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.qfrep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_672qfrep(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_B, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8039
 *         return self.new_gen(qfminim0(self.g,t0,t1,flag,precdl))
 * 
 *     def qfrep(self, B, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         qfrep(x,B,flag=0): vector of (half) the number of vectors of norms
 */

  static PyObject *__pyx_pf_7example_3gen_672qfrep(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("qfrep", 0);

    /* "example.pyx":8046
 *         return a t_VECSMALL instead of a t_VEC.
 *         """
 *         t0GEN(B)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(qfrep0(self.g,t0,flag))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_B); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8047
 *         """
 *         t0GEN(B)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(qfrep0(self.g,t0,flag))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8048
 *         t0GEN(B)
 *         sig_on()
 *         return self.new_gen(qfrep0(self.g,t0,flag))             # <<<<<<<<<<<<<<
 * 
 *     def matsolve(self, B):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, qfrep0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8048; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.qfrep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_675matsolve(PyObject *__pyx_v_self, PyObject *__pyx_v_B); /*proto*/
  static char __pyx_doc_7example_3gen_674matsolve[] = "\n        matsolve(B): Solve the linear system Mx=B for an invertible matrix\n        M\n\n        matsolve(B) uses Gaussian elimination to solve Mx=B, where M is\n        invertible and B is a column vector.\n\n        The corresponding pari library routine is gauss. The gp-interface\n        name matsolve has been given preference here.\n\n        INPUT:\n\n\n        -  ``B`` - a column vector of the same dimension as the\n           square matrix self\n\n\n        EXAMPLES::\n\n            sage: pari('[1,1;1,-1]').matsolve(pari('[1;0]'))\n            [1/2; 1/2]\n        ";
  static PyObject *__pyx_pw_7example_3gen_675matsolve(PyObject *__pyx_v_self, PyObject *__pyx_v_B) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matsolve (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_674matsolve(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_B));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8050
 *         return self.new_gen(qfrep0(self.g,t0,flag))
 * 
 *     def matsolve(self, B):             # <<<<<<<<<<<<<<
 *         """
 *         matsolve(B): Solve the linear system Mx=B for an invertible matrix
 */

  static PyObject *__pyx_pf_7example_3gen_674matsolve(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_B) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matsolve", 0);

    /* "example.pyx":8073
 *             [1/2; 1/2]
 *         """
 *         t0GEN(B)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(gauss(self.g,t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_B); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8074
 *         """
 *         t0GEN(B)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(gauss(self.g,t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8075
 *         t0GEN(B)
 *         sig_on()
 *         return self.new_gen(gauss(self.g,t0))             # <<<<<<<<<<<<<<
 * 
 *     def matker(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gauss(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.matsolve", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_677matker(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_676matker[] = "\n        Return a basis of the kernel of this matrix.\n\n        INPUT:\n\n\n        -  ``flag`` - optional; may be set to 0: default;\n           non-zero: x is known to have integral entries.\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3;4,5,6;7,8,9]').matker()\n            [1; -2; 1]\n\n        With algorithm 1, even if the matrix has integer entries the kernel\n        need not be saturated (which is weird)::\n\n            sage: pari('[1,2,3;4,5,6;7,8,9]').matker(1)\n            [3; -6; 3]\n            sage: pari('matrix(3,3,i,j,i)').matker()\n            [-1, -1; 1, 0; 0, 1]\n            sage: pari('[1,2,3;4,5,6;7,8,9]*Mod(1,2)').matker()\n            [Mod(1, 2); Mod(0, 2); Mod(1, 2)]\n        ";
  static PyObject *__pyx_pw_7example_3gen_677matker(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matker (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matker") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matker", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.matker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_676matker(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8077
 *         return self.new_gen(gauss(self.g,t0))
 * 
 *     def matker(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return a basis of the kernel of this matrix.
 */

  static PyObject *__pyx_pf_7example_3gen_676matker(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matker", 0);

    /* "example.pyx":8103
 *             [Mod(1, 2); Mod(0, 2); Mod(1, 2)]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(matker0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8104
 *         """
 *         sig_on()
 *         return self.new_gen(matker0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matkerint(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, matker0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.matker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_679matkerint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_678matkerint[] = "\n        Return the integer kernel of a matrix.\n\n        This is the LLL-reduced Z-basis of the kernel of the matrix x with\n        integral entries.\n\n        INPUT:\n\n\n        -  ``flag`` - optional, and may be set to 0: default,\n           uses a modified LLL, 1: uses matrixqz.\n\n\n        EXAMPLES::\n\n            sage: pari('[2,1;2,1]').matker()\n            [-1/2; 1]\n            sage: pari('[2,1;2,1]').matkerint()\n            [1; -2]\n            sage: pari('[2,1;2,1]').matkerint(1)\n            [1; -2]\n        ";
  static PyObject *__pyx_pw_7example_3gen_679matkerint(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matkerint (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matkerint") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matkerint", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.matkerint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_678matkerint(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8106
 *         return self.new_gen(matker0(self.g, flag))
 * 
 *     def matkerint(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the integer kernel of a matrix.
 */

  static PyObject *__pyx_pf_7example_3gen_678matkerint(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matkerint", 0);

    /* "example.pyx":8129
 *             [1; -2]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(matkerint0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8130
 *         """
 *         sig_on()
 *         return self.new_gen(matkerint0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matdet(self, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, matkerint0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.matkerint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_681matdet(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_680matdet[] = "\n        Return the determinant of this matrix.\n\n        INPUT:\n\n\n        -  ``flag`` - (optional) flag 0: using Gauss-Bareiss.\n           1: use classical Gaussian elimination (slightly better for integer\n           entries)\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2; 3,4]').matdet(0)\n            -2\n            sage: pari('[1,2; 3,4]').matdet(1)\n            -2\n        ";
  static PyObject *__pyx_pw_7example_3gen_681matdet(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matdet (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matdet") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8132; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8132; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matdet", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8132; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.matdet", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_680matdet(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8132
 *         return self.new_gen(matkerint0(self.g, flag))
 * 
 *     def matdet(self, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the determinant of this matrix.
 */

  static PyObject *__pyx_pf_7example_3gen_680matdet(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matdet", 0);

    /* "example.pyx":8151
 *             -2
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(det0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8152
 *         """
 *         sig_on()
 *         return self.new_gen(det0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def trace(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, det0(__pyx_v_self->g, __pyx_v_flag))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.matdet", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_683trace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_682trace[] = "\n        Return the trace of this PARI object.\n\n        EXAMPLES::\n\n            sage: pari('[1,2; 3,4]').trace()\n            5\n        ";
  static PyObject *__pyx_pw_7example_3gen_683trace(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("trace (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_682trace(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8154
 *         return self.new_gen(det0(self.g, flag))
 * 
 *     def trace(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the trace of this PARI object.
 */

  static PyObject *__pyx_pf_7example_3gen_682trace(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("trace", 0);

    /* "example.pyx":8163
 *             5
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(gtrace(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8164
 *         """
 *         sig_on()
 *         return self.new_gen(gtrace(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def mathnf(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gtrace(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.trace", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_685mathnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_684mathnf[] = "\n        A.mathnf(flag=0): (upper triangular) Hermite normal form of A,\n        basis for the lattice formed by the columns of A.\n\n        INPUT:\n\n\n        -  ``flag`` - optional, value range from 0 to 4 (0 if\n           omitted), meaning : 0: naive algorithm\n\n        -  ``1: Use Batut's algorithm`` - output 2-component\n           vector [H,U] such that H is the HNF of A, and U is a unimodular\n           matrix such that xU=H. 3: Use Batut's algorithm. Output [H,U,P]\n           where P is a permutation matrix such that P A U = H. 4: As 1, using\n           a heuristic variant of LLL reduction along the way.\n\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').mathnf()\n            [6, 1; 3, 1; 0, 1]\n        ";
  static PyObject *__pyx_pw_7example_3gen_685mathnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "mathnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("mathnf", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.mathnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_684mathnf(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8166
 *         return self.new_gen(gtrace(self.g))
 * 
 *     def mathnf(self, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         A.mathnf(flag=0): (upper triangular) Hermite normal form of A,
 */

  static PyObject *__pyx_pf_7example_3gen_684mathnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnf", 0);

    /* "example.pyx":8189
 *             [6, 1; 3, 1; 0, 1]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(mathnf0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8190
 *         """
 *         sig_on()
 *         return self.new_gen(mathnf0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def mathnfmod(self, d):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, mathnf0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.mathnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_687mathnfmod(PyObject *__pyx_v_self, PyObject *__pyx_v_d); /*proto*/
  static char __pyx_doc_7example_3gen_686mathnfmod[] = "\n        Returns the Hermite normal form if d is a multiple of the\n        determinant\n\n        Beware that PARI's concept of a Hermite normal form is an upper\n        triangular matrix with the same column space as the input matrix.\n\n        INPUT:\n\n\n        -  ``d`` - multiple of the determinant of self\n\n\n        EXAMPLES::\n\n                   sage: M=matrix([[1,2,3],[4,5,6],[7,8,11]])\n            sage: d=M.det()\n            sage: pari(M).mathnfmod(d)\n                   [6, 4, 3; 0, 1, 0; 0, 0, 1]\n\n        Note that d really needs to be a multiple of the discriminant, not\n        just of the exponent of the cokernel::\n\n                   sage: M=matrix([[1,0,0],[0,2,0],[0,0,6]])\n            sage: pari(M).mathnfmod(6)\n            [1, 0, 0; 0, 1, 0; 0, 0, 6]\n            sage: pari(M).mathnfmod(12)\n            [1, 0, 0; 0, 2, 0; 0, 0, 6]\n        ";
  static PyObject *__pyx_pw_7example_3gen_687mathnfmod(PyObject *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnfmod (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_686mathnfmod(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_d));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8192
 *         return self.new_gen(mathnf0(self.g, flag))
 * 
 *     def mathnfmod(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite normal form if d is a multiple of the
 */

  static PyObject *__pyx_pf_7example_3gen_686mathnfmod(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnfmod", 0);

    /* "example.pyx":8222
 *             [1, 0, 0; 0, 2, 0; 0, 0, 6]
 *         """
 *         t0GEN(d)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(hnfmod(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_d); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8223
 *         """
 *         t0GEN(d)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(hnfmod(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8224
 *         t0GEN(d)
 *         sig_on()
 *         return self.new_gen(hnfmod(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def mathnfmodid(self, d):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, hnfmod(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.mathnfmod", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_689mathnfmodid(PyObject *__pyx_v_self, PyObject *__pyx_v_d); /*proto*/
  static char __pyx_doc_7example_3gen_688mathnfmodid[] = "\n        Returns the Hermite Normal Form of M concatenated with d\\*Identity\n\n        Beware that PARI's concept of a Hermite normal form is a maximal\n        rank upper triangular matrix with the same column space as the\n        input matrix.\n\n        INPUT:\n\n\n        -  ``d`` - Determines\n\n\n        EXAMPLES::\n\n                   sage: M=matrix([[1,0,0],[0,2,0],[0,0,6]])\n            sage: pari(M).mathnfmodid(6)\n                   [1, 0, 0; 0, 2, 0; 0, 0, 6]\n\n        This routine is not completely equivalent to mathnfmod::\n\n            sage: pari(M).mathnfmod(6)\n            [1, 0, 0; 0, 1, 0; 0, 0, 6]\n        ";
  static PyObject *__pyx_pw_7example_3gen_689mathnfmodid(PyObject *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("mathnfmodid (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_688mathnfmodid(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_d));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8226
 *         return self.new_gen(hnfmod(self.g, t0))
 * 
 *     def mathnfmodid(self, d):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the Hermite Normal Form of M concatenated with d\*Identity
 */

  static PyObject *__pyx_pf_7example_3gen_688mathnfmodid(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("mathnfmodid", 0);

    /* "example.pyx":8251
 *             [1, 0, 0; 0, 1, 0; 0, 0, 6]
 *         """
 *         t0GEN(d)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(hnfmodid(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_d); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8252
 *         """
 *         t0GEN(d)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(hnfmodid(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8253
 *         t0GEN(d)
 *         sig_on()
 *         return self.new_gen(hnfmodid(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def matsnf(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, hnfmodid(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.mathnfmodid", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_691matsnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_690matsnf[] = "\n        x.matsnf(flag=0): Smith normal form (i.e. elementary divisors) of\n        the matrix x, expressed as a vector d. Binary digits of flag mean\n        1: returns [u,v,d] where d=u\\*x\\*v, otherwise only the diagonal d\n        is returned, 2: allow polynomial entries, otherwise assume x is\n        integral, 4: removes all information corresponding to entries equal\n        to 1 in d.\n\n        EXAMPLES::\n\n            sage: pari('[1,2,3; 4,5,6;  7,8,9]').matsnf()\n            [0, 3, 1]\n        ";
  static PyObject *__pyx_pw_7example_3gen_691matsnf(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matsnf (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matsnf") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8255; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matsnf", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8255; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.matsnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_690matsnf(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8255
 *         return self.new_gen(hnfmodid(self.g, t0))
 * 
 *     def matsnf(self, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         x.matsnf(flag=0): Smith normal form (i.e. elementary divisors) of
 */

  static PyObject *__pyx_pf_7example_3gen_690matsnf(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matsnf", 0);

    /* "example.pyx":8269
 *             [0, 3, 1]
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(matsnf0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8270
 *         """
 *         sig_on()
 *         return self.new_gen(matsnf0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def matfrobenius(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, matsnf0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.matsnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_693matfrobenius(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_692matfrobenius[] = "\n        M.matfrobenius(flag=0): Return the Frobenius form of the square\n        matrix M. If flag is 1, return only the elementary divisors (a list\n        of polynomials). If flag is 2, return a two-components vector [F,B]\n        where F is the Frobenius form and B is the basis change so that\n        `M=B^{-1} F B`.\n\n        EXAMPLES::\n\n            sage: a = pari('[1,2;3,4]')\n            sage: a.matfrobenius()\n            [0, 2; 1, 5]\n            sage: a.matfrobenius(flag=1)\n            [x^2 - 5*x - 2]\n            sage: a.matfrobenius(2)\n            [[0, 2; 1, 5], [1, -1/3; 0, 1/3]]\n            sage: v = a.matfrobenius(2)\n            sage: v[0]\n            [0, 2; 1, 5]\n            sage: v[1]^(-1)*v[0]*v[1]\n            [1, 2; 3, 4]\n\n        We let t be the matrix of `T_2` acting on modular symbols\n        of level 43, which was computed using\n        ``ModularSymbols(43,sign=1).T(2).matrix()``::\n\n            sage: t = pari('[3, -2, 0, 0; 0, -2, 0, 1; 0, -1, -2, 2; 0, -2, 0, 2]')\n            sage: t.matfrobenius()\n            [0, 0, 0, -12; 1, 0, 0, -2; 0, 1, 0, 8; 0, 0, 1, 1]\n            sage: t.charpoly('x')\n            x^4 - x^3 - 8*x^2 + 2*x + 12\n            sage: t.matfrobenius(1)\n            [x^4 - x^3 - 8*x^2 + 2*x + 12]\n\n        AUTHORS:\n\n        - Martin Albrect (2006-04-02)\n        ";
  static PyObject *__pyx_pw_7example_3gen_693matfrobenius(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matfrobenius (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matfrobenius") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matfrobenius", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8272; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.matfrobenius", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_692matfrobenius(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8272
 *         return self.new_gen(matsnf0(self.g, flag))
 * 
 *     def matfrobenius(self, flag=0):             # <<<<<<<<<<<<<<
 *         r"""
 *         M.matfrobenius(flag=0): Return the Frobenius form of the square
 */

  static PyObject *__pyx_pf_7example_3gen_692matfrobenius(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matfrobenius", 0);

    /* "example.pyx":8311
 *         - Martin Albrect (2006-04-02)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(matfrobenius(self.g, flag, 0))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8312
 *         """
 *         sig_on()
 *         return self.new_gen(matfrobenius(self.g, flag, 0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, matfrobenius(__pyx_v_self->g, __pyx_t_2, 0))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.matfrobenius", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_695factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_694factor[] = "\n        Return the factorization of x.\n\n        INPUT:\n\n\n        -  ``limit`` - (default: -1) is optional and can be set\n           whenever x is of (possibly recursive) rational type. If limit is\n           set return partial factorization, using primes up to limit (up to\n           primelimit if limit=0).\n\n\n        proof - (default: True) optional. If False (not the default),\n        returned factors `<10^{15}` may only be pseudoprimes.\n\n        .. note::\n\n           In the standard PARI/GP interpreter and C-library the\n           factor command *always* has proof=False, so beware!\n\n        EXAMPLES::\n\n            sage: pari('x^10-1').factor()\n            [x - 1, 1; x + 1, 1; x^4 - x^3 + x^2 - x + 1, 1; x^4 + x^3 + x^2 + x + 1, 1]\n            sage: pari(2^100-1).factor()\n            [3, 1; 5, 3; 11, 1; 31, 1; 41, 1; 101, 1; 251, 1; 601, 1; 1801, 1; 4051, 1; 8101, 1; 268501, 1]\n            sage: pari(2^100-1).factor(proof=False)\n            [3, 1; 5, 3; 11, 1; 31, 1; 41, 1; 101, 1; 251, 1; 601, 1; 1801, 1; 4051, 1; 8101, 1; 268501, 1]\n\n        We illustrate setting a limit::\n\n            sage: pari(next_prime(10^50)*next_prime(10^60)*next_prime(10^4)).factor(10^5)\n            [10007, 1; 100000000000000000000000000000000000000000000000151000000000700000000000000000000000000000000000000000000001057, 1]\n\n        PARI doesn't have an algorithm for factoring multivariate\n        polynomials::\n\n            sage: pari('x^3 - y^3').factor()\n            Traceback (most recent call last):\n            ...\n            PariError:  (7)\n        ";
  static PyObject *__pyx_pw_7example_3gen_695factor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_limit = 0;
    CYTHON_UNUSED int __pyx_v_proof;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factor (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__limit,&__pyx_n_s__proof,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__limit);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__proof);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "factor") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8318; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_limit = values[0];
      if (values[1]) {
        __pyx_v_proof = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_proof == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8318; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_proof = ((int)1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("factor", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8318; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_694factor(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_limit, __pyx_v_proof);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8318
 *     # polarit2.c
 *     ###########################################
 *     def factor(gen self, limit=-1, bint proof=1):             # <<<<<<<<<<<<<<
 *         """
 *         Return the factorization of x.
 */

  static PyObject *__pyx_pf_7example_3gen_694factor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_limit, CYTHON_UNUSED int __pyx_v_proof) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factor", 0);

    /* "example.pyx":8370
 *         #     else:
 *         #         return _factor_int_when_pari_factor_failed(self, z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(factor0(self.g, limit))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8371
 *         #         return _factor_int_when_pari_factor_failed(self, z)
 *         sig_on()
 *         return P.new_gen(factor0(self.g, limit))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_limit); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, factor0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.factor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_697hilbert(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_697hilbert(PyObject *__pyx_v_x, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_p = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("hilbert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__p,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__p)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("hilbert", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8378; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hilbert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8378; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_y = values[0];
      __pyx_v_p = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("hilbert", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8378; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.hilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_696hilbert(((struct __pyx_obj_7example_gen *)__pyx_v_x), __pyx_v_y, __pyx_v_p);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8378
 *     ###########################################
 * 
 *     def hilbert(x, y, p):             # <<<<<<<<<<<<<<
 *         cdef long ret
 *         t0GEN(y)
 */

  static PyObject *__pyx_pf_7example_3gen_696hilbert(struct __pyx_obj_7example_gen *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_p) {
    long __pyx_v_ret;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("hilbert", 0);

    /* "example.pyx":8380
 *     def hilbert(x, y, p):
 *         cdef long ret
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         t1GEN(p)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8381
 *         cdef long ret
 *         t0GEN(y)
 *         t1GEN(p)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         ret = hilbert0(x.g, t0, t1)
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_p); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8382
 *         t0GEN(y)
 *         t1GEN(p)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         ret = hilbert0(x.g, t0, t1)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8383
 *         t1GEN(p)
 *         sig_on()
 *         ret = hilbert0(x.g, t0, t1)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return ret
 */
    __pyx_v_ret = hilbert(__pyx_v_x->g, __pyx_v_7example_t0, __pyx_v_7example_t1);

    /* "example.pyx":8384
 *         sig_on()
 *         ret = hilbert0(x.g, t0, t1)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return ret
 * 
 */
    _pari_sig_off();

    /* "example.pyx":8385
 *         ret = hilbert0(x.g, t0, t1)
 *         sig_off()
 *         return ret             # <<<<<<<<<<<<<<
 * 
 *     def chinese(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(__pyx_v_ret); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.hilbert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_699chinese(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_699chinese(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("chinese (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_698chinese(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8387
 *         return ret
 * 
 *     def chinese(self, y):             # <<<<<<<<<<<<<<
 *         t0GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_698chinese(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("chinese", 0);

    /* "example.pyx":8388
 * 
 *     def chinese(self, y):
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(chinese(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8389
 *     def chinese(self, y):
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(chinese(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8390
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(chinese(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def order(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, chinese(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.chinese", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_701order(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_701order(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("order (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_700order(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8392
 *         return P.new_gen(chinese(self.g, t0))
 * 
 *     def order(self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(order(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_700order(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("order", 0);

    /* "example.pyx":8393
 * 
 *     def order(self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(order(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8394
 *     def order(self):
 *         sig_on()
 *         return P.new_gen(order(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def znprimroot(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, order(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.order", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_703znprimroot(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_702znprimroot[] = "\n        Return a primitive root modulo self, whenever it exists.\n\n        This is a generator of the group `(\\ZZ/n\\ZZ)^*`, whenever\n        this group is cyclic, i.e. if `n=4` or `n=p^k` or\n        `n=2p^k`, where `p` is an odd prime and `k`\n        is a natural number.\n\n        INPUT:\n\n\n        -  ``self`` - positive integer equal to 4, or a power\n           of an odd prime, or twice a power of an odd prime\n\n\n        OUTPUT: gen\n\n        EXAMPLES::\n\n            sage: pari(4).znprimroot()\n            Mod(3, 4)\n            sage: pari(10007^3).znprimroot()\n            Mod(5, 1002101470343)\n            sage: pari(2*109^10).znprimroot()\n            Mod(236736367459211723407, 473472734918423446802)\n        ";
  static PyObject *__pyx_pw_7example_3gen_703znprimroot(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("znprimroot (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_702znprimroot(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8396
 *         return P.new_gen(order(self.g))
 * 
 *     def znprimroot(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return a primitive root modulo self, whenever it exists.
 */

  static PyObject *__pyx_pf_7example_3gen_702znprimroot(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("znprimroot", 0);

    /* "example.pyx":8423
 *             Mod(236736367459211723407, 473472734918423446802)
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(znprimroot0(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8424
 *         """
 *         sig_on()
 *         return P.new_gen(znprimroot0(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def __abs__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, znprimroot0(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.znprimroot", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_705__abs__(PyObject *__pyx_v_self); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_705__abs__(PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__abs__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_704__abs__(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8426
 *         return P.new_gen(znprimroot0(self.g))
 * 
 *     def __abs__(self):             # <<<<<<<<<<<<<<
 *         return self.abs()
 * 
 */

  static PyObject *__pyx_pf_7example_3gen_704__abs__(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__abs__", 0);

    /* "example.pyx":8427
 * 
 *     def __abs__(self):
 *         return self.abs()             # <<<<<<<<<<<<<<
 * 
 *     def norm(gen self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__abs); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.__abs__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_707norm(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_707norm(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("norm (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_706norm(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8429
 *         return self.abs()
 * 
 *     def norm(gen self):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gnorm(self.g))
 */

  static PyObject *__pyx_pf_7example_3gen_706norm(struct __pyx_obj_7example_gen *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("norm", 0);

    /* "example.pyx":8430
 * 
 *     def norm(gen self):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gnorm(self.g))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8430; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8431
 *     def norm(gen self):
 *         sig_on()
 *         return P.new_gen(gnorm(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def nextprime(gen self, bint add_one=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gnorm(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_709nextprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_708nextprime[] = "\n        nextprime(x): smallest pseudoprime greater than or equal to `x`.\n        If ``add_one`` is non-zero, return the smallest pseudoprime\n        strictly greater than `x`.\n\n        EXAMPLES::\n\n            sage: pari(1).nextprime()\n            2\n            sage: pari(2).nextprime()\n            2\n            sage: pari(2).nextprime(add_one = 1)\n            3\n            sage: pari(2^100).nextprime()\n            1267650600228229401496703205653\n        ";
  static PyObject *__pyx_pw_7example_3gen_709nextprime(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    int __pyx_v_add_one;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nextprime (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__add_one,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__add_one);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "nextprime") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8433; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_add_one = __Pyx_PyObject_IsTrue(values[0]); if (unlikely((__pyx_v_add_one == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8433; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_add_one = ((int)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("nextprime", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8433; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.nextprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_708nextprime(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_add_one);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8433
 *         return P.new_gen(gnorm(self.g))
 * 
 *     def nextprime(gen self, bint add_one=0):             # <<<<<<<<<<<<<<
 *         """
 *         nextprime(x): smallest pseudoprime greater than or equal to `x`.
 */

  static PyObject *__pyx_pf_7example_3gen_708nextprime(struct __pyx_obj_7example_gen *__pyx_v_self, int __pyx_v_add_one) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nextprime", 0);

    /* "example.pyx":8450
 *             1267650600228229401496703205653
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if add_one:
 *             return P.new_gen(gnextprime(gaddsg(1,self.g)))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8451
 *         """
 *         sig_on()
 *         if add_one:             # <<<<<<<<<<<<<<
 *             return P.new_gen(gnextprime(gaddsg(1,self.g)))
 *         return P.new_gen(gnextprime(self.g))
 */
    if (__pyx_v_add_one) {

      /* "example.pyx":8452
 *         sig_on()
 *         if add_one:
 *             return P.new_gen(gnextprime(gaddsg(1,self.g)))             # <<<<<<<<<<<<<<
 *         return P.new_gen(gnextprime(self.g))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gnextprime(gaddsg(1, __pyx_v_self->g)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8452; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":8453
 *         if add_one:
 *             return P.new_gen(gnextprime(gaddsg(1,self.g)))
 *         return P.new_gen(gnextprime(self.g))             # <<<<<<<<<<<<<<
 * 
 *     def change_variable_name(self, var):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gnextprime(__pyx_v_self->g))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.nextprime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_711change_variable_name(PyObject *__pyx_v_self, PyObject *__pyx_v_var); /*proto*/
  static char __pyx_doc_7example_3gen_710change_variable_name[] = "\n        In ``self``, which must be a ``t_POL`` or ``t_SER``, set the\n        variable to ``var``.  If the variable of ``self`` is already\n        ``var``, then return ``self``.\n\n        .. WARNING::\n\n            You should be careful with variable priorities when\n            applying this on a polynomial or series of which the\n            coefficients have polynomial components.  To be safe, only\n            use this function on polynomials with integer or rational\n            coefficients.  For a safer alternative, use :meth:`subst`.\n\n        EXAMPLES::\n\n            sage: f = pari('x^3 + 17*x + 3')\n            sage: f.change_variable_name(\"y\")\n            y^3 + 17*y + 3\n            sage: f = pari('1 + 2*y + O(y^10)')\n            sage: f.change_variable_name(\"q\")\n            1 + 2*q + O(q^10)\n            sage: f.change_variable_name(\"y\") is f\n            True\n\n        In PARI, ``I`` refers to the square root of -1, so it cannot be\n        used as variable name.  Note the difference with :meth:`subst`::\n\n            sage: f = pari('x^2 + 1')\n            sage: f.change_variable_name(\"I\")\n            Traceback (most recent call last):\n            ...\n            PariError:  (5)\n            sage: f.subst(\"x\", \"I\")\n            0\n        ";
  static PyObject *__pyx_pw_7example_3gen_711change_variable_name(PyObject *__pyx_v_self, PyObject *__pyx_v_var) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("change_variable_name (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_710change_variable_name(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_var));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8455
 *         return P.new_gen(gnextprime(self.g))
 * 
 *     def change_variable_name(self, var):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, which must be a ``t_POL`` or ``t_SER``, set the
 */

  static PyObject *__pyx_pf_7example_3gen_710change_variable_name(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var) {
    long __pyx_v_n;
    struct __pyx_obj_7example_gen *__pyx_v_newg = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("change_variable_name", 0);

    /* "example.pyx":8491
 *             0
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef long n = P.get_var(var)
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8492
 *         """
 *         sig_on()
 *         cdef long n = P.get_var(var)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         if varn(self.g) == n:
 */
    __pyx_v_n = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_var);

    /* "example.pyx":8493
 *         sig_on()
 *         cdef long n = P.get_var(var)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         if varn(self.g) == n:
 *             return self
 */
    _pari_sig_off();

    /* "example.pyx":8494
 *         cdef long n = P.get_var(var)
 *         sig_off()
 *         if varn(self.g) == n:             # <<<<<<<<<<<<<<
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 */
    __pyx_t_2 = (varn(__pyx_v_self->g) == __pyx_v_n);
    if (__pyx_t_2) {

      /* "example.pyx":8495
 *         sig_off()
 *         if varn(self.g) == n:
 *             return self             # <<<<<<<<<<<<<<
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_self));
      __pyx_r = ((PyObject *)__pyx_v_self);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":8496
 *         if varn(self.g) == n:
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:             # <<<<<<<<<<<<<<
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 *         # Copy self and then change the variable in place
 */
    __pyx_t_2 = (typ(__pyx_v_self->g) != t_POL);
    if (__pyx_t_2) {
      __pyx_t_3 = (typ(__pyx_v_self->g) != t_SER);
      __pyx_t_4 = __pyx_t_3;
    } else {
      __pyx_t_4 = __pyx_t_2;
    }
    if (__pyx_t_4) {

      /* "example.pyx":8497
 *             return self
 *         if typ(self.g) != t_POL and typ(self.g) != t_SER:
 *             raise TypeError, "set_variable() only works for polynomials or power series"             # <<<<<<<<<<<<<<
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)
 */
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_52), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":8499
 *             raise TypeError, "set_variable() only works for polynomials or power series"
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)             # <<<<<<<<<<<<<<
 *         setvarn(newg.g, n)
 *         return newg
 */
    __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, __pyx_v_self->g)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_v_newg = ((struct __pyx_obj_7example_gen *)__pyx_t_5);
    __pyx_t_5 = 0;

    /* "example.pyx":8500
 *         # Copy self and then change the variable in place
 *         cdef gen newg = P.new_gen_noclear(self.g)
 *         setvarn(newg.g, n)             # <<<<<<<<<<<<<<
 *         return newg
 * 
 */
    setvarn(__pyx_v_newg->g, __pyx_v_n);

    /* "example.pyx":8501
 *         cdef gen newg = P.new_gen_noclear(self.g)
 *         setvarn(newg.g, n)
 *         return newg             # <<<<<<<<<<<<<<
 * 
 *     def subst(self, var, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_newg));
    __pyx_r = ((PyObject *)__pyx_v_newg);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.gen.change_variable_name", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_newg);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_713subst(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_712subst[] = "\n        In ``self``, replace the variable ``var`` by the expression `z`.\n\n        EXAMPLES::\n\n            sage: x = pari(\"x\"); y = pari(\"y\")\n            sage: f = pari('x^3 + 17*x + 3')\n            sage: f.subst(x, y)\n            y^3 + 17*y + 3\n            sage: f.subst(x, \"z\")\n            z^3 + 17*z + 3\n            sage: f.subst(x, \"z\")^2\n            z^6 + 34*z^4 + 6*z^3 + 289*z^2 + 102*z + 9\n            sage: f.subst(x, \"x+1\")\n            x^3 + 3*x^2 + 20*x + 21\n            sage: f.subst(x, \"xyz\")\n            xyz^3 + 17*xyz + 3\n            sage: f.subst(x, \"xyz\")^2\n            xyz^6 + 34*xyz^4 + 6*xyz^3 + 289*xyz^2 + 102*xyz + 9\n        ";
  static PyObject *__pyx_pw_7example_3gen_713subst(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("subst (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__var,&__pyx_n_s__z,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("subst", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "subst") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_var = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("subst", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8503; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_712subst(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_var, __pyx_v_z);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8503
 *         return newg
 * 
 *     def subst(self, var, z):             # <<<<<<<<<<<<<<
 *         """
 *         In ``self``, replace the variable ``var`` by the expression `z`.
 */

  static PyObject *__pyx_pf_7example_3gen_712subst(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_z) {
    long __pyx_v_n;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("subst", 0);

    /* "example.pyx":8525
 *         """
 *         cdef long n
 *         n = P.get_var(var)             # <<<<<<<<<<<<<<
 *         t0GEN(z)
 *         sig_on()
 */
    __pyx_v_n = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_var);

    /* "example.pyx":8526
 *         cdef long n
 *         n = P.get_var(var)
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gsubst(self.g, n, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8527
 *         n = P.get_var(var)
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubst(self.g, n, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8528
 *         t0GEN(z)
 *         sig_on()
 *         return P.new_gen(gsubst(self.g, n, t0))             # <<<<<<<<<<<<<<
 * 
 *     def substpol(self, y, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsubst(__pyx_v_self->g, __pyx_v_n, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_715substpol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_715substpol(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_y = 0;
    PyObject *__pyx_v_z = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("substpol (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__y,&__pyx_n_s__z,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__y)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("substpol", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8530; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "substpol") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8530; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_y = values[0];
      __pyx_v_z = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("substpol", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8530; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.substpol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_714substpol(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_y, __pyx_v_z);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8530
 *         return P.new_gen(gsubst(self.g, n, t0))
 * 
 *     def substpol(self, y, z):             # <<<<<<<<<<<<<<
 *         t0GEN(y)
 *         t1GEN(z)
 */

  static PyObject *__pyx_pf_7example_3gen_714substpol(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("substpol", 0);

    /* "example.pyx":8531
 * 
 *     def substpol(self, y, z):
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         t1GEN(z)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8532
 *     def substpol(self, y, z):
 *         t0GEN(y)
 *         t1GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(gsubstpol(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8533
 *         t0GEN(y)
 *         t1GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(gsubstpol(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8534
 *         t1GEN(z)
 *         sig_on()
 *         return self.new_gen(gsubstpol(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def nf_subst(self, z):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gsubstpol(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8534; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.substpol", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_717nf_subst(PyObject *__pyx_v_self, PyObject *__pyx_v_z); /*proto*/
  static char __pyx_doc_7example_3gen_716nf_subst[] = "\n        Given a PARI number field ``self``, return the same PARI\n        number field but in the variable ``z``.\n\n        INPUT:\n\n        - ``self`` -- A PARI number field being the output of ``nfinit()``,\n                      ``bnfinit()`` or ``bnrinit()``.\n\n        EXAMPLES::\n\n            sage: x = polygen(QQ)\n            sage: K = NumberField(x^2 + 5, 'a')\n\n        We can substitute in a PARI ``nf`` structure::\n\n            sage: Kpari = K.pari_nf()\n            sage: Kpari.nf_get_pol()\n            y^2 + 5\n            sage: Lpari = Kpari.nf_subst('a')\n            sage: Lpari.nf_get_pol()\n            a^2 + 5\n\n        We can also substitute in a PARI ``bnf`` structure::\n\n            sage: Kpari = K.pari_bnf()\n            sage: Kpari.nf_get_pol()\n            y^2 + 5\n            sage: Kpari.bnf_get_cyc()  # Structure of class group\n            [2]\n            sage: Lpari = Kpari.nf_subst('a')\n            sage: Lpari.nf_get_pol()\n            a^2 + 5\n            sage: Lpari.bnf_get_cyc()  # We still have a bnf after substituting\n            [2]\n        ";
  static PyObject *__pyx_pw_7example_3gen_717nf_subst(PyObject *__pyx_v_self, PyObject *__pyx_v_z) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nf_subst (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_716nf_subst(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_z));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8536
 *         return self.new_gen(gsubstpol(self.g, t0, t1))
 * 
 *     def nf_subst(self, z):             # <<<<<<<<<<<<<<
 *         """
 *         Given a PARI number field ``self``, return the same PARI
 */

  static PyObject *__pyx_pf_7example_3gen_716nf_subst(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z) {
    GEN __pyx_v_nf;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    GEN __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nf_subst", 0);

    /* "example.pyx":8573
 *             [2]
 *         """
 *         cdef GEN nf = self.get_nf()             # <<<<<<<<<<<<<<
 *         t0GEN(z)
 *         sig_on()
 */
    __pyx_t_1 = ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_nf(__pyx_v_self); if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_nf = __pyx_t_1;

    /* "example.pyx":8574
 *         """
 *         cdef GEN nf = self.get_nf()
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gsubst(self.g, nf_get_varn(nf), t0))
 */
    __pyx_t_2 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":8575
 *         cdef GEN nf = self.get_nf()
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gsubst(self.g, nf_get_varn(nf), t0))
 * 
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8575; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8576
 *         t0GEN(z)
 *         sig_on()
 *         return P.new_gen(gsubst(self.g, nf_get_varn(nf), t0))             # <<<<<<<<<<<<<<
 * 
 *     def taylor(self, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gsubst(__pyx_v_self->g, nf_get_varn(__pyx_v_nf), __pyx_v_7example_t0))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8576; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.nf_subst", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_719taylor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_719taylor(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("taylor (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__v,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "taylor") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_v = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("taylor", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8578; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.taylor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_718taylor(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8578
 *         return P.new_gen(gsubst(self.g, nf_get_varn(nf), t0))
 * 
 *     def taylor(self, v=-1):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(tayl(self.g, self.get_var(v), precdl))
 */

  static PyObject *__pyx_pf_7example_3gen_718taylor(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("taylor", 0);

    /* "example.pyx":8579
 * 
 *     def taylor(self, v=-1):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(tayl(self.g, self.get_var(v), precdl))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8580
 *     def taylor(self, v=-1):
 *         sig_on()
 *         return self.new_gen(tayl(self.g, self.get_var(v), precdl))             # <<<<<<<<<<<<<<
 * 
 *     def thue(self, rhs, ne):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, tayl(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v), precdl))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.taylor", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_721thue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_721thue(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_rhs = 0;
    PyObject *__pyx_v_ne = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("thue (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__rhs,&__pyx_n_s__ne,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__rhs)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__ne)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("thue", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8582; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "thue") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8582; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_rhs = values[0];
      __pyx_v_ne = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("thue", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8582; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.thue", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_720thue(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_rhs, __pyx_v_ne);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8582
 *         return self.new_gen(tayl(self.g, self.get_var(v), precdl))
 * 
 *     def thue(self, rhs, ne):             # <<<<<<<<<<<<<<
 *         t0GEN(rhs)
 *         t1GEN(ne)
 */

  static PyObject *__pyx_pf_7example_3gen_720thue(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_rhs, PyObject *__pyx_v_ne) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("thue", 0);

    /* "example.pyx":8583
 * 
 *     def thue(self, rhs, ne):
 *         t0GEN(rhs)             # <<<<<<<<<<<<<<
 *         t1GEN(ne)
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_rhs); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8584
 *     def thue(self, rhs, ne):
 *         t0GEN(rhs)
 *         t1GEN(ne)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(thue(self.g, t0, t1))
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_ne); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8585
 *         t0GEN(rhs)
 *         t1GEN(ne)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(thue(self.g, t0, t1))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8586
 *         t1GEN(ne)
 *         sig_on()
 *         return self.new_gen(thue(self.g, t0, t1))             # <<<<<<<<<<<<<<
 * 
 *     def charpoly(self, var=-1, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, thue(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.thue", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_723charpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_722charpoly[] = "\n        charpoly(A,v=x,flag=0): det(v\\*Id-A) = characteristic polynomial of\n        A using the comatrix. flag is optional and may be set to 1 (use\n        Lagrange interpolation) or 2 (use Hessenberg form), 0 being the\n        default.\n        ";
  static PyObject *__pyx_pw_7example_3gen_723charpoly(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_var = 0;
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("charpoly (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__var,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_neg_1);
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__var);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "charpoly") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8588; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_var = values[0];
      __pyx_v_flag = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("charpoly", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8588; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.charpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_722charpoly(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_var, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8588
 *         return self.new_gen(thue(self.g, t0, t1))
 * 
 *     def charpoly(self, var=-1, flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         charpoly(A,v=x,flag=0): det(v\*Id-A) = characteristic polynomial of
 */

  static PyObject *__pyx_pf_7example_3gen_722charpoly(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_var, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("charpoly", 0);

    /* "example.pyx":8595
 *         default.
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(charpoly0(self.g, P.get_var(var), flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8596
 *         """
 *         sig_on()
 *         return P.new_gen(charpoly0(self.g, P.get_var(var), flag))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, charpoly0(__pyx_v_self->g, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_var), __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8596; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.charpoly", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_725kronecker(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_725kronecker(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("kronecker (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_724kronecker(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8599
 * 
 * 
 *     def kronecker(gen self, y):             # <<<<<<<<<<<<<<
 *         t0GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_724kronecker(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("kronecker", 0);

    /* "example.pyx":8600
 * 
 *     def kronecker(gen self, y):
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return P.new_gen(gkronecker(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8601
 *     def kronecker(gen self, y):
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return P.new_gen(gkronecker(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8602
 *         t0GEN(y)
 *         sig_on()
 *         return P.new_gen(gkronecker(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, gkronecker(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.kronecker", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_727type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_3gen_726type[] = "\n        Return the Pari type of self as a string.\n\n        .. note::\n\n           In Cython, it is much faster to simply use typ(self.g) for\n           checking Pari types.\n\n        EXAMPLES::\n\n            sage: pari(7).type()\n            't_INT'\n            sage: pari('x').type()\n            't_POL'\n        ";
  static PyObject *__pyx_pw_7example_3gen_727type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("type (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_726type(((struct __pyx_obj_7example_gen *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8605
 * 
 * 
 *     def type(gen self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the Pari type of self as a string.
 */

  static PyObject *__pyx_pf_7example_3gen_726type(struct __pyx_obj_7example_gen *__pyx_v_self) {
    long __pyx_v_t;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("type", 0);

    /* "example.pyx":8636
 *         # need to be updated accordingly.
 *         #
 *         cdef long t = typ(self.g)             # <<<<<<<<<<<<<<
 * 
 *         if   t == t_INT:      return 't_INT'
 */
    __pyx_v_t = typ(__pyx_v_self->g);

    /* "example.pyx":8638
 *         cdef long t = typ(self.g)
 * 
 *         if   t == t_INT:      return 't_INT'             # <<<<<<<<<<<<<<
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'
 */
    __pyx_t_1 = (__pyx_v_t == t_INT);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_INT));
      __pyx_r = ((PyObject *)__pyx_n_s__t_INT);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8639
 * 
 *         if   t == t_INT:      return 't_INT'
 *         elif t == t_REAL:     return 't_REAL'             # <<<<<<<<<<<<<<
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'
 */
    __pyx_t_1 = (__pyx_v_t == t_REAL);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_REAL));
      __pyx_r = ((PyObject *)__pyx_n_s__t_REAL);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8640
 *         if   t == t_INT:      return 't_INT'
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'             # <<<<<<<<<<<<<<
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'
 */
    __pyx_t_1 = (__pyx_v_t == t_INTMOD);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_INTMOD));
      __pyx_r = ((PyObject *)__pyx_n_s__t_INTMOD);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8641
 *         elif t == t_REAL:     return 't_REAL'
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'             # <<<<<<<<<<<<<<
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 */
    __pyx_t_1 = (__pyx_v_t == t_FRAC);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_FRAC));
      __pyx_r = ((PyObject *)__pyx_n_s__t_FRAC);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8642
 *         elif t == t_INTMOD:   return 't_INTMOD'
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'             # <<<<<<<<<<<<<<
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'
 */
    __pyx_t_1 = (__pyx_v_t == t_FFELT);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_FFELT));
      __pyx_r = ((PyObject *)__pyx_n_s__t_FFELT);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8643
 *         elif t == t_FRAC:     return 't_FRAC'
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'             # <<<<<<<<<<<<<<
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'
 */
    __pyx_t_1 = (__pyx_v_t == t_COMPLEX);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_COMPLEX));
      __pyx_r = ((PyObject *)__pyx_n_s__t_COMPLEX);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8644
 *         elif t == t_FFELT:    return 't_FFELT'
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'             # <<<<<<<<<<<<<<
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'
 */
    __pyx_t_1 = (__pyx_v_t == t_PADIC);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_PADIC));
      __pyx_r = ((PyObject *)__pyx_n_s__t_PADIC);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8645
 *         elif t == t_COMPLEX:  return 't_COMPLEX'
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'             # <<<<<<<<<<<<<<
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'
 */
    __pyx_t_1 = (__pyx_v_t == t_QUAD);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_QUAD));
      __pyx_r = ((PyObject *)__pyx_n_s__t_QUAD);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8646
 *         elif t == t_PADIC:    return 't_PADIC'
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'             # <<<<<<<<<<<<<<
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'
 */
    __pyx_t_1 = (__pyx_v_t == t_POLMOD);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_POLMOD));
      __pyx_r = ((PyObject *)__pyx_n_s__t_POLMOD);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8647
 *         elif t == t_QUAD:     return 't_QUAD'
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'             # <<<<<<<<<<<<<<
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'
 */
    __pyx_t_1 = (__pyx_v_t == t_POL);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_POL));
      __pyx_r = ((PyObject *)__pyx_n_s__t_POL);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8648
 *         elif t == t_POLMOD:   return 't_POLMOD'
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'             # <<<<<<<<<<<<<<
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'
 */
    __pyx_t_1 = (__pyx_v_t == t_SER);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_SER));
      __pyx_r = ((PyObject *)__pyx_n_s__t_SER);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8649
 *         elif t == t_POL:      return 't_POL'
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'             # <<<<<<<<<<<<<<
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'
 */
    __pyx_t_1 = (__pyx_v_t == t_RFRAC);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_RFRAC));
      __pyx_r = ((PyObject *)__pyx_n_s__t_RFRAC);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8650
 *         elif t == t_SER:      return 't_SER'
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'             # <<<<<<<<<<<<<<
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'
 */
    __pyx_t_1 = (__pyx_v_t == t_QFR);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_QFR));
      __pyx_r = ((PyObject *)__pyx_n_s__t_QFR);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8651
 *         elif t == t_RFRAC:    return 't_RFRAC'
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'             # <<<<<<<<<<<<<<
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'
 */
    __pyx_t_1 = (__pyx_v_t == t_QFI);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_QFI));
      __pyx_r = ((PyObject *)__pyx_n_s__t_QFI);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8652
 *         elif t == t_QFR:      return 't_QFR'
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'             # <<<<<<<<<<<<<<
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'
 */
    __pyx_t_1 = (__pyx_v_t == t_VEC);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_VEC));
      __pyx_r = ((PyObject *)__pyx_n_s__t_VEC);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8653
 *         elif t == t_QFI:      return 't_QFI'
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'             # <<<<<<<<<<<<<<
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'
 */
    __pyx_t_1 = (__pyx_v_t == t_COL);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_COL));
      __pyx_r = ((PyObject *)__pyx_n_s__t_COL);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8654
 *         elif t == t_VEC:      return 't_VEC'
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'             # <<<<<<<<<<<<<<
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'
 */
    __pyx_t_1 = (__pyx_v_t == t_MAT);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_MAT));
      __pyx_r = ((PyObject *)__pyx_n_s__t_MAT);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8655
 *         elif t == t_COL:      return 't_COL'
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'             # <<<<<<<<<<<<<<
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 */
    __pyx_t_1 = (__pyx_v_t == t_LIST);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_LIST));
      __pyx_r = ((PyObject *)__pyx_n_s__t_LIST);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8656
 *         elif t == t_MAT:      return 't_MAT'
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'             # <<<<<<<<<<<<<<
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 */
    __pyx_t_1 = (__pyx_v_t == t_STR);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_STR));
      __pyx_r = ((PyObject *)__pyx_n_s__t_STR);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8657
 *         elif t == t_LIST:     return 't_LIST'
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'             # <<<<<<<<<<<<<<
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 *         else:
 */
    __pyx_t_1 = (__pyx_v_t == t_VECSMALL);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_VECSMALL));
      __pyx_r = ((PyObject *)__pyx_n_s__t_VECSMALL);
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":8658
 *         elif t == t_STR:      return 't_STR'
 *         elif t == t_VECSMALL: return 't_VECSMALL'
 *         elif t == t_CLOSURE:  return 't_CLOSURE'             # <<<<<<<<<<<<<<
 *         else:
 *             raise TypeError, "Unknown Pari type: %s"%t
 */
    __pyx_t_1 = (__pyx_v_t == t_CLOSURE);
    if (__pyx_t_1) {
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__t_CLOSURE));
      __pyx_r = ((PyObject *)__pyx_n_s__t_CLOSURE);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":8660
 *         elif t == t_CLOSURE:  return 't_CLOSURE'
 *         else:
 *             raise TypeError, "Unknown Pari type: %s"%t             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_t_2 = PyInt_FromLong(__pyx_v_t); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_53), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_3), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.type", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_729polinterpolate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_728polinterpolate[] = "\n        self.polinterpolate(ya,x,e): polynomial interpolation at x\n        according to data vectors self, ya (i.e. return P such that\n        P(self[i]) = ya[i] for all i). Also return an error estimate on the\n        returned value.\n        ";
  static PyObject *__pyx_pw_7example_3gen_729polinterpolate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_ya = 0;
    PyObject *__pyx_v_x = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polinterpolate (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__ya,&__pyx_n_s__x,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__ya)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__x)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polinterpolate", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8663; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polinterpolate") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8663; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_ya = values[0];
      __pyx_v_x = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polinterpolate", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8663; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.polinterpolate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_728polinterpolate(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_ya, __pyx_v_x);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8663
 * 
 * 
 *     def polinterpolate(self, ya, x):             # <<<<<<<<<<<<<<
 *         """
 *         self.polinterpolate(ya,x,e): polynomial interpolation at x
 */

  static PyObject *__pyx_pf_7example_3gen_728polinterpolate(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_ya, PyObject *__pyx_v_x) {
    GEN __pyx_v_dy;
    GEN __pyx_v_g;
    struct __pyx_obj_7example_gen *__pyx_v_dif = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polinterpolate", 0);

    /* "example.pyx":8670
 *         returned value.
 *         """
 *         t0GEN(ya)             # <<<<<<<<<<<<<<
 *         t1GEN(x)
 *         cdef GEN dy, g
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_ya); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8671
 *         """
 *         t0GEN(ya)
 *         t1GEN(x)             # <<<<<<<<<<<<<<
 *         cdef GEN dy, g
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_x); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8671; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8673
 *         t1GEN(x)
 *         cdef GEN dy, g
 *         sig_on()             # <<<<<<<<<<<<<<
 *         g = polint(self.g, t0, t1, &dy)
 *         dif = self.new_gen_noclear(dy)
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8673; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8674
 *         cdef GEN dy, g
 *         sig_on()
 *         g = polint(self.g, t0, t1, &dy)             # <<<<<<<<<<<<<<
 *         dif = self.new_gen_noclear(dy)
 *         return self.new_gen(g), dif
 */
    __pyx_v_g = polint(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_7example_t1, (&__pyx_v_dy));

    /* "example.pyx":8675
 *         sig_on()
 *         g = polint(self.g, t0, t1, &dy)
 *         dif = self.new_gen_noclear(dy)             # <<<<<<<<<<<<<<
 *         return self.new_gen(g), dif
 * 
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen_noclear(__pyx_v_self, __pyx_v_dy)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8675; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_dif = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":8676
 *         g = polint(self.g, t0, t1, &dy)
 *         dif = self.new_gen_noclear(dy)
 *         return self.new_gen(g), dif             # <<<<<<<<<<<<<<
 * 
 *     def algdep(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_v_dif));
    PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_dif));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_dif));
    __pyx_t_1 = 0;
    __pyx_r = ((PyObject *)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.polinterpolate", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_dif);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_731algdep(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_3gen_730algdep[] = "\n        EXAMPLES::\n\n            sage: n = pari.set_real_precision(210)\n            sage: w1 = pari('z1=2-sqrt(26); (z1+I)/(z1-I)')\n            sage: f = w1.algdep(12); f\n            545*x^11 - 297*x^10 - 281*x^9 + 48*x^8 - 168*x^7 + 690*x^6 - 168*x^5 + 48*x^4 - 281*x^3 - 297*x^2 + 545*x\n            sage: f(w1).abs() < 1.0e-200\n            True\n            sage: f.factor()\n            [x, 1; x + 1, 2; x^2 + 1, 1; x^2 + x + 1, 1; 545*x^4 - 1932*x^3 + 2790*x^2 - 1932*x + 545, 1]\n            sage: pari.set_real_precision(n)\n            210\n        ";
  static PyObject *__pyx_pw_7example_3gen_731algdep(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("algdep (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.algdep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_730algdep(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8678
 *         return self.new_gen(g), dif
 * 
 *     def algdep(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_3gen_730algdep(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("algdep", 0);

    /* "example.pyx":8693
 *             210
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(algdep(self.g, n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8693; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8694
 *         """
 *         sig_on()
 *         return self.new_gen(algdep(self.g, n))             # <<<<<<<<<<<<<<
 * 
 *     def concat(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, algdep(__pyx_v_self->g, __pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8694; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.algdep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_733concat(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_733concat(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("concat (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_732concat(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8696
 *         return self.new_gen(algdep(self.g, n))
 * 
 *     def concat(self, y):             # <<<<<<<<<<<<<<
 *         t0GEN(y)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_732concat(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("concat", 0);

    /* "example.pyx":8697
 * 
 *     def concat(self, y):
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(concat(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8698
 *     def concat(self, y):
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(concat(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8699
 *         t0GEN(y)
 *         sig_on()
 *         return self.new_gen(concat(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def lindep(self, flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, concat(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.concat", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_735lindep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_735lindep(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_flag = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("lindep (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__flag,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "lindep") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8701; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_flag = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("lindep", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8701; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.lindep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_734lindep(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8701
 *         return self.new_gen(concat(self.g, t0))
 * 
 *     def lindep(self, flag=0):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(lindep0(self.g, flag))
 */

  static PyObject *__pyx_pf_7example_3gen_734lindep(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("lindep", 0);

    /* "example.pyx":8702
 * 
 *     def lindep(self, flag=0):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(lindep0(self.g, flag))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8702; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8703
 *     def lindep(self, flag=0):
 *         sig_on()
 *         return self.new_gen(lindep0(self.g, flag))             # <<<<<<<<<<<<<<
 * 
 *     def listinsert(self, obj, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyInt_AsLong(__pyx_v_flag); if (unlikely((__pyx_t_2 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, lindep0(__pyx_v_self->g, __pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8703; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.lindep", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_737listinsert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_737listinsert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_obj = 0;
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("listinsert (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__obj,&__pyx_n_s__n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__obj)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("listinsert", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "listinsert") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_obj = values[0];
      __pyx_v_n = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("listinsert", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8705; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.listinsert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_736listinsert(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_obj, __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8705
 *         return self.new_gen(lindep0(self.g, flag))
 * 
 *     def listinsert(self, obj, long n):             # <<<<<<<<<<<<<<
 *         t0GEN(obj)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_736listinsert(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("listinsert", 0);

    /* "example.pyx":8706
 * 
 *     def listinsert(self, obj, long n):
 *         t0GEN(obj)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(listinsert(self.g, t0, n))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_obj); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8706; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8707
 *     def listinsert(self, obj, long n):
 *         t0GEN(obj)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(listinsert(self.g, t0, n))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8707; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8708
 *         t0GEN(obj)
 *         sig_on()
 *         return self.new_gen(listinsert(self.g, t0, n))             # <<<<<<<<<<<<<<
 * 
 *     def listput(self, obj, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, listinsert(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_n))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.listinsert", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_739listput(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_3gen_739listput(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_obj = 0;
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("listput (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__obj,&__pyx_n_s__n,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__obj)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("listput", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8710; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "listput") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8710; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_obj = values[0];
      __pyx_v_n = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8710; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("listput", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8710; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.listput", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_738listput(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_obj, __pyx_v_n);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8710
 *         return self.new_gen(listinsert(self.g, t0, n))
 * 
 *     def listput(self, obj, long n):             # <<<<<<<<<<<<<<
 *         t0GEN(obj)
 *         sig_on()
 */

  static PyObject *__pyx_pf_7example_3gen_738listput(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_obj, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("listput", 0);

    /* "example.pyx":8711
 * 
 *     def listput(self, obj, long n):
 *         t0GEN(obj)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(listput(self.g, t0, n))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_obj); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8712
 *     def listput(self, obj, long n):
 *         t0GEN(obj)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(listput(self.g, t0, n))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8713
 *         t0GEN(obj)
 *         sig_on()
 *         return self.new_gen(listput(self.g, t0, n))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, listput(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_n))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.listput", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_741elleisnum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_740elleisnum[] = "\n        om.elleisnum(k, flag=0): om=[om1,om2] being a 2-component vector\n        giving a basis of a lattice L and k an even positive integer,\n        computes the numerical value of the Eisenstein series of weight k.\n        When flag is non-zero and k=4 or 6, this gives g2 or g3 with the\n        correct normalization.\n\n        INPUT:\n\n\n        -  ``om`` - gen, 2-component vector giving a basis of a\n           lattice L\n\n        -  ``k`` - int (even positive)\n\n        -  ``flag`` - int (default 0)\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - numerical value of E_k\n\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: om = e.omega()\n            sage: om\n            [2.49021256085506, -1.97173770155165*I]\n            sage: om.elleisnum(2) # was:  -5.28864933965426\n            10.0672605281120\n            sage: om.elleisnum(4)\n            112.000000000000\n            sage: om.elleisnum(100)\n            2.15314248576078 E50\n        ";
  static PyObject *__pyx_pw_7example_3gen_741elleisnum(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_k;
    int __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("elleisnum (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__k,&__pyx_n_s__flag,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__k)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "elleisnum") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8717; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_k = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_k == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8717; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      if (values[1]) {
        __pyx_v_flag = __Pyx_PyInt_AsInt(values[1]); if (unlikely((__pyx_v_flag == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8717; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((int)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("elleisnum", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8717; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.elleisnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_740elleisnum(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_k, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8717
 * 
 * 
 *     def elleisnum(self, long k, int flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         om.elleisnum(k, flag=0): om=[om1,om2] being a 2-component vector
 */

  static PyObject *__pyx_pf_7example_3gen_740elleisnum(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_k, int __pyx_v_flag) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    long __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("elleisnum", 0);

    /* "example.pyx":8755
 *             2.15314248576078 E50
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         # the argument prec has no effect
 *         return self.new_gen(elleisnum(self.g, k, flag, prec))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8757
 *         sig_on()
 *         # the argument prec has no effect
 *         return self.new_gen(elleisnum(self.g, k, flag, prec))             # <<<<<<<<<<<<<<
 * 
 *     def ellwp(gen self, z='z', long n=20, long flag=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, elleisnum(__pyx_v_self->g, __pyx_v_k, __pyx_v_flag, __pyx_t_3))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.gen.elleisnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_743ellwp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_742ellwp[] = "\n        Return the value or the series expansion of the Weierstrass\n        `P`-function at `z` on the lattice `self` (or the lattice\n        defined by the elliptic curve `self`).\n\n        INPUT:\n\n        -  ``self`` -- an elliptic curve created using ``ellinit`` or a\n           list ``[om1, om2]`` representing generators for a lattice.\n\n        -  ``z`` -- (default: 'z') a complex number or a variable name\n           (as string or PARI variable).\n\n        -  ``n`` -- (default: 20) if 'z' is a variable, compute the\n           series expansion up to at least `O(z^n)`.\n\n        -  ``flag`` -- (default = 0): If ``flag`` is 0, compute only\n           `P(z)`.  If ``flag`` is 1, compute `[P(z), P'(z)]`.\n\n        OUTPUT:\n\n        - `P(z)` (if ``flag`` is 0) or `[P(z), P'(z)]` (if ``flag`` is 1).\n           numbers\n\n        EXAMPLES:\n\n        We first define the elliptic curve X_0(11)::\n\n            sage: E = pari([0,-1,1,-10,-20]).ellinit()\n\n        Compute P(1)::\n\n            sage: E.ellwp(1)\n            13.9658695257485 + 0.E-18*I\n\n        Compute P(1+i), where i = sqrt(-1)::\n\n            sage: C.<i> = ComplexField()\n            sage: E.ellwp(pari(1+i))\n            -1.11510682565555 + 2.33419052307470*I\n            sage: E.ellwp(1+i)\n            -1.11510682565555 + 2.33419052307470*I\n\n        The series expansion, to the default `O(z^20)` precision::\n\n            sage: E.ellwp()\n            z^-2 + 31/15*z^2 + 2501/756*z^4 + 961/675*z^6 + 77531/41580*z^8 + 1202285717/928746000*z^10 + 2403461/2806650*z^12 + 30211462703/43418875500*z^14 + 3539374016033/7723451736000*z^16 + 413306031683977/1289540602350000*z^18 + O(z^20)\n\n        Compute the series for wp to lower precision::\n\n            sage: E.ellwp(n=4)\n            z^-2 + 31/15*z^2 + O(z^4)\n\n        Next we use the version where the input is generators for a\n        lattice::\n\n            sage: pari([1.2692, 0.63 + 1.45*i]).ellwp(1)\n            13.9656146936689 +"" 0.000644829272810...*I\n\n        With flag=1, compute the pair P(z) and P'(z)::\n\n            sage: E.ellwp(1, flag=1)\n            [13.9658695257485 + 0.E-18*I, 50.5619300880073 ... E-18*I]\n        ";
  static PyObject *__pyx_pw_7example_3gen_743ellwp(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_z = 0;
    long __pyx_v_n;
    long __pyx_v_flag;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellwp (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__z,&__pyx_n_s__n,&__pyx_n_s__flag,0};
      PyObject* values[3] = {0,0,0};
      values[0] = ((PyObject *)__pyx_n_s__z);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__z);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n);
            if (value) { values[1] = value; kw_args--; }
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__flag);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ellwp") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8759; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_z = values[0];
      if (values[1]) {
        __pyx_v_n = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8759; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n = ((long)20);
      }
      if (values[2]) {
        __pyx_v_flag = __Pyx_PyInt_AsLong(values[2]); if (unlikely((__pyx_v_flag == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8759; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_flag = ((long)0);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("ellwp", 0, 0, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8759; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.ellwp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_742ellwp(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_z, __pyx_v_n, __pyx_v_flag);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8759
 *         return self.new_gen(elleisnum(self.g, k, flag, prec))
 * 
 *     def ellwp(gen self, z='z', long n=20, long flag=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the value or the series expansion of the Weierstrass
 */

  static PyObject *__pyx_pf_7example_3gen_742ellwp(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_z, long __pyx_v_n, long __pyx_v_flag) {
    long __pyx_v_dprec;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellwp", 0);

    /* "example.pyx":8824
 *             [13.9658695257485 + 0.E-18*I, 50.5619300880073 ... E-18*I]
 *         """
 *         t0GEN(z)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         cdef long dprec
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_z); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8825
 *         """
 *         t0GEN(z)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cdef long dprec
 *         dprec = gprecision(t0)
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8827
 *         sig_on()
 *         cdef long dprec
 *         dprec = gprecision(t0)             # <<<<<<<<<<<<<<
 *         if dprec:
 *             dprec = prec_words_to_dec(dprec)
 */
    __pyx_v_dprec = gprecision(__pyx_v_7example_t0);

    /* "example.pyx":8828
 *         cdef long dprec
 *         dprec = gprecision(t0)
 *         if dprec:             # <<<<<<<<<<<<<<
 *             dprec = prec_words_to_dec(dprec)
 *         else:
 */
    if (__pyx_v_dprec) {

      /* "example.pyx":8829
 *         dprec = gprecision(t0)
 *         if dprec:
 *             dprec = prec_words_to_dec(dprec)             # <<<<<<<<<<<<<<
 *         else:
 *             dprec = prec
 */
      __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_words_to_dec); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = PyInt_FromLong(__pyx_v_dprec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_dprec = __pyx_t_5;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":8831
 *             dprec = prec_words_to_dec(dprec)
 *         else:
 *             dprec = prec             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellwp0(self.g, t0, flag, n+2, dprec))
 * 
 */
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_dprec = __pyx_t_5;
    }
    __pyx_L3:;

    /* "example.pyx":8832
 *         else:
 *             dprec = prec
 *         return self.new_gen(ellwp0(self.g, t0, flag, n+2, dprec))             # <<<<<<<<<<<<<<
 * 
 *     def ellchangepoint(self, y):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellwp0(__pyx_v_self->g, __pyx_v_7example_t0, __pyx_v_flag, (__pyx_v_n + 2), __pyx_v_dprec))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.gen.ellwp", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_745ellchangepoint(PyObject *__pyx_v_self, PyObject *__pyx_v_y); /*proto*/
  static char __pyx_doc_7example_3gen_744ellchangepoint[] = "\n        self.ellchangepoint(y): change data on point or vector of points\n        self on an elliptic curve according to y=[u,r,s,t]\n\n        EXAMPLES::\n\n            sage: e = pari([0,1,1,-2,0]).ellinit()\n            sage: x = pari([1,0])\n            sage: e.ellisoncurve([1,4])\n            False\n            sage: e.ellisoncurve(x)\n            True\n            sage: f = e.ellchangecurve([1,2,3,-1])\n            sage: f[:5]   # show only first five entries\n            [6, -2, -1, 17, 8]\n            sage: x.ellchangepoint([1,2,3,-1])\n            [-1, 4]\n            sage: f.ellisoncurve([-1,4])\n            True\n        ";
  static PyObject *__pyx_pw_7example_3gen_745ellchangepoint(PyObject *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("ellchangepoint (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_3gen_744ellchangepoint(((struct __pyx_obj_7example_gen *)__pyx_v_self), ((PyObject *)__pyx_v_y));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8834
 *         return self.new_gen(ellwp0(self.g, t0, flag, n+2, dprec))
 * 
 *     def ellchangepoint(self, y):             # <<<<<<<<<<<<<<
 *         """
 *         self.ellchangepoint(y): change data on point or vector of points
 */

  static PyObject *__pyx_pf_7example_3gen_744ellchangepoint(struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_y) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("ellchangepoint", 0);

    /* "example.pyx":8855
 *             True
 *         """
 *         t0GEN(y)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(ellchangepoint(self.g, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_y); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":8856
 *         """
 *         t0GEN(y)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(ellchangepoint(self.g, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8857
 *         t0GEN(y)
 *         sig_on()
 *         return self.new_gen(ellchangepoint(self.g, t0))             # <<<<<<<<<<<<<<
 * 
 *     def debug(gen self, long depth = -1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_gen *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, ellchangepoint(__pyx_v_self->g, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.ellchangepoint", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_3gen_747debug(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_3gen_746debug[] = "\n        Show the internal structure of self (like the ``\\x`` command in gp).\n\n        EXAMPLE::\n\n            sage: pari('[1/2, 1.0*I]').debug()  # random addresses\n            [&=0000000004c5f010] VEC(lg=3):2200000000000003 0000000004c5eff8 0000000004c5efb0\n              1st component = [&=0000000004c5eff8] FRAC(lg=3):0800000000000003 0000000004c5efe0 0000000004c5efc8\n                num = [&=0000000004c5efe0] INT(lg=3):0200000000000003 (+,lgefint=3):4000000000000003 0000000000000001\n                den = [&=0000000004c5efc8] INT(lg=3):0200000000000003 (+,lgefint=3):4000000000000003 0000000000000002\n              2nd component = [&=0000000004c5efb0] COMPLEX(lg=3):0c00000000000003 00007fae8a2eb840 0000000004c5ef90\n                real = gen_0\n                imag = [&=0000000004c5ef90] REAL(lg=4):0400000000000004 (+,expo=0):6000000000000000 8000000000000000 0000000000000000\n        ";
  static PyObject *__pyx_pw_7example_3gen_747debug(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_depth;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("debug (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__depth,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__depth);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "debug") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8859; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_depth = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_depth == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8859; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_depth = ((long)-1);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("debug", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8859; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.gen.debug", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_3gen_746debug(((struct __pyx_obj_7example_gen *)__pyx_v_self), __pyx_v_depth);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8859
 *         return self.new_gen(ellchangepoint(self.g, t0))
 * 
 *     def debug(gen self, long depth = -1):             # <<<<<<<<<<<<<<
 *         r"""
 *         Show the internal structure of self (like the ``\x`` command in gp).
 */

  static PyObject *__pyx_pf_7example_3gen_746debug(struct __pyx_obj_7example_gen *__pyx_v_self, long __pyx_v_depth) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("debug", 0);

    /* "example.pyx":8874
 *                 imag = [&=0000000004c5ef90] REAL(lg=4):0400000000000004 (+,expo=0):6000000000000000 8000000000000000 0000000000000000
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         dbgGEN(self.g, depth)
 *         sig_off()
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8875
 *         """
 *         sig_on()
 *         dbgGEN(self.g, depth)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return
 */
    dbgGEN(__pyx_v_self->g, __pyx_v_depth);

    /* "example.pyx":8876
 *         sig_on()
 *         dbgGEN(self.g, depth)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return
 * 
 */
    _pari_sig_off();

    /* "example.pyx":8877
 *         dbgGEN(self.g, depth)
 *         sig_off()
 *         return             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_AddTraceback("example.gen.debug", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8884
 *     # classes that derive from gen.
 *     ##################################################
 *     cdef gen pari(self, object x):             # <<<<<<<<<<<<<<
 *         return pari(x)
 * 
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_3gen_pari(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pari", 0);

    /* "example.pyx":8885
 *     ##################################################
 *     cdef gen pari(self, object x):
 *         return pari(x)             # <<<<<<<<<<<<<<
 * 
 *     cdef gen new_gen(self, GEN x):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.gen.pari", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8887
 *         return pari(x)
 * 
 *     cdef gen new_gen(self, GEN x):             # <<<<<<<<<<<<<<
 *         return P.new_gen(x)
 * 
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_3gen_new_gen(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, GEN __pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen", 0);

    /* "example.pyx":8888
 * 
 *     cdef gen new_gen(self, GEN x):
 *         return P.new_gen(x)             # <<<<<<<<<<<<<<
 * 
 *     cdef gen new_gen_noclear(self, GEN x):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen(__pyx_v_7example_P, __pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8888; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.new_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8890
 *         return P.new_gen(x)
 * 
 *     cdef gen new_gen_noclear(self, GEN x):             # <<<<<<<<<<<<<<
 *         return P.new_gen_noclear(x)
 * 
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_3gen_new_gen_noclear(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, GEN __pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen_noclear", 0);

    /* "example.pyx":8891
 * 
 *     cdef gen new_gen_noclear(self, GEN x):
 *         return P.new_gen_noclear(x)             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN _deepcopy_to_python_heap(self, GEN x, pari_sp* address):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_P, __pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.gen.new_gen_noclear", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8893
 *         return P.new_gen_noclear(x)
 * 
 *     cdef GEN _deepcopy_to_python_heap(self, GEN x, pari_sp* address):             # <<<<<<<<<<<<<<
 *         return P.deepcopy_to_python_heap(x, address)
 * 
 */

  static GEN __pyx_f_7example_3gen__deepcopy_to_python_heap(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, GEN __pyx_v_x, pari_sp *__pyx_v_address) {
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("_deepcopy_to_python_heap", 0);

    /* "example.pyx":8894
 * 
 *     cdef GEN _deepcopy_to_python_heap(self, GEN x, pari_sp* address):
 *         return P.deepcopy_to_python_heap(x, address)             # <<<<<<<<<<<<<<
 * 
 *     cdef long get_var(self, v):
 */
    __pyx_r = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->deepcopy_to_python_heap(__pyx_v_7example_P, __pyx_v_x, __pyx_v_address);
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8896
 *         return P.deepcopy_to_python_heap(x, address)
 * 
 *     cdef long get_var(self, v):             # <<<<<<<<<<<<<<
 *         return P.get_var(v)
 * 
 */

  static long __pyx_f_7example_3gen_get_var(CYTHON_UNUSED struct __pyx_obj_7example_gen *__pyx_v_self, PyObject *__pyx_v_v) {
    long __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("get_var", 0);

    /* "example.pyx":8897
 * 
 *     cdef long get_var(self, v):
 *         return P.get_var(v)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_r = ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_P->__pyx_vtab)->get_var(__pyx_v_7example_P, __pyx_v_v);
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8907
 * #cdef PariOUT sage_pariOut
 * 
 * cdef void sage_putchar(char c):             # <<<<<<<<<<<<<<
 *     cdef char str[2]
 *     str[0] = c
 */

  static void __pyx_f_7example_sage_putchar(char __pyx_v_c) {
    char __pyx_v_str[2];
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sage_putchar", 0);

    /* "example.pyx":8909
 * cdef void sage_putchar(char c):
 *     cdef char str[2]
 *     str[0] = c             # <<<<<<<<<<<<<<
 *     str[1] = 0
 *     sys.stdout.write(str)
 */
    (__pyx_v_str[0]) = __pyx_v_c;

    /* "example.pyx":8910
 *     cdef char str[2]
 *     str[0] = c
 *     str[1] = 0             # <<<<<<<<<<<<<<
 *     sys.stdout.write(str)
 *     return
 */
    (__pyx_v_str[1]) = 0;

    /* "example.pyx":8911
 *     str[0] = c
 *     str[1] = 0
 *     sys.stdout.write(str)             # <<<<<<<<<<<<<<
 *     return
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__sys); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__stdout); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__write); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyBytes_FromString(__pyx_v_str); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8911; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":8912
 *     str[1] = 0
 *     sys.stdout.write(str)
 *     return             # <<<<<<<<<<<<<<
 * 
 * cdef void sage_puts(char* s):
 */
    goto __pyx_L0;

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_WriteUnraisable("example.sage_putchar", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":8914
 *     return
 * 
 * cdef void sage_puts(char* s):             # <<<<<<<<<<<<<<
 *     sys.stdout.write(s)
 *     return
 */

  static void __pyx_f_7example_sage_puts(char *__pyx_v_s) {
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sage_puts", 0);

    /* "example.pyx":8915
 * 
 * cdef void sage_puts(char* s):
 *     sys.stdout.write(s)             # <<<<<<<<<<<<<<
 *     return
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__sys); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__stdout); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__write); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyBytes_FromString(__pyx_v_s); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_2));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":8916
 * cdef void sage_puts(char* s):
 *     sys.stdout.write(s)
 *     return             # <<<<<<<<<<<<<<
 * 
 * cdef void sage_flush():
 */
    goto __pyx_L0;

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_WriteUnraisable("example.sage_puts", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":8918
 *     return
 * 
 * cdef void sage_flush():             # <<<<<<<<<<<<<<
 *     sys.stdout.flush()
 *     return
 */

  static void __pyx_f_7example_sage_flush(void) {
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("sage_flush", 0);

    /* "example.pyx":8919
 * 
 * cdef void sage_flush():
 *     sys.stdout.flush()             # <<<<<<<<<<<<<<
 *     return
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__sys); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__stdout); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__flush); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":8920
 * cdef void sage_flush():
 *     sys.stdout.flush()
 *     return             # <<<<<<<<<<<<<<
 * 
 * 
 */
    goto __pyx_L0;

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_WriteUnraisable("example.sage_flush", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* Python wrapper */
  static int __pyx_pw_7example_12PariInstance_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance___init__[] = "\n        Initialize the PARI system.\n\n        INPUT:\n\n\n        -  ``size`` - long, the number of bytes for the initial\n           PARI stack (see note below)\n\n        -  ``maxprime`` - unsigned long, upper limit on a\n           precomputed prime number table (default: 500000)\n\n\n        .. note::\n\n           In py_pari, the PARI stack is different than in gp or the\n           PARI C library. In Python, instead of the PARI stack\n           holding the results of all computations, it *only* holds\n           the results of an individual computation. Each time a new\n           Python/PARI object is computed, it it copied to its own\n           space in the Python heap, and the memory it occupied on the\n           PARI stack is freed. Thus it is not necessary to make the\n           stack very large. Also, unlike in PARI, if the stack does\n           overflow, in most cases the PARI stack is automatically\n           increased and the relevant step of the computation rerun.\n\n           This design obviously involves some performance penalties\n           over the way PARI works, but it scales much better and is\n           far more robust for large projects.\n\n        .. note::\n\n           If you do not want prime numbers, put ``maxprime=2``, but be\n           careful because many PARI functions require this table. If\n           you get the error message \"not enough precomputed primes\",\n           increase this parameter.\n        ";
  #if CYTHON_COMPILING_IN_CPYTHON
  struct wrapperbase __pyx_wrapperbase_7example_12PariInstance___init__;
  #endif
  static int __pyx_pw_7example_12PariInstance_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_size;
    unsigned long __pyx_v_maxprime;
    int __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__size,&__pyx_n_s__maxprime,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__size);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__maxprime);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8925; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_size = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_size == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8925; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_size = ((long)16000000);
      }
      if (values[1]) {
        __pyx_v_maxprime = __Pyx_PyInt_AsUnsignedLong(values[1]); if (unlikely((__pyx_v_maxprime == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8925; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_maxprime = ((unsigned long)500000);
      }
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8925; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return -1;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance___init__(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_size, __pyx_v_maxprime);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":8925
 * 
 * cdef class PariInstance:
 *     def __init__(self, long size=16000000, unsigned long maxprime=500000):             # <<<<<<<<<<<<<<
 *         """
 *         Initialize the PARI system.
 */

  static int __pyx_pf_7example_12PariInstance___init__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_size, unsigned long __pyx_v_maxprime) {
    int __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    long __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__init__", 0);

    /* "example.pyx":8963
 *            increase this parameter.
 *         """
 *         if bot:             # <<<<<<<<<<<<<<
 *             return  # pari already initialized.
 * 
 */
    if (bot) {

      /* "example.pyx":8964
 *         """
 *         if bot:
 *             return  # pari already initialized.             # <<<<<<<<<<<<<<
 * 
 *         global num_primes, avma, top, bot, prec
 */
      __pyx_r = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":8970
 *         # The size here doesn't really matter, because we will allocate
 *         # our own stack anyway. We ask PARI not to set up signal handlers.
 *         pari_init_opts(10000, maxprime, INIT_JMPm | INIT_DFTm)             # <<<<<<<<<<<<<<
 *         num_primes = maxprime
 * 
 */
    pari_init_opts(10000, __pyx_v_maxprime, (INIT_JMPm | INIT_DFTm));

    /* "example.pyx":8971
 *         # our own stack anyway. We ask PARI not to set up signal handlers.
 *         pari_init_opts(10000, maxprime, INIT_JMPm | INIT_DFTm)
 *         num_primes = maxprime             # <<<<<<<<<<<<<<
 * 
 *         # NOTE: sig_on() can only come AFTER pari_init_opts()!
 */
    __pyx_v_7example_num_primes = __pyx_v_maxprime;

    /* "example.pyx":8974
 * 
 *         # NOTE: sig_on() can only come AFTER pari_init_opts()!
 *         sig_on()             # <<<<<<<<<<<<<<
 * 
 *         # Free the PARI stack and allocate our own (using Cython)
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8974; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8977
 * 
 *         # Free the PARI stack and allocate our own (using Cython)
 *         pari_free(<void*>bot); bot = 0             # <<<<<<<<<<<<<<
 *         init_stack(size)
 * 
 */
    pari_free(((void *)bot));
    bot = 0;

    /* "example.pyx":8978
 *         # Free the PARI stack and allocate our own (using Cython)
 *         pari_free(<void*>bot); bot = 0
 *         init_stack(size)             # <<<<<<<<<<<<<<
 * 
 *         GP_DATA.fmt.prettyp = 0
 */
    __pyx_t_1 = __pyx_f_7example_init_stack(__pyx_v_size); if (unlikely(__pyx_t_1 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8978; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":8980
 *         init_stack(size)
 * 
 *         GP_DATA.fmt.prettyp = 0             # <<<<<<<<<<<<<<
 * 
 *         # how do I get the following to work? seems to be a circular import
 */
    GP_DATA->fmt->prettyp = 0;

    /* "example.pyx":8985
 *         #from sage.rings.real_mpfr import RealField
 *         #prec_bits = RealField().prec()
 *         prec = prec_bits_to_words(53)             # <<<<<<<<<<<<<<
 *         GP_DATA.fmt.sigd = prec_bits_to_dec(53)
 * 
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_words); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_k_tuple_54), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "example.pyx":8986
 *         #prec_bits = RealField().prec()
 *         prec = prec_bits_to_words(53)
 *         GP_DATA.fmt.sigd = prec_bits_to_dec(53)             # <<<<<<<<<<<<<<
 * 
 *         # Set printing functions
 */
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_dec); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_k_tuple_55), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = __Pyx_PyInt_AsLong(__pyx_t_2); if (unlikely((__pyx_t_4 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    GP_DATA->fmt->sigd = __pyx_t_4;

    /* "example.pyx":8991
 *         global pariOut
 *         #pariOut = &sage_pariOut
 *         pariOut.putch = sage_putchar             # <<<<<<<<<<<<<<
 *         pariOut.puts = sage_puts
 *         pariOut.flush = sage_flush
 */
    pariOut->putch = __pyx_f_7example_sage_putchar;

    /* "example.pyx":8992
 *         #pariOut = &sage_pariOut
 *         pariOut.putch = sage_putchar
 *         pariOut.puts = sage_puts             # <<<<<<<<<<<<<<
 *         pariOut.flush = sage_flush
 *         sig_off()
 */
    pariOut->puts = __pyx_f_7example_sage_puts;

    /* "example.pyx":8993
 *         pariOut.putch = sage_putchar
 *         pariOut.puts = sage_puts
 *         pariOut.flush = sage_flush             # <<<<<<<<<<<<<<
 *         sig_off()
 * 
 */
    pariOut->flush = __pyx_f_7example_sage_flush;

    /* "example.pyx":8994
 *         pariOut.puts = sage_puts
 *         pariOut.flush = sage_flush
 *         sig_off()             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
    _pari_sig_off();

    __pyx_r = 0;
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = -1;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static void __pyx_pw_7example_12PariInstance_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
  static void __pyx_pw_7example_12PariInstance_3__dealloc__(PyObject *__pyx_v_self) {
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__dealloc__ (wrapper)", 0);
    __pyx_pf_7example_12PariInstance_2__dealloc__(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":8996
 *         sig_off()
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         """
 *         Deallocation of the Pari instance.
 */

  static void __pyx_pf_7example_12PariInstance_2__dealloc__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__dealloc__", 0);

    /* "example.pyx":9011
 * 
 *         """
 *         if bot:             # <<<<<<<<<<<<<<
 *             memfree(<void*>bot)
 *         global top, bot
 */
    if (bot) {

      /* "example.pyx":9012
 *         """
 *         if bot:
 *             memfree(<void*>bot)             # <<<<<<<<<<<<<<
 *         global top, bot
 *         top = 0
 */
      memfree(((void *)bot));
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9014
 *             memfree(<void*>bot)
 *         global top, bot
 *         top = 0             # <<<<<<<<<<<<<<
 *         bot = 0
 *         pari_close()
 */
    top = 0;

    /* "example.pyx":9015
 *         global top, bot
 *         top = 0
 *         bot = 0             # <<<<<<<<<<<<<<
 *         pari_close()
 * 
 */
    bot = 0;

    /* "example.pyx":9016
 *         top = 0
 *         bot = 0
 *         pari_close()             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
    pari_close();

    __Pyx_RefNannyFinishContext();
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_5__repr__(PyObject *__pyx_v_self); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_5__repr__(PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_4__repr__(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9018
 *         pari_close()
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         return "Interface to the PARI C library"
 * 
 */

  static PyObject *__pyx_pf_7example_12PariInstance_4__repr__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__repr__", 0);

    /* "example.pyx":9019
 * 
 *     def __repr__(self):
 *         return "Interface to the PARI C library"             # <<<<<<<<<<<<<<
 * 
 *     def __hash__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_kp_s_56));
    __pyx_r = ((PyObject *)__pyx_kp_s_56);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static Py_hash_t __pyx_pw_7example_12PariInstance_7__hash__(PyObject *__pyx_v_self); /*proto*/
  static Py_hash_t __pyx_pw_7example_12PariInstance_7__hash__(PyObject *__pyx_v_self) {
    Py_hash_t __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__hash__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_6__hash__(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9021
 *         return "Interface to the PARI C library"
 * 
 *     def __hash__(self):             # <<<<<<<<<<<<<<
 *         return 907629390   # hash('pari')
 * 
 */

  static Py_hash_t __pyx_pf_7example_12PariInstance_6__hash__(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    Py_hash_t __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__hash__", 0);

    /* "example.pyx":9022
 * 
 *     def __hash__(self):
 *         return 907629390   # hash('pari')             # <<<<<<<<<<<<<<
 * 
 *         #cdef has_coerce_map_from_c_impl(self, x):
 */
    __pyx_r = 907629390;
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    if (unlikely(__pyx_r == -1) && !PyErr_Occurred()) __pyx_r = -2;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_9__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_9__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, int __pyx_v_op) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__richcmp__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_8__richcmp__(((PyObject *)__pyx_v_left), ((PyObject *)__pyx_v_right), ((int)__pyx_v_op));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9027
 *         #return True
 * 
 *     def __richcmp__(left, right, int op):             # <<<<<<<<<<<<<<
 *         """
 *         EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_12PariInstance_8__richcmp__(PyObject *__pyx_v_left, PyObject *__pyx_v_right, CYTHON_UNUSED int __pyx_v_op) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__richcmp__", 0);

    /* "example.pyx":9038
 *             False
 *         """
 *         return gcmp_sage((<gen>left).g, (<gen>right).g)             # <<<<<<<<<<<<<<
 * 
 *     def default(self, variable, value=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(gcmp_sage(((struct __pyx_obj_7example_gen *)__pyx_v_left)->g, ((struct __pyx_obj_7example_gen *)__pyx_v_right)->g)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9038; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_11default(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_11default(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_variable = 0;
    PyObject *__pyx_v_value = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("default (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__variable,&__pyx_n_s__value,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":9040
 *         return gcmp_sage((<gen>left).g, (<gen>right).g)
 * 
 *     def default(self, variable, value=None):             # <<<<<<<<<<<<<<
 *         if not value is None:
 *             return self('default(%s, %s)'%(variable, value))
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__variable)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__value);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "default") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9040; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_variable = values[0];
      __pyx_v_value = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("default", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9040; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.default", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_10default(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_variable, __pyx_v_value);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_12PariInstance_10default(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_variable, PyObject *__pyx_v_value) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("default", 0);

    /* "example.pyx":9041
 * 
 *     def default(self, variable, value=None):
 *         if not value is None:             # <<<<<<<<<<<<<<
 *             return self('default(%s, %s)'%(variable, value))
 *         return self('default(%s)'%variable)
 */
    __pyx_t_1 = (__pyx_v_value == Py_None);
    __pyx_t_2 = (!__pyx_t_1);
    if (__pyx_t_2) {

      /* "example.pyx":9042
 *     def default(self, variable, value=None):
 *         if not value is None:
 *             return self('default(%s, %s)'%(variable, value))             # <<<<<<<<<<<<<<
 *         return self('default(%s)'%variable)
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_v_variable);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_variable);
      __Pyx_GIVEREF(__pyx_v_variable);
      __Pyx_INCREF(__pyx_v_value);
      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_value);
      __Pyx_GIVEREF(__pyx_v_value);
      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_57), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_4));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_Call(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9042; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9043
 *         if not value is None:
 *             return self('default(%s, %s)'%(variable, value))
 *         return self('default(%s)'%variable)             # <<<<<<<<<<<<<<
 * 
 *     def set_debug_level(self, level):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_58), __pyx_v_variable); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9043; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9043; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_4));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_4));
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9043; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.PariInstance.default", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_13set_debug_level(PyObject *__pyx_v_self, PyObject *__pyx_v_level); /*proto*/
  static char __pyx_doc_7example_12PariInstance_12set_debug_level[] = "\n        Set the debug PARI C library variable.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_13set_debug_level(PyObject *__pyx_v_self, PyObject *__pyx_v_level) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("set_debug_level (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_12set_debug_level(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((PyObject *)__pyx_v_level));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9045
 *         return self('default(%s)'%variable)
 * 
 *     def set_debug_level(self, level):             # <<<<<<<<<<<<<<
 *         """
 *         Set the debug PARI C library variable.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_12set_debug_level(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_level) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("set_debug_level", 0);

    /* "example.pyx":9049
 *         Set the debug PARI C library variable.
 *         """
 *         self.default('debug', int(level))             # <<<<<<<<<<<<<<
 * 
 *     def get_debug_level(self):
 */
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__default); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_level);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_level);
    __Pyx_GIVEREF(__pyx_v_level);
    __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(((PyObject *)__pyx_n_s__debug));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__debug));
    __Pyx_GIVEREF(((PyObject *)__pyx_n_s__debug));
    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.set_debug_level", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_15get_debug_level(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_12PariInstance_14get_debug_level[] = "\n        Set the debug PARI C library variable.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_15get_debug_level(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("get_debug_level (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_14get_debug_level(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9051
 *         self.default('debug', int(level))
 * 
 *     def get_debug_level(self):             # <<<<<<<<<<<<<<
 *         """
 *         Set the debug PARI C library variable.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_14get_debug_level(struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("get_debug_level", 0);

    /* "example.pyx":9055
 *         Set the debug PARI C library variable.
 *         """
 *         return int(self.default('debug'))             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN toGEN(self, x, int i) except NULL:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__default); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_k_tuple_59), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.get_debug_level", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9057
 *         return int(self.default('debug'))
 * 
 *     cdef GEN toGEN(self, x, int i) except NULL:             # <<<<<<<<<<<<<<
 *         cdef gen _x
 *         if PY_TYPE_CHECK(x, gen):
 */

  static GEN __pyx_f_7example_12PariInstance_toGEN(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_x, int __pyx_v_i) {
    struct __pyx_obj_7example_gen *__pyx_v__x = 0;
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("toGEN", 0);

    /* "example.pyx":9059
 *     cdef GEN toGEN(self, x, int i) except NULL:
 *         cdef gen _x
 *         if PY_TYPE_CHECK(x, gen):             # <<<<<<<<<<<<<<
 *             _x = x
 *             return _x.g
 */
    __pyx_t_1 = PY_TYPE_CHECK(__pyx_v_x, ((PyObject *)((PyObject*)__pyx_ptype_7example_gen)));
    if (__pyx_t_1) {

      /* "example.pyx":9060
 *         cdef gen _x
 *         if PY_TYPE_CHECK(x, gen):
 *             _x = x             # <<<<<<<<<<<<<<
 *             return _x.g
 * 
 */
      if (!(likely(((__pyx_v_x) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_x, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9060; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_INCREF(__pyx_v_x);
      __pyx_v__x = ((struct __pyx_obj_7example_gen *)__pyx_v_x);

      /* "example.pyx":9061
 *         if PY_TYPE_CHECK(x, gen):
 *             _x = x
 *             return _x.g             # <<<<<<<<<<<<<<
 * 
 *         t0heap[i] = self(x)
 */
      __pyx_r = __pyx_v__x->g;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9063
 *             return _x.g
 * 
 *         t0heap[i] = self(x)             # <<<<<<<<<<<<<<
 *         _x = t0heap[i]
 *         return _x.g
 */
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_x);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_x);
    __Pyx_GIVEREF(__pyx_v_x);
    __pyx_t_3 = PyObject_Call(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__t0heap); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_SetItemInt(__pyx_t_2, __pyx_v_i, __pyx_t_3, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

    /* "example.pyx":9064
 * 
 *         t0heap[i] = self(x)
 *         _x = t0heap[i]             # <<<<<<<<<<<<<<
 *         return _x.g
 * 
 */
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__t0heap); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v__x = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":9065
 *         t0heap[i] = self(x)
 *         _x = t0heap[i]
 *         return _x.g             # <<<<<<<<<<<<<<
 * 
 *         # TODO: Refactor code out of __call__ so it...
 */
    __pyx_r = __pyx_v__x->g;
    goto __pyx_L0;

    __pyx_r = 0;
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.toGEN", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v__x);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_17set_real_precision(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_12PariInstance_16set_real_precision[] = "\n        Sets the PARI default real precision.\n\n        This is used both for creation of new objects from strings and for\n        printing. It is the number of digits *IN DECIMAL* in which real\n        numbers are printed. It also determines the precision of objects\n        created by parsing strings (e.g. pari('1.2')), which is *not* the\n        normal way of creating new pari objects in Sage. It has *no*\n        effect on the precision of computations within the pari library.\n\n        Returns the previous PARI real precision.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_17set_real_precision(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("set_real_precision (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9077; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.set_real_precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_16set_real_precision(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9077
 * 
 * 
 *     def set_real_precision(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Sets the PARI default real precision.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_16set_real_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    unsigned long __pyx_v_k;
    PyObject *__pyx_v_s = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    long __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    char *__pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("set_real_precision", 0);

    /* "example.pyx":9092
 *         cdef unsigned long k
 * 
 *         k = GP_DATA.fmt.sigd             # <<<<<<<<<<<<<<
 *         s = str(n)
 *         sig_on()
 */
    __pyx_t_1 = GP_DATA->fmt->sigd;
    __pyx_v_k = __pyx_t_1;

    /* "example.pyx":9093
 * 
 *         k = GP_DATA.fmt.sigd
 *         s = str(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         sd_realprecision(s, 2)
 */
    __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_s = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "example.pyx":9094
 *         k = GP_DATA.fmt.sigd
 *         s = str(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         sd_realprecision(s, 2)
 *         sig_off()
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9095
 *         s = str(n)
 *         sig_on()
 *         sd_realprecision(s, 2)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return int(k)  # Python int
 */
    __pyx_t_5 = PyBytes_AsString(__pyx_v_s); if (unlikely((!__pyx_t_5) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    sd_realprecision(__pyx_t_5, 2);

    /* "example.pyx":9096
 *         sig_on()
 *         sd_realprecision(s, 2)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return int(k)  # Python int
 * 
 */
    _pari_sig_off();

    /* "example.pyx":9097
 *         sd_realprecision(s, 2)
 *         sig_off()
 *         return int(k)  # Python int             # <<<<<<<<<<<<<<
 * 
 *     def get_real_precision(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyLong_FromUnsignedLong(__pyx_v_k); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.set_real_precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_s);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_19get_real_precision(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_12PariInstance_18get_real_precision[] = "\n        Returns the current PARI default real precision.\n\n        This is used both for creation of new objects from strings and for\n        printing. It is the number of digits *IN DECIMAL* in which real\n        numbers are printed. It also determines the precision of objects\n        created by parsing strings (e.g. pari('1.2')), which is *not* the\n        normal way of creating new pari objects in Sage. It has *no*\n        effect on the precision of computations within the pari library.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_19get_real_precision(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("get_real_precision (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_18get_real_precision(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9099
 *         return int(k)  # Python int
 * 
 *     def get_real_precision(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns the current PARI default real precision.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_18get_real_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("get_real_precision", 0);

    /* "example.pyx":9110
 *         effect on the precision of computations within the pari library.
 *         """
 *         return GP_DATA.fmt.sigd             # <<<<<<<<<<<<<<
 * 
 *     def set_series_precision(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(GP_DATA->fmt->sigd); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.get_real_precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_21set_series_precision(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_21set_series_precision(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("set_series_precision (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9112; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.set_series_precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_20set_series_precision(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9112
 *         return GP_DATA.fmt.sigd
 * 
 *     def set_series_precision(self, long n):             # <<<<<<<<<<<<<<
 *         global precdl
 *         precdl = n
 */

  static PyObject *__pyx_pf_7example_12PariInstance_20set_series_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("set_series_precision", 0);

    /* "example.pyx":9114
 *     def set_series_precision(self, long n):
 *         global precdl
 *         precdl = n             # <<<<<<<<<<<<<<
 * 
 *     def get_series_precision(self):
 */
    precdl = __pyx_v_n;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_23get_series_precision(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_23get_series_precision(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("get_series_precision (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_22get_series_precision(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9116
 *         precdl = n
 * 
 *     def get_series_precision(self):             # <<<<<<<<<<<<<<
 *         return precdl
 * 
 */

  static PyObject *__pyx_pf_7example_12PariInstance_22get_series_precision(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("get_series_precision", 0);

    /* "example.pyx":9117
 * 
 *     def get_series_precision(self):
 *         return precdl             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyInt_FromLong(precdl); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.get_series_precision", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9126
 *     ###########################################
 * 
 *     cdef gen new_gen(self, GEN x):             # <<<<<<<<<<<<<<
 *         """
 *         Create a new gen, then free the \*entire\* stack and call
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance_new_gen(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, GEN __pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_v_g = 0;
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    pari_sp __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen", 0);

    /* "example.pyx":9132
 *         """
 *         cdef gen g
 *         g = _new_gen(x)             # <<<<<<<<<<<<<<
 *         global mytop, avma
 *         avma = mytop
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_7example__new_gen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_g = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9134
 *         g = _new_gen(x)
 *         global mytop, avma
 *         avma = mytop             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return g
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyInt_from_py_pari_sp(__pyx_t_1); if (unlikely((__pyx_t_2 == (pari_sp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    avma = __pyx_t_2;

    /* "example.pyx":9135
 *         global mytop, avma
 *         avma = mytop
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return g
 * 
 */
    _pari_sig_off();

    /* "example.pyx":9136
 *         avma = mytop
 *         sig_off()
 *         return g             # <<<<<<<<<<<<<<
 * 
 *     cdef object new_gen_to_string(self, GEN x):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __Pyx_INCREF(((PyObject *)__pyx_v_g));
    __pyx_r = __pyx_v_g;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.new_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_g);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9138
 *         return g
 * 
 *     cdef object new_gen_to_string(self, GEN x):             # <<<<<<<<<<<<<<
 *         """
 *         Converts a gen to a Python string, free the \*entire\* stack and call
 */

  static PyObject *__pyx_f_7example_12PariInstance_new_gen_to_string(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, GEN __pyx_v_x) {
    char *__pyx_v_c;
    PyObject *__pyx_v_s = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    pari_sp __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen_to_string", 0);

    /* "example.pyx":9145
 *         cdef char* c
 *         cdef int n
 *         c = GENtostr(x)             # <<<<<<<<<<<<<<
 *         s = str(c)
 *         pari_free(c)
 */
    __pyx_v_c = GENtostr(__pyx_v_x);

    /* "example.pyx":9146
 *         cdef int n
 *         c = GENtostr(x)
 *         s = str(c)             # <<<<<<<<<<<<<<
 *         pari_free(c)
 *         global mytop, avma
 */
    __pyx_t_1 = PyBytes_FromString(__pyx_v_c); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_1));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_v_s = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "example.pyx":9147
 *         c = GENtostr(x)
 *         s = str(c)
 *         pari_free(c)             # <<<<<<<<<<<<<<
 *         global mytop, avma
 *         avma = mytop
 */
    pari_free(__pyx_v_c);

    /* "example.pyx":9149
 *         pari_free(c)
 *         global mytop, avma
 *         avma = mytop             # <<<<<<<<<<<<<<
 *         sig_off()
 *         return s
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_from_py_pari_sp(__pyx_t_1); if (unlikely((__pyx_t_3 == (pari_sp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    avma = __pyx_t_3;

    /* "example.pyx":9150
 *         global mytop, avma
 *         avma = mytop
 *         sig_off()             # <<<<<<<<<<<<<<
 *         return s
 * 
 */
    _pari_sig_off();

    /* "example.pyx":9151
 *         avma = mytop
 *         sig_off()
 *         return s             # <<<<<<<<<<<<<<
 * 
 *     cdef void clear_stack(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_s);
    __pyx_r = __pyx_v_s;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.new_gen_to_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_s);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9153
 *         return s
 * 
 *     cdef void clear_stack(self):             # <<<<<<<<<<<<<<
 *         """
 *         Clear the entire PARI stack and call sig_off().
 */

  static void __pyx_f_7example_12PariInstance_clear_stack(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    pari_sp __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("clear_stack", 0);

    /* "example.pyx":9158
 *         """
 *         global mytop, avma
 *         avma = mytop             # <<<<<<<<<<<<<<
 *         sig_off()
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_PyInt_from_py_pari_sp(__pyx_t_1); if (unlikely((__pyx_t_2 == (pari_sp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    avma = __pyx_t_2;

    /* "example.pyx":9159
 *         global mytop, avma
 *         avma = mytop
 *         sig_off()             # <<<<<<<<<<<<<<
 * 
 *     cdef void set_mytop_to_avma(self):
 */
    _pari_sig_off();

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_WriteUnraisable("example.PariInstance.clear_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":9161
 *         sig_off()
 * 
 *     cdef void set_mytop_to_avma(self):             # <<<<<<<<<<<<<<
 *         global mytop, avma
 *         mytop = avma
 */

  static void __pyx_f_7example_12PariInstance_set_mytop_to_avma(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("set_mytop_to_avma", 0);

    /* "example.pyx":9163
 *     cdef void set_mytop_to_avma(self):
 *         global mytop, avma
 *         mytop = avma             # <<<<<<<<<<<<<<
 * 
 *     cdef gen new_gen_from_int(self, int value):
 */
    __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_WriteUnraisable("example.PariInstance.set_mytop_to_avma", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":9165
 *         mytop = avma
 * 
 *     cdef gen new_gen_from_int(self, int value):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(stoi(value))
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance_new_gen_from_int(struct __pyx_obj_7example_PariInstance *__pyx_v_self, int __pyx_v_value) {
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen_from_int", 0);

    /* "example.pyx":9166
 * 
 *     cdef gen new_gen_from_int(self, int value):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(stoi(value))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9167
 *     cdef gen new_gen_from_int(self, int value):
 *         sig_on()
 *         return self.new_gen(stoi(value))             # <<<<<<<<<<<<<<
 * 
 *     cdef gen new_gen_noclear(self, GEN x):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, stoi(__pyx_v_value))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.new_gen_from_int", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9169
 *         return self.new_gen(stoi(value))
 * 
 *     cdef gen new_gen_noclear(self, GEN x):             # <<<<<<<<<<<<<<
 *         """
 *         Create a new gen, but don't free any memory on the stack and don't
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance_new_gen_noclear(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, GEN __pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_v_z = NULL;
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_gen_noclear", 0);

    /* "example.pyx":9174
 *         call sig_off().
 *         """
 *         z = _new_gen(x)             # <<<<<<<<<<<<<<
 *         return z
 * 
 */
    __pyx_t_1 = ((PyObject *)__pyx_f_7example__new_gen(__pyx_v_x)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_z = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9175
 *         """
 *         z = _new_gen(x)
 *         return z             # <<<<<<<<<<<<<<
 * 
 *     def double_to_gen(self, x):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __Pyx_INCREF(((PyObject *)__pyx_v_z));
    __pyx_r = __pyx_v_z;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.new_gen_noclear", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_z);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_25double_to_gen(PyObject *__pyx_v_self, PyObject *__pyx_v_x); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_25double_to_gen(PyObject *__pyx_v_self, PyObject *__pyx_v_x) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("double_to_gen (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_24double_to_gen(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((PyObject *)__pyx_v_x));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9177
 *         return z
 * 
 *     def double_to_gen(self, x):             # <<<<<<<<<<<<<<
 *         cdef double dx
 *         dx = float(x)
 */

  static PyObject *__pyx_pf_7example_12PariInstance_24double_to_gen(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_x) {
    double __pyx_v_dx;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    double __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("double_to_gen", 0);

    /* "example.pyx":9179
 *     def double_to_gen(self, x):
 *         cdef double dx
 *         dx = float(x)             # <<<<<<<<<<<<<<
 *         return self.double_to_gen_c(dx)
 * 
 */
    __pyx_t_1 = __Pyx_PyObject_AsDouble(__pyx_v_x); if (unlikely(__pyx_t_1 == ((double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_dx = __pyx_t_1;

    /* "example.pyx":9180
 *         cdef double dx
 *         dx = float(x)
 *         return self.double_to_gen_c(dx)             # <<<<<<<<<<<<<<
 * 
 *     cdef gen double_to_gen_c(self, double x):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->double_to_gen_c(__pyx_v_self, __pyx_v_dx)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9180; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.double_to_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9182
 *         return self.double_to_gen_c(dx)
 * 
 *     cdef gen double_to_gen_c(self, double x):             # <<<<<<<<<<<<<<
 *         """
 *         Create a new gen with the value of the double x, using Pari's
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance_double_to_gen_c(struct __pyx_obj_7example_PariInstance *__pyx_v_self, double __pyx_v_x) {
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("double_to_gen_c", 0);

    /* "example.pyx":9212
 *         # double).
 * 
 *         sig_on()             # <<<<<<<<<<<<<<
 *         if x == 0:
 *             return self.new_gen(real_0_bit(-53))
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9213
 * 
 *         sig_on()
 *         if x == 0:             # <<<<<<<<<<<<<<
 *             return self.new_gen(real_0_bit(-53))
 *         else:
 */
    __pyx_t_2 = (__pyx_v_x == 0.0);
    if (__pyx_t_2) {

      /* "example.pyx":9214
 *         sig_on()
 *         if x == 0:
 *             return self.new_gen(real_0_bit(-53))             # <<<<<<<<<<<<<<
 *         else:
 *             return self.new_gen(dbltor(x))
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, real_0_bit(-53))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":9216
 *             return self.new_gen(real_0_bit(-53))
 *         else:
 *             return self.new_gen(dbltor(x))             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN double_to_GEN(self, double x):
 */
      __Pyx_XDECREF(((PyObject *)__pyx_r));
      __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, dbltor(__pyx_v_x))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_r = ((struct __pyx_obj_7example_gen *)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.double_to_gen_c", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9218
 *             return self.new_gen(dbltor(x))
 * 
 *     cdef GEN double_to_GEN(self, double x):             # <<<<<<<<<<<<<<
 *         if x == 0:
 *             return real_0_bit(-53)
 */

  static GEN __pyx_f_7example_12PariInstance_double_to_GEN(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, double __pyx_v_x) {
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    __Pyx_RefNannySetupContext("double_to_GEN", 0);

    /* "example.pyx":9219
 * 
 *     cdef GEN double_to_GEN(self, double x):
 *         if x == 0:             # <<<<<<<<<<<<<<
 *             return real_0_bit(-53)
 *         else:
 */
    __pyx_t_1 = (__pyx_v_x == 0.0);
    if (__pyx_t_1) {

      /* "example.pyx":9220
 *     cdef GEN double_to_GEN(self, double x):
 *         if x == 0:
 *             return real_0_bit(-53)             # <<<<<<<<<<<<<<
 *         else:
 *             return dbltor(x)
 */
      __pyx_r = real_0_bit(-53);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":9222
 *             return real_0_bit(-53)
 *         else:
 *             return dbltor(x)             # <<<<<<<<<<<<<<
 * 
 *     def complex(self, re, im):
 */
      __pyx_r = dbltor(__pyx_v_x);
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_27complex(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_26complex[] = "\n        Create a new complex number, initialized from re and im.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_27complex(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_re = 0;
    PyObject *__pyx_v_im = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("complex (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__re,&__pyx_n_s__im,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__re)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__im)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("complex", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9224; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9224; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_re = values[0];
      __pyx_v_im = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("complex", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9224; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_26complex(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_re, __pyx_v_im);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9224
 *             return dbltor(x)
 * 
 *     def complex(self, re, im):             # <<<<<<<<<<<<<<
 *         """
 *         Create a new complex number, initialized from re and im.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_26complex(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_re, PyObject *__pyx_v_im) {
    GEN __pyx_v_cp;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("complex", 0);

    /* "example.pyx":9228
 *         Create a new complex number, initialized from re and im.
 *         """
 *         t0GEN(re)             # <<<<<<<<<<<<<<
 *         t1GEN(im)
 *         cdef GEN cp
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_re); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":9229
 *         """
 *         t0GEN(re)
 *         t1GEN(im)             # <<<<<<<<<<<<<<
 *         cdef GEN cp
 *         sig_on()
 */
    __pyx_t_1 = __pyx_f_7example_t1GEN(__pyx_v_im); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":9231
 *         t1GEN(im)
 *         cdef GEN cp
 *         sig_on()             # <<<<<<<<<<<<<<
 *         cp = cgetg(3, t_COMPLEX)
 *         set_gel(cp, 1, t0)
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9232
 *         cdef GEN cp
 *         sig_on()
 *         cp = cgetg(3, t_COMPLEX)             # <<<<<<<<<<<<<<
 *         set_gel(cp, 1, t0)
 *         set_gel(cp, 2, t1)
 */
    __pyx_v_cp = cgetg(3, t_COMPLEX);

    /* "example.pyx":9233
 *         sig_on()
 *         cp = cgetg(3, t_COMPLEX)
 *         set_gel(cp, 1, t0)             # <<<<<<<<<<<<<<
 *         set_gel(cp, 2, t1)
 *         return self.new_gen(cp)
 */
    set_gel(__pyx_v_cp, 1, __pyx_v_7example_t0);

    /* "example.pyx":9234
 *         cp = cgetg(3, t_COMPLEX)
 *         set_gel(cp, 1, t0)
 *         set_gel(cp, 2, t1)             # <<<<<<<<<<<<<<
 *         return self.new_gen(cp)
 * 
 */
    set_gel(__pyx_v_cp, 2, __pyx_v_7example_t1);

    /* "example.pyx":9235
 *         set_gel(cp, 1, t0)
 *         set_gel(cp, 2, t1)
 *         return self.new_gen(cp)             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN deepcopy_to_python_heap(self, GEN x, pari_sp* address):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_cp)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9235; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9237
 *         return self.new_gen(cp)
 * 
 *     cdef GEN deepcopy_to_python_heap(self, GEN x, pari_sp* address):             # <<<<<<<<<<<<<<
 *         return deepcopy_to_python_heap(x, address)
 * 
 */

  static GEN __pyx_f_7example_12PariInstance_deepcopy_to_python_heap(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, GEN __pyx_v_x, pari_sp *__pyx_v_address) {
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("deepcopy_to_python_heap", 0);

    /* "example.pyx":9238
 * 
 *     cdef GEN deepcopy_to_python_heap(self, GEN x, pari_sp* address):
 *         return deepcopy_to_python_heap(x, address)             # <<<<<<<<<<<<<<
 * 
 *     cdef gen new_ref(self, GEN g, gen parent):
 */
    __pyx_r = __pyx_f_7example_deepcopy_to_python_heap(__pyx_v_x, __pyx_v_address);
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9240
 *         return deepcopy_to_python_heap(x, address)
 * 
 *     cdef gen new_ref(self, GEN g, gen parent):             # <<<<<<<<<<<<<<
 *         """
 *         Create a new gen pointing to the given GEN, which is allocated as a
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance_new_ref(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, GEN __pyx_v_g, struct __pyx_obj_7example_gen *__pyx_v_parent) {
    struct __pyx_obj_7example_gen *__pyx_v_p = 0;
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_ref", 0);

    /* "example.pyx":9264
 *             2
 *         """
 *         cdef gen p = PY_NEW(gen)             # <<<<<<<<<<<<<<
 * 
 *         p.b = 0
 */
    __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_p = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9266
 *         cdef gen p = PY_NEW(gen)
 * 
 *         p.b = 0             # <<<<<<<<<<<<<<
 *         #p._parent = self
 *         p._refers_to = {-1:parent}
 */
    __pyx_v_p->b = 0;

    /* "example.pyx":9268
 *         p.b = 0
 *         #p._parent = self
 *         p._refers_to = {-1:parent}             # <<<<<<<<<<<<<<
 *         p.g = g
 * 
 */
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    if (PyDict_SetItem(__pyx_t_1, __pyx_int_neg_1, ((PyObject *)__pyx_v_parent)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    __Pyx_GOTREF(__pyx_v_p->_refers_to);
    __Pyx_DECREF(__pyx_v_p->_refers_to);
    __pyx_v_p->_refers_to = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9269
 *         #p._parent = self
 *         p._refers_to = {-1:parent}
 *         p.g = g             # <<<<<<<<<<<<<<
 * 
 *         return p
 */
    __pyx_v_p->g = __pyx_v_g;

    /* "example.pyx":9271
 *         p.g = g
 * 
 *         return p             # <<<<<<<<<<<<<<
 * 
 *     def __call__(self, s):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __Pyx_INCREF(((PyObject *)__pyx_v_p));
    __pyx_r = __pyx_v_p;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.new_ref", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_p);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_29__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_28__call__[] = "\n        Create the PARI object obtained by evaluating s using PARI.\n\n        EXAMPLES::\n\n            sage: pari([2,3,5])\n            [2, 3, 5]\n            sage: pari(Matrix(2,2,range(4)))\n            [0, 1; 2, 3]\n            sage: pari(x^2-3)\n            x^2 - 3\n\n        ::\n\n            sage: a = pari(1); a, a.type()\n            (1, 't_INT')\n            sage: a = pari(1/2); a, a.type()\n            (1/2, 't_FRAC')\n            sage: a = pari(1/2); a, a.type()\n            (1/2, 't_FRAC')\n\n        See :func:`pari` for more examples.\n        ";
  #if CYTHON_COMPILING_IN_CPYTHON
  struct wrapperbase __pyx_wrapperbase_7example_12PariInstance_28__call__;
  #endif
  static PyObject *__pyx_pw_7example_12PariInstance_29__call__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__call__ (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__s,0};
      PyObject* values[1] = {0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__s)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      }
      __pyx_v_s = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("__call__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_28__call__(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_s);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9273
 *         return p
 * 
 *     def __call__(self, s):             # <<<<<<<<<<<<<<
 *         """
 *         Create the PARI object obtained by evaluating s using PARI.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_28__call__(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s) {
    int __pyx_v_length;
    int __pyx_v_i;
    struct __pyx_obj_7example_gen *__pyx_v_v = 0;
    GEN __pyx_v_g;
    PyObject *__pyx_v_t = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    double __pyx_t_6;
    PyObject *__pyx_t_7 = NULL;
    PyObject *__pyx_t_8 = NULL;
    PyObject *__pyx_t_9 = NULL;
    Py_ssize_t __pyx_t_10;
    char *__pyx_t_11;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__call__", 0);

    /* "example.pyx":9301
 * 
 * 
 *         if PyObject_TypeCheck(s, gen):             # <<<<<<<<<<<<<<
 *             return s
 *         elif PyObject_HasAttrString(s, "_pari_"):
 */
    __pyx_t_1 = PyObject_TypeCheck(__pyx_v_s, ((PyObject *)((PyObject*)__pyx_ptype_7example_gen)));
    if (__pyx_t_1) {

      /* "example.pyx":9302
 * 
 *         if PyObject_TypeCheck(s, gen):
 *             return s             # <<<<<<<<<<<<<<
 *         elif PyObject_HasAttrString(s, "_pari_"):
 *             return s._pari_()
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(__pyx_v_s);
      __pyx_r = __pyx_v_s;
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":9303
 *         if PyObject_TypeCheck(s, gen):
 *             return s
 *         elif PyObject_HasAttrString(s, "_pari_"):             # <<<<<<<<<<<<<<
 *             return s._pari_()
 * 
 */
    __pyx_t_2 = PyObject_HasAttrString(__pyx_v_s, __pyx_k___pari_);
    if (__pyx_t_2) {

      /* "example.pyx":9304
 *             return s
 *         elif PyObject_HasAttrString(s, "_pari_"):
 *             return s._pari_()             # <<<<<<<<<<<<<<
 * 
 *         # Check basic Python types
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_3 = PyObject_GetAttr(__pyx_v_s, __pyx_n_s___pari_); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9307
 * 
 *         # Check basic Python types
 *         if PyInt_Check(s):             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(stoi(PyInt_AS_LONG(s)))
 */
    __pyx_t_2 = PyInt_Check(__pyx_v_s);
    if (__pyx_t_2) {

      /* "example.pyx":9308
 *         # Check basic Python types
 *         if PyInt_Check(s):
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(stoi(PyInt_AS_LONG(s)))
 *         if PyBool_Check(s):
 */
      __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":9309
 *         if PyInt_Check(s):
 *             sig_on()
 *             return self.new_gen(stoi(PyInt_AS_LONG(s)))             # <<<<<<<<<<<<<<
 *         if PyBool_Check(s):
 *             return self.PARI_ONE if s else self.PARI_ZERO
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, stoi(PyInt_AS_LONG(__pyx_v_s)))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":9310
 *             sig_on()
 *             return self.new_gen(stoi(PyInt_AS_LONG(s)))
 *         if PyBool_Check(s):             # <<<<<<<<<<<<<<
 *             return self.PARI_ONE if s else self.PARI_ZERO
 *         cdef GEN g
 */
    __pyx_t_2 = PyBool_Check(__pyx_v_s);
    if (__pyx_t_2) {

      /* "example.pyx":9311
 *             return self.new_gen(stoi(PyInt_AS_LONG(s)))
 *         if PyBool_Check(s):
 *             return self.PARI_ONE if s else self.PARI_ZERO             # <<<<<<<<<<<<<<
 *         cdef GEN g
 *         if PyLong_Check(s):
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_s); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (__pyx_t_2) {
        __Pyx_INCREF(((PyObject *)__pyx_v_self->PARI_ONE));
        __pyx_t_4 = __pyx_v_self->PARI_ONE;
      } else {
        __Pyx_INCREF(((PyObject *)__pyx_v_self->PARI_ZERO));
        __pyx_t_4 = __pyx_v_self->PARI_ZERO;
      }
      __pyx_r = ((PyObject *)__pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L5;
    }
    __pyx_L5:;

    /* "example.pyx":9313
 *             return self.PARI_ONE if s else self.PARI_ZERO
 *         cdef GEN g
 *         if PyLong_Check(s):             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(stoi((s)))
 */
    __pyx_t_2 = PyLong_Check(__pyx_v_s);
    if (__pyx_t_2) {

      /* "example.pyx":9314
 *         cdef GEN g
 *         if PyLong_Check(s):
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(stoi((s)))
 *         if PyFloat_Check(s):
 */
      __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":9315
 *         if PyLong_Check(s):
 *             sig_on()
 *             return self.new_gen(stoi((s)))             # <<<<<<<<<<<<<<
 *         if PyFloat_Check(s):
 *             sig_on()
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_v_s); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, stoi(__pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "example.pyx":9316
 *             sig_on()
 *             return self.new_gen(stoi((s)))
 *         if PyFloat_Check(s):             # <<<<<<<<<<<<<<
 *             sig_on()
 *             return self.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 */
    __pyx_t_2 = PyFloat_Check(__pyx_v_s);
    if (__pyx_t_2) {

      /* "example.pyx":9317
 *             return self.new_gen(stoi((s)))
 *         if PyFloat_Check(s):
 *             sig_on()             # <<<<<<<<<<<<<<
 *             return self.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *         if PyComplex_Check(s):
 */
      __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":9318
 *         if PyFloat_Check(s):
 *             sig_on()
 *             return self.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))             # <<<<<<<<<<<<<<
 *         if PyComplex_Check(s):
 *             sig_on()
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_6 = PyFloat_AS_DOUBLE(__pyx_v_s); if (unlikely(__pyx_t_6 == -1.0 && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, dbltor(__pyx_t_6))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9318; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "example.pyx":9319
 *             sig_on()
 *             return self.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *         if PyComplex_Check(s):             # <<<<<<<<<<<<<<
 *             sig_on()
 *             g = cgetg(3, t_COMPLEX)
 */
    __pyx_t_2 = PyComplex_Check(__pyx_v_s);
    if (__pyx_t_2) {

      /* "example.pyx":9320
 *             return self.new_gen(dbltor(PyFloat_AS_DOUBLE(s)))
 *         if PyComplex_Check(s):
 *             sig_on()             # <<<<<<<<<<<<<<
 *             g = cgetg(3, t_COMPLEX)
 *             set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 */
      __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "example.pyx":9321
 *         if PyComplex_Check(s):
 *             sig_on()
 *             g = cgetg(3, t_COMPLEX)             # <<<<<<<<<<<<<<
 *             set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *             set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 */
      __pyx_v_g = cgetg(3, t_COMPLEX);

      /* "example.pyx":9322
 *             sig_on()
 *             g = cgetg(3, t_COMPLEX)
 *             set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))             # <<<<<<<<<<<<<<
 *             set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 *             return self.new_gen(g)
 */
      __pyx_t_6 = PyComplex_RealAsDouble(__pyx_v_s); if (unlikely(__pyx_t_6 == -1.0 && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      set_gel(__pyx_v_g, 1, dbltor(__pyx_t_6));

      /* "example.pyx":9323
 *             g = cgetg(3, t_COMPLEX)
 *             set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *             set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))             # <<<<<<<<<<<<<<
 *             return self.new_gen(g)
 * 
 */
      __pyx_t_6 = PyComplex_ImagAsDouble(__pyx_v_s); if (unlikely(__pyx_t_6 == -1.0 && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      set_gel(__pyx_v_g, 2, dbltor(__pyx_t_6));

      /* "example.pyx":9324
 *             set_gel(g, 1, dbltor(PyComplex_RealAsDouble(s)))
 *             set_gel(g, 2, dbltor(PyComplex_ImagAsDouble(s)))
 *             return self.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 *         if isinstance(s, (types.ListType, types.XRangeType,
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_g)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_r = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L0;
      goto __pyx_L8;
    }
    __pyx_L8:;

    /* "example.pyx":9326
 *             return self.new_gen(g)
 * 
 *         if isinstance(s, (types.ListType, types.XRangeType,             # <<<<<<<<<<<<<<
 *                             types.TupleType, types.GeneratorType)):
 *             length = len(s)
 */
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__types); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__ListType); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__types); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__XRangeType); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "example.pyx":9327
 * 
 *         if isinstance(s, (types.ListType, types.XRangeType,
 *                             types.TupleType, types.GeneratorType)):             # <<<<<<<<<<<<<<
 *             length = len(s)
 *             v = self._empty_vector(length)
 */
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__types); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_8 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__TupleType); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__types); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_9 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__GeneratorType); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_8);
    __Pyx_GIVEREF(__pyx_t_8);
    PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_9);
    __Pyx_GIVEREF(__pyx_t_9);
    __pyx_t_3 = 0;
    __pyx_t_7 = 0;
    __pyx_t_8 = 0;
    __pyx_t_9 = 0;
    __pyx_t_2 = PyObject_IsInstance(__pyx_v_s, ((PyObject *)__pyx_t_4)); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    if (__pyx_t_2) {

      /* "example.pyx":9328
 *         if isinstance(s, (types.ListType, types.XRangeType,
 *                             types.TupleType, types.GeneratorType)):
 *             length = len(s)             # <<<<<<<<<<<<<<
 *             v = self._empty_vector(length)
 *             for i from 0 <= i < length:
 */
      __pyx_t_10 = PyObject_Length(__pyx_v_s); if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v_length = __pyx_t_10;

      /* "example.pyx":9329
 *                             types.TupleType, types.GeneratorType)):
 *             length = len(s)
 *             v = self._empty_vector(length)             # <<<<<<<<<<<<<<
 *             for i from 0 <= i < length:
 *                 v[i] = self(s[i])
 */
      __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->_empty_vector(__pyx_v_self, __pyx_v_length)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_v_v = ((struct __pyx_obj_7example_gen *)__pyx_t_4);
      __pyx_t_4 = 0;

      /* "example.pyx":9330
 *             length = len(s)
 *             v = self._empty_vector(length)
 *             for i from 0 <= i < length:             # <<<<<<<<<<<<<<
 *                 v[i] = self(s[i])
 *             return v
 */
      __pyx_t_1 = __pyx_v_length;
      for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_1; __pyx_v_i++) {

        /* "example.pyx":9331
 *             v = self._empty_vector(length)
 *             for i from 0 <= i < length:
 *                 v[i] = self(s[i])             # <<<<<<<<<<<<<<
 *             return v
 * 
 */
        __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_s, __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_4 = PyObject_Call(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_t_9), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_DECREF(((PyObject *)__pyx_t_9)); __pyx_t_9 = 0;
        if (__Pyx_SetItemInt(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_t_4, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      }

      /* "example.pyx":9332
 *             for i from 0 <= i < length:
 *                 v[i] = self(s[i])
 *             return v             # <<<<<<<<<<<<<<
 * 
 *         t = str(s)
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_v));
      __pyx_r = ((PyObject *)__pyx_v_v);
      goto __pyx_L0;
      goto __pyx_L9;
    }
    __pyx_L9:;

    /* "example.pyx":9334
 *             return v
 * 
 *         t = str(s)             # <<<<<<<<<<<<<<
 *         sig_str('evaluating PARI string')
 *         g = gp_read_str(t)
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    __pyx_t_9 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_v_t = __pyx_t_9;
    __pyx_t_9 = 0;

    /* "example.pyx":9335
 * 
 *         t = str(s)
 *         sig_str('evaluating PARI string')             # <<<<<<<<<<<<<<
 *         g = gp_read_str(t)
 *         if g == gnil:
 */
    __pyx_t_1 = _pari_sig_str(__pyx_k_60); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9336
 *         t = str(s)
 *         sig_str('evaluating PARI string')
 *         g = gp_read_str(t)             # <<<<<<<<<<<<<<
 *         if g == gnil:
 *             sig_off()
 */
    __pyx_t_11 = PyBytes_AsString(__pyx_v_t); if (unlikely((!__pyx_t_11) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_g = gp_read_str(__pyx_t_11);

    /* "example.pyx":9337
 *         sig_str('evaluating PARI string')
 *         g = gp_read_str(t)
 *         if g == gnil:             # <<<<<<<<<<<<<<
 *             sig_off()
 *             return None
 */
    __pyx_t_2 = (__pyx_v_g == gnil);
    if (__pyx_t_2) {

      /* "example.pyx":9338
 *         g = gp_read_str(t)
 *         if g == gnil:
 *             sig_off()             # <<<<<<<<<<<<<<
 *             return None
 *         return self.new_gen(g)
 */
      _pari_sig_off();

      /* "example.pyx":9339
 *         if g == gnil:
 *             sig_off()
 *             return None             # <<<<<<<<<<<<<<
 *         return self.new_gen(g)
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(Py_None);
      __pyx_r = Py_None;
      goto __pyx_L0;
      goto __pyx_L12;
    }
    __pyx_L12:;

    /* "example.pyx":9340
 *             sig_off()
 *             return None
 *         return self.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_9 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_g)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_r = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_XDECREF(__pyx_t_9);
    __Pyx_AddTraceback("example.PariInstance.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XDECREF(__pyx_v_t);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_31new_with_bits_prec(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_30new_with_bits_prec[] = "\n        pari.new_with_bits_prec(self, s, precision) creates s as a PARI\n        gen with (at most) precision *bits* of precision.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_31new_with_bits_prec(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    long __pyx_v_precision;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("new_with_bits_prec (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__s,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__s)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("new_with_bits_prec", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9358; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "new_with_bits_prec") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9358; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_s = values[0];
      __pyx_v_precision = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_precision == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9358; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("new_with_bits_prec", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9358; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.new_with_bits_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_30new_with_bits_prec(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_s, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9358
 *     #     return self.PARI_ZERO
 * 
 *     def new_with_bits_prec(self, s, long precision):             # <<<<<<<<<<<<<<
 *         r"""
 *         pari.new_with_bits_prec(self, s, precision) creates s as a PARI
 */

  static PyObject *__pyx_pf_7example_12PariInstance_30new_with_bits_prec(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s, long __pyx_v_precision) {
    unsigned long __pyx_v_old_prec;
    PyObject *__pyx_v_x = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    long __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("new_with_bits_prec", 0);

    /* "example.pyx":9364
 *         """
 *         cdef unsigned long old_prec
 *         old_prec = GP_DATA.fmt.sigd             # <<<<<<<<<<<<<<
 *         precision = prec_bits_to_dec(precision)
 *         if not precision:
 */
    __pyx_t_1 = GP_DATA->fmt->sigd;
    __pyx_v_old_prec = __pyx_t_1;

    /* "example.pyx":9365
 *         cdef unsigned long old_prec
 *         old_prec = GP_DATA.fmt.sigd
 *         precision = prec_bits_to_dec(precision)             # <<<<<<<<<<<<<<
 *         if not precision:
 *             precision = old_prec
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_dec); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_t_1 = __Pyx_PyInt_AsLong(__pyx_t_3); if (unlikely((__pyx_t_1 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_precision = __pyx_t_1;

    /* "example.pyx":9366
 *         old_prec = GP_DATA.fmt.sigd
 *         precision = prec_bits_to_dec(precision)
 *         if not precision:             # <<<<<<<<<<<<<<
 *             precision = old_prec
 *         self.set_real_precision(precision)
 */
    __pyx_t_5 = (!__pyx_v_precision);
    if (__pyx_t_5) {

      /* "example.pyx":9367
 *         precision = prec_bits_to_dec(precision)
 *         if not precision:
 *             precision = old_prec             # <<<<<<<<<<<<<<
 *         self.set_real_precision(precision)
 *         x = self(s)
 */
      __pyx_v_precision = __pyx_v_old_prec;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9368
 *         if not precision:
 *             precision = old_prec
 *         self.set_real_precision(precision)             # <<<<<<<<<<<<<<
 *         x = self(s)
 *         self.set_real_precision(old_prec)
 */
    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__set_real_precision); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyInt_FromLong(__pyx_v_precision); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "example.pyx":9369
 *             precision = old_prec
 *         self.set_real_precision(precision)
 *         x = self(s)             # <<<<<<<<<<<<<<
 *         self.set_real_precision(old_prec)
 *         return x
 */
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    __pyx_t_2 = PyObject_Call(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __pyx_v_x = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "example.pyx":9370
 *         self.set_real_precision(precision)
 *         x = self(s)
 *         self.set_real_precision(old_prec)             # <<<<<<<<<<<<<<
 *         return x
 * 
 */
    __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__set_real_precision); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = PyLong_FromUnsignedLong(__pyx_v_old_prec); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "example.pyx":9371
 *         x = self(s)
 *         self.set_real_precision(old_prec)
 *         return x             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_x);
    __pyx_r = __pyx_v_x;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.PariInstance.new_with_bits_prec", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9375
 * 
 * 
 *     cdef long get_var(self, v):             # <<<<<<<<<<<<<<
 *         """
 *         Converts a Python string into a PARI variable reference number. Or
 */

  static long __pyx_f_7example_12PariInstance_get_var(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_v_s = NULL;
    long __pyx_r;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    char *__pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("get_var", 0);

    /* "example.pyx":9380
 *         if v = -1, returns -1.
 *         """
 *         if v != -1:             # <<<<<<<<<<<<<<
 *             s = str(v)
 *             return fetch_user_var(s)
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_v, __pyx_int_neg_1, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9380; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_2) {

      /* "example.pyx":9381
 *         """
 *         if v != -1:
 *             s = str(v)             # <<<<<<<<<<<<<<
 *             return fetch_user_var(s)
 *         return -1
 */
      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_INCREF(__pyx_v_v);
      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_v);
      __Pyx_GIVEREF(__pyx_v_v);
      __pyx_t_3 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9381; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __pyx_v_s = __pyx_t_3;
      __pyx_t_3 = 0;

      /* "example.pyx":9382
 *         if v != -1:
 *             s = str(v)
 *             return fetch_user_var(s)             # <<<<<<<<<<<<<<
 *         return -1
 * 
 */
      __pyx_t_4 = PyBytes_AsString(__pyx_v_s); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_r = fetch_user_var(__pyx_t_4);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9383
 *             s = str(v)
 *             return fetch_user_var(s)
 *         return -1             # <<<<<<<<<<<<<<
 * 
 *     ############################################################
 */
    __pyx_r = -1;
    goto __pyx_L0;

    __pyx_r = 0;
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_WriteUnraisable("example.PariInstance.get_var", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_s);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_33allocatemem(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_32allocatemem[] = "\n        Double the *PARI* stack.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_33allocatemem(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_s = 0;
    PyObject *__pyx_v_silent = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("allocatemem (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__s,&__pyx_n_s__silent,0};
      PyObject* values[2] = {0,0};
      values[0] = ((PyObject *)__pyx_int_0);
      values[1] = __pyx_k_61;
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__s);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__silent);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "allocatemem") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_s = values[0];
      __pyx_v_silent = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("allocatemem", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9389; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.allocatemem", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_32allocatemem(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_s, __pyx_v_silent);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9389
 *     ############################################################
 * 
 *     def allocatemem(self, s=0, silent=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         Double the *PARI* stack.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_32allocatemem(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_s, PyObject *__pyx_v_silent) {
    size_t __pyx_v_a;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_t_4;
    PyObject *__pyx_t_5 = NULL;
    size_t __pyx_t_6;
    int __pyx_t_7;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("allocatemem", 0);
    __Pyx_INCREF(__pyx_v_s);

    /* "example.pyx":9393
 *         Double the *PARI* stack.
 *         """
 *         if s == 0 and not silent:             # <<<<<<<<<<<<<<
 *             print "Doubling the PARI stack."
 *         s = int(s)
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_s, __pyx_int_0, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_2) {
      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_silent); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_4 = (!__pyx_t_3);
      __pyx_t_3 = __pyx_t_4;
    } else {
      __pyx_t_3 = __pyx_t_2;
    }
    if (__pyx_t_3) {

      /* "example.pyx":9394
 *         """
 *         if s == 0 and not silent:
 *             print "Doubling the PARI stack."             # <<<<<<<<<<<<<<
 *         s = int(s)
 *         cdef size_t a = s
 */
      if (__Pyx_PrintOne(0, ((PyObject *)__pyx_kp_s_62)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9395
 *         if s == 0 and not silent:
 *             print "Doubling the PARI stack."
 *         s = int(s)             # <<<<<<<<<<<<<<
 *         cdef size_t a = s
 *         if int(a) != s:
 */
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_v_s);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_s);
    __Pyx_GIVEREF(__pyx_v_s);
    __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_v_s);
    __pyx_v_s = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "example.pyx":9396
 *             print "Doubling the PARI stack."
 *         s = int(s)
 *         cdef size_t a = s             # <<<<<<<<<<<<<<
 *         if int(a) != s:
 *             raise ValueError, "s must be nonnegative and not too big."
 */
    __pyx_t_6 = __Pyx_PyInt_AsSize_t(__pyx_v_s); if (unlikely((__pyx_t_6 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_a = __pyx_t_6;

    /* "example.pyx":9397
 *         s = int(s)
 *         cdef size_t a = s
 *         if int(a) != s:             # <<<<<<<<<<<<<<
 *             raise ValueError, "s must be nonnegative and not too big."
 *         init_stack(s)
 */
    __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_a); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_t_5, __pyx_v_s, Py_NE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_3) {

      /* "example.pyx":9398
 *         cdef size_t a = s
 *         if int(a) != s:
 *             raise ValueError, "s must be nonnegative and not too big."             # <<<<<<<<<<<<<<
 *         init_stack(s)
 * 
 */
      __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_kp_s_63), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":9399
 *         if int(a) != s:
 *             raise ValueError, "s must be nonnegative and not too big."
 *         init_stack(s)             # <<<<<<<<<<<<<<
 * 
 *     def pari_version(self):
 */
    __pyx_t_6 = __Pyx_PyInt_AsSize_t(__pyx_v_s); if (unlikely((__pyx_t_6 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_7 = __pyx_f_7example_init_stack(__pyx_t_6); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.PariInstance.allocatemem", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_s);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_35pari_version(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_35pari_version(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("pari_version (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_34pari_version(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9401
 *         init_stack(s)
 * 
 *     def pari_version(self):             # <<<<<<<<<<<<<<
 *         return str(PARIVERSION)
 * 
 */

  static PyObject *__pyx_pf_7example_12PariInstance_34pari_version(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pari_version", 0);

    /* "example.pyx":9402
 * 
 *     def pari_version(self):
 *         return str(PARIVERSION)             # <<<<<<<<<<<<<<
 * 
 *     def init_primes(self, _M):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyBytes_FromString(PARIVERSION); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_1));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyString_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.pari_version", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_37init_primes(PyObject *__pyx_v_self, PyObject *__pyx_v__M); /*proto*/
  static char __pyx_doc_7example_12PariInstance_36init_primes[] = "\n        Recompute the primes table including at least all primes up to M\n        (but possibly more).\n\n        EXAMPLES::\n\n            sage: pari.init_primes(200000)\n\n        We make sure that ticket #11741 has been fixed, and double check to\n        make sure that diffptr has not been freed::\n\n            sage: pari.init_primes(2^62)\n            Traceback (most recent call last):\n            ...\n            PariError: not enough memory (28)            # 64-bit\n            OverflowError: long int too large to convert # 32-bit\n            sage: pari.init_primes(200000)\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_37init_primes(PyObject *__pyx_v_self, PyObject *__pyx_v__M) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("init_primes (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_36init_primes(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((PyObject *)__pyx_v__M));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9404
 *         return str(PARIVERSION)
 * 
 *     def init_primes(self, _M):             # <<<<<<<<<<<<<<
 *         """
 *         Recompute the primes table including at least all primes up to M
 */

  static PyObject *__pyx_pf_7example_12PariInstance_36init_primes(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v__M) {
    unsigned long __pyx_v_M;
    char *__pyx_v_tmpptr;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    unsigned long __pyx_t_1;
    int __pyx_t_2;
    int __pyx_t_3;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("init_primes", 0);

    /* "example.pyx":9425
 *         cdef unsigned long M
 *         cdef char *tmpptr
 *         M = _M             # <<<<<<<<<<<<<<
 *         global diffptr, num_primes
 *         if M <= num_primes:
 */
    __pyx_t_1 = __Pyx_PyInt_AsUnsignedLong(__pyx_v__M); if (unlikely((__pyx_t_1 == (unsigned long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_M = __pyx_t_1;

    /* "example.pyx":9427
 *         M = _M
 *         global diffptr, num_primes
 *         if M <= num_primes:             # <<<<<<<<<<<<<<
 *             return
 *         sig_on()
 */
    __pyx_t_2 = (__pyx_v_M <= __pyx_v_7example_num_primes);
    if (__pyx_t_2) {

      /* "example.pyx":9428
 *         global diffptr, num_primes
 *         if M <= num_primes:
 *             return             # <<<<<<<<<<<<<<
 *         sig_on()
 *         tmpptr = initprimes(M)
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_r = Py_None; __Pyx_INCREF(Py_None);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9429
 *         if M <= num_primes:
 *             return
 *         sig_on()             # <<<<<<<<<<<<<<
 *         tmpptr = initprimes(M)
 *         sig_off()
 */
    __pyx_t_3 = _pari_sig_on(); if (unlikely(__pyx_t_3 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9430
 *             return
 *         sig_on()
 *         tmpptr = initprimes(M)             # <<<<<<<<<<<<<<
 *         sig_off()
 *         pari_free(<void*> diffptr)
 */
    __pyx_v_tmpptr = initprimes(__pyx_v_M);

    /* "example.pyx":9431
 *         sig_on()
 *         tmpptr = initprimes(M)
 *         sig_off()             # <<<<<<<<<<<<<<
 *         pari_free(<void*> diffptr)
 *         num_primes = M
 */
    _pari_sig_off();

    /* "example.pyx":9432
 *         tmpptr = initprimes(M)
 *         sig_off()
 *         pari_free(<void*> diffptr)             # <<<<<<<<<<<<<<
 *         num_primes = M
 *         diffptr = tmpptr
 */
    pari_free(((void *)diffptr));

    /* "example.pyx":9433
 *         sig_off()
 *         pari_free(<void*> diffptr)
 *         num_primes = M             # <<<<<<<<<<<<<<
 *         diffptr = tmpptr
 * 
 */
    __pyx_v_7example_num_primes = __pyx_v_M;

    /* "example.pyx":9434
 *         pari_free(<void*> diffptr)
 *         num_primes = M
 *         diffptr = tmpptr             # <<<<<<<<<<<<<<
 * 
 * 
 */
    diffptr = __pyx_v_tmpptr;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_AddTraceback("example.PariInstance.init_primes", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_39read(PyObject *__pyx_v_self, PyObject *__pyx_v_filename); /*proto*/
  static char __pyx_doc_7example_12PariInstance_38read[] = "\n        Read a script from the named filename into the interpreter.  The\n        functions defined in the script are then available for use from\n        Sage/PARI.  The result of the last command in ``filename`` is\n        returned.\n\n        EXAMPLES:\n\n        Create a gp file::\n\n            sage: import tempfile\n            sage: gpfile = tempfile.NamedTemporaryFile(mode=\"w\")\n            sage: gpfile.file.write(\"mysquare(n) = {\\n\")\n            sage: gpfile.file.write(\"    n^2;\\n\")\n            sage: gpfile.file.write(\"}\\n\")\n            sage: gpfile.file.write(\"polcyclo(5)\\n\")\n            sage: gpfile.file.flush()\n\n        Read it in Sage, we get the result of the last line::\n\n            sage: pari.read(gpfile.name)\n            x^4 + x^3 + x^2 + x + 1\n\n        Call the function defined in the gp file::\n\n            sage: pari('mysquare(12)')\n            144\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_39read(PyObject *__pyx_v_self, PyObject *__pyx_v_filename) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("read (wrapper)", 0);
    if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_filename), (&PyBytes_Type), 1, "filename", 1))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_r = __pyx_pf_7example_12PariInstance_38read(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((PyObject*)__pyx_v_filename));
    goto __pyx_L0;
    __pyx_L1_error:;
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9441
 *     ##############################################
 * 
 *     def read(self, bytes filename):             # <<<<<<<<<<<<<<
 *         r"""
 *         Read a script from the named filename into the interpreter.  The
 */

  static PyObject *__pyx_pf_7example_12PariInstance_38read(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_filename) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    char *__pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("read", 0);

    /* "example.pyx":9470
 *             144
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(gp_read_file(filename))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9471
 *         """
 *         sig_on()
 *         return self.new_gen(gp_read_file(filename))             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyBytes_AsString(((PyObject *)__pyx_v_filename)); if (unlikely((!__pyx_t_2) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gp_read_file(__pyx_t_2))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_41_primelimit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_12PariInstance_40_primelimit[] = "\n        Return the number of primes already computed\n        in this Pari instance.\n\n        EXAMPLES:\n            sage: pari._primelimit()\n            500519\n            sage: pari.init_primes(600000)\n            sage: pari._primelimit()\n            600000\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_41_primelimit(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("_primelimit (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_40_primelimit(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9476
 *     ##############################################
 * 
 *     def _primelimit(self):             # <<<<<<<<<<<<<<
 *         """
 *         Return the number of primes already computed
 */

  static PyObject *__pyx_pf_7example_12PariInstance_40_primelimit(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_v_ZZ = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_primelimit", 0);

    /* "example.pyx":9489
 *         """
 *         global num_primes
 *         from sage.rings.all import ZZ             # <<<<<<<<<<<<<<
 *         return ZZ(num_primes)
 * 
 */
    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(((PyObject *)__pyx_n_s__ZZ));
    PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__ZZ));
    __Pyx_GIVEREF(((PyObject *)__pyx_n_s__ZZ));
    __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s_64), ((PyObject *)__pyx_t_1), -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__ZZ);
    if (__pyx_t_1 == NULL) {
      if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseImportError(__pyx_n_s__ZZ);
      if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_INCREF(__pyx_t_1);
    __pyx_v_ZZ = __pyx_t_1;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":9490
 *         global num_primes
 *         from sage.rings.all import ZZ
 *         return ZZ(num_primes)             # <<<<<<<<<<<<<<
 * 
 *     def prime_list(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyLong_FromUnsignedLong(__pyx_v_7example_num_primes); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_v_ZZ, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance._primelimit", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_ZZ);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_43prime_list(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_12PariInstance_42prime_list[] = "\n        prime_list(n): returns list of the first n primes\n\n        To extend the table of primes use pari.init_primes(M).\n\n        INPUT:\n\n\n        -  ``n`` - C long\n\n\n        OUTPUT:\n\n\n        -  ``gen`` - PARI list of first n primes\n\n\n        EXAMPLES::\n\n            sage: pari.prime_list(0)\n            []\n            sage: pari.prime_list(-1)\n            []\n            sage: pari.prime_list(3)\n            [2, 3, 5]\n            sage: pari.prime_list(10)\n            [2, 3, 5, 7, 11, 13, 17, 19, 23, 29]\n            sage: pari.prime_list(20)\n            [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71]\n            sage: len(pari.prime_list(1000))\n            1000\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_43prime_list(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("prime_list (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9492; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.prime_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_42prime_list(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9492
 *         return ZZ(num_primes)
 * 
 *     def prime_list(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         prime_list(n): returns list of the first n primes
 */

  static PyObject *__pyx_pf_7example_12PariInstance_42prime_list(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("prime_list", 0);

    /* "example.pyx":9525
 *             1000
 *         """
 *         if n >= 2:             # <<<<<<<<<<<<<<
 *             self.nth_prime(n)
 *         sig_on()
 */
    __pyx_t_1 = (__pyx_v_n >= 2);
    if (__pyx_t_1) {

      /* "example.pyx":9526
 *         """
 *         if n >= 2:
 *             self.nth_prime(n)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(primes(n))
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__nth_prime); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9527
 *         if n >= 2:
 *             self.nth_prime(n)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(primes(n))
 * 
 */
    __pyx_t_5 = _pari_sig_on(); if (unlikely(__pyx_t_5 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9528
 *             self.nth_prime(n)
 *         sig_on()
 *         return self.new_gen(primes(n))             # <<<<<<<<<<<<<<
 * 
 *     def primes_up_to_n(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, primes(__pyx_v_n))); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.PariInstance.prime_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_45primes_up_to_n(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_12PariInstance_44primes_up_to_n[] = "\n        Return the primes <= n as a pari list.\n\n        EXAMPLES::\n\n            sage: pari.primes_up_to_n(1)\n            []\n            sage: pari.primes_up_to_n(20)\n            [2, 3, 5, 7, 11, 13, 17, 19]\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_45primes_up_to_n(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("primes_up_to_n (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9530; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.primes_up_to_n", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_44primes_up_to_n(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9530
 *         return self.new_gen(primes(n))
 * 
 *     def primes_up_to_n(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the primes <= n as a pari list.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_44primes_up_to_n(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("primes_up_to_n", 0);

    /* "example.pyx":9541
 *             [2, 3, 5, 7, 11, 13, 17, 19]
 *         """
 *         if n <= 1:             # <<<<<<<<<<<<<<
 *             return pari([])
 *         self.init_primes(n+1)
 */
    __pyx_t_1 = (__pyx_v_n <= 1);
    if (__pyx_t_1) {

      /* "example.pyx":9542
 *         """
 *         if n <= 1:
 *             return pari([])             # <<<<<<<<<<<<<<
 *         self.init_primes(n+1)
 *         return self.prime_list(pari(n).primepi())
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
      __pyx_t_3 = 0;
      __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9543
 *         if n <= 1:
 *             return pari([])
 *         self.init_primes(n+1)             # <<<<<<<<<<<<<<
 *         return self.prime_list(pari(n).primepi())
 * 
 */
    __pyx_t_3 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__init_primes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyInt_FromLong((__pyx_v_n + 1)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

    /* "example.pyx":9544
 *             return pari([])
 *         self.init_primes(n+1)
 *         return self.prime_list(pari(n).primepi())             # <<<<<<<<<<<<<<
 * 
 * ##         cdef long k
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__prime_list); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__primepi); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.PariInstance.primes_up_to_n", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_47__nth_prime(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_12PariInstance_46__nth_prime[] = "\n        nth_prime(n): returns the n-th prime, where n is a C-int\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_47__nth_prime(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__nth_prime (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9555; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.__nth_prime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_46__nth_prime(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9555
 * ##         return v[:pari(n).primepi()]
 * 
 *     def __nth_prime(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         nth_prime(n): returns the n-th prime, where n is a C-int
 */

  static PyObject *__pyx_pf_7example_12PariInstance_46__nth_prime(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    GEN __pyx_v_g;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__nth_prime", 0);

    /* "example.pyx":9561
 *         global num_primes
 * 
 *         if n <= 0:             # <<<<<<<<<<<<<<
 *             raise ValueError, "nth prime meaningless for non-positive n (=%s)"%n
 *         cdef GEN g
 */
    __pyx_t_1 = (__pyx_v_n <= 0);
    if (__pyx_t_1) {

      /* "example.pyx":9562
 * 
 *         if n <= 0:
 *             raise ValueError, "nth prime meaningless for non-positive n (=%s)"%n             # <<<<<<<<<<<<<<
 *         cdef GEN g
 *         sig_on()
 */
      __pyx_t_2 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_65), __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_builtin_ValueError, ((PyObject *)__pyx_t_3), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9564
 *             raise ValueError, "nth prime meaningless for non-positive n (=%s)"%n
 *         cdef GEN g
 *         sig_on()             # <<<<<<<<<<<<<<
 *         g = prime(n)
 *         return self.new_gen(g)
 */
    __pyx_t_4 = _pari_sig_on(); if (unlikely(__pyx_t_4 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9565
 *         cdef GEN g
 *         sig_on()
 *         g = prime(n)             # <<<<<<<<<<<<<<
 *         return self.new_gen(g)
 * 
 */
    __pyx_v_g = prime(__pyx_v_n);

    /* "example.pyx":9566
 *         sig_on()
 *         g = prime(n)
 *         return self.new_gen(g)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, __pyx_v_g)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.__nth_prime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_49nth_prime(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_49nth_prime(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("nth_prime (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9569; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.nth_prime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_48nth_prime(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9569
 * 
 * 
 *     def nth_prime(self, long n):             # <<<<<<<<<<<<<<
 *         try:
 *             return self.__nth_prime(n)
 */

  static PyObject *__pyx_pf_7example_12PariInstance_48nth_prime(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    int __pyx_t_7;
    PyObject *__pyx_t_8 = NULL;
    long __pyx_t_9;
    unsigned long __pyx_t_10;
    unsigned long __pyx_t_11;
    PyObject *__pyx_t_12 = NULL;
    PyObject *__pyx_t_13 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("nth_prime", 0);

    /* "example.pyx":9570
 * 
 *     def nth_prime(self, long n):
 *         try:             # <<<<<<<<<<<<<<
 *             return self.__nth_prime(n)
 *         except PariError:
 */
    {
      __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
      __Pyx_XGOTREF(__pyx_t_1);
      __Pyx_XGOTREF(__pyx_t_2);
      __Pyx_XGOTREF(__pyx_t_3);
      /*try:*/ {

        /* "example.pyx":9571
 *     def nth_prime(self, long n):
 *         try:
 *             return self.__nth_prime(n)             # <<<<<<<<<<<<<<
 *         except PariError:
 *             self.init_primes(max(2*num_primes,20*n))
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_4 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s____nth_prime); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_5 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9571; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
        __pyx_r = __pyx_t_5;
        __pyx_t_5 = 0;
        goto __pyx_L7_try_return;
      }
      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L10_try_end;
      __pyx_L7_try_return:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      goto __pyx_L0;
      __pyx_L3_error:;
      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;

      /* "example.pyx":9572
 *         try:
 *             return self.__nth_prime(n)
 *         except PariError:             # <<<<<<<<<<<<<<
 *             self.init_primes(max(2*num_primes,20*n))
 *             return self.nth_prime(n)
 */
      __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__PariError); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9572; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __pyx_t_7 = PyErr_ExceptionMatches(__pyx_t_5);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_7) {
        __Pyx_AddTraceback("example.PariInstance.nth_prime", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9572; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_GOTREF(__pyx_t_4);

        /* "example.pyx":9573
 *             return self.__nth_prime(n)
 *         except PariError:
 *             self.init_primes(max(2*num_primes,20*n))             # <<<<<<<<<<<<<<
 *             return self.nth_prime(n)
 * 
 */
        __pyx_t_8 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__init_primes); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9573; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_9 = (20 * __pyx_v_n);
        __pyx_t_10 = (2 * __pyx_v_7example_num_primes);
        if ((__pyx_t_9 > __pyx_t_10)) {
          __pyx_t_11 = __pyx_t_9;
        } else {
          __pyx_t_11 = __pyx_t_10;
        }
        __pyx_t_12 = PyLong_FromUnsignedLong(__pyx_t_11); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9573; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_13 = PyTuple_New(1); if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9573; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_13);
        PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_12);
        __Pyx_GIVEREF(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = PyObject_Call(__pyx_t_8, ((PyObject *)__pyx_t_13), NULL); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9573; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_12);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_13)); __pyx_t_13 = 0;
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;

        /* "example.pyx":9574
 *         except PariError:
 *             self.init_primes(max(2*num_primes,20*n))
 *             return self.nth_prime(n)             # <<<<<<<<<<<<<<
 * 
 *     def euler(self, precision=0):
 */
        __Pyx_XDECREF(__pyx_r);
        __pyx_t_12 = PyObject_GetAttr(((PyObject *)__pyx_v_self), __pyx_n_s__nth_prime); if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_12);
        __pyx_t_13 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_13);
        __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_13);
        __Pyx_GIVEREF(__pyx_t_13);
        __pyx_t_13 = 0;
        __pyx_t_13 = PyObject_Call(__pyx_t_12, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9574; __pyx_clineno = __LINE__; goto __pyx_L5_except_error;}
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
        __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
        __pyx_r = __pyx_t_13;
        __pyx_t_13 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L6_except_return;
        __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L4_exception_handled;
      }
      __pyx_L5_except_error:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      goto __pyx_L1_error;
      __pyx_L6_except_return:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      goto __pyx_L0;
      __pyx_L4_exception_handled:;
      __Pyx_XGIVEREF(__pyx_t_1);
      __Pyx_XGIVEREF(__pyx_t_2);
      __Pyx_XGIVEREF(__pyx_t_3);
      __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
      __pyx_L10_try_end:;
    }

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_XDECREF(__pyx_t_12);
    __Pyx_XDECREF(__pyx_t_13);
    __Pyx_AddTraceback("example.PariInstance.nth_prime", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_51euler(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_50euler[] = "\n        Return Euler's constant to the requested real precision (in bits).\n\n        EXAMPLES::\n\n            sage: pari.euler()\n            0.577215664901533\n            sage: pari.euler(precision=100).python()\n            0.577215664901532860606512090082...\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_51euler(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("euler (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "euler") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9576; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("euler", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9576; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.euler", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_50euler(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9576
 *             return self.nth_prime(n)
 * 
 *     def euler(self, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return Euler's constant to the requested real precision (in bits).
 */

  static PyObject *__pyx_pf_7example_12PariInstance_50euler(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("euler", 0);

    /* "example.pyx":9587
 *             0.577215664901532860606512090082...
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(mpeuler(pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9587; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9588
 *         """
 *         sig_on()
 *         return self.new_gen(mpeuler(pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def pi(self, precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, mpeuler(__pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.PariInstance.euler", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_53pi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_52pi[] = "\n        Return the value of the constant pi to the requested real precision\n        (in bits).\n\n        EXAMPLES::\n\n            sage: pari.pi()\n            3.14159265358979\n            sage: pari.pi(precision=100).python()\n            3.1415926535897932384626433832...\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_53pi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("pi (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__precision,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pi") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_precision = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("pi", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9590; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.pi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_52pi(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9590
 *         return self.new_gen(mpeuler(pbw(precision)))
 * 
 *     def pi(self, precision=0):             # <<<<<<<<<<<<<<
 *         """
 *         Return the value of the constant pi to the requested real precision
 */

  static PyObject *__pyx_pf_7example_12PariInstance_52pi(struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    long __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pi", 0);

    /* "example.pyx":9602
 *             3.1415926535897932384626433832...
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(mppi(pbw(precision)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9602; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9603
 *         """
 *         sig_on()
 *         return self.new_gen(mppi(pbw(precision)))             # <<<<<<<<<<<<<<
 * 
 *     def pollegendre(self, long n, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsLong(__pyx_t_4); if (unlikely((__pyx_t_5 == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, mppi(__pyx_t_5))); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.PariInstance.pi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_55pollegendre(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_54pollegendre[] = "\n        pollegendre(n, v=x): Legendre polynomial of degree n (n C-integer),\n        in variable v.\n\n        EXAMPLES::\n\n            sage: pari.pollegendre(7)\n            429/16*x^7 - 693/16*x^5 + 315/16*x^3 - 35/16*x\n            sage: pari.pollegendre(7, 'z')\n            429/16*z^7 - 693/16*z^5 + 315/16*z^3 - 35/16*z\n            sage: pari.pollegendre(0)\n            1\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_55pollegendre(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("pollegendre (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__v,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "pollegendre") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9605; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9605; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("pollegendre", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9605; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.pollegendre", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_54pollegendre(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9605
 *         return self.new_gen(mppi(pbw(precision)))
 * 
 *     def pollegendre(self, long n, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         pollegendre(n, v=x): Legendre polynomial of degree n (n C-integer),
 */

  static PyObject *__pyx_pf_7example_12PariInstance_54pollegendre(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("pollegendre", 0);

    /* "example.pyx":9619
 *             1
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(pollegendre(n, self.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9620
 *         """
 *         sig_on()
 *         return self.new_gen(pollegendre(n, self.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def TestBesselk(self,int n11=10000,precision=0):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, pollegendre(__pyx_v_n, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9620; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.pollegendre", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_57TestBesselk(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_57TestBesselk(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    int __pyx_v_n11;
    PyObject *__pyx_v_precision = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("TestBesselk (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n11,&__pyx_n_s__precision,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_0);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n11);
            if (value) { values[0] = value; kw_args--; }
          }
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__precision);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "TestBesselk") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      if (values[0]) {
        __pyx_v_n11 = __Pyx_PyInt_AsInt(values[0]); if (unlikely((__pyx_v_n11 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      } else {
        __pyx_v_n11 = ((int)10000);
      }
      __pyx_v_precision = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("TestBesselk", 0, 0, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9622; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.TestBesselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_56TestBesselk(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n11, __pyx_v_precision);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9622
 *         return self.new_gen(pollegendre(n, self.get_var(v)))
 * 
 *     def TestBesselk(self,int n11=10000,precision=0):             # <<<<<<<<<<<<<<
 *          global mytop,avma
 *          Testbesselk(n11,pbw(precision))
 */

  static PyObject *__pyx_pf_7example_12PariInstance_56TestBesselk(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, int __pyx_v_n11, PyObject *__pyx_v_precision) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    pari_sp __pyx_t_5;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("TestBesselk", 0);

    /* "example.pyx":9624
 *     def TestBesselk(self,int n11=10000,precision=0):
 *          global mytop,avma
 *          Testbesselk(n11,pbw(precision))             # <<<<<<<<<<<<<<
 *          avma=mytop
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__pbw); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_INCREF(__pyx_v_precision);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_precision);
    __Pyx_GIVEREF(__pyx_v_precision);
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_4 = __Pyx_PyInt_AsInt(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    Testbesselk(__pyx_v_n11, __pyx_t_4);

    /* "example.pyx":9625
 *          global mytop,avma
 *          Testbesselk(n11,pbw(precision))
 *          avma=mytop             # <<<<<<<<<<<<<<
 * 
 *     def get_stack_info(self):
 */
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_PyInt_from_py_pari_sp(__pyx_t_3); if (unlikely((__pyx_t_5 == (pari_sp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    avma = __pyx_t_5;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariInstance.TestBesselk", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_59get_stack_info(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_12PariInstance_58get_stack_info[] = "\n         return [current_stack_usage,current_stack_size]\n         ";
  static PyObject *__pyx_pw_7example_12PariInstance_59get_stack_info(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("get_stack_info (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_58get_stack_info(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9627
 *          avma=mytop
 * 
 *     def get_stack_info(self):             # <<<<<<<<<<<<<<
 *          """
 *          return [current_stack_usage,current_stack_size]
 */

  static PyObject *__pyx_pf_7example_12PariInstance_58get_stack_info(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    size_t __pyx_v_l;
    size_t __pyx_v_nu;
    size_t __pyx_v_u;
    size_t __pyx_v_s;
    GEN __pyx_v_adr;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    pari_sp __pyx_t_1;
    size_t __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    double __pyx_t_8;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("get_stack_info", 0);

    /* "example.pyx":9634
 *          cdef pari_sp current_stack_size,current_stack_usage
 *          global top, bot, avma, mytop
 *          cdef GEN adr=getheap()             # <<<<<<<<<<<<<<
 * 
 *          nu = (top -avma)/sizeof(long)
 */
    __pyx_v_adr = getheap();

    /* "example.pyx":9636
 *          cdef GEN adr=getheap()
 * 
 *          nu = (top -avma)/sizeof(long)             # <<<<<<<<<<<<<<
 *          l=(top-bot)/sizeof(long)
 *          print "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n"%(top, mytop,bot, avma)
 */
    __pyx_t_1 = (top - avma);
    __pyx_t_2 = (sizeof(long));
    if (unlikely(__pyx_t_2 == 0)) {
      PyErr_Format(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_v_nu = (__pyx_t_1 / __pyx_t_2);

    /* "example.pyx":9637
 * 
 *          nu = (top -avma)/sizeof(long)
 *          l=(top-bot)/sizeof(long)             # <<<<<<<<<<<<<<
 *          print "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n"%(top, mytop,bot, avma)
 *          print " Used :                         %ld  long words  (%ld K)\n"%(nu, nu/1024*sizeof(long));
 */
    __pyx_t_1 = (top - bot);
    __pyx_t_2 = (sizeof(long));
    if (unlikely(__pyx_t_2 == 0)) {
      PyErr_Format(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9637; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_v_l = (__pyx_t_1 / __pyx_t_2);

    /* "example.pyx":9638
 *          nu = (top -avma)/sizeof(long)
 *          l=(top-bot)/sizeof(long)
 *          print "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n"%(top, mytop,bot, avma)             # <<<<<<<<<<<<<<
 *          print " Used :                         %ld  long words  (%ld K)\n"%(nu, nu/1024*sizeof(long));
 *          print " Available :                    %ld  long words  (%ld K)\n"%((l-nu), (l-nu)/1024*sizeof(long))
 */
    __pyx_t_3 = __Pyx_PyInt_to_py_pari_sp(top); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyInt_to_py_pari_sp(bot); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyInt_to_py_pari_sp(avma); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyTuple_New(4); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_7, 3, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_66), ((PyObject *)__pyx_t_7)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_6)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9638; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;

    /* "example.pyx":9639
 *          l=(top-bot)/sizeof(long)
 *          print "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n"%(top, mytop,bot, avma)
 *          print " Used :                         %ld  long words  (%ld K)\n"%(nu, nu/1024*sizeof(long));             # <<<<<<<<<<<<<<
 *          print " Available :                    %ld  long words  (%ld K)\n"%((l-nu), (l-nu)/1024*sizeof(long))
 *          print " Occupation of the PARI stack : %6.2f percent\n"%(100.0*nu/l);
 */
    __pyx_t_6 = __Pyx_PyInt_FromSize_t(__pyx_v_nu); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyInt_FromSize_t(((__pyx_v_nu / 1024) * (sizeof(long)))); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_7 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_67), ((PyObject *)__pyx_t_5)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_7));
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_7)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;

    /* "example.pyx":9640
 *          print "Top : %lx (Python mytop:%lx)  Bottom : %lx   Current stack : %lx\n"%(top, mytop,bot, avma)
 *          print " Used :                         %ld  long words  (%ld K)\n"%(nu, nu/1024*sizeof(long));
 *          print " Available :                    %ld  long words  (%ld K)\n"%((l-nu), (l-nu)/1024*sizeof(long))             # <<<<<<<<<<<<<<
 *          print " Occupation of the PARI stack : %6.2f percent\n"%(100.0*nu/l);
 *          print " %ld objects on heap occupy %ld long words\n\n"%(itos(gel(adr,1)), itos(gel(adr,2)))
 */
    __pyx_t_7 = __Pyx_PyInt_FromSize_t((__pyx_v_l - __pyx_v_nu)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_5 = __Pyx_PyInt_FromSize_t((((__pyx_v_l - __pyx_v_nu) / 1024) * (sizeof(long)))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_7 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_68), ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_5)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;

    /* "example.pyx":9641
 *          print " Used :                         %ld  long words  (%ld K)\n"%(nu, nu/1024*sizeof(long));
 *          print " Available :                    %ld  long words  (%ld K)\n"%((l-nu), (l-nu)/1024*sizeof(long))
 *          print " Occupation of the PARI stack : %6.2f percent\n"%(100.0*nu/l);             # <<<<<<<<<<<<<<
 *          print " %ld objects on heap occupy %ld long words\n\n"%(itos(gel(adr,1)), itos(gel(adr,2)))
 *          u = pari_var_next();
 */
    __pyx_t_8 = (100.0 * __pyx_v_nu);
    if (unlikely(__pyx_v_l == 0)) {
      PyErr_Format(PyExc_ZeroDivisionError, "float division");
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
    __pyx_t_5 = PyFloat_FromDouble((__pyx_t_8 / __pyx_v_l)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_69), __pyx_t_5); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_6)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;

    /* "example.pyx":9642
 *          print " Available :                    %ld  long words  (%ld K)\n"%((l-nu), (l-nu)/1024*sizeof(long))
 *          print " Occupation of the PARI stack : %6.2f percent\n"%(100.0*nu/l);
 *          print " %ld objects on heap occupy %ld long words\n\n"%(itos(gel(adr,1)), itos(gel(adr,2)))             # <<<<<<<<<<<<<<
 *          u = pari_var_next();
 *          s = MAXVARN - pari_var_next_temp();
 */
    __pyx_t_6 = PyInt_FromLong(itos(gel(__pyx_v_adr, 1))); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = PyInt_FromLong(itos(gel(__pyx_v_adr, 2))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_70), ((PyObject *)__pyx_t_7)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_5)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;

    /* "example.pyx":9643
 *          print " Occupation of the PARI stack : %6.2f percent\n"%(100.0*nu/l);
 *          print " %ld objects on heap occupy %ld long words\n\n"%(itos(gel(adr,1)), itos(gel(adr,2)))
 *          u = pari_var_next();             # <<<<<<<<<<<<<<
 *          s = MAXVARN - pari_var_next_temp();
 *          print " %ld variable names used (%ld user + %ld private) out of %d\n\n"%(u+s, u, s, MAXVARN)
 */
    __pyx_v_u = pari_var_next();

    /* "example.pyx":9644
 *          print " %ld objects on heap occupy %ld long words\n\n"%(itos(gel(adr,1)), itos(gel(adr,2)))
 *          u = pari_var_next();
 *          s = MAXVARN - pari_var_next_temp();             # <<<<<<<<<<<<<<
 *          print " %ld variable names used (%ld user + %ld private) out of %d\n\n"%(u+s, u, s, MAXVARN)
 *          avma=mytop
 */
    __pyx_v_s = (MAXVARN - pari_var_next_temp());

    /* "example.pyx":9645
 *          u = pari_var_next();
 *          s = MAXVARN - pari_var_next_temp();
 *          print " %ld variable names used (%ld user + %ld private) out of %d\n\n"%(u+s, u, s, MAXVARN)             # <<<<<<<<<<<<<<
 *          avma=mytop
 *     def poltchebi(self, long n, v=-1):
 */
    __pyx_t_5 = __Pyx_PyInt_FromSize_t((__pyx_v_u + __pyx_v_s)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_v_u); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_6 = __Pyx_PyInt_FromSize_t(__pyx_v_s); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_4 = PyInt_FromLong(MAXVARN); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_5 = 0;
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_71), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    if (__Pyx_PrintOne(0, ((PyObject *)__pyx_t_4)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;

    /* "example.pyx":9646
 *          s = MAXVARN - pari_var_next_temp();
 *          print " %ld variable names used (%ld user + %ld private) out of %d\n\n"%(u+s, u, s, MAXVARN)
 *          avma=mytop             # <<<<<<<<<<<<<<
 *     def poltchebi(self, long n, v=-1):
 *         """
 */
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__mytop); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_1 = __Pyx_PyInt_from_py_pari_sp(__pyx_t_4); if (unlikely((__pyx_t_1 == (pari_sp)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    avma = __pyx_t_1;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_AddTraceback("example.PariInstance.get_stack_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_61poltchebi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_60poltchebi[] = "\n        poltchebi(n, v=x): Chebyshev polynomial of the first kind of degree\n        n, in variable v.\n\n        EXAMPLES::\n\n            sage: pari.poltchebi(7)\n            64*x^7 - 112*x^5 + 56*x^3 - 7*x\n            sage: pari.poltchebi(7, 'z')\n            64*z^7 - 112*z^5 + 56*z^3 - 7*z\n            sage: pari.poltchebi(0)\n            1\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_61poltchebi(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("poltchebi (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__v,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "poltchebi") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("poltchebi", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9647; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.poltchebi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_60poltchebi(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9647
 *          print " %ld variable names used (%ld user + %ld private) out of %d\n\n"%(u+s, u, s, MAXVARN)
 *          avma=mytop
 *     def poltchebi(self, long n, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         poltchebi(n, v=x): Chebyshev polynomial of the first kind of degree
 */

  static PyObject *__pyx_pf_7example_12PariInstance_60poltchebi(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("poltchebi", 0);

    /* "example.pyx":9661
 *             1
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polchebyshev1(n, self.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9662
 *         """
 *         sig_on()
 *         return self.new_gen(polchebyshev1(n, self.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def factorial(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polchebyshev1(__pyx_v_n, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.poltchebi", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_63factorial(PyObject *__pyx_v_self, PyObject *__pyx_arg_n); /*proto*/
  static char __pyx_doc_7example_12PariInstance_62factorial[] = "\n        Return the factorial of the integer n as a PARI gen.\n\n        EXAMPLES::\n\n            sage: pari.factorial(0)\n            1\n            sage: pari.factorial(1)\n            1\n            sage: pari.factorial(5)\n            120\n            sage: pari.factorial(25)\n            15511210043330985984000000\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_63factorial(PyObject *__pyx_v_self, PyObject *__pyx_arg_n) {
    long __pyx_v_n;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("factorial (wrapper)", 0);
    assert(__pyx_arg_n); {
      __pyx_v_n = __Pyx_PyInt_AsLong(__pyx_arg_n); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9664; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.factorial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_62factorial(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((long)__pyx_v_n));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9664
 *         return self.new_gen(polchebyshev1(n, self.get_var(v)))
 * 
 *     def factorial(self, long n):             # <<<<<<<<<<<<<<
 *         """
 *         Return the factorial of the integer n as a PARI gen.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_62factorial(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("factorial", 0);

    /* "example.pyx":9679
 *             15511210043330985984000000
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(mpfact(n))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9679; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9680
 *         """
 *         sig_on()
 *         return self.new_gen(mpfact(n))             # <<<<<<<<<<<<<<
 * 
 *     def polcyclo(self, long n, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, mpfact(__pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9680; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.factorial", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_65polcyclo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_64polcyclo[] = "\n        polcyclo(n, v=x): cyclotomic polynomial of degree n, in variable\n        v.\n\n        EXAMPLES::\n\n            sage: pari.polcyclo(8)\n            x^4 + 1\n            sage: pari.polcyclo(7, 'z')\n            z^6 + z^5 + z^4 + z^3 + z^2 + z + 1\n            sage: pari.polcyclo(1)\n            x - 1\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_65polcyclo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcyclo (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__v,0};
      PyObject* values[2] = {0,0};
      values[1] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcyclo") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9682; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9682; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcyclo", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9682; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.polcyclo", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_64polcyclo(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9682
 *         return self.new_gen(mpfact(n))
 * 
 *     def polcyclo(self, long n, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         polcyclo(n, v=x): cyclotomic polynomial of degree n, in variable
 */

  static PyObject *__pyx_pf_7example_12PariInstance_64polcyclo(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcyclo", 0);

    /* "example.pyx":9696
 *             x - 1
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polcyclo(n, self.get_var(v)))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9697
 *         """
 *         sig_on()
 *         return self.new_gen(polcyclo(n, self.get_var(v)))             # <<<<<<<<<<<<<<
 * 
 *     def polcyclo_eval(self, long n, v):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polcyclo(__pyx_v_n, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.polcyclo", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_67polcyclo_eval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_66polcyclo_eval[] = "\n        polcyclo_eval(n, v): value of the nth cyclotomic polynomial at value v.\n\n        EXAMPLES::\n\n            sage: pari.polcyclo_eval(8, 2)\n            17\n            sage: cyclotomic_polynomial(8)(2)\n            17\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_67polcyclo_eval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polcyclo_eval (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__v,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polcyclo_eval", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9699; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polcyclo_eval") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9699; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9699; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polcyclo_eval", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9699; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.polcyclo_eval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_66polcyclo_eval(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9699
 *         return self.new_gen(polcyclo(n, self.get_var(v)))
 * 
 *     def polcyclo_eval(self, long n, v):             # <<<<<<<<<<<<<<
 *         """
 *         polcyclo_eval(n, v): value of the nth cyclotomic polynomial at value v.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_66polcyclo_eval(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polcyclo_eval", 0);

    /* "example.pyx":9710
 *             17
 *         """
 *         t0GEN(v)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polcyclo_eval(n, t0))
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_v); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9710; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":9711
 *         """
 *         t0GEN(v)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polcyclo_eval(n, t0))
 * 
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9711; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9712
 *         t0GEN(v)
 *         sig_on()
 *         return self.new_gen(polcyclo_eval(n, t0))             # <<<<<<<<<<<<<<
 * 
 *     def polsubcyclo(self, long n, long d, v=-1):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polcyclo_eval(__pyx_v_n, __pyx_v_7example_t0))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.polcyclo_eval", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_69polsubcyclo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_68polsubcyclo[] = "\n        polsubcyclo(n, d, v=x): return the pari list of polynomial(s)\n        defining the sub-abelian extensions of degree `d` of the\n        cyclotomic field `\\QQ(\\zeta_n)`, where `d`\n        divides `\\phi(n)`.\n\n        EXAMPLES::\n\n            sage: pari.polsubcyclo(8, 4)\n            [x^4 + 1]\n            sage: pari.polsubcyclo(8, 2, 'z')\n            [z^2 - 2, z^2 + 1, z^2 + 2]\n            sage: pari.polsubcyclo(8, 1)\n            [x - 1]\n            sage: pari.polsubcyclo(8, 3)\n            []\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_69polsubcyclo(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    long __pyx_v_d;
    PyObject *__pyx_v_v = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polsubcyclo (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__d,&__pyx_n_s__v,0};
      PyObject* values[3] = {0,0,0};
      values[2] = ((PyObject *)__pyx_int_neg_1);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__d)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polsubcyclo", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__v);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polsubcyclo") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_d = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_d == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_v = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polsubcyclo", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9714; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.polsubcyclo", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_68polsubcyclo(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_d, __pyx_v_v);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9714
 *         return self.new_gen(polcyclo_eval(n, t0))
 * 
 *     def polsubcyclo(self, long n, long d, v=-1):             # <<<<<<<<<<<<<<
 *         """
 *         polsubcyclo(n, d, v=x): return the pari list of polynomial(s)
 */

  static PyObject *__pyx_pf_7example_12PariInstance_68polsubcyclo(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, long __pyx_v_d, PyObject *__pyx_v_v) {
    struct __pyx_obj_7example_gen *__pyx_v_plist = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polsubcyclo", 0);

    /* "example.pyx":9733
 *         """
 *         cdef gen plist
 *         sig_on()             # <<<<<<<<<<<<<<
 *         plist = self.new_gen(polsubcyclo(n, d, self.get_var(v)))
 *         if typ(plist.g) != t_VEC:
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9734
 *         cdef gen plist
 *         sig_on()
 *         plist = self.new_gen(polsubcyclo(n, d, self.get_var(v)))             # <<<<<<<<<<<<<<
 *         if typ(plist.g) != t_VEC:
 *             return pari.vector(1, [plist])
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polsubcyclo(__pyx_v_n, __pyx_v_d, ((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->get_var(__pyx_v_self, __pyx_v_v)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_plist = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":9735
 *         sig_on()
 *         plist = self.new_gen(polsubcyclo(n, d, self.get_var(v)))
 *         if typ(plist.g) != t_VEC:             # <<<<<<<<<<<<<<
 *             return pari.vector(1, [plist])
 *         else:
 */
    __pyx_t_3 = (typ(__pyx_v_plist->g) != t_VEC);
    if (__pyx_t_3) {

      /* "example.pyx":9736
 *         plist = self.new_gen(polsubcyclo(n, d, self.get_var(v)))
 *         if typ(plist.g) != t_VEC:
 *             return pari.vector(1, [plist])             # <<<<<<<<<<<<<<
 *         else:
 *             return plist
 */
      __Pyx_XDECREF(__pyx_r);
      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_4 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__vector); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_INCREF(((PyObject *)__pyx_v_plist));
      PyList_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_v_plist));
      __Pyx_GIVEREF(((PyObject *)__pyx_v_plist));
      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_INCREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_int_1);
      __Pyx_GIVEREF(__pyx_int_1);
      PyTuple_SET_ITEM(__pyx_t_5, 1, ((PyObject *)__pyx_t_2));
      __Pyx_GIVEREF(((PyObject *)__pyx_t_2));
      __pyx_t_2 = 0;
      __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":9738
 *             return pari.vector(1, [plist])
 *         else:
 *             return plist             # <<<<<<<<<<<<<<
 *         #return self.new_gen(polsubcyclo(n, d, self.get_var(v)))
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_v_plist));
      __pyx_r = ((PyObject *)__pyx_v_plist);
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.PariInstance.polsubcyclo", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_plist);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_71polzagier(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static PyObject *__pyx_pw_7example_12PariInstance_71polzagier(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    long __pyx_v_m;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("polzagier (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__m,0};
      PyObject* values[2] = {0,0};
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__m)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("polzagier", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "polzagier") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
        goto __pyx_L5_argtuple_error;
      } else {
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_m = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_m == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("polzagier", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.polzagier", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_70polzagier(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_m);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9741
 *         #return self.new_gen(polsubcyclo(n, d, self.get_var(v)))
 * 
 *     def polzagier(self, long n, long m):             # <<<<<<<<<<<<<<
 *         sig_on()
 *         return self.new_gen(polzag(n, m))
 */

  static PyObject *__pyx_pf_7example_12PariInstance_70polzagier(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, long __pyx_v_m) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("polzagier", 0);

    /* "example.pyx":9742
 * 
 *     def polzagier(self, long n, long m):
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(polzag(n, m))
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9743
 *     def polzagier(self, long n, long m):
 *         sig_on()
 *         return self.new_gen(polzag(n, m))             # <<<<<<<<<<<<<<
 * 
 *     def setrand(self, seed):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, polzag(__pyx_v_n, __pyx_v_m))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.polzagier", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_73setrand(PyObject *__pyx_v_self, PyObject *__pyx_v_seed); /*proto*/
  static char __pyx_doc_7example_12PariInstance_72setrand[] = "\n        Sets PARI's current random number seed.\n\n        INPUT:\n\n        - ``seed`` -- either a strictly positive integer or a GEN of\n          type ``t_VECSMALL`` as output by ``getrand()``\n\n        This should not be called directly; instead, use Sage's global\n        random number seed handling in ``sage.misc.randstate``\n        and call ``current_randstate().set_seed_pari()``.\n\n        EXAMPLES::\n\n            sage: pari.setrand(50)\n            sage: a = pari.getrand(); a\n            Vecsmall([...])\n            sage: pari.setrand(a)\n            sage: a == pari.getrand()\n            True\n\n        TESTS:\n\n        Check that invalid inputs are handled properly (#11825)::\n\n            sage: pari.setrand(0)\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n            sage: pari.setrand(\"foobar\")\n            Traceback (most recent call last):\n            ...\n            PariError: incorrect type (11)\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_73setrand(PyObject *__pyx_v_self, PyObject *__pyx_v_seed) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("setrand (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_72setrand(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), ((PyObject *)__pyx_v_seed));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9745
 *         return self.new_gen(polzag(n, m))
 * 
 *     def setrand(self, seed):             # <<<<<<<<<<<<<<
 *         """
 *         Sets PARI's current random number seed.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_72setrand(CYTHON_UNUSED struct __pyx_obj_7example_PariInstance *__pyx_v_self, PyObject *__pyx_v_seed) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("setrand", 0);

    /* "example.pyx":9780
 *             PariError: incorrect type (11)
 *         """
 *         t0GEN(seed)             # <<<<<<<<<<<<<<
 *         sig_on()
 *         setrand(t0)
 */
    __pyx_t_1 = __pyx_f_7example_t0GEN(__pyx_v_seed); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":9781
 *         """
 *         t0GEN(seed)
 *         sig_on()             # <<<<<<<<<<<<<<
 *         setrand(t0)
 *         sig_off()
 */
    __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9782
 *         t0GEN(seed)
 *         sig_on()
 *         setrand(t0)             # <<<<<<<<<<<<<<
 *         sig_off()
 * 
 */
    setrand(__pyx_v_7example_t0);

    /* "example.pyx":9783
 *         sig_on()
 *         setrand(t0)
 *         sig_off()             # <<<<<<<<<<<<<<
 * 
 *     def getrand(self):
 */
    _pari_sig_off();

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_AddTraceback("example.PariInstance.setrand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_75getrand(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
  static char __pyx_doc_7example_12PariInstance_74getrand[] = "\n        Returns PARI's current random number seed.\n\n        OUTPUT:\n\n        GEN of type t_VECSMALL\n\n        EXAMPLES::\n\n            sage: pari.setrand(50)\n            sage: a = pari.getrand(); a\n            Vecsmall([...])\n            sage: pari.setrand(a)\n            sage: a == pari.getrand()\n            True\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_75getrand(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("getrand (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_12PariInstance_74getrand(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9785
 *         sig_off()
 * 
 *     def getrand(self):             # <<<<<<<<<<<<<<
 *         """
 *         Returns PARI's current random number seed.
 */

  static PyObject *__pyx_pf_7example_12PariInstance_74getrand(struct __pyx_obj_7example_PariInstance *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("getrand", 0);

    /* "example.pyx":9802
 *             True
 *         """
 *         sig_on()             # <<<<<<<<<<<<<<
 *         return self.new_gen(getrand())
 * 
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9803
 *         """
 *         sig_on()
 *         return self.new_gen(getrand())             # <<<<<<<<<<<<<<
 * 
 *     def vector(self, long n, entries=None):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, getrand())); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9803; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance.getrand", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_77vector(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_76vector[] = "\n        vector(long n, entries=None): Create and return the length n PARI\n        vector with given list of entries.\n\n        EXAMPLES::\n\n            sage: pari.vector(5, [1, 2, 5, 4, 3])\n            [1, 2, 5, 4, 3]\n            sage: pari.vector(2, [x, 1])\n            [x, 1]\n            sage: pari.vector(2, [x, 1, 5])\n            Traceback (most recent call last):\n            ...\n            IndexError: length of entries (=3) must equal n (=2)\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_77vector(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_n;
    PyObject *__pyx_v_entries = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("vector (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__n,&__pyx_n_s__entries,0};
      PyObject* values[2] = {0,0};

      /* "example.pyx":9805
 *         return self.new_gen(getrand())
 * 
 *     def vector(self, long n, entries=None):             # <<<<<<<<<<<<<<
 *         """
 *         vector(long n, entries=None): Create and return the length n PARI
 */
      values[1] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__entries);
            if (value) { values[1] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vector") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9805; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_n = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9805; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_entries = values[1];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("vector", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9805; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.vector", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_76vector(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_n, __pyx_v_entries);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_12PariInstance_76vector(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n, PyObject *__pyx_v_entries) {
    struct __pyx_obj_7example_gen *__pyx_v_v = 0;
    PyObject *__pyx_v_i = NULL;
    PyObject *__pyx_v_x = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    Py_ssize_t __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    PyObject *__pyx_t_5 = NULL;
    PyObject *(*__pyx_t_6)(PyObject *);
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("vector", 0);

    /* "example.pyx":9821
 *             IndexError: length of entries (=3) must equal n (=2)
 *         """
 *         cdef gen v = self._empty_vector(n)             # <<<<<<<<<<<<<<
 *         if entries is not None:
 *             if len(entries) != n:
 */
    __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->_empty_vector(__pyx_v_self, __pyx_v_n)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_v = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9822
 *         """
 *         cdef gen v = self._empty_vector(n)
 *         if entries is not None:             # <<<<<<<<<<<<<<
 *             if len(entries) != n:
 *                 raise IndexError, "length of entries (=%s) must equal n (=%s)"%\
 */
    __pyx_t_2 = (__pyx_v_entries != Py_None);
    if (__pyx_t_2) {

      /* "example.pyx":9823
 *         cdef gen v = self._empty_vector(n)
 *         if entries is not None:
 *             if len(entries) != n:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "length of entries (=%s) must equal n (=%s)"%\
 *                       (len(entries), n)
 */
      __pyx_t_3 = PyObject_Length(__pyx_v_entries); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_2 = (__pyx_t_3 != __pyx_v_n);
      if (__pyx_t_2) {

        /* "example.pyx":9825
 *             if len(entries) != n:
 *                 raise IndexError, "length of entries (=%s) must equal n (=%s)"%\
 *                       (len(entries), n)             # <<<<<<<<<<<<<<
 *             for i, x in enumerate(entries):
 *                 v[i] = x
 */
        __pyx_t_3 = PyObject_Length(__pyx_v_entries); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __pyx_t_4 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_4);
        __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
        __Pyx_GIVEREF(__pyx_t_1);
        PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_4);
        __pyx_t_1 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_72), ((PyObject *)__pyx_t_5)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_4));
        __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_4), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        goto __pyx_L4;
      }
      __pyx_L4:;

      /* "example.pyx":9826
 *                 raise IndexError, "length of entries (=%s) must equal n (=%s)"%\
 *                       (len(entries), n)
 *             for i, x in enumerate(entries):             # <<<<<<<<<<<<<<
 *                 v[i] = x
 *         return v
 */
      __Pyx_INCREF(__pyx_int_0);
      __pyx_t_4 = __pyx_int_0;
      if (PyList_CheckExact(__pyx_v_entries) || PyTuple_CheckExact(__pyx_v_entries)) {
        __pyx_t_5 = __pyx_v_entries; __Pyx_INCREF(__pyx_t_5); __pyx_t_3 = 0;
        __pyx_t_6 = NULL;
      } else {
        __pyx_t_3 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_entries); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
      }
      for (;;) {
        if (!__pyx_t_6 && PyList_CheckExact(__pyx_t_5)) {
          if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        } else if (!__pyx_t_6 && PyTuple_CheckExact(__pyx_t_5)) {
          if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #else
          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          #endif
        } else {
          __pyx_t_1 = __pyx_t_6(__pyx_t_5);
          if (unlikely(!__pyx_t_1)) {
            if (PyErr_Occurred()) {
              if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
              else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
            }
            break;
          }
          __Pyx_GOTREF(__pyx_t_1);
        }
        __Pyx_XDECREF(__pyx_v_x);
        __pyx_v_x = __pyx_t_1;
        __pyx_t_1 = 0;
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_XDECREF(__pyx_v_i);
        __pyx_v_i = __pyx_t_4;
        __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_int_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_4);
        __pyx_t_4 = __pyx_t_1;
        __pyx_t_1 = 0;

        /* "example.pyx":9827
 *                       (len(entries), n)
 *             for i, x in enumerate(entries):
 *                 v[i] = x             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
        if (PyObject_SetItem(((PyObject *)__pyx_v_v), __pyx_v_i, __pyx_v_x) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      }
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9828
 *             for i, x in enumerate(entries):
 *                 v[i] = x
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     cdef gen _empty_vector(self, long n):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_v));
    __pyx_r = ((PyObject *)__pyx_v_v);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_AddTraceback("example.PariInstance.vector", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XDECREF(__pyx_v_i);
    __Pyx_XDECREF(__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9830
 *         return v
 * 
 *     cdef gen _empty_vector(self, long n):             # <<<<<<<<<<<<<<
 *         cdef gen v
 *         sig_on()
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example_12PariInstance__empty_vector(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_n) {
    struct __pyx_obj_7example_gen *__pyx_v_v = 0;
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_empty_vector", 0);

    /* "example.pyx":9832
 *     cdef gen _empty_vector(self, long n):
 *         cdef gen v
 *         sig_on()             # <<<<<<<<<<<<<<
 *         v = self.new_gen(zerovec(n))
 *         return v
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9833
 *         cdef gen v
 *         sig_on()
 *         v = self.new_gen(zerovec(n))             # <<<<<<<<<<<<<<
 *         return v
 * 
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, zerovec(__pyx_v_n))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_v = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":9834
 *         sig_on()
 *         v = self.new_gen(zerovec(n))
 *         return v             # <<<<<<<<<<<<<<
 * 
 *     def matrix(self, long m, long n, entries=None):
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __Pyx_INCREF(((PyObject *)__pyx_v_v));
    __pyx_r = __pyx_v_v;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariInstance._empty_vector", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_v);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_12PariInstance_79matrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12PariInstance_78matrix[] = "\n        matrix(long m, long n, entries=None): Create and return the m x n\n        PARI matrix with given list of entries.\n        ";
  static PyObject *__pyx_pw_7example_12PariInstance_79matrix(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    long __pyx_v_m;
    long __pyx_v_n;
    PyObject *__pyx_v_entries = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("matrix (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__m,&__pyx_n_s__n,&__pyx_n_s__entries,0};
      PyObject* values[3] = {0,0,0};

      /* "example.pyx":9836
 *         return v
 * 
 *     def matrix(self, long m, long n, entries=None):             # <<<<<<<<<<<<<<
 *         """
 *         matrix(long m, long n, entries=None): Create and return the m x n
 */
      values[2] = ((PyObject *)Py_None);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (likely((values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__m)) != 0)) kw_args--;
          else goto __pyx_L5_argtuple_error;
          case  1:
          if (likely((values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__n)) != 0)) kw_args--;
          else {
            __Pyx_RaiseArgtupleInvalid("matrix", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
          }
          case  2:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__entries);
            if (value) { values[2] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "matrix") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
          case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
          values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_m = __Pyx_PyInt_AsLong(values[0]); if (unlikely((__pyx_v_m == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_n = __Pyx_PyInt_AsLong(values[1]); if (unlikely((__pyx_v_n == (long)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_entries = values[2];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("matrix", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9836; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.PariInstance.matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12PariInstance_78matrix(((struct __pyx_obj_7example_PariInstance *)__pyx_v_self), __pyx_v_m, __pyx_v_n, __pyx_v_entries);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  static PyObject *__pyx_pf_7example_12PariInstance_78matrix(struct __pyx_obj_7example_PariInstance *__pyx_v_self, long __pyx_v_m, long __pyx_v_n, PyObject *__pyx_v_entries) {
    long __pyx_v_i;
    long __pyx_v_j;
    long __pyx_v_k;
    struct __pyx_obj_7example_gen *__pyx_v_A = 0;
    struct __pyx_obj_7example_gen *__pyx_v_x = 0;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_t_3;
    Py_ssize_t __pyx_t_4;
    PyObject *__pyx_t_5 = NULL;
    PyObject *__pyx_t_6 = NULL;
    PyObject *__pyx_t_7 = NULL;
    PyObject *__pyx_t_8 = NULL;
    long __pyx_t_9;
    long __pyx_t_10;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("matrix", 0);

    /* "example.pyx":9845
 *         cdef gen x
 * 
 *         sig_on()             # <<<<<<<<<<<<<<
 *          # The gtomat is very important!!  Without sage/PARI will segfault.
 *          # I do not know why. -- William Stein
 */
    __pyx_t_1 = _pari_sig_on(); if (unlikely(__pyx_t_1 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    /* "example.pyx":9848
 *          # The gtomat is very important!!  Without sage/PARI will segfault.
 *          # I do not know why. -- William Stein
 *         A = self.new_gen(gtomat(zeromat(m,n)))             # <<<<<<<<<<<<<<
 *         if entries is not None:
 *             if len(entries) != m*n:
 */
    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_self->__pyx_vtab)->new_gen(__pyx_v_self, gtomat(zeromat(__pyx_v_m, __pyx_v_n)))); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_A = ((struct __pyx_obj_7example_gen *)__pyx_t_2);
    __pyx_t_2 = 0;

    /* "example.pyx":9849
 *          # I do not know why. -- William Stein
 *         A = self.new_gen(gtomat(zeromat(m,n)))
 *         if entries is not None:             # <<<<<<<<<<<<<<
 *             if len(entries) != m*n:
 *                 raise IndexError, "len of entries (=%s) must be %s*%s=%s"%(len(entries),m,n,m*n)
 */
    __pyx_t_3 = (__pyx_v_entries != Py_None);
    if (__pyx_t_3) {

      /* "example.pyx":9850
 *         A = self.new_gen(gtomat(zeromat(m,n)))
 *         if entries is not None:
 *             if len(entries) != m*n:             # <<<<<<<<<<<<<<
 *                 raise IndexError, "len of entries (=%s) must be %s*%s=%s"%(len(entries),m,n,m*n)
 *             k = 0
 */
      __pyx_t_4 = PyObject_Length(__pyx_v_entries); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9850; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_3 = (__pyx_t_4 != (__pyx_v_m * __pyx_v_n));
      if (__pyx_t_3) {

        /* "example.pyx":9851
 *         if entries is not None:
 *             if len(entries) != m*n:
 *                 raise IndexError, "len of entries (=%s) must be %s*%s=%s"%(len(entries),m,n,m*n)             # <<<<<<<<<<<<<<
 *             k = 0
 *             for i from 0 <= i < m:
 */
        __pyx_t_4 = PyObject_Length(__pyx_v_entries); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_2);
        __pyx_t_5 = PyInt_FromLong(__pyx_v_m); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_5);
        __pyx_t_6 = PyInt_FromLong(__pyx_v_n); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __pyx_t_7 = PyInt_FromLong((__pyx_v_m * __pyx_v_n)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_7);
        __pyx_t_8 = PyTuple_New(4); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_8);
        PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
        __Pyx_GIVEREF(__pyx_t_2);
        PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_5);
        __Pyx_GIVEREF(__pyx_t_5);
        PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_6);
        __Pyx_GIVEREF(__pyx_t_6);
        PyTuple_SET_ITEM(__pyx_t_8, 3, __pyx_t_7);
        __Pyx_GIVEREF(__pyx_t_7);
        __pyx_t_2 = 0;
        __pyx_t_5 = 0;
        __pyx_t_6 = 0;
        __pyx_t_7 = 0;
        __pyx_t_7 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_73), ((PyObject *)__pyx_t_8)); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_7));
        __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
        __Pyx_Raise(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_7), 0, 0);
        __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9851; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        goto __pyx_L4;
      }
      __pyx_L4:;

      /* "example.pyx":9852
 *             if len(entries) != m*n:
 *                 raise IndexError, "len of entries (=%s) must be %s*%s=%s"%(len(entries),m,n,m*n)
 *             k = 0             # <<<<<<<<<<<<<<
 *             for i from 0 <= i < m:
 *                 for j from 0 <= j < n:
 */
      __pyx_v_k = 0;

      /* "example.pyx":9853
 *                 raise IndexError, "len of entries (=%s) must be %s*%s=%s"%(len(entries),m,n,m*n)
 *             k = 0
 *             for i from 0 <= i < m:             # <<<<<<<<<<<<<<
 *                 for j from 0 <= j < n:
 *                     x = pari(entries[k])
 */
      __pyx_t_9 = __pyx_v_m;
      for (__pyx_v_i = 0; __pyx_v_i < __pyx_t_9; __pyx_v_i++) {

        /* "example.pyx":9854
 *             k = 0
 *             for i from 0 <= i < m:
 *                 for j from 0 <= j < n:             # <<<<<<<<<<<<<<
 *                     x = pari(entries[k])
 *                     A._refers_to[(i,j)] = x
 */
        __pyx_t_10 = __pyx_v_n;
        for (__pyx_v_j = 0; __pyx_v_j < __pyx_t_10; __pyx_v_j++) {

          /* "example.pyx":9855
 *             for i from 0 <= i < m:
 *                 for j from 0 <= j < n:
 *                     x = pari(entries[k])             # <<<<<<<<<<<<<<
 *                     A._refers_to[(i,j)] = x
 *                     (<GEN>(A.g)[j+1])[i+1] = <long>(x.g)
 */
          __pyx_t_7 = __Pyx_GetName(__pyx_m, __pyx_n_s__pari); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_7);
          __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_entries, __pyx_v_k, sizeof(long), PyInt_FromLong); if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_6);
          PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8);
          __Pyx_GIVEREF(__pyx_t_8);
          __pyx_t_8 = 0;
          __pyx_t_8 = PyObject_Call(__pyx_t_7, ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
          __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
          if (!(likely(((__pyx_t_8) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_8, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_XDECREF(((PyObject *)__pyx_v_x));
          __pyx_v_x = ((struct __pyx_obj_7example_gen *)__pyx_t_8);
          __pyx_t_8 = 0;

          /* "example.pyx":9856
 *                 for j from 0 <= j < n:
 *                     x = pari(entries[k])
 *                     A._refers_to[(i,j)] = x             # <<<<<<<<<<<<<<
 *                     (<GEN>(A.g)[j+1])[i+1] = <long>(x.g)
 *                     k = k + 1
 */
          __pyx_t_8 = PyInt_FromLong(__pyx_v_i); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_8);
          __pyx_t_6 = PyInt_FromLong(__pyx_v_j); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_6);
          __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_GOTREF(__pyx_t_7);
          PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_8);
          __Pyx_GIVEREF(__pyx_t_8);
          PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
          __Pyx_GIVEREF(__pyx_t_6);
          __pyx_t_8 = 0;
          __pyx_t_6 = 0;
          if (PyObject_SetItem(__pyx_v_A->_refers_to, ((PyObject *)__pyx_t_7), ((PyObject *)__pyx_v_x)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;

          /* "example.pyx":9857
 *                     x = pari(entries[k])
 *                     A._refers_to[(i,j)] = x
 *                     (<GEN>(A.g)[j+1])[i+1] = <long>(x.g)             # <<<<<<<<<<<<<<
 *                     k = k + 1
 *         return A
 */
          (((GEN)(__pyx_v_A->g[(__pyx_v_j + 1)]))[(__pyx_v_i + 1)]) = ((long)__pyx_v_x->g);

          /* "example.pyx":9858
 *                     A._refers_to[(i,j)] = x
 *                     (<GEN>(A.g)[j+1])[i+1] = <long>(x.g)
 *                     k = k + 1             # <<<<<<<<<<<<<<
 *         return A
 * 
 */
          __pyx_v_k = (__pyx_v_k + 1);
        }
      }
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9859
 *                     (<GEN>(A.g)[j+1])[i+1] = <long>(x.g)
 *                     k = k + 1
 *         return A             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_A));
    __pyx_r = ((PyObject *)__pyx_v_A);
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_5);
    __Pyx_XDECREF(__pyx_t_6);
    __Pyx_XDECREF(__pyx_t_7);
    __Pyx_XDECREF(__pyx_t_8);
    __Pyx_AddTraceback("example.PariInstance.matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_A);
    __Pyx_XDECREF((PyObject *)__pyx_v_x);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_13init_pari_stack(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
  static char __pyx_doc_7example_12init_pari_stack[] = "\n    Change the PARI scratch stack space to the given size.\n\n    The main application of this command is that you've done some\n    individual PARI computation that used a lot of stack space. As a\n    result the PARI stack may have doubled several times and is now\n    quite large. That object you computed is copied off to the heap,\n    but the PARI stack is never automatically shrunk back down. If you\n    call this function you can shrink it back down.\n\n    If you set this too small then it will automatically be increased\n    if it is exceeded, which could make some calculations initially\n    slower (since they have to be redone until the stack is big\n    enough).\n\n    INPUT:\n\n\n    -  ``size`` - an integer (default: 8000000)\n\n\n    EXAMPLES::\n\n        sage: get_memory_usage()                       # random output\n        '122M+'\n        sage: a = pari('2^100000000')\n        sage: get_memory_usage()                       # random output\n        '157M+'\n        sage: del a\n        sage: get_memory_usage()                       # random output\n        '145M+'\n\n    Hey, I want my memory back!\n\n    ::\n\n        sage: sage.libs.pari.gen.init_pari_stack()\n        sage: get_memory_usage()                       # random output\n        '114M+'\n\n    Ahh, that's better.\n    ";
  static PyMethodDef __pyx_mdef_7example_13init_pari_stack = {__Pyx_NAMESTR("init_pari_stack"), (PyCFunction)__pyx_pw_7example_13init_pari_stack, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12init_pari_stack)};
  static PyObject *__pyx_pw_7example_13init_pari_stack(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
    PyObject *__pyx_v_size = 0;
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("init_pari_stack (wrapper)", 0);
    {
      static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__size,0};
      PyObject* values[1] = {0};
      values[0] = ((PyObject *)__pyx_int_8000000);
      if (unlikely(__pyx_kwds)) {
        Py_ssize_t kw_args;
        const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
        switch (pos_args) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
        kw_args = PyDict_Size(__pyx_kwds);
        switch (pos_args) {
          case  0:
          if (kw_args > 0) {
            PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__size);
            if (value) { values[0] = value; kw_args--; }
          }
        }
        if (unlikely(kw_args > 0)) {
          if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "init_pari_stack") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      } else {
        switch (PyTuple_GET_SIZE(__pyx_args)) {
          case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
          case  0: break;
          default: goto __pyx_L5_argtuple_error;
        }
      }
      __pyx_v_size = values[0];
    }
    goto __pyx_L4_argument_unpacking_done;
    __pyx_L5_argtuple_error:;
    __Pyx_RaiseArgtupleInvalid("init_pari_stack", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_L3_error:;
    __Pyx_AddTraceback("example.init_pari_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __Pyx_RefNannyFinishContext();
    return NULL;
    __pyx_L4_argument_unpacking_done:;
    __pyx_r = __pyx_pf_7example_12init_pari_stack(__pyx_self, __pyx_v_size);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9871
 * ##############################################
 * 
 * def init_pari_stack(size=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Change the PARI scratch stack space to the given size.
 */

  static PyObject *__pyx_pf_7example_12init_pari_stack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_size) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    size_t __pyx_t_1;
    int __pyx_t_2;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("init_pari_stack", 0);

    /* "example.pyx":9914
 *     Ahh, that's better.
 *     """
 *     init_stack(size)             # <<<<<<<<<<<<<<
 * 
 * cdef int init_stack(size_t size) except -1:
 */
    __pyx_t_1 = __Pyx_PyInt_AsSize_t(__pyx_v_size); if (unlikely((__pyx_t_1 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __pyx_f_7example_init_stack(__pyx_t_1); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_AddTraceback("example.init_pari_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9916
 *     init_stack(size)
 * 
 * cdef int init_stack(size_t size) except -1:             # <<<<<<<<<<<<<<
 *     cdef size_t s
 *     cdef pari_sp cur_stack_size
 */

  static int __pyx_f_7example_init_stack(size_t __pyx_v_size) {
    size_t __pyx_v_s;
    int __pyx_v_err;
    PyObject *__pyx_v_prev_stack_size = NULL;
    int __pyx_r;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    size_t __pyx_t_3;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("init_stack", 0);

    /* "example.pyx":9923
 * 
 * 
 *     err = False    # whether or not a memory allocation error occurred.             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_v_err = 0;

    /* "example.pyx":9927
 * 
 *     # delete this if get core dumps and change the 2* to a 1* below.
 *     if bot:             # <<<<<<<<<<<<<<
 *         memfree(<void*>bot)
 * 
 */
    if (bot) {

      /* "example.pyx":9928
 *     # delete this if get core dumps and change the 2* to a 1* below.
 *     if bot:
 *         memfree(<void*>bot)             # <<<<<<<<<<<<<<
 * 
 *     prev_stack_size = top - bot
 */
      memfree(((void *)bot));
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9930
 *         memfree(<void*>bot)
 * 
 *     prev_stack_size = top - bot             # <<<<<<<<<<<<<<
 *     if size == 0:
 *         size = 2 * prev_stack_size
 */
    __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp((top - bot)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9930; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_v_prev_stack_size = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "example.pyx":9931
 * 
 *     prev_stack_size = top - bot
 *     if size == 0:             # <<<<<<<<<<<<<<
 *         size = 2 * prev_stack_size
 * 
 */
    __pyx_t_2 = (__pyx_v_size == 0);
    if (__pyx_t_2) {

      /* "example.pyx":9932
 *     prev_stack_size = top - bot
 *     if size == 0:
 *         size = 2 * prev_stack_size             # <<<<<<<<<<<<<<
 * 
 *     # Decide on size
 */
      __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_prev_stack_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = __Pyx_PyInt_AsSize_t(__pyx_t_1); if (unlikely((__pyx_t_3 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_size = __pyx_t_3;
      goto __pyx_L4;
    }
    __pyx_L4:;

    /* "example.pyx":9935
 * 
 *     # Decide on size
 *     s = fix_size(size)             # <<<<<<<<<<<<<<
 * 
 *     # Allocate memory for new stack using Python's memory allocator.
 */
    __pyx_v_s = __pyx_f_7example_fix_size(__pyx_v_size);

    /* "example.pyx":9940
 *     # As explained in the python/C API reference, using this instead
 *     # of malloc is much better (and more platform independent, etc.)
 *     bot = <pari_sp> memmalloc(s)             # <<<<<<<<<<<<<<
 * 
 *     while not bot:
 */
    bot = ((pari_sp)memmalloc(__pyx_v_s));

    /* "example.pyx":9942
 *     bot = <pari_sp> memmalloc(s)
 * 
 *     while not bot:             # <<<<<<<<<<<<<<
 *         err = True
 *         s = fix_size(prev_stack_size)
 */
    while (1) {
      __pyx_t_2 = (!bot);
      if (!__pyx_t_2) break;

      /* "example.pyx":9943
 * 
 *     while not bot:
 *         err = True             # <<<<<<<<<<<<<<
 *         s = fix_size(prev_stack_size)
 *         bot = <pari_sp> memmalloc(s)
 */
      __pyx_v_err = 1;

      /* "example.pyx":9944
 *     while not bot:
 *         err = True
 *         s = fix_size(prev_stack_size)             # <<<<<<<<<<<<<<
 *         bot = <pari_sp> memmalloc(s)
 *         if not bot:
 */
      __pyx_t_3 = __Pyx_PyInt_AsSize_t(__pyx_v_prev_stack_size); if (unlikely((__pyx_t_3 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9944; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_v_s = __pyx_f_7example_fix_size(__pyx_t_3);

      /* "example.pyx":9945
 *         err = True
 *         s = fix_size(prev_stack_size)
 *         bot = <pari_sp> memmalloc(s)             # <<<<<<<<<<<<<<
 *         if not bot:
 *             prev_stack_size /= 2
 */
      bot = ((pari_sp)memmalloc(__pyx_v_s));

      /* "example.pyx":9946
 *         s = fix_size(prev_stack_size)
 *         bot = <pari_sp> memmalloc(s)
 *         if not bot:             # <<<<<<<<<<<<<<
 *             prev_stack_size /= 2
 * 
 */
      __pyx_t_2 = (!bot);
      if (__pyx_t_2) {

        /* "example.pyx":9947
 *         bot = <pari_sp> memmalloc(s)
 *         if not bot:
 *             prev_stack_size /= 2             # <<<<<<<<<<<<<<
 * 
 *     top = bot + s
 */
        __pyx_t_1 = __Pyx_PyNumber_InPlaceDivide(__pyx_v_prev_stack_size, __pyx_int_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9947; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_v_prev_stack_size);
        __pyx_v_prev_stack_size = __pyx_t_1;
        __pyx_t_1 = 0;
        goto __pyx_L7;
      }
      __pyx_L7:;
    }

    /* "example.pyx":9949
 *             prev_stack_size /= 2
 * 
 *     top = bot + s             # <<<<<<<<<<<<<<
 *     mytop = top
 *     avma = top
 */
    top = (bot + __pyx_v_s);

    /* "example.pyx":9950
 * 
 *     top = bot + s
 *     mytop = top             # <<<<<<<<<<<<<<
 *     avma = top
 * 
 */
    __pyx_t_1 = __Pyx_PyInt_to_py_pari_sp(top); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mytop, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "example.pyx":9951
 *     top = bot + s
 *     mytop = top
 *     avma = top             # <<<<<<<<<<<<<<
 * 
 *     if err:
 */
    avma = top;

    /* "example.pyx":9953
 *     avma = top
 * 
 *     if err:             # <<<<<<<<<<<<<<
 *         raise MemoryError, "Unable to allocate %s bytes memory for PARI."%size
 * 
 */
    if (__pyx_v_err) {

      /* "example.pyx":9954
 * 
 *     if err:
 *         raise MemoryError, "Unable to allocate %s bytes memory for PARI."%size             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_4 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_74), __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_4));
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_Raise(__pyx_builtin_MemoryError, ((PyObject *)__pyx_t_4), 0, 0);
      __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L8;
    }
    __pyx_L8:;

    __pyx_r = 0;
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.init_stack", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = -1;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_prev_stack_size);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9957
 * 
 * 
 * cdef size_t fix_size(size_t a):             # <<<<<<<<<<<<<<
 *     cdef size_t b
 *     b = a - (a & (sizeof(long)-1))     # sizeof(long) | b <= a
 */

  static size_t __pyx_f_7example_fix_size(size_t __pyx_v_a) {
    size_t __pyx_v_b;
    size_t __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    __Pyx_RefNannySetupContext("fix_size", 0);

    /* "example.pyx":9959
 * cdef size_t fix_size(size_t a):
 *     cdef size_t b
 *     b = a - (a & (sizeof(long)-1))     # sizeof(long) | b <= a             # <<<<<<<<<<<<<<
 *     if b < 1024:
 *         b = 1024
 */
    __pyx_v_b = (__pyx_v_a - (__pyx_v_a & ((sizeof(long)) - 1)));

    /* "example.pyx":9960
 *     cdef size_t b
 *     b = a - (a & (sizeof(long)-1))     # sizeof(long) | b <= a
 *     if b < 1024:             # <<<<<<<<<<<<<<
 *         b = 1024
 *     return b
 */
    __pyx_t_1 = (__pyx_v_b < 1024);
    if (__pyx_t_1) {

      /* "example.pyx":9961
 *     b = a - (a & (sizeof(long)-1))     # sizeof(long) | b <= a
 *     if b < 1024:
 *         b = 1024             # <<<<<<<<<<<<<<
 *     return b
 * 
 */
      __pyx_v_b = 1024;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":9962
 *     if b < 1024:
 *         b = 1024
 *     return b             # <<<<<<<<<<<<<<
 * 
 * cdef GEN deepcopy_to_python_heap(GEN x, pari_sp* address):
 */
    __pyx_r = __pyx_v_b;
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9964
 *     return b
 * 
 * cdef GEN deepcopy_to_python_heap(GEN x, pari_sp* address):             # <<<<<<<<<<<<<<
 *     cdef size_t s
 *     cdef pari_sp tmp_bot, tmp_top, tmp_avma
 */

  static GEN __pyx_f_7example_deepcopy_to_python_heap(GEN __pyx_v_x, pari_sp *__pyx_v_address) {
    size_t __pyx_v_s;
    pari_sp __pyx_v_tmp_bot;
    pari_sp __pyx_v_tmp_top;
    pari_sp __pyx_v_tmp_avma;
    GEN __pyx_v_h;
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("deepcopy_to_python_heap", 0);

    /* "example.pyx":9970
 *     cdef GEN h
 * 
 *     tmp_top = top             # <<<<<<<<<<<<<<
 *     tmp_bot = bot
 *     tmp_avma = avma
 */
    __pyx_v_tmp_top = top;

    /* "example.pyx":9971
 * 
 *     tmp_top = top
 *     tmp_bot = bot             # <<<<<<<<<<<<<<
 *     tmp_avma = avma
 * 
 */
    __pyx_v_tmp_bot = bot;

    /* "example.pyx":9972
 *     tmp_top = top
 *     tmp_bot = bot
 *     tmp_avma = avma             # <<<<<<<<<<<<<<
 * 
 *     h = gcopy(x)
 */
    __pyx_v_tmp_avma = avma;

    /* "example.pyx":9974
 *     tmp_avma = avma
 * 
 *     h = gcopy(x)             # <<<<<<<<<<<<<<
 *     s = <size_t> (tmp_avma - avma)
 * 
 */
    __pyx_v_h = gcopy(__pyx_v_x);

    /* "example.pyx":9975
 * 
 *     h = gcopy(x)
 *     s = <size_t> (tmp_avma - avma)             # <<<<<<<<<<<<<<
 * 
 *     #print "Allocating %s bytes for PARI/Python object"%(<long> s)
 */
    __pyx_v_s = ((size_t)(__pyx_v_tmp_avma - avma));

    /* "example.pyx":9978
 * 
 *     #print "Allocating %s bytes for PARI/Python object"%(<long> s)
 *     bot = <pari_sp> memmalloc(s)             # <<<<<<<<<<<<<<
 *     top = bot + s
 *     avma = top
 */
    bot = ((pari_sp)memmalloc(__pyx_v_s));

    /* "example.pyx":9979
 *     #print "Allocating %s bytes for PARI/Python object"%(<long> s)
 *     bot = <pari_sp> memmalloc(s)
 *     top = bot + s             # <<<<<<<<<<<<<<
 *     avma = top
 *     h = gcopy(x)
 */
    top = (bot + __pyx_v_s);

    /* "example.pyx":9980
 *     bot = <pari_sp> memmalloc(s)
 *     top = bot + s
 *     avma = top             # <<<<<<<<<<<<<<
 *     h = gcopy(x)
 *     address[0] = bot
 */
    avma = top;

    /* "example.pyx":9981
 *     top = bot + s
 *     avma = top
 *     h = gcopy(x)             # <<<<<<<<<<<<<<
 *     address[0] = bot
 * 
 */
    __pyx_v_h = gcopy(__pyx_v_x);

    /* "example.pyx":9982
 *     avma = top
 *     h = gcopy(x)
 *     address[0] = bot             # <<<<<<<<<<<<<<
 * 
 *     # Restore the stack to how it was before x was created.
 */
    (__pyx_v_address[0]) = bot;

    /* "example.pyx":9985
 * 
 *     # Restore the stack to how it was before x was created.
 *     top = tmp_top             # <<<<<<<<<<<<<<
 *     bot = tmp_bot
 *     avma = tmp_avma
 */
    top = __pyx_v_tmp_top;

    /* "example.pyx":9986
 *     # Restore the stack to how it was before x was created.
 *     top = tmp_top
 *     bot = tmp_bot             # <<<<<<<<<<<<<<
 *     avma = tmp_avma
 *     return h
 */
    bot = __pyx_v_tmp_bot;

    /* "example.pyx":9987
 *     top = tmp_top
 *     bot = tmp_bot
 *     avma = tmp_avma             # <<<<<<<<<<<<<<
 *     return h
 * 
 */
    avma = __pyx_v_tmp_avma;

    /* "example.pyx":9988
 *     bot = tmp_bot
 *     avma = tmp_avma
 *     return h             # <<<<<<<<<<<<<<
 * 
 * # The first one makes a separate copy on the heap, so the stack
 */
    __pyx_r = __pyx_v_h;
    goto __pyx_L0;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":9992
 * # The first one makes a separate copy on the heap, so the stack
 * # won't overflow -- but this costs more time...
 * cdef gen _new_gen (GEN x):             # <<<<<<<<<<<<<<
 *     cdef GEN h
 *     cdef pari_sp address
 */

  static struct __pyx_obj_7example_gen *__pyx_f_7example__new_gen(GEN __pyx_v_x) {
    GEN __pyx_v_h;
    pari_sp __pyx_v_address;
    struct __pyx_obj_7example_gen *__pyx_v_y = 0;
    struct __pyx_obj_7example_gen *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_new_gen", 0);

    /* "example.pyx":9997
 *     cdef gen y
 *     global NumberOfGEN
 *     h = deepcopy_to_python_heap(x, &address)             # <<<<<<<<<<<<<<
 *     y = PY_NEW(gen)
 *     y.init(h, address)
 */
    __pyx_v_h = __pyx_f_7example_deepcopy_to_python_heap(__pyx_v_x, (&__pyx_v_address));

    /* "example.pyx":9998
 *     global NumberOfGEN
 *     h = deepcopy_to_python_heap(x, &address)
 *     y = PY_NEW(gen)             # <<<<<<<<<<<<<<
 *     y.init(h, address)
 *     NumberOfGEN=NumberOfGEN+1;
 */
    __pyx_t_1 = PY_NEW(((PyObject *)((PyObject*)__pyx_ptype_7example_gen))); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_7example_gen))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_v_y = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
    __pyx_t_1 = 0;

    /* "example.pyx":9999
 *     h = deepcopy_to_python_heap(x, &address)
 *     y = PY_NEW(gen)
 *     y.init(h, address)             # <<<<<<<<<<<<<<
 *     NumberOfGEN=NumberOfGEN+1;
 *     return y
 */
    ((struct __pyx_vtabstruct_7example_gen *)__pyx_v_y->__pyx_vtab)->init(__pyx_v_y, __pyx_v_h, __pyx_v_address);

    /* "example.pyx":10000
 *     y = PY_NEW(gen)
 *     y.init(h, address)
 *     NumberOfGEN=NumberOfGEN+1;             # <<<<<<<<<<<<<<
 *     return y
 * 
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__NumberOfGEN); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10000; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyNumber_Add(__pyx_t_1, __pyx_int_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10000; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NumberOfGEN, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10000; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "example.pyx":10001
 *     y.init(h, address)
 *     NumberOfGEN=NumberOfGEN+1;
 *     return y             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(((PyObject *)__pyx_r));
    __Pyx_INCREF(((PyObject *)__pyx_v_y));
    __pyx_r = __pyx_v_y;
    goto __pyx_L0;

    __pyx_r = ((struct __pyx_obj_7example_gen *)Py_None); __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example._new_gen", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_XDECREF((PyObject *)__pyx_v_y);
    __Pyx_XGIVEREF((PyObject *)__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10011
 * #              - Gonzalo Tornario
 * 
 * cdef public void _pari_trap "_pari_trap" (long errno, long retries) except *:             # <<<<<<<<<<<<<<
 *     """
 *     TESTS::
 */

  void _pari_trap(long __pyx_v_errno, long __pyx_v_retries) {
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("_pari_trap", 0);

    /* "example.pyx":10016
 * 
 *     """
 *     if retries > 100:             # <<<<<<<<<<<<<<
 *         sig_off()
 *         raise RuntimeError, "_pari_trap recursion too deep"
 */
    __pyx_t_1 = (__pyx_v_retries > 100);
    if (__pyx_t_1) {

      /* "example.pyx":10017
 *     """
 *     if retries > 100:
 *         sig_off()             # <<<<<<<<<<<<<<
 *         raise RuntimeError, "_pari_trap recursion too deep"
 *     if errno == errpile:
 */
      _pari_sig_off();

      /* "example.pyx":10018
 *     if retries > 100:
 *         sig_off()
 *         raise RuntimeError, "_pari_trap recursion too deep"             # <<<<<<<<<<<<<<
 *     if errno == errpile:
 *         P.allocatemem(silent=True)
 */
      __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__RuntimeError); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10018; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __Pyx_Raise(__pyx_t_2, ((PyObject *)__pyx_kp_s_75), 0, 0);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10018; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":10021
 *     if errno == errpile:
 *         P.allocatemem(silent=True)
 *     elif errno == user:             # <<<<<<<<<<<<<<
 *         sig_off()
 *         raise RuntimeError("PARI user exception")
 */
    switch (__pyx_v_errno) {

      /* "example.pyx":10019
 *         sig_off()
 *         raise RuntimeError, "_pari_trap recursion too deep"
 *     if errno == errpile:             # <<<<<<<<<<<<<<
 *         P.allocatemem(silent=True)
 *     elif errno == user:
 */
      case errpile:

      /* "example.pyx":10020
 *         raise RuntimeError, "_pari_trap recursion too deep"
 *     if errno == errpile:
 *         P.allocatemem(silent=True)             # <<<<<<<<<<<<<<
 *     elif errno == user:
 *         sig_off()
 */
      __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_7example_P), __pyx_n_s__allocatemem); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_2);
      __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_3));
      __pyx_t_4 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__silent), __pyx_t_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10020; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      break;

      /* "example.pyx":10021
 *     if errno == errpile:
 *         P.allocatemem(silent=True)
 *     elif errno == user:             # <<<<<<<<<<<<<<
 *         sig_off()
 *         raise RuntimeError("PARI user exception")
 */
      case user:

      /* "example.pyx":10022
 *         P.allocatemem(silent=True)
 *     elif errno == user:
 *         sig_off()             # <<<<<<<<<<<<<<
 *         raise RuntimeError("PARI user exception")
 *     else:
 */
      _pari_sig_off();

      /* "example.pyx":10023
 *     elif errno == user:
 *         sig_off()
 *         raise RuntimeError("PARI user exception")             # <<<<<<<<<<<<<<
 *     else:
 *         sig_off()
 */
      __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__RuntimeError); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10023; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_k_tuple_77), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10023; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10023; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      break;
      default:

      /* "example.pyx":10025
 *         raise RuntimeError("PARI user exception")
 *     else:
 *         sig_off()             # <<<<<<<<<<<<<<
 *         raise PariError, errno
 * 
 */
      _pari_sig_off();

      /* "example.pyx":10026
 *     else:
 *         sig_off()
 *         raise PariError, errno             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__PariError); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10026; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyInt_FromLong(__pyx_v_errno); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10026; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_Raise(__pyx_t_3, __pyx_t_4, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10026; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      break;
    }

    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example._pari_trap", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
  }

  /* "example.pyx":10030
 * 
 * 
 * cdef GEN _Vec_append(GEN v, GEN a, long n):             # <<<<<<<<<<<<<<
 *     """
 *     This implements appending zeros (or another constant GEN ``a``) to
 */

  static GEN __pyx_f_7example__Vec_append(GEN __pyx_v_v, GEN __pyx_v_a, long __pyx_v_n) {
    long __pyx_v_lenv;
    GEN __pyx_v_w;
    long __pyx_v_i;
    GEN __pyx_r;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    long __pyx_t_2;
    __Pyx_RefNannySetupContext("_Vec_append", 0);

    /* "example.pyx":10052
 *     A GEN of the same type as ``v``.
 *     """
 *     cdef long lenv = lg(v)-1             # <<<<<<<<<<<<<<
 *     cdef GEN w
 *     cdef long i
 */
    __pyx_v_lenv = (lg(__pyx_v_v) - 1);

    /* "example.pyx":10056
 *     cdef long i
 *     # Do we need to extend the vector with zeros?
 *     if n > lenv:             # <<<<<<<<<<<<<<
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 */
    __pyx_t_1 = (__pyx_v_n > __pyx_v_lenv);
    if (__pyx_t_1) {

      /* "example.pyx":10057
 *     # Do we need to extend the vector with zeros?
 *     if n > lenv:
 *         w = cgetg(n+1, typ(v))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))
 */
      __pyx_v_w = cgetg((__pyx_v_n + 1), typ(__pyx_v_v));

      /* "example.pyx":10058
 *     if n > lenv:
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 */
      __pyx_t_2 = __pyx_v_lenv;
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "example.pyx":10059
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)
 */
        set_gel(__pyx_v_w, __pyx_v_i, gel(__pyx_v_v, __pyx_v_i));
      }

      /* "example.pyx":10060
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i+lenv, a)
 *         return w
 */
      __pyx_t_2 = (__pyx_v_n - __pyx_v_lenv);
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "example.pyx":10061
 *             set_gel(w, i, gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)             # <<<<<<<<<<<<<<
 *         return w
 *     elif n < -lenv:
 */
        set_gel(__pyx_v_w, (__pyx_v_i + __pyx_v_lenv), __pyx_v_a);
      }

      /* "example.pyx":10062
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i+lenv, a)
 *         return w             # <<<<<<<<<<<<<<
 *     elif n < -lenv:
 *         n = -n  # Make n positive
 */
      __pyx_r = __pyx_v_w;
      goto __pyx_L0;
      goto __pyx_L3;
    }

    /* "example.pyx":10063
 *             set_gel(w, i+lenv, a)
 *         return w
 *     elif n < -lenv:             # <<<<<<<<<<<<<<
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))
 */
    __pyx_t_1 = (__pyx_v_n < (-__pyx_v_lenv));
    if (__pyx_t_1) {

      /* "example.pyx":10064
 *         return w
 *     elif n < -lenv:
 *         n = -n  # Make n positive             # <<<<<<<<<<<<<<
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 */
      __pyx_v_n = (-__pyx_v_n);

      /* "example.pyx":10065
 *     elif n < -lenv:
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))
 */
      __pyx_v_w = cgetg((__pyx_v_n + 1), typ(__pyx_v_v));

      /* "example.pyx":10066
 *         n = -n  # Make n positive
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 */
      __pyx_t_2 = __pyx_v_lenv;
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "example.pyx":10067
 *         w = cgetg(n+1, typ(v))
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))             # <<<<<<<<<<<<<<
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)
 */
        set_gel(__pyx_v_w, (__pyx_v_i + (__pyx_v_n - __pyx_v_lenv)), gel(__pyx_v_v, __pyx_v_i));
      }

      /* "example.pyx":10068
 *         for i from 1 <= i <= lenv:
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:             # <<<<<<<<<<<<<<
 *             set_gel(w, i, a)
 *         return w
 */
      __pyx_t_2 = (__pyx_v_n - __pyx_v_lenv);
      for (__pyx_v_i = 1; __pyx_v_i <= __pyx_t_2; __pyx_v_i++) {

        /* "example.pyx":10069
 *             set_gel(w, i+(n-lenv), gel(v, i))
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)             # <<<<<<<<<<<<<<
 *         return w
 *     else:
 */
        set_gel(__pyx_v_w, __pyx_v_i, __pyx_v_a);
      }

      /* "example.pyx":10070
 *         for i from 1 <= i <= n-lenv:
 *             set_gel(w, i, a)
 *         return w             # <<<<<<<<<<<<<<
 *     else:
 *         return v
 */
      __pyx_r = __pyx_v_w;
      goto __pyx_L0;
      goto __pyx_L3;
    }
    /*else*/ {

      /* "example.pyx":10072
 *         return w
 *     else:
 *         return v             # <<<<<<<<<<<<<<
 * 
 * 
 */
      __pyx_r = __pyx_v_v;
      goto __pyx_L0;
    }
    __pyx_L3:;

    __pyx_r = 0;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_15__errmessage(PyObject *__pyx_self, PyObject *__pyx_v_d); /*proto*/
  static PyMethodDef __pyx_mdef_7example_15__errmessage = {__Pyx_NAMESTR("__errmessage"), (PyCFunction)__pyx_pw_7example_15__errmessage, METH_O, __Pyx_DOCSTR(0)};
  static PyObject *__pyx_pw_7example_15__errmessage(PyObject *__pyx_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__errmessage (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_14__errmessage(__pyx_self, ((PyObject *)__pyx_v_d));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10090
 * 
 * 
 * def __errmessage(d):             # <<<<<<<<<<<<<<
 *     if d <= 0 or d > noer:
 *         return "unknown"
 */

  static PyObject *__pyx_pf_7example_14__errmessage(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_d) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    int __pyx_t_2;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_t_4;
    int __pyx_t_5;
    Py_ssize_t __pyx_t_6;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__errmessage", 0);

    /* "example.pyx":10091
 * 
 * def __errmessage(d):
 *     if d <= 0 or d > noer:             # <<<<<<<<<<<<<<
 *         return "unknown"
 *     return errmessage[d]
 */
    __pyx_t_1 = PyObject_RichCompare(__pyx_v_d, __pyx_int_0, Py_LE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10091; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10091; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (!__pyx_t_2) {
      __pyx_t_1 = PyInt_FromLong(noer); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10091; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_d, __pyx_t_1, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10091; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10091; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = __pyx_t_4;
    } else {
      __pyx_t_5 = __pyx_t_2;
    }
    if (__pyx_t_5) {

      /* "example.pyx":10092
 * def __errmessage(d):
 *     if d <= 0 or d > noer:
 *         return "unknown"             # <<<<<<<<<<<<<<
 *     return errmessage[d]
 * 
 */
      __Pyx_XDECREF(__pyx_r);
      __Pyx_INCREF(((PyObject *)__pyx_n_s__unknown));
      __pyx_r = ((PyObject *)__pyx_n_s__unknown);
      goto __pyx_L0;
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":10093
 *     if d <= 0 or d > noer:
 *         return "unknown"
 *     return errmessage[d]             # <<<<<<<<<<<<<<
 * 
 * # FIXME: we derive PariError from RuntimeError, for backward
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_v_d); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = PyBytes_FromString((errmessage[__pyx_t_6])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __pyx_r = ((PyObject *)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.__errmessage", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_9PariError_1errnum(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_7example_9PariError_errnum[] = "\n        Return the PARI error number corresponding to this exception.\n\n        EXAMPLES::\n\n            sage: try:\n            ...     pari('1/0')\n            ... except PariError, err:\n            ...     print err.errnum()\n            27\n        ";
  static PyMethodDef __pyx_mdef_7example_9PariError_1errnum = {__Pyx_NAMESTR("errnum"), (PyCFunction)__pyx_pw_7example_9PariError_1errnum, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_9PariError_errnum)};
  static PyObject *__pyx_pw_7example_9PariError_1errnum(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("errnum (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_9PariError_errnum(__pyx_self, ((PyObject *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10107
 *     errmessage = staticmethod(__errmessage)
 * 
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */

  static PyObject *__pyx_pf_7example_9PariError_errnum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("errnum", 0);

    /* "example.pyx":10119
 *             27
 *         """
 *         return self.args[0]             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__args); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariError.errnum", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_9PariError_3__repr__(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_7example_9PariError_2__repr__[] = "\n        TESTS::\n\n            sage: PariError(11)\n            PariError(11)\n        ";
  static PyMethodDef __pyx_mdef_7example_9PariError_3__repr__ = {__Pyx_NAMESTR("__repr__"), (PyCFunction)__pyx_pw_7example_9PariError_3__repr__, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_9PariError_2__repr__)};
  static PyObject *__pyx_pw_7example_9PariError_3__repr__(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__repr__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_9PariError_2__repr__(__pyx_self, ((PyObject *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10121
 *         return self.args[0]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */

  static PyObject *__pyx_pf_7example_9PariError_2__repr__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__repr__", 0);

    /* "example.pyx":10128
 *             PariError(11)
 *         """
 *         return "PariError(%d)"%self.errnum()             # <<<<<<<<<<<<<<
 * 
 *     def __str__(self):
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__errnum); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_78), __pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_AddTraceback("example.PariError.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_9PariError_5__str__(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
  static char __pyx_doc_7example_9PariError_4__str__[] = "\n        EXAMPLES::\n\n            sage: try:\n            ...     pari('1/0')\n            ... except PariError, err:\n            ...     print err\n            division by zero (27)\n        ";
  static PyMethodDef __pyx_mdef_7example_9PariError_5__str__ = {__Pyx_NAMESTR("__str__"), (PyCFunction)__pyx_pw_7example_9PariError_5__str__, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_9PariError_4__str__)};
  static PyObject *__pyx_pw_7example_9PariError_5__str__(PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("__str__ (wrapper)", 0);
    __pyx_r = __pyx_pf_7example_9PariError_4__str__(__pyx_self, ((PyObject *)__pyx_v_self));
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10130
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         EXAMPLES::
 */

  static PyObject *__pyx_pf_7example_9PariError_4__str__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    PyObject *__pyx_t_1 = NULL;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("__str__", 0);

    /* "example.pyx":10140
 *             division by zero (27)
 *         """
 *         return "%s (%d)"%(self.errmessage(self.errnum()), self.errnum())             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__errmessage); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__errnum); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__errnum); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_3 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_79), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __pyx_r = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_1);
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_AddTraceback("example.PariError.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* Python wrapper */
  static PyObject *__pyx_pw_7example_17vecsmall_to_intlist(PyObject *__pyx_self, PyObject *__pyx_v_v); /*proto*/
  static char __pyx_doc_7example_16vecsmall_to_intlist[] = "\n    INPUT:\n\n\n    -  ``v`` - a gen of type Vecsmall\n\n\n    OUTPUT: a Python list of Python ints\n    ";
  static PyMethodDef __pyx_mdef_7example_17vecsmall_to_intlist = {__Pyx_NAMESTR("vecsmall_to_intlist"), (PyCFunction)__pyx_pw_7example_17vecsmall_to_intlist, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_16vecsmall_to_intlist)};
  static PyObject *__pyx_pw_7example_17vecsmall_to_intlist(PyObject *__pyx_self, PyObject *__pyx_v_v) {
    PyObject *__pyx_r = 0;
    __Pyx_RefNannyDeclarations
    __Pyx_RefNannySetupContext("vecsmall_to_intlist (wrapper)", 0);
    if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_v), __pyx_ptype_7example_gen, 1, "v", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_r = __pyx_pf_7example_16vecsmall_to_intlist(__pyx_self, ((struct __pyx_obj_7example_gen *)__pyx_v_v));
    goto __pyx_L0;
    __pyx_L1_error:;
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }

  /* "example.pyx":10145
 * 
 * 
 * def vecsmall_to_intlist(gen v):             # <<<<<<<<<<<<<<
 *     """
 *     INPUT:
 */

  static PyObject *__pyx_pf_7example_16vecsmall_to_intlist(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_7example_gen *__pyx_v_v) {
    PyObject *__pyx_v_k = NULL;
    PyObject *__pyx_r = NULL;
    __Pyx_RefNannyDeclarations
    int __pyx_t_1;
    PyObject *__pyx_t_2 = NULL;
    PyObject *__pyx_t_3 = NULL;
    PyObject *__pyx_t_4 = NULL;
    Py_ssize_t __pyx_t_5;
    PyObject *(*__pyx_t_6)(PyObject *);
    Py_ssize_t __pyx_t_7;
    int __pyx_lineno = 0;
    const char *__pyx_filename = NULL;
    int __pyx_clineno = 0;
    __Pyx_RefNannySetupContext("vecsmall_to_intlist", 0);

    /* "example.pyx":10155
 *     OUTPUT: a Python list of Python ints
 *     """
 *     if typ(v.g) != t_VECSMALL:             # <<<<<<<<<<<<<<
 *         raise TypeError, "input v must be of type vecsmall (use v.Vecsmall())"
 *     return [v.g[k+1] for k in range(glength(v.g))]
 */
    __pyx_t_1 = (typ(__pyx_v_v->g) != t_VECSMALL);
    if (__pyx_t_1) {

      /* "example.pyx":10156
 *     """
 *     if typ(v.g) != t_VECSMALL:
 *         raise TypeError, "input v must be of type vecsmall (use v.Vecsmall())"             # <<<<<<<<<<<<<<
 *     return [v.g[k+1] for k in range(glength(v.g))]
 * 
 */
      __Pyx_Raise(__pyx_builtin_TypeError, ((PyObject *)__pyx_kp_s_80), 0, 0);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L3;
    }
    __pyx_L3:;

    /* "example.pyx":10157
 *     if typ(v.g) != t_VECSMALL:
 *         raise TypeError, "input v must be of type vecsmall (use v.Vecsmall())"
 *     return [v.g[k+1] for k in range(glength(v.g))]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyInt_FromLong(glength(__pyx_v_v->g)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
      __pyx_t_4 = __pyx_t_3; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (!__pyx_t_6 && PyList_CheckExact(__pyx_t_4)) {
        if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #endif
      } else if (!__pyx_t_6 && PyTuple_CheckExact(__pyx_t_4)) {
        if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely(0 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #else
        __pyx_t_3 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        #endif
      } else {
        __pyx_t_3 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          if (PyErr_Occurred()) {
            if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
            else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_3);
      }
      __Pyx_XDECREF(__pyx_v_k);
      __pyx_v_k = __pyx_t_3;
      __pyx_t_3 = 0;
      __pyx_t_3 = PyNumber_Add(__pyx_v_k, __pyx_int_1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyInt_FromLong((__pyx_v_v->g[__pyx_t_7])); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      if (unlikely(__Pyx_PyList_Append(__pyx_t_2, (PyObject*)__pyx_t_3))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    }
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_INCREF(((PyObject *)__pyx_t_2));
    __pyx_r = ((PyObject *)__pyx_t_2);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    goto __pyx_L0;

    __pyx_r = Py_None; __Pyx_INCREF(Py_None);
    goto __pyx_L0;
    __pyx_L1_error:;
    __Pyx_XDECREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_t_3);
    __Pyx_XDECREF(__pyx_t_4);
    __Pyx_AddTraceback("example.vecsmall_to_intlist", __pyx_clineno, __pyx_lineno, __pyx_filename);
    __pyx_r = NULL;
    __pyx_L0:;
    __Pyx_XDECREF(__pyx_v_k);
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    return __pyx_r;
  }
  static struct __pyx_vtabstruct_7example_gen __pyx_vtable_7example_gen;

  static PyObject *__pyx_tp_new_7example_gen(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
    struct __pyx_obj_7example_gen *p;
    PyObject *o = (*t->tp_alloc)(t, 0);
    if (!o) return 0;
    p = ((struct __pyx_obj_7example_gen *)o);
    p->__pyx_vtab = __pyx_vtabptr_7example_gen;
    p->_refers_to = Py_None; Py_INCREF(Py_None);
    return o;
  }

  static void __pyx_tp_dealloc_7example_gen(PyObject *o) {
    struct __pyx_obj_7example_gen *p = (struct __pyx_obj_7example_gen *)o;
    PyObject_GC_UnTrack(o);
    {
      PyObject *etype, *eval, *etb;
      PyErr_Fetch(&etype, &eval, &etb);
      ++Py_REFCNT(o);
      __pyx_pw_7example_3gen_5__dealloc__(o);
      if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
      --Py_REFCNT(o);
      PyErr_Restore(etype, eval, etb);
    }
    Py_CLEAR(p->_refers_to);
    PyObject_GC_Track(o);
    (*Py_TYPE(o)->tp_free)(o);
  }

  static int __pyx_tp_traverse_7example_gen(PyObject *o, visitproc v, void *a) {
    int e;
    struct __pyx_obj_7example_gen *p = (struct __pyx_obj_7example_gen *)o;
    if (p->_refers_to) {
      e = (*v)(p->_refers_to, a); if (e) return e;
    }
    return 0;
  }

  static int __pyx_tp_clear_7example_gen(PyObject *o) {
    struct __pyx_obj_7example_gen *p = (struct __pyx_obj_7example_gen *)o;
    PyObject* tmp;
    tmp = ((PyObject*)p->_refers_to);
    p->_refers_to = Py_None; Py_INCREF(Py_None);
    Py_XDECREF(tmp);
    return 0;
  }
  static PyObject *__pyx_sq_item_7example_gen(PyObject *o, Py_ssize_t i) {
    PyObject *r;
    PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
    r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
    Py_DECREF(x);
    return r;
  }

  static int __pyx_mp_ass_subscript_7example_gen(PyObject *o, PyObject *i, PyObject *v) {
    if (v) {
      return __pyx_pw_7example_3gen_85__setitem__(o, i, v);
    }
    else {
      PyErr_Format(PyExc_NotImplementedError,
        "Subscript deletion not supported by %s", Py_TYPE(o)->tp_name);
      return -1;
    }
  }

  static PyMethodDef __pyx_methods_7example_gen[] = {
    {__Pyx_NAMESTR("parent"), (PyCFunction)__pyx_pw_7example_3gen_3parent, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("_testclass"), (PyCFunction)__pyx_pw_7example_3gen_11_testclass, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("list"), (PyCFunction)__pyx_pw_7example_3gen_13list, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_12list)},
    {__Pyx_NAMESTR("__reduce__"), (PyCFunction)__pyx_pw_7example_3gen_15__reduce__, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_14__reduce__)},
    {__Pyx_NAMESTR("_add_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_19_add_unsafe, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_18_add_unsafe)},
    {__Pyx_NAMESTR("_sub_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_23_sub_unsafe, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_22_sub_unsafe)},
    {__Pyx_NAMESTR("_mul_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_27_mul_unsafe, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_26_mul_unsafe)},
    {__Pyx_NAMESTR("_div_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_31_div_unsafe, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_30_div_unsafe)},
    {__Pyx_NAMESTR("_add_one"), (PyCFunction)__pyx_pw_7example_3gen_33_add_one, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_32_add_one)},
    {__Pyx_NAMESTR("getattr"), (PyCFunction)__pyx_pw_7example_3gen_49getattr, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("mod"), (PyCFunction)__pyx_pw_7example_3gen_51mod, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_50mod)},
    {__Pyx_NAMESTR("nf_get_pol"), (PyCFunction)__pyx_pw_7example_3gen_53nf_get_pol, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_52nf_get_pol)},
    {__Pyx_NAMESTR("nf_get_diff"), (PyCFunction)__pyx_pw_7example_3gen_55nf_get_diff, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_54nf_get_diff)},
    {__Pyx_NAMESTR("nf_get_sign"), (PyCFunction)__pyx_pw_7example_3gen_57nf_get_sign, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_56nf_get_sign)},
    {__Pyx_NAMESTR("nf_get_zk"), (PyCFunction)__pyx_pw_7example_3gen_59nf_get_zk, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_58nf_get_zk)},
    {__Pyx_NAMESTR("bnf_get_no"), (PyCFunction)__pyx_pw_7example_3gen_61bnf_get_no, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_60bnf_get_no)},
    {__Pyx_NAMESTR("bnf_get_cyc"), (PyCFunction)__pyx_pw_7example_3gen_63bnf_get_cyc, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_62bnf_get_cyc)},
    {__Pyx_NAMESTR("bnf_get_gen"), (PyCFunction)__pyx_pw_7example_3gen_65bnf_get_gen, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_64bnf_get_gen)},
    {__Pyx_NAMESTR("bnf_get_reg"), (PyCFunction)__pyx_pw_7example_3gen_67bnf_get_reg, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_66bnf_get_reg)},
    {__Pyx_NAMESTR("pr_get_p"), (PyCFunction)__pyx_pw_7example_3gen_69pr_get_p, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_68pr_get_p)},
    {__Pyx_NAMESTR("pr_get_e"), (PyCFunction)__pyx_pw_7example_3gen_71pr_get_e, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_70pr_get_e)},
    {__Pyx_NAMESTR("pr_get_f"), (PyCFunction)__pyx_pw_7example_3gen_73pr_get_f, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_72pr_get_f)},
    {__Pyx_NAMESTR("pr_get_gen"), (PyCFunction)__pyx_pw_7example_3gen_75pr_get_gen, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_74pr_get_gen)},
    {__Pyx_NAMESTR("bid_get_cyc"), (PyCFunction)__pyx_pw_7example_3gen_77bid_get_cyc, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_76bid_get_cyc)},
    {__Pyx_NAMESTR("bid_get_gen"), (PyCFunction)__pyx_pw_7example_3gen_79bid_get_gen, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_78bid_get_gen)},
    {__Pyx_NAMESTR("_gen_length"), (PyCFunction)__pyx_pw_7example_3gen_83_gen_length, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_82_gen_length)},
    {__Pyx_NAMESTR("__copy__"), (PyCFunction)__pyx_pw_7example_3gen_91__copy__, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("list_str"), (PyCFunction)__pyx_pw_7example_3gen_93list_str, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_92list_str)},
    {__Pyx_NAMESTR("int_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_99int_unsafe, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_98int_unsafe)},
    {__Pyx_NAMESTR("intvec_unsafe"), (PyCFunction)__pyx_pw_7example_3gen_101intvec_unsafe, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_100intvec_unsafe)},
    {__Pyx_NAMESTR("python_list_small"), (PyCFunction)__pyx_pw_7example_3gen_103python_list_small, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_102python_list_small)},
    {__Pyx_NAMESTR("python_list"), (PyCFunction)__pyx_pw_7example_3gen_105python_list, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_104python_list)},
    {__Pyx_NAMESTR("__complex__"), (PyCFunction)__pyx_pw_7example_3gen_111__complex__, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_110__complex__)},
    {__Pyx_NAMESTR("gequal"), (PyCFunction)__pyx_pw_7example_3gen_115gequal, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_114gequal)},
    {__Pyx_NAMESTR("gequal0"), (PyCFunction)__pyx_pw_7example_3gen_117gequal0, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_116gequal0)},
    {__Pyx_NAMESTR("gequal_long"), (PyCFunction)__pyx_pw_7example_3gen_119gequal_long, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_118gequal_long)},
    {__Pyx_NAMESTR("isprime"), (PyCFunction)__pyx_pw_7example_3gen_121isprime, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_120isprime)},
    {__Pyx_NAMESTR("qfbhclassno"), (PyCFunction)__pyx_pw_7example_3gen_123qfbhclassno, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_122qfbhclassno)},
    {__Pyx_NAMESTR("ispseudoprime"), (PyCFunction)__pyx_pw_7example_3gen_125ispseudoprime, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_124ispseudoprime)},
    {__Pyx_NAMESTR("ispower"), (PyCFunction)__pyx_pw_7example_3gen_127ispower, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_126ispower)},
    {__Pyx_NAMESTR("divrem"), (PyCFunction)__pyx_pw_7example_3gen_129divrem, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_128divrem)},
    {__Pyx_NAMESTR("lex"), (PyCFunction)__pyx_pw_7example_3gen_131lex, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_130lex)},
    {__Pyx_NAMESTR("max"), (PyCFunction)__pyx_pw_7example_3gen_133max, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_132max)},
    {__Pyx_NAMESTR("min"), (PyCFunction)__pyx_pw_7example_3gen_135min, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_134min)},
    {__Pyx_NAMESTR("shift"), (PyCFunction)__pyx_pw_7example_3gen_137shift, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_136shift)},
    {__Pyx_NAMESTR("shiftmul"), (PyCFunction)__pyx_pw_7example_3gen_139shiftmul, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_138shiftmul)},
    {__Pyx_NAMESTR("moebius"), (PyCFunction)__pyx_pw_7example_3gen_141moebius, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_140moebius)},
    {__Pyx_NAMESTR("sign"), (PyCFunction)__pyx_pw_7example_3gen_143sign, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_142sign)},
    {__Pyx_NAMESTR("vecmax"), (PyCFunction)__pyx_pw_7example_3gen_145vecmax, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_144vecmax)},
    {__Pyx_NAMESTR("vecmin"), (PyCFunction)__pyx_pw_7example_3gen_147vecmin, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_146vecmin)},
    {__Pyx_NAMESTR("Col"), (PyCFunction)__pyx_pw_7example_3gen_149Col, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_148Col)},
    {__Pyx_NAMESTR("Colrev"), (PyCFunction)__pyx_pw_7example_3gen_151Colrev, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_150Colrev)},
    {__Pyx_NAMESTR("List"), (PyCFunction)__pyx_pw_7example_3gen_153List, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_152List)},
    {__Pyx_NAMESTR("Mat"), (PyCFunction)__pyx_pw_7example_3gen_155Mat, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_154Mat)},
    {__Pyx_NAMESTR("Mod"), (PyCFunction)__pyx_pw_7example_3gen_157Mod, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_156Mod)},
    {__Pyx_NAMESTR("Pol"), (PyCFunction)__pyx_pw_7example_3gen_159Pol, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_158Pol)},
    {__Pyx_NAMESTR("Polrev"), (PyCFunction)__pyx_pw_7example_3gen_161Polrev, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_160Polrev)},
    {__Pyx_NAMESTR("Qfb"), (PyCFunction)__pyx_pw_7example_3gen_163Qfb, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_162Qfb)},
    {__Pyx_NAMESTR("Ser"), (PyCFunction)__pyx_pw_7example_3gen_165Ser, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_164Ser)},
    {__Pyx_NAMESTR("Set"), (PyCFunction)__pyx_pw_7example_3gen_167Set, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_166Set)},
    {__Pyx_NAMESTR("Str"), (PyCFunction)__pyx_pw_7example_3gen_169Str, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_168Str)},
    {__Pyx_NAMESTR("Strchr"), (PyCFunction)__pyx_pw_7example_3gen_171Strchr, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_170Strchr)},
    {__Pyx_NAMESTR("Strexpand"), (PyCFunction)__pyx_pw_7example_3gen_173Strexpand, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_172Strexpand)},
    {__Pyx_NAMESTR("Strtex"), (PyCFunction)__pyx_pw_7example_3gen_175Strtex, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_174Strtex)},
    {__Pyx_NAMESTR("printtex"), (PyCFunction)__pyx_pw_7example_3gen_177printtex, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("Vec"), (PyCFunction)__pyx_pw_7example_3gen_179Vec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_178Vec)},
    {__Pyx_NAMESTR("Vecrev"), (PyCFunction)__pyx_pw_7example_3gen_181Vecrev, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_180Vecrev)},
    {__Pyx_NAMESTR("Vecsmall"), (PyCFunction)__pyx_pw_7example_3gen_183Vecsmall, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_182Vecsmall)},
    {__Pyx_NAMESTR("binary"), (PyCFunction)__pyx_pw_7example_3gen_185binary, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_184binary)},
    {__Pyx_NAMESTR("bitand"), (PyCFunction)__pyx_pw_7example_3gen_187bitand, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_186bitand)},
    {__Pyx_NAMESTR("bitneg"), (PyCFunction)__pyx_pw_7example_3gen_189bitneg, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_188bitneg)},
    {__Pyx_NAMESTR("bitnegimply"), (PyCFunction)__pyx_pw_7example_3gen_191bitnegimply, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_190bitnegimply)},
    {__Pyx_NAMESTR("bitor"), (PyCFunction)__pyx_pw_7example_3gen_193bitor, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_192bitor)},
    {__Pyx_NAMESTR("bittest"), (PyCFunction)__pyx_pw_7example_3gen_195bittest, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_194bittest)},
    {__Pyx_NAMESTR("bitxor"), (PyCFunction)__pyx_pw_7example_3gen_197bitxor, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_196bitxor)},
    {__Pyx_NAMESTR("ceil"), (PyCFunction)__pyx_pw_7example_3gen_199ceil, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_198ceil)},
    {__Pyx_NAMESTR("centerlift"), (PyCFunction)__pyx_pw_7example_3gen_201centerlift, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_200centerlift)},
    {__Pyx_NAMESTR("component"), (PyCFunction)__pyx_pw_7example_3gen_203component, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_202component)},
    {__Pyx_NAMESTR("conj"), (PyCFunction)__pyx_pw_7example_3gen_205conj, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_204conj)},
    {__Pyx_NAMESTR("conjvec"), (PyCFunction)__pyx_pw_7example_3gen_207conjvec, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_206conjvec)},
    {__Pyx_NAMESTR("denominator"), (PyCFunction)__pyx_pw_7example_3gen_209denominator, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_208denominator)},
    {__Pyx_NAMESTR("floor"), (PyCFunction)__pyx_pw_7example_3gen_211floor, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_210floor)},
    {__Pyx_NAMESTR("frac"), (PyCFunction)__pyx_pw_7example_3gen_213frac, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_212frac)},
    {__Pyx_NAMESTR("imag"), (PyCFunction)__pyx_pw_7example_3gen_215imag, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_214imag)},
    {__Pyx_NAMESTR("length"), (PyCFunction)__pyx_pw_7example_3gen_217length, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_216length)},
    {__Pyx_NAMESTR("lift"), (PyCFunction)__pyx_pw_7example_3gen_219lift, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_218lift)},
    {__Pyx_NAMESTR("numbpart"), (PyCFunction)__pyx_pw_7example_3gen_221numbpart, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_220numbpart)},
    {__Pyx_NAMESTR("numerator"), (PyCFunction)__pyx_pw_7example_3gen_223numerator, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_222numerator)},
    {__Pyx_NAMESTR("numtoperm"), (PyCFunction)__pyx_pw_7example_3gen_225numtoperm, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_224numtoperm)},
    {__Pyx_NAMESTR("padicprec"), (PyCFunction)__pyx_pw_7example_3gen_227padicprec, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_226padicprec)},
    {__Pyx_NAMESTR("padicprime"), (PyCFunction)__pyx_pw_7example_3gen_229padicprime, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_228padicprime)},
    {__Pyx_NAMESTR("permtonum"), (PyCFunction)__pyx_pw_7example_3gen_231permtonum, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_230permtonum)},
    {__Pyx_NAMESTR("precision"), (PyCFunction)__pyx_pw_7example_3gen_233precision, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_232precision)},
    {__Pyx_NAMESTR("random"), (PyCFunction)__pyx_pw_7example_3gen_235random, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_234random)},
    {__Pyx_NAMESTR("real"), (PyCFunction)__pyx_pw_7example_3gen_237real, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_236real)},
    {__Pyx_NAMESTR("round"), (PyCFunction)__pyx_pw_7example_3gen_239round, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_238round)},
    {__Pyx_NAMESTR("simplify"), (PyCFunction)__pyx_pw_7example_3gen_241simplify, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_240simplify)},
    {__Pyx_NAMESTR("sizeword"), (PyCFunction)__pyx_pw_7example_3gen_243sizeword, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_242sizeword)},
    {__Pyx_NAMESTR("sizebyte"), (PyCFunction)__pyx_pw_7example_3gen_245sizebyte, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_244sizebyte)},
    {__Pyx_NAMESTR("sizedigit"), (PyCFunction)__pyx_pw_7example_3gen_247sizedigit, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_246sizedigit)},
    {__Pyx_NAMESTR("truncate"), (PyCFunction)__pyx_pw_7example_3gen_249truncate, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_248truncate)},
    {__Pyx_NAMESTR("valuation"), (PyCFunction)__pyx_pw_7example_3gen_251valuation, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_250valuation)},
    {__Pyx_NAMESTR("_valp"), (PyCFunction)__pyx_pw_7example_3gen_253_valp, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_252_valp)},
    {__Pyx_NAMESTR("variable"), (PyCFunction)__pyx_pw_7example_3gen_255variable, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_254variable)},
    {__Pyx_NAMESTR("abs"), (PyCFunction)__pyx_pw_7example_3gen_257abs, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_256abs)},
    {__Pyx_NAMESTR("acos"), (PyCFunction)__pyx_pw_7example_3gen_259acos, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_258acos)},
    {__Pyx_NAMESTR("acosh"), (PyCFunction)__pyx_pw_7example_3gen_261acosh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_260acosh)},
    {__Pyx_NAMESTR("agm"), (PyCFunction)__pyx_pw_7example_3gen_263agm, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_262agm)},
    {__Pyx_NAMESTR("arg"), (PyCFunction)__pyx_pw_7example_3gen_265arg, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_264arg)},
    {__Pyx_NAMESTR("asin"), (PyCFunction)__pyx_pw_7example_3gen_267asin, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_266asin)},
    {__Pyx_NAMESTR("asinh"), (PyCFunction)__pyx_pw_7example_3gen_269asinh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_268asinh)},
    {__Pyx_NAMESTR("atan"), (PyCFunction)__pyx_pw_7example_3gen_271atan, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_270atan)},
    {__Pyx_NAMESTR("atanh"), (PyCFunction)__pyx_pw_7example_3gen_273atanh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_272atanh)},
    {__Pyx_NAMESTR("bernfrac"), (PyCFunction)__pyx_pw_7example_3gen_275bernfrac, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_274bernfrac)},
    {__Pyx_NAMESTR("bernreal"), (PyCFunction)__pyx_pw_7example_3gen_277bernreal, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_276bernreal)},
    {__Pyx_NAMESTR("bernvec"), (PyCFunction)__pyx_pw_7example_3gen_279bernvec, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_278bernvec)},
    {__Pyx_NAMESTR("besselh1"), (PyCFunction)__pyx_pw_7example_3gen_281besselh1, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_280besselh1)},
    {__Pyx_NAMESTR("besselh2"), (PyCFunction)__pyx_pw_7example_3gen_283besselh2, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_282besselh2)},
    {__Pyx_NAMESTR("besselj"), (PyCFunction)__pyx_pw_7example_3gen_285besselj, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_284besselj)},
    {__Pyx_NAMESTR("besseljh"), (PyCFunction)__pyx_pw_7example_3gen_287besseljh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_286besseljh)},
    {__Pyx_NAMESTR("besseli"), (PyCFunction)__pyx_pw_7example_3gen_289besseli, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_288besseli)},
    {__Pyx_NAMESTR("besselk"), (PyCFunction)__pyx_pw_7example_3gen_291besselk, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_290besselk)},
    {__Pyx_NAMESTR("besseln"), (PyCFunction)__pyx_pw_7example_3gen_293besseln, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_292besseln)},
    {__Pyx_NAMESTR("cos"), (PyCFunction)__pyx_pw_7example_3gen_295cos, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_294cos)},
    {__Pyx_NAMESTR("cosh"), (PyCFunction)__pyx_pw_7example_3gen_297cosh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_296cosh)},
    {__Pyx_NAMESTR("cotan"), (PyCFunction)__pyx_pw_7example_3gen_299cotan, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_298cotan)},
    {__Pyx_NAMESTR("dilog"), (PyCFunction)__pyx_pw_7example_3gen_301dilog, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_300dilog)},
    {__Pyx_NAMESTR("eint1"), (PyCFunction)__pyx_pw_7example_3gen_303eint1, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_302eint1)},
    {__Pyx_NAMESTR("erfc"), (PyCFunction)__pyx_pw_7example_3gen_305erfc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_304erfc)},
    {__Pyx_NAMESTR("eta"), (PyCFunction)__pyx_pw_7example_3gen_307eta, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_306eta)},
    {__Pyx_NAMESTR("exp"), (PyCFunction)__pyx_pw_7example_3gen_309exp, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_308exp)},
    {__Pyx_NAMESTR("gamma"), (PyCFunction)__pyx_pw_7example_3gen_311gamma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_310gamma)},
    {__Pyx_NAMESTR("gammah"), (PyCFunction)__pyx_pw_7example_3gen_313gammah, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_312gammah)},
    {__Pyx_NAMESTR("hyperu"), (PyCFunction)__pyx_pw_7example_3gen_315hyperu, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_314hyperu)},
    {__Pyx_NAMESTR("incgam"), (PyCFunction)__pyx_pw_7example_3gen_317incgam, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_316incgam)},
    {__Pyx_NAMESTR("incgamc"), (PyCFunction)__pyx_pw_7example_3gen_319incgamc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_318incgamc)},
    {__Pyx_NAMESTR("log"), (PyCFunction)__pyx_pw_7example_3gen_321log, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_320log)},
    {__Pyx_NAMESTR("lngamma"), (PyCFunction)__pyx_pw_7example_3gen_323lngamma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_322lngamma)},
    {__Pyx_NAMESTR("log_gamma"), (PyCFunction)__pyx_pw_7example_3gen_325log_gamma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_324log_gamma)},
    {__Pyx_NAMESTR("polylog"), (PyCFunction)__pyx_pw_7example_3gen_327polylog, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_326polylog)},
    {__Pyx_NAMESTR("psi"), (PyCFunction)__pyx_pw_7example_3gen_329psi, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_328psi)},
    {__Pyx_NAMESTR("sin"), (PyCFunction)__pyx_pw_7example_3gen_331sin, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_330sin)},
    {__Pyx_NAMESTR("sinh"), (PyCFunction)__pyx_pw_7example_3gen_333sinh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_332sinh)},
    {__Pyx_NAMESTR("sqr"), (PyCFunction)__pyx_pw_7example_3gen_335sqr, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_334sqr)},
    {__Pyx_NAMESTR("sqrt"), (PyCFunction)__pyx_pw_7example_3gen_337sqrt, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_336sqrt)},
    {__Pyx_NAMESTR("sqrtn"), (PyCFunction)__pyx_pw_7example_3gen_339sqrtn, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_338sqrtn)},
    {__Pyx_NAMESTR("tan"), (PyCFunction)__pyx_pw_7example_3gen_341tan, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_340tan)},
    {__Pyx_NAMESTR("tanh"), (PyCFunction)__pyx_pw_7example_3gen_343tanh, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_342tanh)},
    {__Pyx_NAMESTR("teichmuller"), (PyCFunction)__pyx_pw_7example_3gen_345teichmuller, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_344teichmuller)},
    {__Pyx_NAMESTR("theta"), (PyCFunction)__pyx_pw_7example_3gen_347theta, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_346theta)},
    {__Pyx_NAMESTR("thetanullk"), (PyCFunction)__pyx_pw_7example_3gen_349thetanullk, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_348thetanullk)},
    {__Pyx_NAMESTR("weber"), (PyCFunction)__pyx_pw_7example_3gen_351weber, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_350weber)},
    {__Pyx_NAMESTR("zeta"), (PyCFunction)__pyx_pw_7example_3gen_353zeta, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_352zeta)},
    {__Pyx_NAMESTR("bezout"), (PyCFunction)__pyx_pw_7example_3gen_355bezout, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("binomial"), (PyCFunction)__pyx_pw_7example_3gen_357binomial, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_356binomial)},
    {__Pyx_NAMESTR("contfrac"), (PyCFunction)__pyx_pw_7example_3gen_359contfrac, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_358contfrac)},
    {__Pyx_NAMESTR("contfracpnqn"), (PyCFunction)__pyx_pw_7example_3gen_361contfracpnqn, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_360contfracpnqn)},
    {__Pyx_NAMESTR("fibonacci"), (PyCFunction)__pyx_pw_7example_3gen_363fibonacci, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_362fibonacci)},
    {__Pyx_NAMESTR("gcd"), (PyCFunction)__pyx_pw_7example_3gen_365gcd, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_364gcd)},
    {__Pyx_NAMESTR("issquare"), (PyCFunction)__pyx_pw_7example_3gen_367issquare, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_366issquare)},
    {__Pyx_NAMESTR("issquarefree"), (PyCFunction)__pyx_pw_7example_3gen_369issquarefree, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_368issquarefree)},
    {__Pyx_NAMESTR("lcm"), (PyCFunction)__pyx_pw_7example_3gen_371lcm, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_370lcm)},
    {__Pyx_NAMESTR("numdiv"), (PyCFunction)__pyx_pw_7example_3gen_373numdiv, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_372numdiv)},
    {__Pyx_NAMESTR("phi"), (PyCFunction)__pyx_pw_7example_3gen_375phi, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_374phi)},
    {__Pyx_NAMESTR("primepi"), (PyCFunction)__pyx_pw_7example_3gen_377primepi, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_376primepi)},
    {__Pyx_NAMESTR("sumdiv"), (PyCFunction)__pyx_pw_7example_3gen_379sumdiv, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_378sumdiv)},
    {__Pyx_NAMESTR("sumdivk"), (PyCFunction)__pyx_pw_7example_3gen_381sumdivk, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_380sumdivk)},
    {__Pyx_NAMESTR("xgcd"), (PyCFunction)__pyx_pw_7example_3gen_383xgcd, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_382xgcd)},
    {__Pyx_NAMESTR("ellinit"), (PyCFunction)__pyx_pw_7example_3gen_385ellinit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_384ellinit)},
    {__Pyx_NAMESTR("ellglobalred"), (PyCFunction)__pyx_pw_7example_3gen_387ellglobalred, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_386ellglobalred)},
    {__Pyx_NAMESTR("elladd"), (PyCFunction)__pyx_pw_7example_3gen_389elladd, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_388elladd)},
    {__Pyx_NAMESTR("ellak"), (PyCFunction)__pyx_pw_7example_3gen_391ellak, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_390ellak)},
    {__Pyx_NAMESTR("ellan"), (PyCFunction)__pyx_pw_7example_3gen_393ellan, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_392ellan)},
    {__Pyx_NAMESTR("ellanalyticrank"), (PyCFunction)__pyx_pw_7example_3gen_395ellanalyticrank, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_394ellanalyticrank)},
    {__Pyx_NAMESTR("ellap"), (PyCFunction)__pyx_pw_7example_3gen_397ellap, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_396ellap)},
    {__Pyx_NAMESTR("ellaplist"), (PyCFunction)__pyx_pw_7example_3gen_399ellaplist, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_398ellaplist)},
    {__Pyx_NAMESTR("ellbil"), (PyCFunction)__pyx_pw_7example_3gen_401ellbil, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_400ellbil)},
    {__Pyx_NAMESTR("ellchangecurve"), (PyCFunction)__pyx_pw_7example_3gen_403ellchangecurve, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_402ellchangecurve)},
    {__Pyx_NAMESTR("elleta"), (PyCFunction)__pyx_pw_7example_3gen_405elleta, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_404elleta)},
    {__Pyx_NAMESTR("ellheight"), (PyCFunction)__pyx_pw_7example_3gen_407ellheight, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_406ellheight)},
    {__Pyx_NAMESTR("ellheightmatrix"), (PyCFunction)__pyx_pw_7example_3gen_409ellheightmatrix, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_408ellheightmatrix)},
    {__Pyx_NAMESTR("ellisoncurve"), (PyCFunction)__pyx_pw_7example_3gen_411ellisoncurve, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_410ellisoncurve)},
    {__Pyx_NAMESTR("elllocalred"), (PyCFunction)__pyx_pw_7example_3gen_413elllocalred, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_412elllocalred)},
    {__Pyx_NAMESTR("elllseries"), (PyCFunction)__pyx_pw_7example_3gen_415elllseries, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_414elllseries)},
    {__Pyx_NAMESTR("ellminimalmodel"), (PyCFunction)__pyx_pw_7example_3gen_417ellminimalmodel, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_416ellminimalmodel)},
    {__Pyx_NAMESTR("ellorder"), (PyCFunction)__pyx_pw_7example_3gen_419ellorder, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_418ellorder)},
    {__Pyx_NAMESTR("ellordinate"), (PyCFunction)__pyx_pw_7example_3gen_421ellordinate, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_420ellordinate)},
    {__Pyx_NAMESTR("ellpointtoz"), (PyCFunction)__pyx_pw_7example_3gen_423ellpointtoz, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_422ellpointtoz)},
    {__Pyx_NAMESTR("ellpow"), (PyCFunction)__pyx_pw_7example_3gen_425ellpow, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_424ellpow)},
    {__Pyx_NAMESTR("ellrootno"), (PyCFunction)__pyx_pw_7example_3gen_427ellrootno, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_426ellrootno)},
    {__Pyx_NAMESTR("ellsigma"), (PyCFunction)__pyx_pw_7example_3gen_429ellsigma, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_428ellsigma)},
    {__Pyx_NAMESTR("ellsub"), (PyCFunction)__pyx_pw_7example_3gen_431ellsub, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_430ellsub)},
    {__Pyx_NAMESTR("elltaniyama"), (PyCFunction)__pyx_pw_7example_3gen_433elltaniyama, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("elltors"), (PyCFunction)__pyx_pw_7example_3gen_435elltors, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_434elltors)},
    {__Pyx_NAMESTR("ellzeta"), (PyCFunction)__pyx_pw_7example_3gen_437ellzeta, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_436ellzeta)},
    {__Pyx_NAMESTR("ellztopoint"), (PyCFunction)__pyx_pw_7example_3gen_439ellztopoint, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_438ellztopoint)},
    {__Pyx_NAMESTR("omega"), (PyCFunction)__pyx_pw_7example_3gen_441omega, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_440omega)},
    {__Pyx_NAMESTR("disc"), (PyCFunction)__pyx_pw_7example_3gen_443disc, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_442disc)},
    {__Pyx_NAMESTR("j"), (PyCFunction)__pyx_pw_7example_3gen_445j, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_444j)},
    {__Pyx_NAMESTR("ellj"), (PyCFunction)__pyx_pw_7example_3gen_447ellj, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfcertify"), (PyCFunction)__pyx_pw_7example_3gen_449bnfcertify, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_448bnfcertify)},
    {__Pyx_NAMESTR("bnfinit"), (PyCFunction)__pyx_pw_7example_3gen_451bnfinit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfisintnorm"), (PyCFunction)__pyx_pw_7example_3gen_453bnfisintnorm, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfisnorm"), (PyCFunction)__pyx_pw_7example_3gen_455bnfisnorm, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfisprincipal"), (PyCFunction)__pyx_pw_7example_3gen_457bnfisprincipal, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfnarrow"), (PyCFunction)__pyx_pw_7example_3gen_459bnfnarrow, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfsunit"), (PyCFunction)__pyx_pw_7example_3gen_461bnfsunit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfunit"), (PyCFunction)__pyx_pw_7example_3gen_463bnfunit, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("bnfisunit"), (PyCFunction)__pyx_pw_7example_3gen_465bnfisunit, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("dirzetak"), (PyCFunction)__pyx_pw_7example_3gen_467dirzetak, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("galoisapply"), (PyCFunction)__pyx_pw_7example_3gen_469galoisapply, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("galoisinit"), (PyCFunction)__pyx_pw_7example_3gen_471galoisinit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_470galoisinit)},
    {__Pyx_NAMESTR("galoispermtopol"), (PyCFunction)__pyx_pw_7example_3gen_473galoispermtopol, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("galoisfixedfield"), (PyCFunction)__pyx_pw_7example_3gen_475galoisfixedfield, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealred"), (PyCFunction)__pyx_pw_7example_3gen_477idealred, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealadd"), (PyCFunction)__pyx_pw_7example_3gen_479idealadd, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealaddtoone"), (PyCFunction)__pyx_pw_7example_3gen_481idealaddtoone, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealappr"), (PyCFunction)__pyx_pw_7example_3gen_483idealappr, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealcoprime"), (PyCFunction)__pyx_pw_7example_3gen_485idealcoprime, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_484idealcoprime)},
    {__Pyx_NAMESTR("idealdiv"), (PyCFunction)__pyx_pw_7example_3gen_487idealdiv, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealfactor"), (PyCFunction)__pyx_pw_7example_3gen_489idealfactor, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealhnf"), (PyCFunction)__pyx_pw_7example_3gen_491idealhnf, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealintersection"), (PyCFunction)__pyx_pw_7example_3gen_493idealintersection, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("ideallist"), (PyCFunction)__pyx_pw_7example_3gen_495ideallist, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_494ideallist)},
    {__Pyx_NAMESTR("ideallog"), (PyCFunction)__pyx_pw_7example_3gen_497ideallog, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_496ideallog)},
    {__Pyx_NAMESTR("idealmul"), (PyCFunction)__pyx_pw_7example_3gen_499idealmul, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealnorm"), (PyCFunction)__pyx_pw_7example_3gen_501idealnorm, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealprimedec"), (PyCFunction)__pyx_pw_7example_3gen_503idealprimedec, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_502idealprimedec)},
    {__Pyx_NAMESTR("idealstar"), (PyCFunction)__pyx_pw_7example_3gen_505idealstar, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_504idealstar)},
    {__Pyx_NAMESTR("idealtwoelt"), (PyCFunction)__pyx_pw_7example_3gen_507idealtwoelt, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("idealval"), (PyCFunction)__pyx_pw_7example_3gen_509idealval, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("elementval"), (PyCFunction)__pyx_pw_7example_3gen_511elementval, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("modreverse"), (PyCFunction)__pyx_pw_7example_3gen_513modreverse, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_512modreverse)},
    {__Pyx_NAMESTR("nfbasis"), (PyCFunction)__pyx_pw_7example_3gen_515nfbasis, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_514nfbasis)},
    {__Pyx_NAMESTR("nfbasis_d"), (PyCFunction)__pyx_pw_7example_3gen_517nfbasis_d, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_516nfbasis_d)},
    {__Pyx_NAMESTR("nfbasistoalg"), (PyCFunction)__pyx_pw_7example_3gen_519nfbasistoalg, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_518nfbasistoalg)},
    {__Pyx_NAMESTR("nfbasistoalg_lift"), (PyCFunction)__pyx_pw_7example_3gen_521nfbasistoalg_lift, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_520nfbasistoalg_lift)},
    {__Pyx_NAMESTR("nfdisc"), (PyCFunction)__pyx_pw_7example_3gen_523nfdisc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_522nfdisc)},
    {__Pyx_NAMESTR("nfeltreduce"), (PyCFunction)__pyx_pw_7example_3gen_525nfeltreduce, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_524nfeltreduce)},
    {__Pyx_NAMESTR("nffactor"), (PyCFunction)__pyx_pw_7example_3gen_527nffactor, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("nfgenerator"), (PyCFunction)__pyx_pw_7example_3gen_529nfgenerator, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("nfhilbert"), (PyCFunction)__pyx_pw_7example_3gen_531nfhilbert, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_530nfhilbert)},
    {__Pyx_NAMESTR("nfhnf"), (PyCFunction)__pyx_pw_7example_3gen_533nfhnf, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_532nfhnf)},
    {__Pyx_NAMESTR("nfinit"), (PyCFunction)__pyx_pw_7example_3gen_535nfinit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_534nfinit)},
    {__Pyx_NAMESTR("_nfinit_with_prec"), (PyCFunction)__pyx_pw_7example_3gen_537_nfinit_with_prec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_536_nfinit_with_prec)},
    {__Pyx_NAMESTR("nfisisom"), (PyCFunction)__pyx_pw_7example_3gen_539nfisisom, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_538nfisisom)},
    {__Pyx_NAMESTR("nfrootsof1"), (PyCFunction)__pyx_pw_7example_3gen_541nfrootsof1, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_540nfrootsof1)},
    {__Pyx_NAMESTR("nfsubfields"), (PyCFunction)__pyx_pw_7example_3gen_543nfsubfields, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_542nfsubfields)},
    {__Pyx_NAMESTR("rnfcharpoly"), (PyCFunction)__pyx_pw_7example_3gen_545rnfcharpoly, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfdisc"), (PyCFunction)__pyx_pw_7example_3gen_547rnfdisc, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfeltabstorel"), (PyCFunction)__pyx_pw_7example_3gen_549rnfeltabstorel, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfeltreltoabs"), (PyCFunction)__pyx_pw_7example_3gen_551rnfeltreltoabs, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfequation"), (PyCFunction)__pyx_pw_7example_3gen_553rnfequation, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfidealabstorel"), (PyCFunction)__pyx_pw_7example_3gen_555rnfidealabstorel, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfidealdown"), (PyCFunction)__pyx_pw_7example_3gen_557rnfidealdown, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_556rnfidealdown)},
    {__Pyx_NAMESTR("rnfidealhnf"), (PyCFunction)__pyx_pw_7example_3gen_559rnfidealhnf, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfidealnormrel"), (PyCFunction)__pyx_pw_7example_3gen_561rnfidealnormrel, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfidealreltoabs"), (PyCFunction)__pyx_pw_7example_3gen_563rnfidealreltoabs, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfidealtwoelt"), (PyCFunction)__pyx_pw_7example_3gen_565rnfidealtwoelt, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfinit"), (PyCFunction)__pyx_pw_7example_3gen_567rnfinit, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_566rnfinit)},
    {__Pyx_NAMESTR("rnfisfree"), (PyCFunction)__pyx_pw_7example_3gen_569rnfisfree, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("quadhilbert"), (PyCFunction)__pyx_pw_7example_3gen_571quadhilbert, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_570quadhilbert)},
    {__Pyx_NAMESTR("reverse"), (PyCFunction)__pyx_pw_7example_3gen_573reverse, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_572reverse)},
    {__Pyx_NAMESTR("content"), (PyCFunction)__pyx_pw_7example_3gen_575content, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_574content)},
    {__Pyx_NAMESTR("deriv"), (PyCFunction)__pyx_pw_7example_3gen_577deriv, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("eval"), (PyCFunction)__pyx_pw_7example_3gen_579eval, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("factornf"), (PyCFunction)__pyx_pw_7example_3gen_583factornf, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_582factornf)},
    {__Pyx_NAMESTR("factorpadic"), (PyCFunction)__pyx_pw_7example_3gen_585factorpadic, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_584factorpadic)},
    {__Pyx_NAMESTR("factormod"), (PyCFunction)__pyx_pw_7example_3gen_587factormod, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_586factormod)},
    {__Pyx_NAMESTR("intformal"), (PyCFunction)__pyx_pw_7example_3gen_589intformal, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_588intformal)},
    {__Pyx_NAMESTR("padicappr"), (PyCFunction)__pyx_pw_7example_3gen_591padicappr, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_590padicappr)},
    {__Pyx_NAMESTR("newtonpoly"), (PyCFunction)__pyx_pw_7example_3gen_593newtonpoly, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_592newtonpoly)},
    {__Pyx_NAMESTR("polcoeff"), (PyCFunction)__pyx_pw_7example_3gen_595polcoeff, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_594polcoeff)},
    {__Pyx_NAMESTR("polcompositum"), (PyCFunction)__pyx_pw_7example_3gen_597polcompositum, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("poldegree"), (PyCFunction)__pyx_pw_7example_3gen_599poldegree, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_598poldegree)},
    {__Pyx_NAMESTR("poldisc"), (PyCFunction)__pyx_pw_7example_3gen_601poldisc, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_600poldisc)},
    {__Pyx_NAMESTR("poldiscreduced"), (PyCFunction)__pyx_pw_7example_3gen_603poldiscreduced, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polgalois"), (PyCFunction)__pyx_pw_7example_3gen_605polgalois, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_604polgalois)},
    {__Pyx_NAMESTR("nfgaloisconj"), (PyCFunction)__pyx_pw_7example_3gen_607nfgaloisconj, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_606nfgaloisconj)},
    {__Pyx_NAMESTR("nfroots"), (PyCFunction)__pyx_pw_7example_3gen_609nfroots, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_608nfroots)},
    {__Pyx_NAMESTR("polhensellift"), (PyCFunction)__pyx_pw_7example_3gen_611polhensellift, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_610polhensellift)},
    {__Pyx_NAMESTR("polisirreducible"), (PyCFunction)__pyx_pw_7example_3gen_613polisirreducible, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_612polisirreducible)},
    {__Pyx_NAMESTR("pollead"), (PyCFunction)__pyx_pw_7example_3gen_615pollead, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_614pollead)},
    {__Pyx_NAMESTR("polrecip"), (PyCFunction)__pyx_pw_7example_3gen_617polrecip, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polred"), (PyCFunction)__pyx_pw_7example_3gen_619polred, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polredabs"), (PyCFunction)__pyx_pw_7example_3gen_621polredabs, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polresultant"), (PyCFunction)__pyx_pw_7example_3gen_623polresultant, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polroots"), (PyCFunction)__pyx_pw_7example_3gen_625polroots, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_624polroots)},
    {__Pyx_NAMESTR("polrootsmod"), (PyCFunction)__pyx_pw_7example_3gen_627polrootsmod, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polrootspadic"), (PyCFunction)__pyx_pw_7example_3gen_629polrootspadic, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polrootspadicfast"), (PyCFunction)__pyx_pw_7example_3gen_631polrootspadicfast, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polsturm"), (PyCFunction)__pyx_pw_7example_3gen_633polsturm, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polsturm_full"), (PyCFunction)__pyx_pw_7example_3gen_635polsturm_full, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polsylvestermatrix"), (PyCFunction)__pyx_pw_7example_3gen_637polsylvestermatrix, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("polsym"), (PyCFunction)__pyx_pw_7example_3gen_639polsym, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("serconvol"), (PyCFunction)__pyx_pw_7example_3gen_641serconvol, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("serlaplace"), (PyCFunction)__pyx_pw_7example_3gen_643serlaplace, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("serreverse"), (PyCFunction)__pyx_pw_7example_3gen_645serreverse, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_644serreverse)},
    {__Pyx_NAMESTR("thueinit"), (PyCFunction)__pyx_pw_7example_3gen_647thueinit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfisnorminit"), (PyCFunction)__pyx_pw_7example_3gen_649rnfisnorminit, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("rnfisnorm"), (PyCFunction)__pyx_pw_7example_3gen_651rnfisnorm, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("vecextract"), (PyCFunction)__pyx_pw_7example_3gen_653vecextract, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_652vecextract)},
    {__Pyx_NAMESTR("ncols"), (PyCFunction)__pyx_pw_7example_3gen_655ncols, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_654ncols)},
    {__Pyx_NAMESTR("nrows"), (PyCFunction)__pyx_pw_7example_3gen_657nrows, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_656nrows)},
    {__Pyx_NAMESTR("mattranspose"), (PyCFunction)__pyx_pw_7example_3gen_659mattranspose, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_658mattranspose)},
    {__Pyx_NAMESTR("matadjoint"), (PyCFunction)__pyx_pw_7example_3gen_661matadjoint, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_660matadjoint)},
    {__Pyx_NAMESTR("qflll"), (PyCFunction)__pyx_pw_7example_3gen_663qflll, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_662qflll)},
    {__Pyx_NAMESTR("qflllgram"), (PyCFunction)__pyx_pw_7example_3gen_665qflllgram, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_664qflllgram)},
    {__Pyx_NAMESTR("lllgram"), (PyCFunction)__pyx_pw_7example_3gen_667lllgram, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("lllgramint"), (PyCFunction)__pyx_pw_7example_3gen_669lllgramint, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("qfminim"), (PyCFunction)__pyx_pw_7example_3gen_671qfminim, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_670qfminim)},
    {__Pyx_NAMESTR("qfrep"), (PyCFunction)__pyx_pw_7example_3gen_673qfrep, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_672qfrep)},
    {__Pyx_NAMESTR("matsolve"), (PyCFunction)__pyx_pw_7example_3gen_675matsolve, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_674matsolve)},
    {__Pyx_NAMESTR("matker"), (PyCFunction)__pyx_pw_7example_3gen_677matker, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_676matker)},
    {__Pyx_NAMESTR("matkerint"), (PyCFunction)__pyx_pw_7example_3gen_679matkerint, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_678matkerint)},
    {__Pyx_NAMESTR("matdet"), (PyCFunction)__pyx_pw_7example_3gen_681matdet, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_680matdet)},
    {__Pyx_NAMESTR("trace"), (PyCFunction)__pyx_pw_7example_3gen_683trace, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_682trace)},
    {__Pyx_NAMESTR("mathnf"), (PyCFunction)__pyx_pw_7example_3gen_685mathnf, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_684mathnf)},
    {__Pyx_NAMESTR("mathnfmod"), (PyCFunction)__pyx_pw_7example_3gen_687mathnfmod, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_686mathnfmod)},
    {__Pyx_NAMESTR("mathnfmodid"), (PyCFunction)__pyx_pw_7example_3gen_689mathnfmodid, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_688mathnfmodid)},
    {__Pyx_NAMESTR("matsnf"), (PyCFunction)__pyx_pw_7example_3gen_691matsnf, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_690matsnf)},
    {__Pyx_NAMESTR("matfrobenius"), (PyCFunction)__pyx_pw_7example_3gen_693matfrobenius, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_692matfrobenius)},
    {__Pyx_NAMESTR("factor"), (PyCFunction)__pyx_pw_7example_3gen_695factor, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_694factor)},
    {__Pyx_NAMESTR("hilbert"), (PyCFunction)__pyx_pw_7example_3gen_697hilbert, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("chinese"), (PyCFunction)__pyx_pw_7example_3gen_699chinese, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("order"), (PyCFunction)__pyx_pw_7example_3gen_701order, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("znprimroot"), (PyCFunction)__pyx_pw_7example_3gen_703znprimroot, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_702znprimroot)},
    {__Pyx_NAMESTR("norm"), (PyCFunction)__pyx_pw_7example_3gen_707norm, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("nextprime"), (PyCFunction)__pyx_pw_7example_3gen_709nextprime, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_708nextprime)},
    {__Pyx_NAMESTR("change_variable_name"), (PyCFunction)__pyx_pw_7example_3gen_711change_variable_name, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_710change_variable_name)},
    {__Pyx_NAMESTR("subst"), (PyCFunction)__pyx_pw_7example_3gen_713subst, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_712subst)},
    {__Pyx_NAMESTR("substpol"), (PyCFunction)__pyx_pw_7example_3gen_715substpol, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("nf_subst"), (PyCFunction)__pyx_pw_7example_3gen_717nf_subst, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_716nf_subst)},
    {__Pyx_NAMESTR("taylor"), (PyCFunction)__pyx_pw_7example_3gen_719taylor, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("thue"), (PyCFunction)__pyx_pw_7example_3gen_721thue, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("charpoly"), (PyCFunction)__pyx_pw_7example_3gen_723charpoly, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_722charpoly)},
    {__Pyx_NAMESTR("kronecker"), (PyCFunction)__pyx_pw_7example_3gen_725kronecker, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("type"), (PyCFunction)__pyx_pw_7example_3gen_727type, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_726type)},
    {__Pyx_NAMESTR("polinterpolate"), (PyCFunction)__pyx_pw_7example_3gen_729polinterpolate, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_728polinterpolate)},
    {__Pyx_NAMESTR("algdep"), (PyCFunction)__pyx_pw_7example_3gen_731algdep, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_730algdep)},
    {__Pyx_NAMESTR("concat"), (PyCFunction)__pyx_pw_7example_3gen_733concat, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("lindep"), (PyCFunction)__pyx_pw_7example_3gen_735lindep, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("listinsert"), (PyCFunction)__pyx_pw_7example_3gen_737listinsert, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("listput"), (PyCFunction)__pyx_pw_7example_3gen_739listput, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("elleisnum"), (PyCFunction)__pyx_pw_7example_3gen_741elleisnum, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_740elleisnum)},
    {__Pyx_NAMESTR("ellwp"), (PyCFunction)__pyx_pw_7example_3gen_743ellwp, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_742ellwp)},
    {__Pyx_NAMESTR("ellchangepoint"), (PyCFunction)__pyx_pw_7example_3gen_745ellchangepoint, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_3gen_744ellchangepoint)},
    {__Pyx_NAMESTR("debug"), (PyCFunction)__pyx_pw_7example_3gen_747debug, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_3gen_746debug)},
    {0, 0, 0, 0}
  };

  static PyNumberMethods __pyx_tp_as_number_gen = {
    __pyx_pw_7example_3gen_17__add__, /*nb_add*/
    __pyx_pw_7example_3gen_21__sub__, /*nb_subtract*/
    __pyx_pw_7example_3gen_25__mul__, /*nb_multiply*/
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_7example_3gen_29__div__, /*nb_divide*/
    #endif
    __pyx_pw_7example_3gen_35__mod__, /*nb_remainder*/
    0, /*nb_divmod*/
    __pyx_pw_7example_3gen_37__pow__, /*nb_power*/
    __pyx_pw_7example_3gen_39__neg__, /*nb_negative*/
    0, /*nb_positive*/
    __pyx_pw_7example_3gen_705__abs__, /*nb_absolute*/
    __pyx_pw_7example_3gen_113__nonzero__, /*nb_nonzero*/
    __pyx_pw_7example_3gen_47__invert__, /*nb_invert*/
    __pyx_pw_7example_3gen_45__lshift__, /*nb_lshift*/
    __pyx_pw_7example_3gen_43__rshift__, /*nb_rshift*/
    0, /*nb_and*/
    __pyx_pw_7example_3gen_41__xor__, /*nb_xor*/
    0, /*nb_or*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_coerce*/
    #endif
    __pyx_pw_7example_3gen_97__int__, /*nb_int*/
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_7example_3gen_107__long__, /*nb_long*/
    #else
    0, /*reserved*/
    #endif
    __pyx_pw_7example_3gen_109__float__, /*nb_float*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_oct*/
    #endif
    #if PY_MAJOR_VERSION < 3
    __pyx_pw_7example_3gen_95__hex__, /*nb_hex*/
    #endif
    0, /*nb_inplace_add*/
    0, /*nb_inplace_subtract*/
    0, /*nb_inplace_multiply*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_inplace_divide*/
    #endif
    0, /*nb_inplace_remainder*/
    0, /*nb_inplace_power*/
    0, /*nb_inplace_lshift*/
    0, /*nb_inplace_rshift*/
    0, /*nb_inplace_and*/
    0, /*nb_inplace_xor*/
    0, /*nb_inplace_or*/
    0, /*nb_floor_divide*/
    0, /*nb_true_divide*/
    0, /*nb_inplace_floor_divide*/
    0, /*nb_inplace_true_divide*/
    #if PY_VERSION_HEX >= 0x02050000
    0, /*nb_index*/
    #endif
  };

  static PySequenceMethods __pyx_tp_as_sequence_gen = {
    __pyx_pw_7example_3gen_87__len__, /*sq_length*/
    0, /*sq_concat*/
    0, /*sq_repeat*/
    __pyx_sq_item_7example_gen, /*sq_item*/
    0, /*sq_slice*/
    0, /*sq_ass_item*/
    0, /*sq_ass_slice*/
    0, /*sq_contains*/
    0, /*sq_inplace_concat*/
    0, /*sq_inplace_repeat*/
  };

  static PyMappingMethods __pyx_tp_as_mapping_gen = {
    __pyx_pw_7example_3gen_87__len__, /*mp_length*/
    __pyx_pw_7example_3gen_81__getitem__, /*mp_subscript*/
    __pyx_mp_ass_subscript_7example_gen, /*mp_ass_subscript*/
  };

  static PyBufferProcs __pyx_tp_as_buffer_gen = {
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getreadbuffer*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getwritebuffer*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getsegcount*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getcharbuffer*/
    #endif
    #if PY_VERSION_HEX >= 0x02060000
    0, /*bf_getbuffer*/
    #endif
    #if PY_VERSION_HEX >= 0x02060000
    0, /*bf_releasebuffer*/
    #endif
  };

  static PyTypeObject __pyx_type_7example_gen = {
    PyVarObject_HEAD_INIT(0, 0)
    __Pyx_NAMESTR("example.gen"), /*tp_name*/
    sizeof(struct __pyx_obj_7example_gen), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_7example_gen, /*tp_dealloc*/
    0, /*tp_print*/
    0, /*tp_getattr*/
    0, /*tp_setattr*/
    #if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
    #else
    0, /*reserved*/
    #endif
    __pyx_pw_7example_3gen_7__repr__, /*tp_repr*/
    &__pyx_tp_as_number_gen, /*tp_as_number*/
    &__pyx_tp_as_sequence_gen, /*tp_as_sequence*/
    &__pyx_tp_as_mapping_gen, /*tp_as_mapping*/
    __pyx_pw_7example_3gen_9__hash__, /*tp_hash*/
    __pyx_pw_7example_3gen_581__call__, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    &__pyx_tp_as_buffer_gen, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    __Pyx_DOCSTR("\n    Python extension class that models the PARI GEN type.\n    "), /*tp_doc*/
    __pyx_tp_traverse_7example_gen, /*tp_traverse*/
    __pyx_tp_clear_7example_gen, /*tp_clear*/
    __pyx_pw_7example_3gen_89__richcmp__, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    __pyx_methods_7example_gen, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    __pyx_pw_7example_3gen_1__init__, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_7example_gen, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    #if PY_VERSION_HEX >= 0x02060000
    0, /*tp_version_tag*/
    #endif
  };
  static struct __pyx_vtabstruct_7example_PariInstance __pyx_vtable_7example_PariInstance;

  static PyObject *__pyx_tp_new_7example_PariInstance(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
    struct __pyx_obj_7example_PariInstance *p;
    PyObject *o = (*t->tp_alloc)(t, 0);
    if (!o) return 0;
    p = ((struct __pyx_obj_7example_PariInstance *)o);
    p->__pyx_vtab = __pyx_vtabptr_7example_PariInstance;
    p->PARI_ZERO = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    p->PARI_ONE = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    p->PARI_TWO = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    return o;
  }

  static void __pyx_tp_dealloc_7example_PariInstance(PyObject *o) {
    struct __pyx_obj_7example_PariInstance *p = (struct __pyx_obj_7example_PariInstance *)o;
    PyObject_GC_UnTrack(o);
    {
      PyObject *etype, *eval, *etb;
      PyErr_Fetch(&etype, &eval, &etb);
      ++Py_REFCNT(o);
      __pyx_pw_7example_12PariInstance_3__dealloc__(o);
      if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
      --Py_REFCNT(o);
      PyErr_Restore(etype, eval, etb);
    }
    Py_CLEAR(p->PARI_ZERO);
    Py_CLEAR(p->PARI_ONE);
    Py_CLEAR(p->PARI_TWO);
    PyObject_GC_Track(o);
    (*Py_TYPE(o)->tp_free)(o);
  }

  static int __pyx_tp_traverse_7example_PariInstance(PyObject *o, visitproc v, void *a) {
    int e;
    struct __pyx_obj_7example_PariInstance *p = (struct __pyx_obj_7example_PariInstance *)o;
    if (p->PARI_ZERO) {
      e = (*v)(((PyObject*)p->PARI_ZERO), a); if (e) return e;
    }
    if (p->PARI_ONE) {
      e = (*v)(((PyObject*)p->PARI_ONE), a); if (e) return e;
    }
    if (p->PARI_TWO) {
      e = (*v)(((PyObject*)p->PARI_TWO), a); if (e) return e;
    }
    return 0;
  }

  static int __pyx_tp_clear_7example_PariInstance(PyObject *o) {
    struct __pyx_obj_7example_PariInstance *p = (struct __pyx_obj_7example_PariInstance *)o;
    PyObject* tmp;
    tmp = ((PyObject*)p->PARI_ZERO);
    p->PARI_ZERO = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    Py_XDECREF(tmp);
    tmp = ((PyObject*)p->PARI_ONE);
    p->PARI_ONE = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    Py_XDECREF(tmp);
    tmp = ((PyObject*)p->PARI_TWO);
    p->PARI_TWO = ((struct __pyx_obj_7example_gen *)Py_None); Py_INCREF(Py_None);
    Py_XDECREF(tmp);
    return 0;
  }

  static PyMethodDef __pyx_methods_7example_PariInstance[] = {
    {__Pyx_NAMESTR("default"), (PyCFunction)__pyx_pw_7example_12PariInstance_11default, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("set_debug_level"), (PyCFunction)__pyx_pw_7example_12PariInstance_13set_debug_level, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_12set_debug_level)},
    {__Pyx_NAMESTR("get_debug_level"), (PyCFunction)__pyx_pw_7example_12PariInstance_15get_debug_level, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_14get_debug_level)},
    {__Pyx_NAMESTR("set_real_precision"), (PyCFunction)__pyx_pw_7example_12PariInstance_17set_real_precision, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_16set_real_precision)},
    {__Pyx_NAMESTR("get_real_precision"), (PyCFunction)__pyx_pw_7example_12PariInstance_19get_real_precision, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_18get_real_precision)},
    {__Pyx_NAMESTR("set_series_precision"), (PyCFunction)__pyx_pw_7example_12PariInstance_21set_series_precision, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("get_series_precision"), (PyCFunction)__pyx_pw_7example_12PariInstance_23get_series_precision, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("double_to_gen"), (PyCFunction)__pyx_pw_7example_12PariInstance_25double_to_gen, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("complex"), (PyCFunction)__pyx_pw_7example_12PariInstance_27complex, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_26complex)},
    {__Pyx_NAMESTR("new_with_bits_prec"), (PyCFunction)__pyx_pw_7example_12PariInstance_31new_with_bits_prec, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_30new_with_bits_prec)},
    {__Pyx_NAMESTR("allocatemem"), (PyCFunction)__pyx_pw_7example_12PariInstance_33allocatemem, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_32allocatemem)},
    {__Pyx_NAMESTR("pari_version"), (PyCFunction)__pyx_pw_7example_12PariInstance_35pari_version, METH_NOARGS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("init_primes"), (PyCFunction)__pyx_pw_7example_12PariInstance_37init_primes, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_36init_primes)},
    {__Pyx_NAMESTR("read"), (PyCFunction)__pyx_pw_7example_12PariInstance_39read, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_38read)},
    {__Pyx_NAMESTR("_primelimit"), (PyCFunction)__pyx_pw_7example_12PariInstance_41_primelimit, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_40_primelimit)},
    {__Pyx_NAMESTR("prime_list"), (PyCFunction)__pyx_pw_7example_12PariInstance_43prime_list, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_42prime_list)},
    {__Pyx_NAMESTR("primes_up_to_n"), (PyCFunction)__pyx_pw_7example_12PariInstance_45primes_up_to_n, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_44primes_up_to_n)},
    {__Pyx_NAMESTR("__nth_prime"), (PyCFunction)__pyx_pw_7example_12PariInstance_47__nth_prime, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_46__nth_prime)},
    {__Pyx_NAMESTR("nth_prime"), (PyCFunction)__pyx_pw_7example_12PariInstance_49nth_prime, METH_O, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("euler"), (PyCFunction)__pyx_pw_7example_12PariInstance_51euler, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_50euler)},
    {__Pyx_NAMESTR("pi"), (PyCFunction)__pyx_pw_7example_12PariInstance_53pi, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_52pi)},
    {__Pyx_NAMESTR("pollegendre"), (PyCFunction)__pyx_pw_7example_12PariInstance_55pollegendre, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_54pollegendre)},
    {__Pyx_NAMESTR("TestBesselk"), (PyCFunction)__pyx_pw_7example_12PariInstance_57TestBesselk, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("get_stack_info"), (PyCFunction)__pyx_pw_7example_12PariInstance_59get_stack_info, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_58get_stack_info)},
    {__Pyx_NAMESTR("poltchebi"), (PyCFunction)__pyx_pw_7example_12PariInstance_61poltchebi, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_60poltchebi)},
    {__Pyx_NAMESTR("factorial"), (PyCFunction)__pyx_pw_7example_12PariInstance_63factorial, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_62factorial)},
    {__Pyx_NAMESTR("polcyclo"), (PyCFunction)__pyx_pw_7example_12PariInstance_65polcyclo, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_64polcyclo)},
    {__Pyx_NAMESTR("polcyclo_eval"), (PyCFunction)__pyx_pw_7example_12PariInstance_67polcyclo_eval, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_66polcyclo_eval)},
    {__Pyx_NAMESTR("polsubcyclo"), (PyCFunction)__pyx_pw_7example_12PariInstance_69polsubcyclo, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_68polsubcyclo)},
    {__Pyx_NAMESTR("polzagier"), (PyCFunction)__pyx_pw_7example_12PariInstance_71polzagier, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
    {__Pyx_NAMESTR("setrand"), (PyCFunction)__pyx_pw_7example_12PariInstance_73setrand, METH_O, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_72setrand)},
    {__Pyx_NAMESTR("getrand"), (PyCFunction)__pyx_pw_7example_12PariInstance_75getrand, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_74getrand)},
    {__Pyx_NAMESTR("vector"), (PyCFunction)__pyx_pw_7example_12PariInstance_77vector, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_76vector)},
    {__Pyx_NAMESTR("matrix"), (PyCFunction)__pyx_pw_7example_12PariInstance_79matrix, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_7example_12PariInstance_78matrix)},
    {0, 0, 0, 0}
  };

  static PyNumberMethods __pyx_tp_as_number_PariInstance = {
    0, /*nb_add*/
    0, /*nb_subtract*/
    0, /*nb_multiply*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_divide*/
    #endif
    0, /*nb_remainder*/
    0, /*nb_divmod*/
    0, /*nb_power*/
    0, /*nb_negative*/
    0, /*nb_positive*/
    0, /*nb_absolute*/
    0, /*nb_nonzero*/
    0, /*nb_invert*/
    0, /*nb_lshift*/
    0, /*nb_rshift*/
    0, /*nb_and*/
    0, /*nb_xor*/
    0, /*nb_or*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_coerce*/
    #endif
    0, /*nb_int*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_long*/
    #else
    0, /*reserved*/
    #endif
    0, /*nb_float*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_oct*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*nb_hex*/
    #endif
    0, /*nb_inplace_add*/
    0, /*nb_inplace_subtract*/
    0, /*nb_inplace_multiply*/
    #if PY_MAJOR_VERSION < 3
    0, /*nb_inplace_divide*/
    #endif
    0, /*nb_inplace_remainder*/
    0, /*nb_inplace_power*/
    0, /*nb_inplace_lshift*/
    0, /*nb_inplace_rshift*/
    0, /*nb_inplace_and*/
    0, /*nb_inplace_xor*/
    0, /*nb_inplace_or*/
    0, /*nb_floor_divide*/
    0, /*nb_true_divide*/
    0, /*nb_inplace_floor_divide*/
    0, /*nb_inplace_true_divide*/
    #if PY_VERSION_HEX >= 0x02050000
    0, /*nb_index*/
    #endif
  };

  static PySequenceMethods __pyx_tp_as_sequence_PariInstance = {
    0, /*sq_length*/
    0, /*sq_concat*/
    0, /*sq_repeat*/
    0, /*sq_item*/
    0, /*sq_slice*/
    0, /*sq_ass_item*/
    0, /*sq_ass_slice*/
    0, /*sq_contains*/
    0, /*sq_inplace_concat*/
    0, /*sq_inplace_repeat*/
  };

  static PyMappingMethods __pyx_tp_as_mapping_PariInstance = {
    0, /*mp_length*/
    0, /*mp_subscript*/
    0, /*mp_ass_subscript*/
  };

  static PyBufferProcs __pyx_tp_as_buffer_PariInstance = {
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getreadbuffer*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getwritebuffer*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getsegcount*/
    #endif
    #if PY_MAJOR_VERSION < 3
    0, /*bf_getcharbuffer*/
    #endif
    #if PY_VERSION_HEX >= 0x02060000
    0, /*bf_getbuffer*/
    #endif
    #if PY_VERSION_HEX >= 0x02060000
    0, /*bf_releasebuffer*/
    #endif
  };

  static PyTypeObject __pyx_type_7example_PariInstance = {
    PyVarObject_HEAD_INIT(0, 0)
    __Pyx_NAMESTR("example.PariInstance"), /*tp_name*/
    sizeof(struct __pyx_obj_7example_PariInstance), /*tp_basicsize*/
    0, /*tp_itemsize*/
    __pyx_tp_dealloc_7example_PariInstance, /*tp_dealloc*/
    0, /*tp_print*/
    0, /*tp_getattr*/
    0, /*tp_setattr*/
    #if PY_MAJOR_VERSION < 3
    0, /*tp_compare*/
    #else
    0, /*reserved*/
    #endif
    __pyx_pw_7example_12PariInstance_5__repr__, /*tp_repr*/
    &__pyx_tp_as_number_PariInstance, /*tp_as_number*/
    &__pyx_tp_as_sequence_PariInstance, /*tp_as_sequence*/
    &__pyx_tp_as_mapping_PariInstance, /*tp_as_mapping*/
    __pyx_pw_7example_12PariInstance_7__hash__, /*tp_hash*/
    __pyx_pw_7example_12PariInstance_29__call__, /*tp_call*/
    0, /*tp_str*/
    0, /*tp_getattro*/
    0, /*tp_setattro*/
    &__pyx_tp_as_buffer_PariInstance, /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
    0, /*tp_doc*/
    __pyx_tp_traverse_7example_PariInstance, /*tp_traverse*/
    __pyx_tp_clear_7example_PariInstance, /*tp_clear*/
    __pyx_pw_7example_12PariInstance_9__richcmp__, /*tp_richcompare*/
    0, /*tp_weaklistoffset*/
    0, /*tp_iter*/
    0, /*tp_iternext*/
    __pyx_methods_7example_PariInstance, /*tp_methods*/
    0, /*tp_members*/
    0, /*tp_getset*/
    0, /*tp_base*/
    0, /*tp_dict*/
    0, /*tp_descr_get*/
    0, /*tp_descr_set*/
    0, /*tp_dictoffset*/
    __pyx_pw_7example_12PariInstance_1__init__, /*tp_init*/
    0, /*tp_alloc*/
    __pyx_tp_new_7example_PariInstance, /*tp_new*/
    0, /*tp_free*/
    0, /*tp_is_gc*/
    0, /*tp_bases*/
    0, /*tp_mro*/
    0, /*tp_cache*/
    0, /*tp_subclasses*/
    0, /*tp_weaklist*/
    0, /*tp_del*/
    #if PY_VERSION_HEX >= 0x02060000
    0, /*tp_version_tag*/
    #endif
  };

  static PyMethodDef __pyx_methods[] = {
    {0, 0, 0, 0}
  };

  #if PY_MAJOR_VERSION >= 3
  static struct PyModuleDef __pyx_moduledef = {
    #if PY_VERSION_HEX < 0x03020000
      { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
    #else
      PyModuleDef_HEAD_INIT,
    #endif
      __Pyx_NAMESTR("example"),
      0, /* m_doc */
      -1, /* m_size */
      __pyx_methods /* m_methods */,
      NULL, /* m_reload */
      NULL, /* m_traverse */
      NULL, /* m_clear */
      NULL /* m_free */
  };
  #endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_n_s_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 1, 1},
  {&__pyx_kp_s_10, __pyx_k_10, sizeof(__pyx_k_10), 0, 0, 1, 0},
  {&__pyx_n_s_101, __pyx_k_101, sizeof(__pyx_k_101), 0, 0, 1, 1},
  {&__pyx_n_s_104, __pyx_k_104, sizeof(__pyx_k_104), 0, 0, 1, 1},
  {&__pyx_n_s_107, __pyx_k_107, sizeof(__pyx_k_107), 0, 0, 1, 1},
  {&__pyx_kp_s_11, __pyx_k_11, sizeof(__pyx_k_11), 0, 0, 1, 0},
  {&__pyx_kp_s_12, __pyx_k_12, sizeof(__pyx_k_12), 0, 0, 1, 0},
  {&__pyx_kp_s_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 0, 1, 0},
  {&__pyx_kp_s_15, __pyx_k_15, sizeof(__pyx_k_15), 0, 0, 1, 0},
  {&__pyx_kp_s_16, __pyx_k_16, sizeof(__pyx_k_16), 0, 0, 1, 0},
  {&__pyx_kp_s_17, __pyx_k_17, sizeof(__pyx_k_17), 0, 0, 1, 0},
  {&__pyx_kp_s_18, __pyx_k_18, sizeof(__pyx_k_18), 0, 0, 1, 0},
  {&__pyx_kp_s_19, __pyx_k_19, sizeof(__pyx_k_19), 0, 0, 1, 0},
  {&__pyx_kp_s_2, __pyx_k_2, sizeof(__pyx_k_2), 0, 0, 1, 0},
  {&__pyx_kp_s_20, __pyx_k_20, sizeof(__pyx_k_20), 0, 0, 1, 0},
  {&__pyx_kp_s_21, __pyx_k_21, sizeof(__pyx_k_21), 0, 0, 1, 0},
  {&__pyx_kp_s_22, __pyx_k_22, sizeof(__pyx_k_22), 0, 0, 1, 0},
  {&__pyx_kp_s_23, __pyx_k_23, sizeof(__pyx_k_23), 0, 0, 1, 0},
  {&__pyx_kp_s_24, __pyx_k_24, sizeof(__pyx_k_24), 0, 0, 1, 0},
  {&__pyx_kp_s_25, __pyx_k_25, sizeof(__pyx_k_25), 0, 0, 1, 0},
  {&__pyx_kp_s_26, __pyx_k_26, sizeof(__pyx_k_26), 0, 0, 1, 0},
  {&__pyx_kp_s_27, __pyx_k_27, sizeof(__pyx_k_27), 0, 0, 1, 0},
  {&__pyx_kp_s_28, __pyx_k_28, sizeof(__pyx_k_28), 0, 0, 1, 0},
  {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
  {&__pyx_kp_s_30, __pyx_k_30, sizeof(__pyx_k_30), 0, 0, 1, 0},
  {&__pyx_kp_s_32, __pyx_k_32, sizeof(__pyx_k_32), 0, 0, 1, 0},
  {&__pyx_kp_s_34, __pyx_k_34, sizeof(__pyx_k_34), 0, 0, 1, 0},
  {&__pyx_kp_s_35, __pyx_k_35, sizeof(__pyx_k_35), 0, 0, 1, 0},
  {&__pyx_kp_s_36, __pyx_k_36, sizeof(__pyx_k_36), 0, 0, 1, 0},
  {&__pyx_kp_s_37, __pyx_k_37, sizeof(__pyx_k_37), 0, 0, 1, 0},
  {&__pyx_kp_s_38, __pyx_k_38, sizeof(__pyx_k_38), 0, 0, 1, 0},
  {&__pyx_kp_s_39, __pyx_k_39, sizeof(__pyx_k_39), 0, 0, 1, 0},
  {&__pyx_kp_s_4, __pyx_k_4, sizeof(__pyx_k_4), 0, 0, 1, 0},
  {&__pyx_kp_s_40, __pyx_k_40, sizeof(__pyx_k_40), 0, 0, 1, 0},
  {&__pyx_kp_s_41, __pyx_k_41, sizeof(__pyx_k_41), 0, 0, 1, 0},
  {&__pyx_kp_s_42, __pyx_k_42, sizeof(__pyx_k_42), 0, 0, 1, 0},
  {&__pyx_kp_s_44, __pyx_k_44, sizeof(__pyx_k_44), 0, 0, 1, 0},
  {&__pyx_kp_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 0},
  {&__pyx_kp_s_52, __pyx_k_52, sizeof(__pyx_k_52), 0, 0, 1, 0},
  {&__pyx_kp_s_53, __pyx_k_53, sizeof(__pyx_k_53), 0, 0, 1, 0},
  {&__pyx_kp_s_56, __pyx_k_56, sizeof(__pyx_k_56), 0, 0, 1, 0},
  {&__pyx_kp_s_57, __pyx_k_57, sizeof(__pyx_k_57), 0, 0, 1, 0},
  {&__pyx_kp_s_58, __pyx_k_58, sizeof(__pyx_k_58), 0, 0, 1, 0},
  {&__pyx_kp_s_62, __pyx_k_62, sizeof(__pyx_k_62), 0, 0, 1, 0},
  {&__pyx_kp_s_63, __pyx_k_63, sizeof(__pyx_k_63), 0, 0, 1, 0},
  {&__pyx_n_s_64, __pyx_k_64, sizeof(__pyx_k_64), 0, 0, 1, 1},
  {&__pyx_kp_s_65, __pyx_k_65, sizeof(__pyx_k_65), 0, 0, 1, 0},
  {&__pyx_kp_s_66, __pyx_k_66, sizeof(__pyx_k_66), 0, 0, 1, 0},
  {&__pyx_kp_s_67, __pyx_k_67, sizeof(__pyx_k_67), 0, 0, 1, 0},
  {&__pyx_kp_s_68, __pyx_k_68, sizeof(__pyx_k_68), 0, 0, 1, 0},
  {&__pyx_kp_s_69, __pyx_k_69, sizeof(__pyx_k_69), 0, 0, 1, 0},
  {&__pyx_kp_s_7, __pyx_k_7, sizeof(__pyx_k_7), 0, 0, 1, 0},
  {&__pyx_kp_s_70, __pyx_k_70, sizeof(__pyx_k_70), 0, 0, 1, 0},
  {&__pyx_kp_s_71, __pyx_k_71, sizeof(__pyx_k_71), 0, 0, 1, 0},
  {&__pyx_kp_s_72, __pyx_k_72, sizeof(__pyx_k_72), 0, 0, 1, 0},
  {&__pyx_kp_s_73, __pyx_k_73, sizeof(__pyx_k_73), 0, 0, 1, 0},
  {&__pyx_kp_s_74, __pyx_k_74, sizeof(__pyx_k_74), 0, 0, 1, 0},
  {&__pyx_kp_s_75, __pyx_k_75, sizeof(__pyx_k_75), 0, 0, 1, 0},
  {&__pyx_kp_s_76, __pyx_k_76, sizeof(__pyx_k_76), 0, 0, 1, 0},
  {&__pyx_kp_s_78, __pyx_k_78, sizeof(__pyx_k_78), 0, 0, 1, 0},
  {&__pyx_kp_s_79, __pyx_k_79, sizeof(__pyx_k_79), 0, 0, 1, 0},
  {&__pyx_kp_s_80, __pyx_k_80, sizeof(__pyx_k_80), 0, 0, 1, 0},
  {&__pyx_kp_s_83, __pyx_k_83, sizeof(__pyx_k_83), 0, 0, 1, 0},
  {&__pyx_kp_s_9, __pyx_k_9, sizeof(__pyx_k_9), 0, 0, 1, 0},
  {&__pyx_kp_s__0, __pyx_k__0, sizeof(__pyx_k__0), 0, 0, 1, 0},
  {&__pyx_n_s__A, __pyx_k__A, sizeof(__pyx_k__A), 0, 0, 1, 1},
  {&__pyx_n_s__AttributeError, __pyx_k__AttributeError, sizeof(__pyx_k__AttributeError), 0, 0, 1, 1},
  {&__pyx_n_s__B, __pyx_k__B, sizeof(__pyx_k__B), 0, 0, 1, 1},
  {&__pyx_n_s__D, __pyx_k__D, sizeof(__pyx_k__D), 0, 0, 1, 1},
  {&__pyx_n_s__GeneratorType, __pyx_k__GeneratorType, sizeof(__pyx_k__GeneratorType), 0, 0, 1, 1},
  {&__pyx_n_s__I, __pyx_k__I, sizeof(__pyx_k__I), 0, 0, 1, 1},
  {&__pyx_n_s__IndexError, __pyx_k__IndexError, sizeof(__pyx_k__IndexError), 0, 0, 1, 1},
  {&__pyx_n_s__ListType, __pyx_k__ListType, sizeof(__pyx_k__ListType), 0, 0, 1, 1},
  {&__pyx_n_s__Mat, __pyx_k__Mat, sizeof(__pyx_k__Mat), 0, 0, 1, 1},
  {&__pyx_n_s__MemoryError, __pyx_k__MemoryError, sizeof(__pyx_k__MemoryError), 0, 0, 1, 1},
  {&__pyx_n_s__Mod, __pyx_k__Mod, sizeof(__pyx_k__Mod), 0, 0, 1, 1},
  {&__pyx_n_s__NumberOfGEN, __pyx_k__NumberOfGEN, sizeof(__pyx_k__NumberOfGEN), 0, 0, 1, 1},
  {&__pyx_n_s__P, __pyx_k__P, sizeof(__pyx_k__P), 0, 0, 1, 1},
  {&__pyx_n_s__PariError, __pyx_k__PariError, sizeof(__pyx_k__PariError), 0, 0, 1, 1},
  {&__pyx_n_s__Polrev, __pyx_k__Polrev, sizeof(__pyx_k__Polrev), 0, 0, 1, 1},
  {&__pyx_n_s__RuntimeError, __pyx_k__RuntimeError, sizeof(__pyx_k__RuntimeError), 0, 0, 1, 1},
  {&__pyx_n_s__S, __pyx_k__S, sizeof(__pyx_k__S), 0, 0, 1, 1},
  {&__pyx_n_s__Strtex, __pyx_k__Strtex, sizeof(__pyx_k__Strtex), 0, 0, 1, 1},
  {&__pyx_n_s__T, __pyx_k__T, sizeof(__pyx_k__T), 0, 0, 1, 1},
  {&__pyx_n_s__TupleType, __pyx_k__TupleType, sizeof(__pyx_k__TupleType), 0, 0, 1, 1},
  {&__pyx_n_s__TypeError, __pyx_k__TypeError, sizeof(__pyx_k__TypeError), 0, 0, 1, 1},
  {&__pyx_n_s__ValueError, __pyx_k__ValueError, sizeof(__pyx_k__ValueError), 0, 0, 1, 1},
  {&__pyx_n_s__Vec, __pyx_k__Vec, sizeof(__pyx_k__Vec), 0, 0, 1, 1},
  {&__pyx_n_s__Vecrev, __pyx_k__Vecrev, sizeof(__pyx_k__Vecrev), 0, 0, 1, 1},
  {&__pyx_n_s__XRangeType, __pyx_k__XRangeType, sizeof(__pyx_k__XRangeType), 0, 0, 1, 1},
  {&__pyx_n_s__ZZ, __pyx_k__ZZ, sizeof(__pyx_k__ZZ), 0, 0, 1, 1},
  {&__pyx_n_s____errmessage, __pyx_k____errmessage, sizeof(__pyx_k____errmessage), 0, 0, 1, 1},
  {&__pyx_n_s____getitem__, __pyx_k____getitem__, sizeof(__pyx_k____getitem__), 0, 0, 1, 1},
  {&__pyx_n_s____main__, __pyx_k____main__, sizeof(__pyx_k____main__), 0, 0, 1, 1},
  {&__pyx_n_s____nth_prime, __pyx_k____nth_prime, sizeof(__pyx_k____nth_prime), 0, 0, 1, 1},
  {&__pyx_n_s____repr__, __pyx_k____repr__, sizeof(__pyx_k____repr__), 0, 0, 1, 1},
  {&__pyx_n_s____str__, __pyx_k____str__, sizeof(__pyx_k____str__), 0, 0, 1, 1},
  {&__pyx_n_s____test__, __pyx_k____test__, sizeof(__pyx_k____test__), 0, 0, 1, 1},
  {&__pyx_n_s___init, __pyx_k___init, sizeof(__pyx_k___init), 0, 0, 1, 1},
  {&__pyx_n_s___nfinit_with_prec, __pyx_k___nfinit_with_prec, sizeof(__pyx_k___nfinit_with_prec), 0, 0, 1, 1},
  {&__pyx_n_s___pari_, __pyx_k___pari_, sizeof(__pyx_k___pari_), 0, 0, 1, 1},
  {&__pyx_n_s__a, __pyx_k__a, sizeof(__pyx_k__a), 0, 0, 1, 1},
  {&__pyx_n_s__abs, __pyx_k__abs, sizeof(__pyx_k__abs), 0, 0, 1, 1},
  {&__pyx_n_s__add_one, __pyx_k__add_one, sizeof(__pyx_k__add_one), 0, 0, 1, 1},
  {&__pyx_n_s__allocatemem, __pyx_k__allocatemem, sizeof(__pyx_k__allocatemem), 0, 0, 1, 1},
  {&__pyx_n_s__args, __pyx_k__args, sizeof(__pyx_k__args), 0, 0, 1, 1},
  {&__pyx_n_s__aut, __pyx_k__aut, sizeof(__pyx_k__aut), 0, 0, 1, 1},
  {&__pyx_n_s__b, __pyx_k__b, sizeof(__pyx_k__b), 0, 0, 1, 1},
  {&__pyx_n_s__bezout, __pyx_k__bezout, sizeof(__pyx_k__bezout), 0, 0, 1, 1},
  {&__pyx_n_s__bid, __pyx_k__bid, sizeof(__pyx_k__bid), 0, 0, 1, 1},
  {&__pyx_n_s__bound, __pyx_k__bound, sizeof(__pyx_k__bound), 0, 0, 1, 1},
  {&__pyx_n_s__c, __pyx_k__c, sizeof(__pyx_k__c), 0, 0, 1, 1},
  {&__pyx_n_s__chr, __pyx_k__chr, sizeof(__pyx_k__chr), 0, 0, 1, 1},
  {&__pyx_n_s__component, __pyx_k__component, sizeof(__pyx_k__component), 0, 0, 1, 1},
  {&__pyx_n_s__d, __pyx_k__d, sizeof(__pyx_k__d), 0, 0, 1, 1},
  {&__pyx_n_s__debug, __pyx_k__debug, sizeof(__pyx_k__debug), 0, 0, 1, 1},
  {&__pyx_n_s__default, __pyx_k__default, sizeof(__pyx_k__default), 0, 0, 1, 1},
  {&__pyx_n_s__den, __pyx_k__den, sizeof(__pyx_k__den), 0, 0, 1, 1},
  {&__pyx_n_s__denom, __pyx_k__denom, sizeof(__pyx_k__denom), 0, 0, 1, 1},
  {&__pyx_n_s__depth, __pyx_k__depth, sizeof(__pyx_k__depth), 0, 0, 1, 1},
  {&__pyx_n_s__e, __pyx_k__e, sizeof(__pyx_k__e), 0, 0, 1, 1},
  {&__pyx_n_s__entries, __pyx_k__entries, sizeof(__pyx_k__entries), 0, 0, 1, 1},
  {&__pyx_n_s__enumerate, __pyx_k__enumerate, sizeof(__pyx_k__enumerate), 0, 0, 1, 1},
  {&__pyx_n_s__errmessage, __pyx_k__errmessage, sizeof(__pyx_k__errmessage), 0, 0, 1, 1},
  {&__pyx_n_s__errnum, __pyx_k__errnum, sizeof(__pyx_k__errnum), 0, 0, 1, 1},
  {&__pyx_n_s__estimate, __pyx_k__estimate, sizeof(__pyx_k__estimate), 0, 0, 1, 1},
  {&__pyx_n_s__eval, __pyx_k__eval, sizeof(__pyx_k__eval), 0, 0, 1, 1},
  {&__pyx_n_s__example, __pyx_k__example, sizeof(__pyx_k__example), 0, 0, 1, 1},
  {&__pyx_n_s__exceptions, __pyx_k__exceptions, sizeof(__pyx_k__exceptions), 0, 0, 1, 1},
  {&__pyx_n_s__fa, __pyx_k__fa, sizeof(__pyx_k__fa), 0, 0, 1, 1},
  {&__pyx_n_s__find, __pyx_k__find, sizeof(__pyx_k__find), 0, 0, 1, 1},
  {&__pyx_n_s__find_root, __pyx_k__find_root, sizeof(__pyx_k__find_root), 0, 0, 1, 1},
  {&__pyx_n_s__flag, __pyx_k__flag, sizeof(__pyx_k__flag), 0, 0, 1, 1},
  {&__pyx_n_s__flush, __pyx_k__flush, sizeof(__pyx_k__flush), 0, 0, 1, 1},
  {&__pyx_n_s__gen_py, __pyx_k__gen_py, sizeof(__pyx_k__gen_py), 0, 0, 1, 1},
  {&__pyx_n_s__im, __pyx_k__im, sizeof(__pyx_k__im), 0, 0, 1, 1},
  {&__pyx_n_s__indices, __pyx_k__indices, sizeof(__pyx_k__indices), 0, 0, 1, 1},
  {&__pyx_n_s__init_pari_stack, __pyx_k__init_pari_stack, sizeof(__pyx_k__init_pari_stack), 0, 0, 1, 1},
  {&__pyx_n_s__init_primes, __pyx_k__init_primes, sizeof(__pyx_k__init_primes), 0, 0, 1, 1},
  {&__pyx_n_s__k, __pyx_k__k, sizeof(__pyx_k__k), 0, 0, 1, 1},
  {&__pyx_n_s__libs, __pyx_k__libs, sizeof(__pyx_k__libs), 0, 0, 1, 1},
  {&__pyx_n_s__limit, __pyx_k__limit, sizeof(__pyx_k__limit), 0, 0, 1, 1},
  {&__pyx_n_s__lmax, __pyx_k__lmax, sizeof(__pyx_k__lmax), 0, 0, 1, 1},
  {&__pyx_n_s__log_10, __pyx_k__log_10, sizeof(__pyx_k__log_10), 0, 0, 1, 1},
  {&__pyx_n_s__log_2, __pyx_k__log_2, sizeof(__pyx_k__log_2), 0, 0, 1, 1},
  {&__pyx_n_s__log_gamma, __pyx_k__log_gamma, sizeof(__pyx_k__log_gamma), 0, 0, 1, 1},
  {&__pyx_n_s__m, __pyx_k__m, sizeof(__pyx_k__m), 0, 0, 1, 1},
  {&__pyx_n_s__math, __pyx_k__math, sizeof(__pyx_k__math), 0, 0, 1, 1},
  {&__pyx_n_s__max, __pyx_k__max, sizeof(__pyx_k__max), 0, 0, 1, 1},
  {&__pyx_n_s__maxprime, __pyx_k__maxprime, sizeof(__pyx_k__maxprime), 0, 0, 1, 1},
  {&__pyx_n_s__mytop, __pyx_k__mytop, sizeof(__pyx_k__mytop), 0, 0, 1, 1},
  {&__pyx_n_s__n, __pyx_k__n, sizeof(__pyx_k__n), 0, 0, 1, 1},
  {&__pyx_n_s__n11, __pyx_k__n11, sizeof(__pyx_k__n11), 0, 0, 1, 1},
  {&__pyx_n_s__ncols, __pyx_k__ncols, sizeof(__pyx_k__ncols), 0, 0, 1, 1},
  {&__pyx_n_s__ne, __pyx_k__ne, sizeof(__pyx_k__ne), 0, 0, 1, 1},
  {&__pyx_n_s__nrows, __pyx_k__nrows, sizeof(__pyx_k__nrows), 0, 0, 1, 1},
  {&__pyx_n_s__nth_prime, __pyx_k__nth_prime, sizeof(__pyx_k__nth_prime), 0, 0, 1, 1},
  {&__pyx_n_s__obj, __pyx_k__obj, sizeof(__pyx_k__obj), 0, 0, 1, 1},
  {&__pyx_n_s__operator, __pyx_k__operator, sizeof(__pyx_k__operator), 0, 0, 1, 1},
  {&__pyx_n_s__p, __pyx_k__p, sizeof(__pyx_k__p), 0, 0, 1, 1},
  {&__pyx_n_s__padded_bits, __pyx_k__padded_bits, sizeof(__pyx_k__padded_bits), 0, 0, 1, 1},
  {&__pyx_n_s__pari, __pyx_k__pari, sizeof(__pyx_k__pari), 0, 0, 1, 1},
  {&__pyx_n_s__pbw, __pyx_k__pbw, sizeof(__pyx_k__pbw), 0, 0, 1, 1},
  {&__pyx_n_s__perm, __pyx_k__perm, sizeof(__pyx_k__perm), 0, 0, 1, 1},
  {&__pyx_n_s__pol2, __pyx_k__pol2, sizeof(__pyx_k__pol2), 0, 0, 1, 1},
  {&__pyx_n_s__polcoeff, __pyx_k__polcoeff, sizeof(__pyx_k__polcoeff), 0, 0, 1, 1},
  {&__pyx_n_s__poldegree, __pyx_k__poldegree, sizeof(__pyx_k__poldegree), 0, 0, 1, 1},
  {&__pyx_n_s__polrel, __pyx_k__polrel, sizeof(__pyx_k__polrel), 0, 0, 1, 1},
  {&__pyx_n_s__poly, __pyx_k__poly, sizeof(__pyx_k__poly), 0, 0, 1, 1},
  {&__pyx_n_s__prec, __pyx_k__prec, sizeof(__pyx_k__prec), 0, 0, 1, 1},
  {&__pyx_n_s__prec_bits_to_dec, __pyx_k__prec_bits_to_dec, sizeof(__pyx_k__prec_bits_to_dec), 0, 0, 1, 1},
  {&__pyx_n_s__prec_bits_to_words, __pyx_k__prec_bits_to_words, sizeof(__pyx_k__prec_bits_to_words), 0, 0, 1, 1},
  {&__pyx_n_s__prec_dec_to_bits, __pyx_k__prec_dec_to_bits, sizeof(__pyx_k__prec_dec_to_bits), 0, 0, 1, 1},
  {&__pyx_n_s__prec_dec_to_words, __pyx_k__prec_dec_to_words, sizeof(__pyx_k__prec_dec_to_words), 0, 0, 1, 1},
  {&__pyx_n_s__prec_in_bits, __pyx_k__prec_in_bits, sizeof(__pyx_k__prec_in_bits), 0, 0, 1, 1},
  {&__pyx_n_s__prec_in_dec, __pyx_k__prec_in_dec, sizeof(__pyx_k__prec_in_dec), 0, 0, 1, 1},
  {&__pyx_n_s__prec_in_words, __pyx_k__prec_in_words, sizeof(__pyx_k__prec_in_words), 0, 0, 1, 1},
  {&__pyx_n_s__prec_words_to_bits, __pyx_k__prec_words_to_bits, sizeof(__pyx_k__prec_words_to_bits), 0, 0, 1, 1},
  {&__pyx_n_s__prec_words_to_dec, __pyx_k__prec_words_to_dec, sizeof(__pyx_k__prec_words_to_dec), 0, 0, 1, 1},
  {&__pyx_n_s__precision, __pyx_k__precision, sizeof(__pyx_k__precision), 0, 0, 1, 1},
  {&__pyx_n_s__prime_list, __pyx_k__prime_list, sizeof(__pyx_k__prime_list), 0, 0, 1, 1},
  {&__pyx_n_s__primepi, __pyx_k__primepi, sizeof(__pyx_k__primepi), 0, 0, 1, 1},
  {&__pyx_n_s__proof, __pyx_k__proof, sizeof(__pyx_k__proof), 0, 0, 1, 1},
  {&__pyx_n_s__python_ints, __pyx_k__python_ints, sizeof(__pyx_k__python_ints), 0, 0, 1, 1},
  {&__pyx_n_s__qflllgram, __pyx_k__qflllgram, sizeof(__pyx_k__qflllgram), 0, 0, 1, 1},
  {&__pyx_n_s__r, __pyx_k__r, sizeof(__pyx_k__r), 0, 0, 1, 1},
  {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
  {&__pyx_n_s__re, __pyx_k__re, sizeof(__pyx_k__re), 0, 0, 1, 1},
  {&__pyx_n_s__replace, __pyx_k__replace, sizeof(__pyx_k__replace), 0, 0, 1, 1},
  {&__pyx_n_s__rhs, __pyx_k__rhs, sizeof(__pyx_k__rhs), 0, 0, 1, 1},
  {&__pyx_n_s__s, __pyx_k__s, sizeof(__pyx_k__s), 0, 0, 1, 1},
  {&__pyx_n_s__self, __pyx_k__self, sizeof(__pyx_k__self), 0, 0, 1, 1},
  {&__pyx_n_s__seriesprecision, __pyx_k__seriesprecision, sizeof(__pyx_k__seriesprecision), 0, 0, 1, 1},
  {&__pyx_n_s__set_real_precision, __pyx_k__set_real_precision, sizeof(__pyx_k__set_real_precision), 0, 0, 1, 1},
  {&__pyx_n_s__silent, __pyx_k__silent, sizeof(__pyx_k__silent), 0, 0, 1, 1},
  {&__pyx_n_s__size, __pyx_k__size, sizeof(__pyx_k__size), 0, 0, 1, 1},
  {&__pyx_n_s__staticmethod, __pyx_k__staticmethod, sizeof(__pyx_k__staticmethod), 0, 0, 1, 1},
  {&__pyx_n_s__stdout, __pyx_k__stdout, sizeof(__pyx_k__stdout), 0, 0, 1, 1},
  {&__pyx_n_s__sys, __pyx_k__sys, sizeof(__pyx_k__sys), 0, 0, 1, 1},
  {&__pyx_n_s__t0heap, __pyx_k__t0heap, sizeof(__pyx_k__t0heap), 0, 0, 1, 1},
  {&__pyx_n_s__t_CLOSURE, __pyx_k__t_CLOSURE, sizeof(__pyx_k__t_CLOSURE), 0, 0, 1, 1},
  {&__pyx_n_s__t_COL, __pyx_k__t_COL, sizeof(__pyx_k__t_COL), 0, 0, 1, 1},
  {&__pyx_n_s__t_COMPLEX, __pyx_k__t_COMPLEX, sizeof(__pyx_k__t_COMPLEX), 0, 0, 1, 1},
  {&__pyx_n_s__t_FFELT, __pyx_k__t_FFELT, sizeof(__pyx_k__t_FFELT), 0, 0, 1, 1},
  {&__pyx_n_s__t_FRAC, __pyx_k__t_FRAC, sizeof(__pyx_k__t_FRAC), 0, 0, 1, 1},
  {&__pyx_n_s__t_INT, __pyx_k__t_INT, sizeof(__pyx_k__t_INT), 0, 0, 1, 1},
  {&__pyx_n_s__t_INTMOD, __pyx_k__t_INTMOD, sizeof(__pyx_k__t_INTMOD), 0, 0, 1, 1},
  {&__pyx_n_s__t_LIST, __pyx_k__t_LIST, sizeof(__pyx_k__t_LIST), 0, 0, 1, 1},
  {&__pyx_n_s__t_MAT, __pyx_k__t_MAT, sizeof(__pyx_k__t_MAT), 0, 0, 1, 1},
  {&__pyx_n_s__t_PADIC, __pyx_k__t_PADIC, sizeof(__pyx_k__t_PADIC), 0, 0, 1, 1},
  {&__pyx_n_s__t_POL, __pyx_k__t_POL, sizeof(__pyx_k__t_POL), 0, 0, 1, 1},
  {&__pyx_n_s__t_POLMOD, __pyx_k__t_POLMOD, sizeof(__pyx_k__t_POLMOD), 0, 0, 1, 1},
  {&__pyx_n_s__t_QFI, __pyx_k__t_QFI, sizeof(__pyx_k__t_QFI), 0, 0, 1, 1},
  {&__pyx_n_s__t_QFR, __pyx_k__t_QFR, sizeof(__pyx_k__t_QFR), 0, 0, 1, 1},
  {&__pyx_n_s__t_QUAD, __pyx_k__t_QUAD, sizeof(__pyx_k__t_QUAD), 0, 0, 1, 1},
  {&__pyx_n_s__t_REAL, __pyx_k__t_REAL, sizeof(__pyx_k__t_REAL), 0, 0, 1, 1},
  {&__pyx_n_s__t_RFRAC, __pyx_k__t_RFRAC, sizeof(__pyx_k__t_RFRAC), 0, 0, 1, 1},
  {&__pyx_n_s__t_SER, __pyx_k__t_SER, sizeof(__pyx_k__t_SER), 0, 0, 1, 1},
  {&__pyx_n_s__t_STR, __pyx_k__t_STR, sizeof(__pyx_k__t_STR), 0, 0, 1, 1},
  {&__pyx_n_s__t_VEC, __pyx_k__t_VEC, sizeof(__pyx_k__t_VEC), 0, 0, 1, 1},
  {&__pyx_n_s__t_VECSMALL, __pyx_k__t_VECSMALL, sizeof(__pyx_k__t_VECSMALL), 0, 0, 1, 1},
  {&__pyx_n_s__tech, __pyx_k__tech, sizeof(__pyx_k__tech), 0, 0, 1, 1},
  {&__pyx_n_s__test, __pyx_k__test, sizeof(__pyx_k__test), 0, 0, 1, 1},
  {&__pyx_n_s__testclass, __pyx_k__testclass, sizeof(__pyx_k__testclass), 0, 0, 1, 1},
  {&__pyx_n_s__type, __pyx_k__type, sizeof(__pyx_k__type), 0, 0, 1, 1},
  {&__pyx_n_s__types, __pyx_k__types, sizeof(__pyx_k__types), 0, 0, 1, 1},
  {&__pyx_n_s__unknown, __pyx_k__unknown, sizeof(__pyx_k__unknown), 0, 0, 1, 1},
  {&__pyx_n_s__v, __pyx_k__v, sizeof(__pyx_k__v), 0, 0, 1, 1},
  {&__pyx_n_s__value, __pyx_k__value, sizeof(__pyx_k__value), 0, 0, 1, 1},
  {&__pyx_n_s__var, __pyx_k__var, sizeof(__pyx_k__var), 0, 0, 1, 1},
  {&__pyx_n_s__variable, __pyx_k__variable, sizeof(__pyx_k__variable), 0, 0, 1, 1},
  {&__pyx_n_s__vdir, __pyx_k__vdir, sizeof(__pyx_k__vdir), 0, 0, 1, 1},
  {&__pyx_n_s__vecextract, __pyx_k__vecextract, sizeof(__pyx_k__vecextract), 0, 0, 1, 1},
  {&__pyx_n_s__vecsmall_to_intlist, __pyx_k__vecsmall_to_intlist, sizeof(__pyx_k__vecsmall_to_intlist), 0, 0, 1, 1},
  {&__pyx_n_s__vector, __pyx_k__vector, sizeof(__pyx_k__vector), 0, 0, 1, 1},
  {&__pyx_n_s__wordsize, __pyx_k__wordsize, sizeof(__pyx_k__wordsize), 0, 0, 1, 1},
  {&__pyx_n_s__write, __pyx_k__write, sizeof(__pyx_k__write), 0, 0, 1, 1},
  {&__pyx_n_s__x, __pyx_k__x, sizeof(__pyx_k__x), 0, 0, 1, 1},
  {&__pyx_n_s__xrange, __pyx_k__xrange, sizeof(__pyx_k__xrange), 0, 0, 1, 1},
  {&__pyx_n_s__y, __pyx_k__y, sizeof(__pyx_k__y), 0, 0, 1, 1},
  {&__pyx_n_s__ya, __pyx_k__ya, sizeof(__pyx_k__ya), 0, 0, 1, 1},
  {&__pyx_n_s__z, __pyx_k__z, sizeof(__pyx_k__z), 0, 0, 1, 1},
  {&__pyx_n_s__z0, __pyx_k__z0, sizeof(__pyx_k__z0), 0, 0, 1, 1},
  {&__pyx_n_s__z1, __pyx_k__z1, sizeof(__pyx_k__z1), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_staticmethod = __Pyx_GetName(__pyx_b, __pyx_n_s__staticmethod); if (!__pyx_builtin_staticmethod) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_TypeError = __Pyx_GetName(__pyx_b, __pyx_n_s__TypeError); if (!__pyx_builtin_TypeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_IndexError = __Pyx_GetName(__pyx_b, __pyx_n_s__IndexError); if (!__pyx_builtin_IndexError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION >= 3
  __pyx_builtin_xrange = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_xrange) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #else
  __pyx_builtin_xrange = __Pyx_GetName(__pyx_b, __pyx_n_s__xrange); if (!__pyx_builtin_xrange) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 994; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  __pyx_builtin_enumerate = __Pyx_GetName(__pyx_b, __pyx_n_s__enumerate); if (!__pyx_builtin_enumerate) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_chr = __Pyx_GetName(__pyx_b, __pyx_n_s__chr); if (!__pyx_builtin_chr) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_eval = __Pyx_GetName(__pyx_b, __pyx_n_s__eval); if (!__pyx_builtin_eval) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5677; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_AttributeError = __Pyx_GetName(__pyx_b, __pyx_n_s__AttributeError); if (!__pyx_builtin_AttributeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_MemoryError = __Pyx_GetName(__pyx_b, __pyx_n_s__MemoryError); if (!__pyx_builtin_MemoryError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9954; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "example.pyx":524
 *         """
 *         if typ(self.g) != t_INTMOD and typ(self.g) != t_POLMOD:
 *             raise TypeError("Not an INTMOD or POLMOD in mod()")             # <<<<<<<<<<<<<<
 *         sig_on()
 *         # The hardcoded 1 below refers to the position in the internal
 */
  __pyx_k_tuple_6 = PyTuple_Pack(1, ((PyObject *)__pyx_kp_s_5)); if (unlikely(!__pyx_k_tuple_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_6);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_6));

  /* "example.pyx":572
 *         sig_off()
 *         if not nf:
 *             raise TypeError("Not a PARI number field")             # <<<<<<<<<<<<<<
 *         return nf
 * 
 */
  __pyx_k_tuple_8 = PyTuple_Pack(1, ((PyObject *)__pyx_kp_s_7)); if (unlikely(!__pyx_k_tuple_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_8);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_8));

  /* "example.pyx":998
 *             # fast exit
 *             if k==0:
 *                 return P.vector(0)             # <<<<<<<<<<<<<<
 *             # fast call, beware pari is one based
 *             if pari_type == t_VEC:
 */
  __pyx_k_tuple_13 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_k_tuple_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 998; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_13);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_13));

  /* "example.pyx":1324
 *         if s[:4] == "Mat(":
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")             # <<<<<<<<<<<<<<
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")
 */
  __pyx_k_tuple_29 = PyTuple_Pack(2, ((PyObject *)__pyx_kp_s_27), ((PyObject *)__pyx_kp_s_28)); if (unlikely(!__pyx_k_tuple_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1324; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_29);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_29));

  /* "example.pyx":1325
 *             s = "[" + s[4:-1] + "]"
 *         s = s.replace("~","")
 *         if s.find(";") != -1:             # <<<<<<<<<<<<<<
 *             s = s.replace(";","], [")
 *             s = "[" + s + "]"
 */
  __pyx_k_tuple_31 = PyTuple_Pack(1, ((PyObject *)__pyx_kp_s_30)); if (unlikely(!__pyx_k_tuple_31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_31);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_31));

  /* "example.pyx":1326
 *         s = s.replace("~","")
 *         if s.find(";") != -1:
 *             s = s.replace(";","], [")             # <<<<<<<<<<<<<<
 *             s = "[" + s + "]"
 *             return eval(s)
 */
  __pyx_k_tuple_33 = PyTuple_Pack(2, ((PyObject *)__pyx_kp_s_30), ((PyObject *)__pyx_kp_s_32)); if (unlikely(!__pyx_k_tuple_33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_33);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_33));

  /* "example.pyx":3512
 *                 _p, _p.type()))
 *         if not gequal(gel(x.g, 2), _p.g):
 *             raise ValueError("not the same prime in padicprec")             # <<<<<<<<<<<<<<
 *         return padicprec(x.g, _p.g)
 * 
 */
  __pyx_k_tuple_43 = PyTuple_Pack(1, ((PyObject *)__pyx_kp_s_42)); if (unlikely(!__pyx_k_tuple_43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_43);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_43));

  /* "example.pyx":8019
 * 
 *     def lllgram(self):
 *         return self.qflllgram(0)             # <<<<<<<<<<<<<<
 * 
 *     def lllgramint(self):
 */
  __pyx_k_tuple_50 = PyTuple_Pack(1, __pyx_int_0); if (unlikely(!__pyx_k_tuple_50)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8019; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_50);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_50));

  /* "example.pyx":8022
 * 
 *     def lllgramint(self):
 *         return self.qflllgram(1)             # <<<<<<<<<<<<<<
 * 
 *     def qfminim(self, B, max, long flag=0):
 */
  __pyx_k_tuple_51 = PyTuple_Pack(1, __pyx_int_1); if (unlikely(!__pyx_k_tuple_51)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8022; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_51);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_51));

  /* "example.pyx":8985
 *         #from sage.rings.real_mpfr import RealField
 *         #prec_bits = RealField().prec()
 *         prec = prec_bits_to_words(53)             # <<<<<<<<<<<<<<
 *         GP_DATA.fmt.sigd = prec_bits_to_dec(53)
 * 
 */
  __pyx_k_tuple_54 = PyTuple_Pack(1, __pyx_int_53); if (unlikely(!__pyx_k_tuple_54)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8985; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_54);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_54));

  /* "example.pyx":8986
 *         #prec_bits = RealField().prec()
 *         prec = prec_bits_to_words(53)
 *         GP_DATA.fmt.sigd = prec_bits_to_dec(53)             # <<<<<<<<<<<<<<
 * 
 *         # Set printing functions
 */
  __pyx_k_tuple_55 = PyTuple_Pack(1, __pyx_int_53); if (unlikely(!__pyx_k_tuple_55)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8986; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_55);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_55));

  /* "example.pyx":9055
 *         Set the debug PARI C library variable.
 *         """
 *         return int(self.default('debug'))             # <<<<<<<<<<<<<<
 * 
 *     cdef GEN toGEN(self, x, int i) except NULL:
 */
  __pyx_k_tuple_59 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__debug)); if (unlikely(!__pyx_k_tuple_59)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_59);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_59));

  /* "example.pyx":10023
 *     elif errno == user:
 *         sig_off()
 *         raise RuntimeError("PARI user exception")             # <<<<<<<<<<<<<<
 *     else:
 *         sig_off()
 */
  __pyx_k_tuple_77 = PyTuple_Pack(1, ((PyObject *)__pyx_kp_s_76)); if (unlikely(!__pyx_k_tuple_77)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10023; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_77);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_77));

  /* "example.pyx":14
 * #    int PyObject_HasAttrString(object o, char *attr_name)
 * 
 * def prec_bits_to_dec(int prec_in_bits):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to precision expressed in
 */
  __pyx_k_tuple_81 = PyTuple_Pack(3, ((PyObject *)__pyx_n_s__prec_in_bits), ((PyObject *)__pyx_n_s__prec_in_bits), ((PyObject *)__pyx_n_s__log_2)); if (unlikely(!__pyx_k_tuple_81)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_81);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_81));
  __pyx_k_codeobj_82 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_bits_to_dec, 14, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_82)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":37
 *     return int(prec_in_bits*log_2)
 * 
 * def prec_dec_to_bits(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */
  __pyx_k_tuple_84 = PyTuple_Pack(3, ((PyObject *)__pyx_n_s__prec_in_dec), ((PyObject *)__pyx_n_s__prec_in_dec), ((PyObject *)__pyx_n_s__log_10)); if (unlikely(!__pyx_k_tuple_84)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_84);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_84));
  __pyx_k_codeobj_85 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_dec_to_bits, 37, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_85)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":61
 *     return int(prec_in_dec*log_10)
 * 
 * def prec_bits_to_words(int prec_in_bits=0):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to pari real precision
 */
  __pyx_k_tuple_86 = PyTuple_Pack(3, ((PyObject *)__pyx_n_s__prec_in_bits), ((PyObject *)__pyx_n_s__wordsize), ((PyObject *)__pyx_n_s__padded_bits)); if (unlikely(!__pyx_k_tuple_86)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_86);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_86));
  __pyx_k_codeobj_87 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_bits_to_words, 61, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_87)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":93
 * pbw = prec_bits_to_words
 * 
 * def prec_words_to_bits(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from pari real precision expressed in words to precision
 */
  __pyx_k_tuple_88 = PyTuple_Pack(2, ((PyObject *)__pyx_n_s__prec_in_words), ((PyObject *)__pyx_n_s__prec_in_words)); if (unlikely(!__pyx_k_tuple_88)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_88);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_88));
  __pyx_k_codeobj_89 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_words_to_bits, 93, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_89)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":112
 *     return int((prec_in_words - 2) * BITS_IN_LONG)
 * 
 * def prec_dec_to_words(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */
  __pyx_k_tuple_90 = PyTuple_Pack(2, ((PyObject *)__pyx_n_s__prec_in_dec), ((PyObject *)__pyx_n_s__prec_in_dec)); if (unlikely(!__pyx_k_tuple_90)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_90);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_90));
  __pyx_k_codeobj_91 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_dec_to_words, 112, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_91)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":130
 *     return prec_bits_to_words(prec_dec_to_bits(prec_in_dec))
 * 
 * def prec_words_to_dec(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in words to precision expressed in
 */
  __pyx_k_tuple_92 = PyTuple_Pack(2, ((PyObject *)__pyx_n_s__prec_in_words), ((PyObject *)__pyx_n_s__prec_in_words)); if (unlikely(!__pyx_k_tuple_92)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_92);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_92));
  __pyx_k_codeobj_93 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__prec_words_to_dec, 130, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_93)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":151
 * # The unique running Pari instance.
 * cdef PariInstance pari_instance, P
 * pari_instance = PariInstance(16000000, 500000)             # <<<<<<<<<<<<<<
 * P = pari_instance   # shorthand notation
 * 
 */
  __pyx_k_tuple_94 = PyTuple_Pack(2, __pyx_int_16000000, __pyx_int_500000); if (unlikely(!__pyx_k_tuple_94)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_94);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_94));

  /* "example.pyx":9871
 * ##############################################
 * 
 * def init_pari_stack(size=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Change the PARI scratch stack space to the given size.
 */
  __pyx_k_tuple_95 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__size)); if (unlikely(!__pyx_k_tuple_95)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_95);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_95));
  __pyx_k_codeobj_96 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_95, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__init_pari_stack, 9871, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_96)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":10090
 * 
 * 
 * def __errmessage(d):             # <<<<<<<<<<<<<<
 *     if d <= 0 or d > noer:
 *         return "unknown"
 */
  __pyx_k_tuple_97 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__d)); if (unlikely(!__pyx_k_tuple_97)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_97);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_97));
  __pyx_k_codeobj_98 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_97, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s____errmessage, 10090, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_98)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":10107
 *     errmessage = staticmethod(__errmessage)
 * 
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */
  __pyx_k_tuple_99 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__self)); if (unlikely(!__pyx_k_tuple_99)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_99);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_99));
  __pyx_k_codeobj_100 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_99, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__errnum, 10107, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_100)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":10121
 *         return self.args[0]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */
  __pyx_k_tuple_102 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__self)); if (unlikely(!__pyx_k_tuple_102)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_102);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_102));
  __pyx_k_codeobj_103 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s____repr__, 10121, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_103)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":10130
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         EXAMPLES::
 */
  __pyx_k_tuple_105 = PyTuple_Pack(1, ((PyObject *)__pyx_n_s__self)); if (unlikely(!__pyx_k_tuple_105)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_105);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_105));
  __pyx_k_codeobj_106 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s____str__, 10130, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_106)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":10145
 * 
 * 
 * def vecsmall_to_intlist(gen v):             # <<<<<<<<<<<<<<
 *     """
 *     INPUT:
 */
  __pyx_k_tuple_108 = PyTuple_Pack(2, ((PyObject *)__pyx_n_s__v), ((PyObject *)__pyx_n_s__k)); if (unlikely(!__pyx_k_tuple_108)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_tuple_108);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_108));
  __pyx_k_codeobj_109 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_k_tuple_108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_83, __pyx_n_s__vecsmall_to_intlist, 10145, __pyx_empty_bytes); if (unlikely(!__pyx_k_codeobj_109)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_10 = PyInt_FromLong(10); if (unlikely(!__pyx_int_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_20 = PyInt_FromLong(20); if (unlikely(!__pyx_int_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_53 = PyInt_FromLong(53); if (unlikely(!__pyx_int_53)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_500000 = PyInt_FromLong(500000); if (unlikely(!__pyx_int_500000)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_8000000 = PyInt_FromLong(8000000); if (unlikely(!__pyx_int_8000000)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_16000000 = PyInt_FromLong(16000000); if (unlikely(!__pyx_int_16000000)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initexample(void); /*proto*/
PyMODINIT_FUNC initexample(void)
#else
PyMODINIT_FUNC PyInit_example(void); /*proto*/
PyMODINIT_FUNC PyInit_example(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_example(void)", 0);
  if ( __Pyx_check_binary_version() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #ifdef __Pyx_CyFunction_USED
  if (__Pyx_CyFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4(__Pyx_NAMESTR("example"), __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (!PyDict_GetItemString(modules, "example")) {
      if (unlikely(PyDict_SetItemString(modules, "example", __pyx_m) < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    }
  }
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_NAMESTR(__Pyx_BUILTIN_MODULE_NAME)); if (unlikely(!__pyx_b)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_module_is_main_example) {
    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_n_s____main__) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Constants init code ---*/
  if (unlikely(__Pyx_InitCachedConstants() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Global init code ---*/
  __pyx_v_7example_pari_instance = ((struct __pyx_obj_7example_PariInstance *)Py_None); Py_INCREF(Py_None);
  __pyx_v_7example_P = ((struct __pyx_obj_7example_PariInstance *)Py_None); Py_INCREF(Py_None);
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  if (__Pyx_ExportFunction("_Vec_append", (void (*)(void))__pyx_f_7example__Vec_append, "GEN (GEN, GEN, long)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Type init code ---*/
  __pyx_vtabptr_7example_gen = &__pyx_vtable_7example_gen;
  __pyx_vtable_7example_gen.init = (void (*)(struct __pyx_obj_7example_gen *, GEN, pari_sp))__pyx_f_7example_3gen_init;
  __pyx_vtable_7example_gen._gen = (GEN (*)(struct __pyx_obj_7example_gen *))__pyx_f_7example_3gen__gen;
  __pyx_vtable_7example_gen.new_gen = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_gen *, GEN))__pyx_f_7example_3gen_new_gen;
  __pyx_vtable_7example_gen.new_gen_noclear = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_gen *, GEN))__pyx_f_7example_3gen_new_gen_noclear;
  __pyx_vtable_7example_gen.pari = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_gen *, PyObject *))__pyx_f_7example_3gen_pari;
  __pyx_vtable_7example_gen._deepcopy_to_python_heap = (GEN (*)(struct __pyx_obj_7example_gen *, GEN, pari_sp *))__pyx_f_7example_3gen__deepcopy_to_python_heap;
  __pyx_vtable_7example_gen.get_var = (long (*)(struct __pyx_obj_7example_gen *, PyObject *))__pyx_f_7example_3gen_get_var;
  __pyx_vtable_7example_gen.get_nf = (GEN (*)(struct __pyx_obj_7example_gen *))__pyx_f_7example_3gen_get_nf;
  if (PyType_Ready(&__pyx_type_7example_gen) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__hash__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_8__hash__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_8__hash__.doc = __pyx_doc_7example_3gen_8__hash__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_8__hash__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__getitem__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_80__getitem__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_80__getitem__.doc = __pyx_doc_7example_3gen_80__getitem__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_80__getitem__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__setitem__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_84__setitem__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_84__setitem__.doc = __pyx_doc_7example_3gen_84__setitem__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_84__setitem__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__hex__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_94__hex__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_94__hex__.doc = __pyx_doc_7example_3gen_94__hex__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_94__hex__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__int__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_96__int__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_96__int__.doc = __pyx_doc_7example_3gen_96__int__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_96__int__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__long__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_106__long__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_106__long__.doc = __pyx_doc_7example_3gen_106__long__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_106__long__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_gen, "__float__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_3gen_108__float__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_3gen_108__float__.doc = __pyx_doc_7example_3gen_108__float__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_3gen_108__float__;
    }
  }
  #endif
  if (__Pyx_SetVtable(__pyx_type_7example_gen.tp_dict, __pyx_vtabptr_7example_gen) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "gen", (PyObject *)&__pyx_type_7example_gen) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7example_gen = &__pyx_type_7example_gen;
  __pyx_vtabptr_7example_PariInstance = &__pyx_vtable_7example_PariInstance;
  __pyx_vtable_7example_PariInstance.new_gen = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, GEN))__pyx_f_7example_12PariInstance_new_gen;
  __pyx_vtable_7example_PariInstance.new_gen_to_string = (PyObject *(*)(struct __pyx_obj_7example_PariInstance *, GEN))__pyx_f_7example_12PariInstance_new_gen_to_string;
  __pyx_vtable_7example_PariInstance.new_gen_noclear = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, GEN))__pyx_f_7example_12PariInstance_new_gen_noclear;
  __pyx_vtable_7example_PariInstance.new_gen_from_int = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, int))__pyx_f_7example_12PariInstance_new_gen_from_int;
  __pyx_vtable_7example_PariInstance.clear_stack = (void (*)(struct __pyx_obj_7example_PariInstance *))__pyx_f_7example_12PariInstance_clear_stack;
  __pyx_vtable_7example_PariInstance.set_mytop_to_avma = (void (*)(struct __pyx_obj_7example_PariInstance *))__pyx_f_7example_12PariInstance_set_mytop_to_avma;
  __pyx_vtable_7example_PariInstance.double_to_gen_c = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, double))__pyx_f_7example_12PariInstance_double_to_gen_c;
  __pyx_vtable_7example_PariInstance.double_to_GEN = (GEN (*)(struct __pyx_obj_7example_PariInstance *, double))__pyx_f_7example_12PariInstance_double_to_GEN;
  __pyx_vtable_7example_PariInstance.deepcopy_to_python_heap = (GEN (*)(struct __pyx_obj_7example_PariInstance *, GEN, pari_sp *))__pyx_f_7example_12PariInstance_deepcopy_to_python_heap;
  __pyx_vtable_7example_PariInstance.new_ref = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, GEN, struct __pyx_obj_7example_gen *))__pyx_f_7example_12PariInstance_new_ref;
  __pyx_vtable_7example_PariInstance._empty_vector = (struct __pyx_obj_7example_gen *(*)(struct __pyx_obj_7example_PariInstance *, long))__pyx_f_7example_12PariInstance__empty_vector;
  __pyx_vtable_7example_PariInstance.get_var = (long (*)(struct __pyx_obj_7example_PariInstance *, PyObject *))__pyx_f_7example_12PariInstance_get_var;
  __pyx_vtable_7example_PariInstance.toGEN = (GEN (*)(struct __pyx_obj_7example_PariInstance *, PyObject *, int))__pyx_f_7example_12PariInstance_toGEN;
  if (PyType_Ready(&__pyx_type_7example_PariInstance) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_PariInstance, "__init__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_12PariInstance___init__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_12PariInstance___init__.doc = __pyx_doc_7example_12PariInstance___init__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_12PariInstance___init__;
    }
  }
  #endif
  #if CYTHON_COMPILING_IN_CPYTHON
  {
    PyObject *wrapper = __Pyx_GetAttrString((PyObject *)&__pyx_type_7example_PariInstance, "__call__"); if (unlikely(!wrapper)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    if (Py_TYPE(wrapper) == &PyWrapperDescr_Type) {
      __pyx_wrapperbase_7example_12PariInstance_28__call__ = *((PyWrapperDescrObject *)wrapper)->d_base;
      __pyx_wrapperbase_7example_12PariInstance_28__call__.doc = __pyx_doc_7example_12PariInstance_28__call__;
      ((PyWrapperDescrObject *)wrapper)->d_base = &__pyx_wrapperbase_7example_12PariInstance_28__call__;
    }
  }
  #endif
  if (__Pyx_SetVtable(__pyx_type_7example_PariInstance.tp_dict, __pyx_vtabptr_7example_PariInstance) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "PariInstance", (PyObject *)&__pyx_type_7example_PariInstance) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7example_PariInstance = &__pyx_type_7example_PariInstance;
  /*--- Type import code ---*/
  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "type", 
  #if CYTHON_COMPILING_IN_PYPY
  sizeof(PyTypeObject),
  #else
  sizeof(PyHeapTypeObject),
  #endif
  0); if (unlikely(!__pyx_ptype_7cpython_4type_type)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), 0); if (unlikely(!__pyx_ptype_7cpython_7complex_complex)) {__pyx_filename = __pyx_f[3]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "example.pyx":3
 * 
 * 
 * import sys             # <<<<<<<<<<<<<<
 * import math
 * import types
 */
  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__sys), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__sys, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":4
 * 
 * import sys
 * import math             # <<<<<<<<<<<<<<
 * import types
 * import operator
 */
  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__math), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__math, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 4; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":5
 * import sys
 * import math
 * import types             # <<<<<<<<<<<<<<
 * import operator
 * include 'pari_err.pxi'
 */
  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__types), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__types, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":6
 * import math
 * import types
 * import operator             # <<<<<<<<<<<<<<
 * include 'pari_err.pxi'
 * include 'stdsage.pxi'
 */
  __pyx_t_1 = __Pyx_Import(((PyObject *)__pyx_n_s__operator), 0, -1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__operator, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "E:\Programmation\Packages\Sage\Test\stdsage.pxi":44
 * 
 * # Do this for every single module that links in stdsage.
 * init_csage_module()             # <<<<<<<<<<<<<<
 */
  init_csage_module();

  /* "example.pyx":14
 * #    int PyObject_HasAttrString(object o, char *attr_name)
 * 
 * def prec_bits_to_dec(int prec_in_bits):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to precision expressed in
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_1prec_bits_to_dec, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_bits_to_dec, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":37
 *     return int(prec_in_bits*log_2)
 * 
 * def prec_dec_to_bits(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_3prec_dec_to_bits, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_dec_to_bits, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 37; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":61
 *     return int(prec_in_dec*log_10)
 * 
 * def prec_bits_to_words(int prec_in_bits=0):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in bits to pari real precision
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_5prec_bits_to_words, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_bits_to_words, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":91
 *     return int(padded_bits/wordsize + 2)
 * 
 * pbw = prec_bits_to_words             # <<<<<<<<<<<<<<
 * 
 * def prec_words_to_bits(int prec_in_words):
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__prec_bits_to_words); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__pbw, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 91; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":93
 * pbw = prec_bits_to_words
 * 
 * def prec_words_to_bits(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from pari real precision expressed in words to precision
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_7prec_words_to_bits, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_words_to_bits, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":112
 *     return int((prec_in_words - 2) * BITS_IN_LONG)
 * 
 * def prec_dec_to_words(int prec_in_dec):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in decimal to precision expressed
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_9prec_dec_to_words, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_dec_to_words, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":130
 *     return prec_bits_to_words(prec_dec_to_bits(prec_in_dec))
 * 
 * def prec_words_to_dec(int prec_in_words):             # <<<<<<<<<<<<<<
 *     r"""
 *     Convert from precision expressed in words to precision expressed in
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_11prec_words_to_dec, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__prec_words_to_dec, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":151
 * # The unique running Pari instance.
 * cdef PariInstance pari_instance, P
 * pari_instance = PariInstance(16000000, 500000)             # <<<<<<<<<<<<<<
 * P = pari_instance   # shorthand notation
 * 
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_7example_PariInstance)), ((PyObject *)__pyx_k_tuple_94), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_XGOTREF(((PyObject *)__pyx_v_7example_pari_instance));
  __Pyx_DECREF(((PyObject *)__pyx_v_7example_pari_instance));
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_v_7example_pari_instance = ((struct __pyx_obj_7example_PariInstance *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":152
 * cdef PariInstance pari_instance, P
 * pari_instance = PariInstance(16000000, 500000)
 * P = pari_instance   # shorthand notation             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_INCREF(((PyObject *)__pyx_v_7example_pari_instance));
  __Pyx_XGOTREF(((PyObject *)__pyx_v_7example_P));
  __Pyx_DECREF(((PyObject *)__pyx_v_7example_P));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_7example_pari_instance));
  __pyx_v_7example_P = __pyx_v_7example_pari_instance;

  /* "example.pyx":155
 * 
 * 
 * NumberOfGEN=0             # <<<<<<<<<<<<<<
 * 
 * # PariInstance.__init__ must not create gen objects because their parent is not constructed yet
 */
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__NumberOfGEN, __pyx_int_0) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":158
 * 
 * # PariInstance.__init__ must not create gen objects because their parent is not constructed yet
 * sig_on()             # <<<<<<<<<<<<<<
 * pari_instance.PARI_ZERO = pari_instance.new_gen_noclear(gen_0)
 * pari_instance.PARI_ONE  = pari_instance.new_gen_noclear(gen_1)
 */
  __pyx_t_2 = _pari_sig_on(); if (unlikely(__pyx_t_2 == 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":159
 * # PariInstance.__init__ must not create gen objects because their parent is not constructed yet
 * sig_on()
 * pari_instance.PARI_ZERO = pari_instance.new_gen_noclear(gen_0)             # <<<<<<<<<<<<<<
 * pari_instance.PARI_ONE  = pari_instance.new_gen_noclear(gen_1)
 * pari_instance.PARI_TWO  = pari_instance.new_gen_noclear(gen_2)
 */
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_pari_instance->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_pari_instance, gen_0)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_7example_pari_instance->PARI_ZERO);
  __Pyx_DECREF(((PyObject *)__pyx_v_7example_pari_instance->PARI_ZERO));
  __pyx_v_7example_pari_instance->PARI_ZERO = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":160
 * sig_on()
 * pari_instance.PARI_ZERO = pari_instance.new_gen_noclear(gen_0)
 * pari_instance.PARI_ONE  = pari_instance.new_gen_noclear(gen_1)             # <<<<<<<<<<<<<<
 * pari_instance.PARI_TWO  = pari_instance.new_gen_noclear(gen_2)
 * sig_off()
 */
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_pari_instance->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_pari_instance, gen_1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_7example_pari_instance->PARI_ONE);
  __Pyx_DECREF(((PyObject *)__pyx_v_7example_pari_instance->PARI_ONE));
  __pyx_v_7example_pari_instance->PARI_ONE = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":161
 * pari_instance.PARI_ZERO = pari_instance.new_gen_noclear(gen_0)
 * pari_instance.PARI_ONE  = pari_instance.new_gen_noclear(gen_1)
 * pari_instance.PARI_TWO  = pari_instance.new_gen_noclear(gen_2)             # <<<<<<<<<<<<<<
 * sig_off()
 * 
 */
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_7example_PariInstance *)__pyx_v_7example_pari_instance->__pyx_vtab)->new_gen_noclear(__pyx_v_7example_pari_instance, gen_2)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __Pyx_GOTREF(__pyx_v_7example_pari_instance->PARI_TWO);
  __Pyx_DECREF(((PyObject *)__pyx_v_7example_pari_instance->PARI_TWO));
  __pyx_v_7example_pari_instance->PARI_TWO = ((struct __pyx_obj_7example_gen *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":162
 * pari_instance.PARI_ONE  = pari_instance.new_gen_noclear(gen_1)
 * pari_instance.PARI_TWO  = pari_instance.new_gen_noclear(gen_2)
 * sig_off()             # <<<<<<<<<<<<<<
 * 
 * # Also a copy of PARI accessible from external pure python code.
 */
  _pari_sig_off();

  /* "example.pyx":165
 * 
 * # Also a copy of PARI accessible from external pure python code.
 * pari = pari_instance             # <<<<<<<<<<<<<<
 * 
 * 
 */
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__pari, ((PyObject *)__pyx_v_7example_pari_instance)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "example.pyx":170
 * 
 * cdef GEN t0,t1,t2,t3,t4
 * t0heap = [0]*5             # <<<<<<<<<<<<<<
 * 
 * cdef t0GEN(x):
 */
  __pyx_t_1 = PyList_New(1 * 5); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  { Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp < 5; __pyx_temp++) {
      __Pyx_INCREF(__pyx_int_0);
      PyList_SET_ITEM(__pyx_t_1, __pyx_temp, __pyx_int_0);
      __Pyx_GIVEREF(__pyx_int_0);
    }
  }
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__t0heap, ((PyObject *)__pyx_t_1)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;

  /* "example.pyx":3628
 *         return P.new_gen(greal(x.g))
 * 
 *     def round(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         round(x,estimate=False): If x is a real number, returns x rounded
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_45 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":3824
 *         return sizedigit(x.g)
 * 
 *     def truncate(gen x, estimate=False):             # <<<<<<<<<<<<<<
 *         """
 *         truncate(x,estimate=False): Return the truncation of x. If estimate
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_46 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":5323
 *         return P.new_gen(ggcd0(x.g, t0))
 * 
 *     def issquare(gen x, find_root=False):             # <<<<<<<<<<<<<<
 *         """
 *         issquare(x,n): true(1) if x is a square, false(0) if not. If
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_47 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":5643
 * 
 * 
 *     def ellan(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         """
 *         Return the first `n` Fourier coefficients of the modular
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_48 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":5738
 * 
 * 
 *     def ellaplist(self, long n, python_ints=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         e.ellaplist(n): Returns a PARI list of all the prime-indexed
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_49 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":9389
 *     ############################################################
 * 
 *     def allocatemem(self, s=0, silent=False):             # <<<<<<<<<<<<<<
 *         r"""
 *         Double the *PARI* stack.
 */
  __pyx_t_1 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_k_61 = __pyx_t_1;
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;

  /* "example.pyx":9871
 * ##############################################
 * 
 * def init_pari_stack(size=8000000):             # <<<<<<<<<<<<<<
 *     """
 *     Change the PARI scratch stack space to the given size.
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_13init_pari_stack, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__init_pari_stack, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9871; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10090
 * 
 * 
 * def __errmessage(d):             # <<<<<<<<<<<<<<
 *     if d <= 0 or d > noer:
 *         return "unknown"
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_7example_15__errmessage, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s____errmessage, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10098
 * # compatibility with code that catches the latter. Once this is
 * # in production, we should change the base class to StandardError.
 * from exceptions import RuntimeError             # <<<<<<<<<<<<<<
 * 
 * # can we have "cdef class" ?
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_n_s__RuntimeError));
  PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__RuntimeError));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__RuntimeError));
  __pyx_t_3 = __Pyx_Import(((PyObject *)__pyx_n_s__exceptions), ((PyObject *)__pyx_t_1), -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__RuntimeError);
  if (__pyx_t_1 == NULL) {
    if (PyErr_ExceptionMatches(PyExc_AttributeError)) __Pyx_RaiseImportError(__pyx_n_s__RuntimeError);
    if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__RuntimeError, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "example.pyx":10103
 * # because of the inheritance, need to somehow "import" the built-in
 * # exception class...
 * class PariError (RuntimeError):             # <<<<<<<<<<<<<<
 * 
 *     errmessage = staticmethod(__errmessage)
 */
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));

  /* "example.pyx":10105
 * class PariError (RuntimeError):
 * 
 *     errmessage = staticmethod(__errmessage)             # <<<<<<<<<<<<<<
 * 
 *     def errnum(self):
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s____errmessage); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_staticmethod, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyObject_SetItem(__pyx_t_3, __pyx_n_s__errmessage, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10107
 *     errmessage = staticmethod(__errmessage)
 * 
 *     def errnum(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         Return the PARI error number corresponding to this exception.
 */
  __pyx_t_1 = __Pyx_CyFunction_NewEx(&__pyx_mdef_7example_9PariError_1errnum, 0, __pyx_n_s_101, NULL, __pyx_n_s__example, ((PyObject *)__pyx_k_codeobj_100)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetItem(__pyx_t_3, __pyx_n_s__errnum, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10121
 *         return self.args[0]
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         TESTS::
 */
  __pyx_t_1 = __Pyx_CyFunction_NewEx(&__pyx_mdef_7example_9PariError_3__repr__, 0, __pyx_n_s_104, NULL, __pyx_n_s__example, ((PyObject *)__pyx_k_codeobj_103)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetItem(__pyx_t_3, __pyx_n_s____repr__, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10130
 *         return "PariError(%d)"%self.errnum()
 * 
 *     def __str__(self):             # <<<<<<<<<<<<<<
 *         r"""
 *         EXAMPLES::
 */
  __pyx_t_1 = __Pyx_CyFunction_NewEx(&__pyx_mdef_7example_9PariError_5__str__, 0, __pyx_n_s_107, NULL, __pyx_n_s__example, ((PyObject *)__pyx_k_codeobj_106)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyObject_SetItem(__pyx_t_3, __pyx_n_s____str__, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "example.pyx":10103
 * # because of the inheritance, need to somehow "import" the built-in
 * # exception class...
 * class PariError (RuntimeError):             # <<<<<<<<<<<<<<
 * 
 *     errmessage = staticmethod(__errmessage)
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__RuntimeError); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_CreateClass(((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_3), __pyx_n_s__PariError, __pyx_n_s__PariError, __pyx_n_s__example); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__PariError, __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;

  /* "example.pyx":10145
 * 
 * 
 * def vecsmall_to_intlist(gen v):             # <<<<<<<<<<<<<<
 *     """
 *     INPUT:
 */
  __pyx_t_3 = PyCFunction_NewEx(&__pyx_mdef_7example_17vecsmall_to_intlist, NULL, __pyx_n_s__example); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__vecsmall_to_intlist, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "example.pyx":3
 * 
 * 
 * import sys             # <<<<<<<<<<<<<<
 * import math
 * import types
 */
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_3)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  if (__pyx_m) {
    __Pyx_AddTraceback("init example", __pyx_clineno, __pyx_lineno, __pyx_filename);
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init example");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* Runtime support code */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif /* CYTHON_REFNANNY */

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result) {
        if (dict != __pyx_b) {
            PyErr_Clear();
            result = PyObject_GetAttr(__pyx_b, name);
        }
        if (!result) {
            PyErr_SetObject(PyExc_NameError, name);
        }
    }
    return result;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AsString(kw_name));
        #endif
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;
    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
            continue;
        }
        name = first_kw_arg;
        #if PY_MAJOR_VERSION < 3
        if (likely(PyString_CheckExact(key)) || likely(PyString_Check(key))) {
            while (*name) {
                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
                        && _PyString_Eq(**name, key)) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    if ((**argname == key) || (
                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
                             && _PyString_Eq(**argname, key))) {
                        goto arg_passed_twice;
                    }
                    argname++;
                }
            }
        } else
        #endif
        if (likely(PyUnicode_Check(key))) {
            while (*name) {
                int cmp = (**name == key) ? 0 :
                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                    (PyUnicode_GET_SIZE(**name) != PyUnicode_GET_SIZE(key)) ? 1 :
                #endif
                    PyUnicode_Compare(**name, key);
                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                if (cmp == 0) {
                    values[name-argnames] = value;
                    break;
                }
                name++;
            }
            if (*name) continue;
            else {
                PyObject*** argname = argnames;
                while (argname != first_kw_arg) {
                    int cmp = (**argname == key) ? 0 :
                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
                        (PyUnicode_GET_SIZE(**argname) != PyUnicode_GET_SIZE(key)) ? 1 :
                    #endif
                        PyUnicode_Compare(**argname, key);
                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
                    if (cmp == 0) goto arg_passed_twice;
                    argname++;
                }
            }
        } else
            goto invalid_keyword_type;
        if (kwds2) {
            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
        } else {
            goto invalid_keyword;
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, key);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;
    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%s() takes %s %" CYTHON_FORMAT_SSIZE_T "d positional argument%s (%" CYTHON_FORMAT_SSIZE_T "d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

static CYTHON_INLINE int __Pyx_div_int(int a, int b) {
    int q = a / b;
    int r = a - q*b;
    q -= ((r != 0) & ((r ^ b) < 0));
    return q;
}

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
#if CPYTHON_COMPILING_IN_PYPY
    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
        goto invalid_keyword;
    return 1;
#else
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #endif
            if (unlikely(!PyUnicode_Check(key)))
                goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    return 0;
#endif
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (Py_TYPE(obj) == type) return 1;
    }
    else {
        if (PyObject_TypeCheck(obj, type)) return 1;
    }
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
    return 0;
}

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_Restore(type, value, tb);
#endif
}
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(type, value, tb);
#endif
}

#if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                        CYTHON_UNUSED PyObject *cause) {
    Py_XINCREF(type);
    if (!value || value == Py_None)
        value = NULL;
    else
        Py_INCREF(value);
    if (!tb || tb == Py_None)
        tb = NULL;
    else {
        Py_INCREF(tb);
        if (!PyTraceBack_Check(tb)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: arg 3 must be a traceback or None");
            goto raise_error;
        }
    }
    #if PY_VERSION_HEX < 0x02050000
    if (PyClass_Check(type)) {
    #else
    if (PyType_Check(type)) {
    #endif
#if CYTHON_COMPILING_IN_PYPY
        if (!value) {
            Py_INCREF(Py_None);
            value = Py_None;
        }
#endif
        PyErr_NormalizeException(&type, &value, &tb);
    } else {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                type = 0;
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) Py_TYPE(type);
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}
#else /* Python 3+ */
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *args;
        if (!value)
            args = PyTuple_New(0);
        else if (PyTuple_Check(value)) {
            Py_INCREF(value);
            args = value;
        }
        else
            args = PyTuple_Pack(1, value);
        if (!args)
            goto bad;
        owned_instance = PyEval_CallObject(type, args);
        Py_DECREF(args);
        if (!owned_instance)
            goto bad;
        value = owned_instance;
        if (!PyExceptionInstance_Check(value)) {
            PyErr_Format(PyExc_TypeError,
                         "calling %R should have returned an instance of "
                         "BaseException, not %R",
                         type, Py_TYPE(value));
            goto bad;
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
    if (cause && cause != Py_None) {
        PyObject *fixed_cause;
        if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        }
        else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        }
        else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}
#endif

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%s to unpack",
                 index, (index == 1) ? "" : "s");
}

static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

static int __Pyx_GetException(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *local_type, *local_value, *local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    local_type = tstate->curexc_type;
    local_value = tstate->curexc_value;
    local_tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
#else
    PyErr_Fetch(&local_type, &local_value, &local_tb);
#endif
    PyErr_NormalizeException(&local_type, &local_value, &local_tb);
#if CYTHON_COMPILING_IN_CPYTHON
    if (unlikely(tstate->curexc_type))
#else
    if (unlikely(PyErr_Occurred()))
#endif
        goto bad;
    #if PY_MAJOR_VERSION >= 3
    if (unlikely(PyException_SetTraceback(local_value, local_tb) < 0))
        goto bad;
    #endif
    Py_INCREF(local_type);
    Py_INCREF(local_value);
    Py_INCREF(local_tb);
    *type = local_type;
    *value = local_value;
    *tb = local_tb;
#if CYTHON_COMPILING_IN_CPYTHON
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = local_type;
    tstate->exc_value = local_value;
    tstate->exc_traceback = local_tb;
    /* Make sure tstate is in a consistent state when we XDECREF
       these objects (DECREF may run arbitrary code). */
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_SetExcInfo(local_type, local_value, local_tb);
#endif
    return 0;
bad:
    *type = 0;
    *value = 0;
    *tb = 0;
    Py_XDECREF(local_type);
    Py_XDECREF(local_value);
    Py_XDECREF(local_tb);
    return -1;
}

static double __Pyx__PyObject_AsDouble(PyObject* obj) {
    PyObject* float_value;
#if CYTHON_COMPILING_IN_PYPY
    float_value = PyNumber_Float(obj);
#else
    if (Py_TYPE(obj)->tp_as_number && Py_TYPE(obj)->tp_as_number->nb_float) {
        return PyFloat_AsDouble(obj);
    } else if (PyUnicode_CheckExact(obj) || PyBytes_CheckExact(obj)) {
#if PY_MAJOR_VERSION >= 3
        float_value = PyFloat_FromString(obj);
#else
        float_value = PyFloat_FromString(obj, 0);
#endif
    } else {
        PyObject* args = PyTuple_New(1);
        if (unlikely(!args)) goto bad;
        PyTuple_SET_ITEM(args, 0, obj);
        float_value = PyObject_Call((PyObject*)&PyFloat_Type, args, 0);
        PyTuple_SET_ITEM(args, 0, 0);
        Py_DECREF(args);
    }
#endif
    if (likely(float_value)) {
        double value = PyFloat_AS_DOUBLE(float_value);
        Py_DECREF(float_value);
        return value;
    }
bad:
    return (double)-1;
}

static CYTHON_INLINE void __Pyx_ExceptionSave(PyObject **type, PyObject **value, PyObject **tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->exc_type;
    *value = tstate->exc_value;
    *tb = tstate->exc_traceback;
    Py_XINCREF(*type);
    Py_XINCREF(*value);
    Py_XINCREF(*tb);
#else
    PyErr_GetExcInfo(type, value, tb);
#endif
}
static void __Pyx_ExceptionReset(PyObject *type, PyObject *value, PyObject *tb) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();
    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;
    tstate->exc_type = type;
    tstate->exc_value = value;
    tstate->exc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
#else
    PyErr_SetExcInfo(type, value, tb);
#endif
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import = 0;
    py_import = __Pyx_GetAttrString(__pyx_b, "__import__");
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    #if PY_VERSION_HEX >= 0x02050000
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0; /* try absolute import on failure */
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
    #else
    if (level>0) {
        PyErr_SetString(PyExc_RuntimeError, "Relative import is not supported for Python <=2.4.");
        goto bad;
    }
    module = PyObject_CallFunctionObjArgs(py_import,
        name, global_dict, empty_dict, list, NULL);
    #endif
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

static CYTHON_INLINE void __Pyx_RaiseImportError(PyObject *name) {
#if PY_MAJOR_VERSION < 3
    PyErr_Format(PyExc_ImportError, "cannot import name %.230s",
                 PyString_AsString(name));
#else
    PyErr_Format(PyExc_ImportError, "cannot import name %S", name);
#endif
}

static PyObject *__Pyx_FindPy2Metaclass(PyObject *bases) {
    PyObject *metaclass;
#if PY_MAJOR_VERSION < 3
    if (PyTuple_Check(bases) && PyTuple_GET_SIZE(bases) > 0) {
        PyObject *base = PyTuple_GET_ITEM(bases, 0);
        metaclass = PyObject_GetAttrString(base, (char *)"__class__");
        if (!metaclass) {
            PyErr_Clear();
            metaclass = (PyObject*) Py_TYPE(base);
        }
    } else {
        metaclass = (PyObject *) &PyClass_Type;
    }
#else
    if (PyTuple_Check(bases) && PyTuple_GET_SIZE(bases) > 0) {
        PyObject *base = PyTuple_GET_ITEM(bases, 0);
        metaclass = (PyObject*) Py_TYPE(base);
    } else {
        metaclass = (PyObject *) &PyType_Type;
    }
#endif
    Py_INCREF(metaclass);
    return metaclass;
}

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name,
                                   PyObject *qualname, PyObject *modname) {
    PyObject *result;
    PyObject *metaclass;
    if (PyDict_SetItemString(dict, "__module__", modname) < 0)
        return NULL;
    if (PyDict_SetItemString(dict, "__qualname__", qualname) < 0)
        return NULL;
    metaclass = PyDict_GetItemString(dict, "__metaclass__");
    if (metaclass) {
        Py_INCREF(metaclass);
    } else {
        metaclass = __Pyx_FindPy2Metaclass(bases);
    }
    result = PyObject_CallFunctionObjArgs(metaclass, name, bases, dict, NULL);
    Py_DECREF(metaclass);
    return result;
}

static PyObject *
__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
{
    if (unlikely(op->func_doc == NULL)) {
        if (op->func.m_ml->ml_doc) {
#if PY_MAJOR_VERSION >= 3
            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
#else
            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
#endif
            if (unlikely(op->func_doc == NULL))
                return NULL;
        } else {
            Py_INCREF(Py_None);
            return Py_None;
        }
    }
    Py_INCREF(op->func_doc);
    return op->func_doc;
}
static int
__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp = op->func_doc;
    if (value == NULL)
        value = Py_None; /* Mark as deleted */
    Py_INCREF(value);
    op->func_doc = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_name == NULL)) {
#if PY_MAJOR_VERSION >= 3
        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
#else
        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
#endif
        if (unlikely(op->func_name == NULL))
            return NULL;
    }
    Py_INCREF(op->func_name);
    return op->func_name;
}
static int
__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__name__ must be set to a string object");
        return -1;
    }
    tmp = op->func_name;
    Py_INCREF(value);
    op->func_name = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op)
{
    Py_INCREF(op->func_qualname);
    return op->func_qualname;
}
static int
__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
#if PY_MAJOR_VERSION >= 3
    if (unlikely(value == NULL || !PyUnicode_Check(value))) {
#else
    if (unlikely(value == NULL || !PyString_Check(value))) {
#endif
        PyErr_SetString(PyExc_TypeError,
                        "__qualname__ must be set to a string object");
        return -1;
    }
    tmp = op->func_qualname;
    Py_INCREF(value);
    op->func_qualname = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
{
    PyObject *self;
    self = m->func_closure;
    if (self == NULL)
        self = Py_None;
    Py_INCREF(self);
    return self;
}
static PyObject *
__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op)
{
    if (unlikely(op->func_dict == NULL)) {
        op->func_dict = PyDict_New();
        if (unlikely(op->func_dict == NULL))
            return NULL;
    }
    Py_INCREF(op->func_dict);
    return op->func_dict;
}
static int
__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value)
{
    PyObject *tmp;
    if (unlikely(value == NULL)) {
        PyErr_SetString(PyExc_TypeError,
               "function's dictionary may not be deleted");
        return -1;
    }
    if (unlikely(!PyDict_Check(value))) {
        PyErr_SetString(PyExc_TypeError,
               "setting function's dictionary to a non-dict");
        return -1;
    }
    tmp = op->func_dict;
    Py_INCREF(value);
    op->func_dict = value;
    Py_XDECREF(tmp);
    return 0;
}
static PyObject *
__Pyx_CyFunction_get_globals(CYTHON_UNUSED __pyx_CyFunctionObject *op)
{
    PyObject* dict = PyModule_GetDict(__pyx_m);
    Py_XINCREF(dict);
    return dict;
}
static PyObject *
__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op)
{
    Py_INCREF(Py_None);
    return Py_None;
}
static PyObject *
__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op)
{
    PyObject* result = (op->func_code) ? op->func_code : Py_None;
    Py_INCREF(result);
    return result;
}
static PyObject *
__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op)
{
    if (op->defaults_tuple) {
        Py_INCREF(op->defaults_tuple);
        return op->defaults_tuple;
    }
    if (op->defaults_getter) {
        PyObject *res = op->defaults_getter((PyObject *) op);
        if (likely(res)) {
            Py_INCREF(res);
            op->defaults_tuple = res;
        }
        return res;
    }
    Py_INCREF(Py_None);
    return Py_None;
}
static PyGetSetDef __pyx_CyFunction_getsets[] = {
    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, 0, 0, 0},
    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, 0, 0, 0},
    {0, 0, 0, 0, 0}
};
#ifndef PY_WRITE_RESTRICTED /* < Py2.5 */
#define PY_WRITE_RESTRICTED WRITE_RESTRICTED
#endif
static PyMemberDef __pyx_CyFunction_members[] = {
    {(char *) "__module__", T_OBJECT, offsetof(__pyx_CyFunctionObject, func.m_module), PY_WRITE_RESTRICTED, 0},
    {0, 0, 0,  0, 0}
};
static PyObject *
__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromString(m->func.m_ml->ml_name);
#else
    return PyString_FromString(m->func.m_ml->ml_name);
#endif
}
static PyMethodDef __pyx_CyFunction_methods[] = {
    {__Pyx_NAMESTR("__reduce__"), (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
    {0, 0, 0, 0}
};
static PyObject *__Pyx_CyFunction_New(PyTypeObject *type, PyMethodDef *ml, int flags, PyObject* qualname,
                                      PyObject *closure, PyObject *module, PyObject* code) {
    __pyx_CyFunctionObject *op = PyObject_GC_New(__pyx_CyFunctionObject, type);
    if (op == NULL)
        return NULL;
    op->flags = flags;
    op->func_weakreflist = NULL;
    op->func.m_ml = ml;
    op->func.m_self = (PyObject *) op;
    Py_XINCREF(closure);
    op->func_closure = closure;
    Py_XINCREF(module);
    op->func.m_module = module;
    op->func_dict = NULL;
    op->func_name = NULL;
    Py_INCREF(qualname);
    op->func_qualname = qualname;
    op->func_doc = NULL;
    op->func_classobj = NULL;
    Py_XINCREF(code);
    op->func_code = code;
    op->defaults_pyobjects = 0;
    op->defaults = NULL;
    op->defaults_tuple = NULL;
    op->defaults_getter = NULL;
    PyObject_GC_Track(op);
    return (PyObject *) op;
}
static int
__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
{
    Py_CLEAR(m->func_closure);
    Py_CLEAR(m->func.m_module);
    Py_CLEAR(m->func_dict);
    Py_CLEAR(m->func_name);
    Py_CLEAR(m->func_qualname);
    Py_CLEAR(m->func_doc);
    Py_CLEAR(m->func_code);
    Py_CLEAR(m->func_classobj);
    Py_CLEAR(m->defaults_tuple);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_XDECREF(pydefaults[i]);
        PyMem_Free(m->defaults);
        m->defaults = NULL;
    }
    return 0;
}
static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
{
    PyObject_GC_UnTrack(m);
    if (m->func_weakreflist != NULL)
        PyObject_ClearWeakRefs((PyObject *) m);
    __Pyx_CyFunction_clear(m);
    PyObject_GC_Del(m);
}
static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
{
    Py_VISIT(m->func_closure);
    Py_VISIT(m->func.m_module);
    Py_VISIT(m->func_dict);
    Py_VISIT(m->func_name);
    Py_VISIT(m->func_qualname);
    Py_VISIT(m->func_doc);
    Py_VISIT(m->func_code);
    Py_VISIT(m->func_classobj);
    Py_VISIT(m->defaults_tuple);
    if (m->defaults) {
        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
        int i;
        for (i = 0; i < m->defaults_pyobjects; i++)
            Py_VISIT(pydefaults[i]);
    }
    return 0;
}
static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
{
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
        Py_INCREF(func);
        return func;
    }
    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
        if (type == NULL)
            type = (PyObject *)(Py_TYPE(obj));
        return PyMethod_New(func,
                            type, (PyObject *)(Py_TYPE(type)));
    }
    if (obj == Py_None)
        obj = NULL;
    return PyMethod_New(func, obj, type);
}
static PyObject*
__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
{
#if PY_MAJOR_VERSION >= 3
    return PyUnicode_FromFormat("<cyfunction %U at %p>",
                                op->func_qualname, (void *)op);
#else
    return PyString_FromFormat("<cyfunction %s at %p>",
                               PyString_AsString(op->func_qualname), (void *)op);
#endif
}
#if CYTHON_COMPILING_IN_PYPY
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyCFunctionObject* f = (PyCFunctionObject*)func;
    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
    PyObject *self = PyCFunction_GET_SELF(func);
    Py_ssize_t size;
    switch (PyCFunction_GET_FLAGS(func) & ~(METH_CLASS | METH_STATIC | METH_COEXIST)) {
    case METH_VARARGS:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0)
            return (*meth)(self, arg);
        break;
    case METH_VARARGS | METH_KEYWORDS:
        return (*(PyCFunctionWithKeywords)meth)(self, arg, kw);
    case METH_NOARGS:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0) {
            size = PyTuple_GET_SIZE(arg);
            if (size == 0)
                return (*meth)(self, NULL);
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes no arguments (%zd given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    case METH_O:
        if (likely(kw == NULL) || PyDict_Size(kw) == 0) {
            size = PyTuple_GET_SIZE(arg);
            if (size == 1)
                return (*meth)(self, PyTuple_GET_ITEM(arg, 0));
            PyErr_Format(PyExc_TypeError,
                "%.200s() takes exactly one argument (%zd given)",
                f->m_ml->ml_name, size);
            return NULL;
        }
        break;
    default:
        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
                        "longer supported!");
        return NULL;
    }
    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
                 f->m_ml->ml_name);
    return NULL;
}
#else
static PyObject * __Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
	return PyCFunction_Call(func, arg, kw);
}
#endif
static PyTypeObject __pyx_CyFunctionType_type = {
    PyVarObject_HEAD_INIT(0, 0)
    __Pyx_NAMESTR("cython_function_or_method"), /*tp_name*/
    sizeof(__pyx_CyFunctionObject),   /*tp_basicsize*/
    0,                                  /*tp_itemsize*/
    (destructor) __Pyx_CyFunction_dealloc, /*tp_dealloc*/
    0,                                  /*tp_print*/
    0,                                  /*tp_getattr*/
    0,                                  /*tp_setattr*/
#if PY_MAJOR_VERSION < 3
    0,                                  /*tp_compare*/
#else
    0,                                  /*reserved*/
#endif
    (reprfunc) __Pyx_CyFunction_repr,   /*tp_repr*/
    0,                                  /*tp_as_number*/
    0,                                  /*tp_as_sequence*/
    0,                                  /*tp_as_mapping*/
    0,                                  /*tp_hash*/
    __Pyx_CyFunction_Call,              /*tp_call*/
    0,                                  /*tp_str*/
    0,                                  /*tp_getattro*/
    0,                                  /*tp_setattro*/
    0,                                  /*tp_as_buffer*/
    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC, /* tp_flags*/
    0,                                  /*tp_doc*/
    (traverseproc) __Pyx_CyFunction_traverse,   /*tp_traverse*/
    (inquiry) __Pyx_CyFunction_clear,   /*tp_clear*/
    0,                                  /*tp_richcompare*/
    offsetof(__pyx_CyFunctionObject, func_weakreflist), /* tp_weaklistoffse */
    0,                                  /*tp_iter*/
    0,                                  /*tp_iternext*/
    __pyx_CyFunction_methods,           /*tp_methods*/
    __pyx_CyFunction_members,           /*tp_members*/
    __pyx_CyFunction_getsets,           /*tp_getset*/
    0,                                  /*tp_base*/
    0,                                  /*tp_dict*/
    __Pyx_CyFunction_descr_get,         /*tp_descr_get*/
    0,                                  /*tp_descr_set*/
    offsetof(__pyx_CyFunctionObject, func_dict),/*tp_dictoffset*/
    0,                                  /*tp_init*/
    0,                                  /*tp_alloc*/
    0,                                  /*tp_new*/
    0,                                  /*tp_free*/
    0,                                  /*tp_is_gc*/
    0,                                  /*tp_bases*/
    0,                                  /*tp_mro*/
    0,                                  /*tp_cache*/
    0,                                  /*tp_subclasses*/
    0,                                  /*tp_weaklist*/
    0,                                  /*tp_del*/
#if PY_VERSION_HEX >= 0x02060000
    0,                                  /*tp_version_tag*/
#endif
};
static int __Pyx_CyFunction_init(void) {
#if !CYTHON_COMPILING_IN_PYPY
    __pyx_CyFunctionType_type.tp_call = PyCFunction_Call;
#endif
    if (PyType_Ready(&__pyx_CyFunctionType_type) < 0)
        return -1;
    __pyx_CyFunctionType = &__pyx_CyFunctionType_type;
    return 0;
}
static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults = PyMem_Malloc(size);
    if (!m->defaults)
        return PyErr_NoMemory();
    memset(m->defaults, 0, sizeof(size));
    m->defaults_pyobjects = pyobjects;
    return m->defaults;
}
static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
    m->defaults_tuple = tuple;
    Py_INCREF(tuple);
}

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_pari_sp(pari_sp val) {
    const pari_sp neg_one = (pari_sp)-1, const_zero = (pari_sp)0;
    const int is_unsigned = const_zero < neg_one;
    if ((sizeof(pari_sp) == sizeof(char))  ||
        (sizeof(pari_sp) == sizeof(short))) {
        return PyInt_FromLong((long)val);
    } else if ((sizeof(pari_sp) == sizeof(int)) ||
               (sizeof(pari_sp) == sizeof(long))) {
        if (is_unsigned)
            return PyLong_FromUnsignedLong((unsigned long)val);
        else
            return PyInt_FromLong((long)val);
    } else if (sizeof(pari_sp) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)val);
        else
            return PyLong_FromLongLong((PY_LONG_LONG)val);
    } else {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        return _PyLong_FromByteArray(bytes, sizeof(pari_sp),
                                     little, !is_unsigned);
    }
}

static PyObject* __Pyx_Globals(void) {
    Py_ssize_t i;
    PyObject *names = NULL;
    PyObject *globals = PyObject_GetAttrString(__pyx_m, "__dict__");
    if (!globals) {
        PyErr_SetString(PyExc_TypeError,
            "current module must have __dict__ attribute");
        goto bad;
    }
    names = PyObject_Dir(__pyx_m);
    if (!names)
        goto bad;
    for (i = PyList_GET_SIZE(names)-1; i >= 0; i--) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject* name = PySequence_GetItem(names, i);
        if (!name)
            goto bad;
#else
        PyObject* name = PyList_GET_ITEM(names, i);
#endif
        if (!PyDict_Contains(globals, name)) {
            PyObject* value = PyObject_GetAttr(__pyx_m, name);
            if (!value) {
#if CYTHON_COMPILING_IN_PYPY
                Py_DECREF(name);
#endif
                goto bad;
            }
            if (PyDict_SetItem(globals, name, value) < 0) {
#if CYTHON_COMPILING_IN_PYPY
                Py_DECREF(name);
#endif
                Py_DECREF(value);
                goto bad;
            }
        }
#if CYTHON_COMPILING_IN_PYPY
        Py_DECREF(name);
#endif
    }
    Py_DECREF(names);
    return globals;
bad:
    Py_XDECREF(names);
    Py_XDECREF(globals);
    return NULL;
}

static CYTHON_INLINE pari_sp __Pyx_PyInt_from_py_pari_sp(PyObject* x) {
    const pari_sp neg_one = (pari_sp)-1, const_zero = (pari_sp)0;
    const int is_unsigned = const_zero < neg_one;
    if (sizeof(pari_sp) == sizeof(char)) {
        if (is_unsigned)
            return (pari_sp)__Pyx_PyInt_AsUnsignedChar(x);
        else
            return (pari_sp)__Pyx_PyInt_AsSignedChar(x);
    } else if (sizeof(pari_sp) == sizeof(short)) {
        if (is_unsigned)
            return (pari_sp)__Pyx_PyInt_AsUnsignedShort(x);
        else
            return (pari_sp)__Pyx_PyInt_AsSignedShort(x);
    } else if (sizeof(pari_sp) == sizeof(int)) {
        if (is_unsigned)
            return (pari_sp)__Pyx_PyInt_AsUnsignedInt(x);
        else
            return (pari_sp)__Pyx_PyInt_AsSignedInt(x);
    } else if (sizeof(pari_sp) == sizeof(long)) {
        if (is_unsigned)
            return (pari_sp)__Pyx_PyInt_AsUnsignedLong(x);
        else
            return (pari_sp)__Pyx_PyInt_AsSignedLong(x);
    } else if (sizeof(pari_sp) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return (pari_sp)__Pyx_PyInt_AsUnsignedLongLong(x);
        else
            return (pari_sp)__Pyx_PyInt_AsSignedLongLong(x);
    }  else {
        #if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
        PyErr_SetString(PyExc_RuntimeError,
                        "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
        #else
        pari_sp val;
        PyObject *v = __Pyx_PyNumber_Int(x);
        #if PY_VERSION_HEX < 0x03000000
        if (likely(v) && !PyLong_Check(v)) {
            PyObject *tmp = v;
            v = PyNumber_Long(tmp);
            Py_DECREF(tmp);
        }
        #endif
        if (likely(v)) {
            int one = 1; int is_little = (int)*(unsigned char *)&one;
            unsigned char *bytes = (unsigned char *)&val;
            int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                          bytes, sizeof(val),
                                          is_little, !is_unsigned);
            Py_DECREF(v);
            if (likely(!ret))
                return val;
        }
        #endif
        return (pari_sp)-1;
    }
}

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject((char *)"stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}
static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
    int i;
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        PyObject* v;
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                goto error;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            goto error;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0 &&
                isspace(Py_CHARMASK(s[len-1])) &&
                s[len-1] != ' ')
                    PyFile_SoftSpace(f, 0);
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            goto error;
        PyFile_SoftSpace(f, 0);
    }
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
}
#else /* Python 3 has a print function */
static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (unlikely(!__pyx_print)) {
        __pyx_print = __Pyx_GetAttrString(__pyx_b, "print");
        if (!__pyx_print)
            return -1;
    }
    if (stream) {
        kwargs = PyDict_New();
        if (unlikely(!kwargs))
            return -1;
        if (unlikely(PyDict_SetItemString(kwargs, "file", stream) < 0))
            goto bad;
        if (!newline) {
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                goto bad;
            if (PyDict_SetItemString(kwargs, "end", end_string) < 0) {
                Py_DECREF(end_string);
                goto bad;
            }
            Py_DECREF(end_string);
        }
    } else if (!newline) {
        if (unlikely(!__pyx_print_kwargs)) {
            __pyx_print_kwargs = PyDict_New();
            if (unlikely(!__pyx_print_kwargs))
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (unlikely(!end_string))
                return -1;
            if (PyDict_SetItemString(__pyx_print_kwargs, "end", end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
        Py_DECREF(kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
bad:
    if (kwargs != __pyx_print_kwargs)
        Py_XDECREF(kwargs);
    return -1;
}
#endif

#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
    if (!f) {
        if (!(f = __Pyx_GetStdout()))
            return -1;
    }
    Py_INCREF(f);
    if (PyFile_SoftSpace(f, 0)) {
        if (PyFile_WriteString(" ", f) < 0)
            goto error;
    }
    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
        goto error;
    if (PyFile_WriteString("\n", f) < 0)
        goto error;
    Py_DECREF(f);
    return 0;
error:
    Py_DECREF(f);
    return -1;
    /* the line below is just to avoid C compiler
     * warnings about unused functions */
    return __Pyx_Print(f, NULL, 0);
}
#else /* Python 3 has a print function */
static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
    int res;
    PyObject* arg_tuple = PyTuple_Pack(1, o);
    if (unlikely(!arg_tuple))
        return -1;
    res = __Pyx_Print(stream, arg_tuple, 1);
    Py_DECREF(arg_tuple);
    return res;
}
#endif

static CYTHON_INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject* x) {
    const unsigned char neg_one = (unsigned char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned char" :
                    "value too large to convert to unsigned char");
            }
            return (unsigned char)-1;
        }
        return (unsigned char)val;
    }
    return (unsigned char)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject* x) {
    const unsigned short neg_one = (unsigned short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned short" :
                    "value too large to convert to unsigned short");
            }
            return (unsigned short)-1;
        }
        return (unsigned short)val;
    }
    return (unsigned short)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject* x) {
    const unsigned int neg_one = (unsigned int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned int" :
                    "value too large to convert to unsigned int");
            }
            return (unsigned int)-1;
        }
        return (unsigned int)val;
    }
    return (unsigned int)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE char __Pyx_PyInt_AsChar(PyObject* x) {
    const char neg_one = (char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to char" :
                    "value too large to convert to char");
            }
            return (char)-1;
        }
        return (char)val;
    }
    return (char)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE short __Pyx_PyInt_AsShort(PyObject* x) {
    const short neg_one = (short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to short" :
                    "value too large to convert to short");
            }
            return (short)-1;
        }
        return (short)val;
    }
    return (short)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE int __Pyx_PyInt_AsInt(PyObject* x) {
    const int neg_one = (int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to int" :
                    "value too large to convert to int");
            }
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject* x) {
    const signed char neg_one = (signed char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed char" :
                    "value too large to convert to signed char");
            }
            return (signed char)-1;
        }
        return (signed char)val;
    }
    return (signed char)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject* x) {
    const signed short neg_one = (signed short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed short" :
                    "value too large to convert to signed short");
            }
            return (signed short)-1;
        }
        return (signed short)val;
    }
    return (signed short)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject* x) {
    const signed int neg_one = (signed int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed int" :
                    "value too large to convert to signed int");
            }
            return (signed int)-1;
        }
        return (signed int)val;
    }
    return (signed int)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject* x) {
    const int neg_one = (int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to int" :
                    "value too large to convert to int");
            }
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject* x) {
    const unsigned long neg_one = (unsigned long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned long");
            return (unsigned long)-1;
        }
        return (unsigned long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned long");
                return (unsigned long)-1;
            }
            return (unsigned long)PyLong_AsUnsignedLong(x);
        } else {
            return (unsigned long)PyLong_AsLong(x);
        }
    } else {
        unsigned long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned long)-1;
        val = __Pyx_PyInt_AsUnsignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    const unsigned PY_LONG_LONG neg_one = (unsigned PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned PY_LONG_LONG");
            return (unsigned PY_LONG_LONG)-1;
        }
        return (unsigned PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned PY_LONG_LONG");
                return (unsigned PY_LONG_LONG)-1;
            }
            return (unsigned PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (unsigned PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        unsigned PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE long __Pyx_PyInt_AsLong(PyObject* x) {
    const long neg_one = (long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to long");
            return (long)-1;
        }
        return (long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to long");
                return (long)-1;
            }
            return (long)PyLong_AsUnsignedLong(x);
        } else {
            return (long)PyLong_AsLong(x);
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long)-1;
        val = __Pyx_PyInt_AsLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject* x) {
    const PY_LONG_LONG neg_one = (PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to PY_LONG_LONG");
            return (PY_LONG_LONG)-1;
        }
        return (PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to PY_LONG_LONG");
                return (PY_LONG_LONG)-1;
            }
            return (PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject* x) {
    const signed long neg_one = (signed long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed long");
            return (signed long)-1;
        }
        return (signed long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed long");
                return (signed long)-1;
            }
            return (signed long)PyLong_AsUnsignedLong(x);
        } else {
            return (signed long)PyLong_AsLong(x);
        }
    } else {
        signed long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed long)-1;
        val = __Pyx_PyInt_AsSignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject* x) {
    const signed PY_LONG_LONG neg_one = (signed PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed PY_LONG_LONG");
            return (signed PY_LONG_LONG)-1;
        }
        return (signed PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed PY_LONG_LONG");
                return (signed PY_LONG_LONG)-1;
            }
            return (signed PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (signed PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        signed PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsSignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static void __Pyx_WriteUnraisable(const char *name, CYTHON_UNUSED int clineno,
                                  CYTHON_UNUSED int lineno, CYTHON_UNUSED const char *filename) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
    #if PY_MAJOR_VERSION < 3
    ctx = PyString_FromString(name);
    #else
    ctx = PyUnicode_FromString(name);
    #endif
    __Pyx_ErrRestore(old_exc, old_val, old_tb);
    if (!ctx) {
        PyErr_WriteUnraisable(Py_None);
    } else {
        PyErr_WriteUnraisable(ctx);
        Py_DECREF(ctx);
    }
}

static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        #if PY_VERSION_HEX < 0x02050000
        return PyErr_Warn(NULL, message);
        #else
        return PyErr_WarnEx(NULL, message, 1);
        #endif
    }
    return 0;
}

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;
    d = PyObject_GetAttrString(__pyx_m, (char *)"__pyx_capi__");
    if (!d) {
        PyErr_Clear();
        d = PyDict_New();
        if (!d)
            goto bad;
        Py_INCREF(d);
        if (PyModule_AddObject(__pyx_m, (char *)"__pyx_capi__", d) < 0)
            goto bad;
    }
    tmp.fp = f;
#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
    cobj = PyCapsule_New(tmp.p, sig, 0);
#else
    cobj = PyCObject_FromVoidPtrAndDesc(tmp.p, (void *)sig, 0);
#endif
    if (!cobj)
        goto bad;
    if (PyDict_SetItemString(d, name, cobj) < 0)
        goto bad;
    Py_DECREF(cobj);
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(cobj);
    Py_XDECREF(d);
    return -1;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
#else
    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
#endif
    if (!ob)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", ob) < 0)
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;
    py_name = __Pyx_PyIdentifier_FromString(name);
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];
    Py_ssize_t basicsize;
#ifdef Py_LIMITED_API
    PyObject *py_basicsize;
#endif
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    py_name = __Pyx_PyIdentifier_FromString(class_name);
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
#ifndef Py_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
#else
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (!strict && (size_t)basicsize > size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility",
            module_name, class_name);
        #if PY_VERSION_HEX < 0x02050000
        if (PyErr_Warn(NULL, warning) < 0) goto bad;
        #else
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
        #endif
    }
    else if ((size_t)basicsize != size) {
        PyErr_Format(PyExc_ValueError,
            "%s.%s has the wrong size, try recompiling",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = (start + end) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,            /*int argcount,*/
        0,            /*int kwonlyargcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,      /*int firstlineno,*/
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_globals = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_VERSION_HEX < 0x03000000
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_VERSION_HEX < 0x03000000
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_VERSION_HEX < 0x03000000
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%s__ returned non-%s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
#if PY_VERSION_HEX < 0x02050000
   if (ival <= LONG_MAX)
       return PyInt_FromLong((long)ival);
   else {
       unsigned char *bytes = (unsigned char *) &ival;
       int one = 1; int little = (int)*(unsigned char*)&one;
       return _PyLong_FromByteArray(bytes, sizeof(size_t), little, 0);
   }
#else
   return PyInt_FromSize_t(ival);
#endif
}
static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject* x) {
   unsigned PY_LONG_LONG val = __Pyx_PyInt_AsUnsignedLongLong(x);
   if (unlikely(val == (unsigned PY_LONG_LONG)-1 && PyErr_Occurred())) {
       return (size_t)-1;
   } else if (unlikely(val != (unsigned PY_LONG_LONG)(size_t)val)) {
       PyErr_SetString(PyExc_OverflowError,
                       "value too large to convert to size_t");
       return (size_t)-1;
   }
   return (size_t)val;
}


#endif /* Py_PYTHON_H */
